// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../layers/support/fieldUtils ./support/utils ../support/utils".split(" "),function(y,z,v,n,e,c,p,q,f){function w(b){return e(this,void 0,void 0,function(){var a,h,d,r,k,g,l,e,t,u;return n(this,function(m){switch(m.label){case 0:if(!(b&&b.layer&&(b.field||b.valueExpression||b.sqlExpression)))throw new c("histogram:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");
if(b.valueExpression&&!b.sqlExpression&&!b.view)throw new c("histogram:missing-parameters","View is required when 'valueExpression' is specified");a=v({},b);a.normalizationType=f.getNormalizationType(a);h=[0,2,1,3,4];d=f.createLayerAdapter(a.layer,h);a.layer=d;if(!d)throw new c("histogram:invalid-parameters","'layer' must be one of these types: "+f.getLayerTypeLabels(h).join(", "));return[4,d.load()];case 1:return m.sent(),r=a.valueExpression||a.sqlExpression,g=(k=a.field)?d.getField(k):null,l=!a.classificationMethod||
"equal-interval"===a.classificationMethod,[4,f.getFieldsList({field:k,normalizationField:a.normalizationField,valueExpression:a.valueExpression})];case 2:e=m.sent();if(t=q.verifyBasicFieldValidity(d,e,"histogram:invalid-parameters"))throw t;if(g){if(u=q.verifyFieldType(d,g,"histogram:invalid-parameters",x))throw u;if(p.isDateField(g)){if(a.normalizationType)throw new c("histogram:invalid-parameters","Normalization is not allowed for date fields");if(!l)throw new c("histogram:invalid-parameters","'classificationMethod' other than 'equal-interval' is not allowed for date fields");
}}else if(r){if(a.normalizationType)throw new c("histogram:invalid-parameters","Normalization is not allowed when 'valueExpression' or 'sqlExpression' is specified");if(!l)throw new c("histogram:invalid-parameters","'classificationMethod' other than 'equal-interval' is not allowed when 'valueExpression' or 'sqlExpression' is specified");}return[2,a]}})})}var x=["date"].concat(p.numericTypes);return function(b){return e(this,void 0,void 0,function(){var a,c,d;return n(this,function(e){switch(e.label){case 0:return[4,
w(b)];case 1:return a=e.sent(),c=a.layer,d={field:a.field,valueExpression:a.valueExpression,sqlExpression:a.sqlExpression,sqlWhere:a.sqlWhere,normalizationType:a.normalizationType,normalizationField:a.normalizationField,classificationMethod:a.classificationMethod,standardDeviationInterval:a.standardDeviationInterval,numBins:a.numBins,minValue:a.minValue,maxValue:a.maxValue,features:a.features,view:a.view},[2,c.histogram(d)]}})})}});