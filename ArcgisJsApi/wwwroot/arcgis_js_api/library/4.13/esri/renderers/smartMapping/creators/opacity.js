// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ./support/utils ../statistics/summaryStatistics ../support/utils ../../support/AuthoringInfo ../../support/AuthoringInfoVisualVariable ../../visualVariables/OpacityVariable".split(" "),function(z,n,r,p,q,k,t,l,u,m,v,w,x){function y(e){return q(this,void 0,void 0,function(){var a,g,b,d,f;return p(this,function(c){switch(c.label){case 0:if(!(e&&
e.layer&&(e.field||e.valueExpression||e.sqlExpression)))throw new k("opacity-visual-variable:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(e.valueExpression&&!e.view)throw new k("opacity-visual-variable:missing-parameters","View is required when 'valueExpression' is specified");a=r({},e);g=[0,2,1,3];b=m.createLayerAdapter(a.layer,g);a.layer=b;if(!b)throw new k("opacity-visual-variable:invalid-parameters","'layer' must be one of these types: "+
m.getLayerTypeLabels(g).join(", "));return[4,b.load()];case 1:return c.sent(),[4,m.getFieldsList({field:a.field,normalizationField:a.normalizationField,valueExpression:a.valueExpression})];case 2:d=c.sent();if(f=l.verifyBasicFieldValidity(b,d,"opacity-visual-variable:invalid-parameters"))throw f;return[2,a]}})})}Object.defineProperty(n,"__esModule",{value:!0});n.createVisualVariable=function(e){return q(this,void 0,void 0,function(){var a,g;return p(this,function(b){switch(b.label){case 0:return[4,
y(e)];case 1:a=b.sent();g=null;if(!a.statistics)return[3,2];g=a.statistics;return[3,4];case 2:return[4,u({layer:a.layer,field:a.field,valueExpression:a.valueExpression,sqlExpression:a.sqlExpression,sqlWhere:a.sqlWhere,normalizationType:a.normalizationField?"field":void 0,normalizationField:a.normalizationField,minValue:a.minValue,maxValue:a.maxValue,view:a.view})];case 3:g=b.sent(),b.label=4;case 4:b=g;var d=a,f=d.layer,c=d.field,f=(f=c&&"function"!==typeof c?f.getField(c):null)&&"date"===f.type,
h=l.createStopValues(b),h=(f=l.getDefaultDataRange(b,f,!0))||[h[0],h[4]],d=new x({field:c,valueExpression:d.valueExpression,valueExpressionTitle:d.valueExpressionTitle,normalizationField:d.normalizationField,stops:[{value:h[0],opacity:.3},{value:h[1],opacity:1}],legendOptions:d.legendOptions}),c=new w({type:"opacity",minSliderValue:b.min,maxSliderValue:b.max}),c=new v({visualVariables:[c]});return[2,t.resolve({visualVariable:d,statistics:b,defaultValuesUsed:!!f,authoringInfo:c})]}})})}});