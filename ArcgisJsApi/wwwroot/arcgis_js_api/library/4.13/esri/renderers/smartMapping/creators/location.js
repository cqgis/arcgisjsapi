// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../.. ../../../core/Error ../../../core/maybe ./support/utils ../heuristics/outline ../support/utils ../symbology/location".split(" "),function(B,t,w,p,h,x,l,u,n,y,v,q){function z(e){return h(this,void 0,void 0,function(){var a,d,c,b;return p(this,function(f){switch(f.label){case 0:if(!e||!e.layer)throw new l("location-renderer:missing-parameters","'layer' parameter is required");
a=w({},e);a.symbolType=a.symbolType||"2d";d=[0,2,1,3];c=v.createLayerAdapter(a.layer,d);a.layer=c;if(!c)throw new l("location-renderer:invalid-parameters","'layer' must be one of these types: "+v.getLayerTypeLabels(d).join(", "));return[4,c.load()];case 1:f.sent();b=c.geometryType;a.outlineOptimizationEnabled="polygon"===b?a.outlineOptimizationEnabled:!1;if("mesh"===b)a.symbolType="3d-volumetric",a.colorMixMode=a.colorMixMode||"replace",a.edgesType=a.edgesType||"none";else{if("3d-volumetric-uniform"===
a.symbolType&&"point"!==b)throw new l("location-renderer:not-supported","3d-volumetric-uniform symbols are supported for point layers only");if(-1<a.symbolType.indexOf("3d-volumetric")&&(!a.view||"3d"!==a.view.type))throw new l("location-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or '3d-volumetric-uniform'");}return[2,a]}})})}function A(e,a){return h(this,void 0,void 0,function(){var d,c,b,f,g;return p(this,function(k){switch(k.label){case 0:return d=
e.locationScheme,b=c=null,[4,n.getBasemapInfo(e.basemap,e.view)];case 1:f=k.sent();c=u.isSome(f.basemapId)?f.basemapId:null;b=u.isSome(f.basemapTheme)?f.basemapTheme:null;if(d)return[2,{scheme:q.cloneScheme(d),basemapId:c,basemapTheme:b}];if(g=q.getSchemes({basemap:c,basemapTheme:b,geometryType:a,worldScale:-1<e.symbolType.indexOf("3d-volumetric"),view:e.view}))d=g.primaryScheme,c=g.basemapId,b=g.basemapTheme;return[2,{scheme:d,basemapId:c,basemapTheme:b}]}})})}Object.defineProperty(t,"__esModule",
{value:!0});t.createRenderer=function(e){return h(this,void 0,void 0,function(){var a,d,c,b,f,g,k,h,r;return p(this,function(m){switch(m.label){case 0:return[4,z(e)];case 1:return a=m.sent(),d=a.layer.geometryType,[4,A(a,d)];case 2:c=m.sent();b=c.scheme;if(!b)throw new l("location-renderer:insufficient-info","Unable to find location scheme");f={layer:a.layer,view:a.view};return a.outlineOptimizationEnabled?[4,y(f)]:[3,4];case 3:return k=m.sent(),[3,5];case 4:k=null,m.label=5;case 5:return h=(g=k)&&
g.opacity,r=new x.SimpleRenderer({symbol:n.createSymbol(d,{type:a.symbolType,color:b.color,size:n.getSymbolSizeFromScheme(b,d),outline:n.getSymbolOutlineFromScheme(b,d,h),meshInfo:{colorMixMode:a.colorMixMode,edgesType:a.edgesType}})}),g&&g.visualVariables&&g.visualVariables.length&&(r.visualVariables=g.visualVariables.map(function(a){return a.clone()})),[2,{renderer:r,locationScheme:q.cloneScheme(b),basemapId:c.basemapId,basemapTheme:c.basemapTheme}]}})})}});