// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ./color ./size ./support/utils ../support/utils ../../support/AuthoringInfo".split(" "),function(C,p,g,h,n,k,w,q,r,l,x){function y(a){return n(this,void 0,void 0,function(){var b,d,e,m,c;return h(this,function(f){switch(f.label){case 0:if(!(a&&a.layer&&(a.field||a.valueExpression||a.sqlExpression)))throw new k("univariate-colorsize-visual-variables:missing-parameters",
"'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new k("univariate-colorsize-visual-variables:missing-parameters","View is required when 'valueExpression' is specified");b=g({},a);d=[0,2,1,3];e=l.createLayerAdapter(b.layer,d);b.layer=e;if(!e)throw new k("univariate-colorsize-visual-variables:invalid-parameters","'layer' must be one of these types: "+l.getLayerTypeLabels(d).join(", "));return[4,e.load()];case 1:return f.sent(),
[4,l.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression})];case 2:m=f.sent();if(c=r.verifyBasicFieldValidity(e,m,"univariate-colorsize-visual-variables:invalid-parameters"))throw c;return[2,b]}})})}function t(a,b){a=g({},a);b=0===b?a.colorOptions:a.sizeOptions;delete a.sizeOptions;delete a.colorOptions;return g({},a,b)}function z(a){return n(this,void 0,void 0,function(){var b,d,e,m,c;return h(this,function(f){switch(f.label){case 0:if(!(a&&a.layer&&
(a.field||a.valueExpression||a.sqlExpression)))throw new k("univariate-colorsize-continuous-renderer:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new k("univariate-colorsize-continuous-renderer:missing-parameters","View is required when 'valueExpression' is specified");b=g({},a);b.symbolType=b.symbolType||"2d";d=[0,2,1,3];e=l.createLayerAdapter(b.layer,d);b.layer=e;if(!e)throw new k("univariate-colorsize-continuous-renderer:invalid-parameters",
"'layer' must be one of these types: "+l.getLayerTypeLabels(d).join(", "));return[4,e.load()];case 1:return f.sent(),[4,l.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression})];case 2:m=f.sent();if(c=r.verifyBasicFieldValidity(e,m,"univariate-colorsize-continuous-renderer:invalid-parameters"))throw c;return[2,b]}})})}function A(a){a=g({},a);var b=g({},a.sizeOptions);delete a.sizeOptions;delete a.colorOptions;delete b.sizeOptimizationEnabled;return g({},
a,b)}function B(a){a=g({},a);var b=a.symbolType,d=-1<b.indexOf("3d-volumetric");delete a.symbolType;delete a.defaultSymbolEnabled;if(a.worldScale=d)a.sizeOptions=g({},a.sizeOptions),a.sizeOptions.axis="3d-volumetric-uniform"===b?"all":"height";return a}function u(a){return n(this,void 0,void 0,function(){var b,d,e,m,c,f,g,v,k,l,n;return h(this,function(h){switch(h.label){case 0:return[4,y(a)];case 1:return b=h.sent(),[4,w.createVisualVariable(t(b,0))];case 2:return e=h.sent(),m=t(b,1),m.statistics=
e.statistics,d=e,[4,q.createVisualVariables(m)];case 3:return c=h.sent(),f=d.visualVariable,g=c.visualVariables,v=f.stops.length,g.forEach(function(a){null!=a.minDataValue&&(a.minDataValue=f.stops[0].value,a.maxDataValue=f.stops[v-1].value)}),k=d.authoringInfo.visualVariables[0],l=c.authoringInfo.visualVariables[0],n=new x({type:"univariate-color-size",visualVariables:[k.clone(),l.clone()]}),[2,{basemapId:c.basemapId,basemapTheme:c.basemapTheme,statistics:d.statistics,defaultValuesUsed:d.defaultValuesUsed,
color:{visualVariable:f,colorScheme:d.colorScheme},size:{visualVariables:g,sizeScheme:c.sizeScheme},authoringInfo:n}]}})})}Object.defineProperty(p,"__esModule",{value:!0});p.createVisualVariables=u;p.createContinuousRenderer=function(a){return n(this,void 0,void 0,function(){var b,d,e,g,c,f,k;return h(this,function(h){switch(h.label){case 0:return[4,z(a)];case 1:return b=h.sent(),[4,q.createContinuousRenderer(A(b))];case 2:return e=h.sent(),g=B(b),g.statistics=e.statistics,d=e,[4,u(g)];case 3:return c=
h.sent(),f=d.renderer,k=c.size.visualVariables.map(function(a){return a.clone()}),k.push(c.color.visualVariable.clone()),f.visualVariables=k,f.authoringInfo=c.authoringInfo&&c.authoringInfo.clone(),[2,{renderer:f,statistics:d.statistics,defaultValuesUsed:d.defaultValuesUsed,color:c.color,size:c.size,basemapId:c.basemapId,basemapTheme:c.basemapTheme}]}})})}});