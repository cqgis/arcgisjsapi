// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/Accessor ../../core/Collection ../../core/compilerUtils ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/Layer ../../views/layers/support/ClipRect".split(" "),function(z,A,p,d,q,r,e,t,u,v,w,l,c,x,f){function y(c,a){a=Math.pow(10,a);return Math.round(c*
a)/a}var h=u.ofType(x),g={left:0,right:0,top:0,bottom:0};return function(m){function a(b){b=m.call(this,b)||this;b._handles=new w;b._leadingClips=new Map;b._trailingClips=new Map;b.direction="horizontal";b.leadingLayers=new h;b.max=100;b.min=0;b.precision=4;b.step=.5;b.stepMultiplier=10;b.trailingLayers=new h;b.view=null;return b}p(a,m);a.prototype.initialize=function(){var b=this;this._handles.add([l.init(this,["view","view.ready","position","direction"],function(){return b._clipLayers()}),l.on(this,
"leadingLayers","change",function(){return b._clipLeadingLayers()}),l.on(this,"trailingLayers","change",function(){return b._clipTrailingLayers()})])};a.prototype.destroy=function(){this._removeExistingClips();this._handles.destroy();this._handles=null};Object.defineProperty(a.prototype,"position",{get:function(){return 25},set:function(b){this._set("position",y(Math.max(Math.min(b,this.max),this.min),this.precision))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"state",{get:function(){var b=
this.view;return b&&b.ready?"ready":"disabled"},enumerable:!0,configurable:!0});a.prototype._clipLayers=function(){this._clipLeadingLayers();this._clipTrailingLayers()};a.prototype._clipLeadingLayers=function(){var b=this;this._removeClips("leading");this.leadingLayers.forEach(function(a){return b._clipLayer({layer:a,type:"leading"})})};a.prototype._clipTrailingLayers=function(){var b=this;this._removeClips("trailing");this.trailingLayers.forEach(function(a){return b._clipLayer({layer:a,type:"trailing"})})};
a.prototype._getLayerView=function(b){var a=this.view;return b&&a?v.typeCast(a)().whenLayerView(b):null};a.prototype._getVerticalClipRect=function(b){var a=this.position;return"leading"===b?new f(e({},g,{bottom:100-a+"%"})):"trailing"===b?new f(e({},g,{top:a+"%"})):null};a.prototype._getHorizontalClipRect=function(b){var a=this.position;return"leading"===b?new f(e({},g,{right:100-a+"%"})):"trailing"===b?new f(e({},g,{left:a+"%"})):null};a.prototype._getClipRect=function(b){var a=this.direction;return"vertical"===
a?this._getVerticalClipRect(b):"horizontal"===a?this._getHorizontalClipRect(b):null};a.prototype._clipLayer=function(a){return r(this,void 0,void 0,function(){var b,c,d,n,e,f,k,h,g;return q(this,function(l){switch(l.label){case 0:return b=this,c=b._leadingClips,d=b._trailingClips,n=a.layer,e=a.type,f="trailing"===e?d:"leading"===e?c:null,[4,this._getLayerView(n)];case 1:k=l.sent();if(!k||!f||!k.hasOwnProperty("clips"))return[2];(h=f.get(k))&&k.clips.remove(h);if(g=this._getClipRect(e))f.set(k,g),
k.clips.add(g);return[2]}})})};a.prototype._removeClips=function(a){var b=this._leadingClips,c=this._trailingClips;if(a="trailing"===a?c:"leading"===a?b:null)a.forEach(function(a,b){b&&b.hasOwnProperty("clips")&&b.clips.remove(a)}),a.clear()};a.prototype._removeExistingClips=function(){this._removeClips("leading");this._removeClips("trailing")};d([c.property()],a.prototype,"direction",void 0);d([c.property({type:h})],a.prototype,"leadingLayers",void 0);d([c.property({readOnly:!0})],a.prototype,"max",
void 0);d([c.property({readOnly:!0})],a.prototype,"min",void 0);d([c.property()],a.prototype,"position",null);d([c.property()],a.prototype,"precision",void 0);d([c.property({dependsOn:["view.ready"],readOnly:!0})],a.prototype,"state",null);d([c.property()],a.prototype,"step",void 0);d([c.property()],a.prototype,"stepMultiplier",void 0);d([c.property({type:h})],a.prototype,"trailingLayers",void 0);d([c.property()],a.prototype,"view",void 0);return a=d([c.subclass("esri.widgets.Swipe.SwipeViewModel")],
a)}(c.declared(t))});