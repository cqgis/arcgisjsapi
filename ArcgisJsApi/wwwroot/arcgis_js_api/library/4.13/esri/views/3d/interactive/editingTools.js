// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/3d/interactive/editingTools/graphicMove3D/GraphicMove3DTool":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/Collection ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/accessorSupport/decorators ../../../../draw/support/drawUtils ../../../../interactive/GraphicManipulator ../../../../interactive/InteractiveToolBase".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g){Object.defineProperty(b,"__esModule",{value:!0});var E=function(){return function(a){this.allGraphics=a;this.type="graphic-move-start"}}();b.GraphicMoveStartEvent=E;var B=function(){return function(a,c,n){this.dx=a;this.dy=c;this.allGraphics=n;this.type="graphic-move"}}();b.GraphicMoveEvent=B;var h=function(){return function(a){this.allGraphics=a;this.type="graphic-move-stop"}}();b.GraphicMoveStopEvent=h;v=function(m){function q(c){c=m.call(this,c)||this;c.graphics=
new r;c.type="move-3d";c._handles=new a;return c}t(q,m);q.prototype.initialize=function(){var a=this;this._handles.add(this.graphics.on("change",function(){a._refreshGraphicManipulators()}));this._refreshGraphicManipulators()};q.prototype.destroy=function(){this._handles.destroy();this._handles=null;this.graphics.removeAll();this._set("view",null)};q.prototype.reset=function(){this.graphics.removeAll()};q.prototype._refreshGraphicManipulators=function(){var a=this;this._handles.remove("graphics");
this.manipulators.removeAll();var q=this.graphics.toArray().map(function(d){d=new c.GraphicManipulator({graphic:d,view:a.view,selectable:!0});a.manipulators.add(d);return d}),m=0;q.forEach(function(c){c.on("drag",function(n){q.forEach(function(a){var p=e.expect(a.graphic.geometry);"mesh"!==p.type&&a!==c&&(a.graphic.geometry=d.move(p.clone(),n.dxMap,n.dyMap))});a.emit("graphic-move",new B(n.dx,n.dy,a.graphics.toArray()))});c.on("click",function(){return a.emit("click")});var n=c.watch("dragging",function(d){d?
(m++,1===m&&(a.emit("graphic-move-start",new E(a.graphics.toArray())),q.forEach(function(a){a!==c&&(a.interactive=!1)}))):(m--,0===m&&(a.emit("graphic-move-stop",new h(a.graphics.toArray())),q.forEach(function(a){a.interactive=!0})))},!0),g=c.watch("hovering",function(c){a.cursor=c?"move":null},!0);a._handles.add(n,"graphics");a._handles.add(g,"graphics")})};f([l.property({constructOnly:!0,nonNullable:!0})],q.prototype,"view",void 0);f([l.property({readOnly:!0})],q.prototype,"graphics",void 0);f([l.property({value:null})],
q.prototype,"cursor",void 0);f([l.property({readOnly:!0})],q.prototype,"type",void 0);return q=f([l.subclass("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMove3DTool")],q)}(l.declared(u.EventedMixin(g.InteractiveToolBase)));b.GraphicMove3DTool=v})},"esri/views/draw/support/drawUtils":function(){define(["require","exports","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(v,b,f,t,r){function u(a,e,b){if("point"===
a.type)return a.x+=e,a.y+=b,a;if("multipoint"===a.type){for(var d=a.points,c=0;c<d.length;c++){var g=d[c],l=g[0],g=g[1];d[c]=[l+e,g+b]}return a}if("extent"===a.type)return a.xmin+=e,a.xmax+=e,a.ymin+=b,a.ymax+=b,a;for(var d=r.geometryToCoordinates(a),f="polyline"===a.type?a.paths:a.rings,h=0;h<d.length;h++)for(var m=d[h],c=0;c<m.length;c++)g=m[c],l=g[0],g=g[1],f[h][c]=[l+e,g+b];"paths"in a?a.paths=f:a.rings=f;return a}Object.defineProperty(b,"__esModule",{value:!0});b.move=u;b.cloneMove=function(a,
e,b,d,c){a=a.clone();var g=d.resolution;if("point"===a.type){if(c)u(a,e*g,-b*g);else{c=d.state.transform;d=d.state.inverseTransform;var f=c[0]*a.x+c[2]*a.y+c[4],l=c[1]*a.x+c[3]*a.y+c[5];a.x=d[0]*(f+e)+d[2]*(l+b)+d[4];a.y=d[1]*(f+e)+d[3]*(l+b)+d[5]}return a}if("multipoint"===a.type){if(c)u(a,e*g,-b*g);else{g=a.points;c=d.state.transform;d=d.state.inverseTransform;for(var h=0;h<g.length;h++){var f=g[h],l=c[0]*f[0]+c[2]*f[1]+c[4],m=c[1]*f[0]+c[3]*f[1]+c[5],f=d[0]*(l+e)+d[2]*(m+b)+d[4],l=d[1]*(l+e)+d[3]*
(m+b)+d[5];g[h]=[f,l]}}return a}if("extent"===a.type){if(c)u(a,e*g,-b*g);else{c=d.state.transform;d=d.state.inverseTransform;var g=c[0]*a.xmin+c[2]*a.ymin+c[4],q=c[1]*a.xmin+c[3]*a.ymin+c[5],h=c[0]*a.xmax+c[2]*a.ymax+c[4];c=c[1]*a.xmax+c[3]*a.ymax+c[5];a.xmin=d[0]*(g+e)+d[2]*(q+b)+d[4];a.ymin=d[1]*(g+e)+d[3]*(q+b)+d[5];a.xmax=d[0]*(h+e)+d[2]*(c+b)+d[4];a.ymax=d[1]*(h+e)+d[3]*(c+b)+d[5]}return a}if(c)u(a,e*g,-b*g);else{q=r.geometryToCoordinates(a);g="polyline"===a.type?a.paths:a.rings;c=d.state.transform;
d=d.state.inverseTransform;for(var n=0;n<q.length;n++)for(var C=q[n],h=0;h<C.length;h++)f=C[h],l=c[0]*f[0]+c[2]*f[1]+c[4],m=c[1]*f[0]+c[3]*f[1]+c[5],f=d[0]*(l+e)+d[2]*(m+b)+d[4],l=d[1]*(l+e)+d[3]*(m+b)+d[5],g[n][h]=[f,l];"paths"in a?a.paths=g:a.rings=g}return a};b.scale=function(a,e,b,d,c){if("point"===a.type){d=a.x;var g=a.y,l=c?c[0]:d;c=c?c[1]:g;a=a.clone();a.x=(d-l)*e+l;a.y=(g-c)*b+c;return a}if("multipoint"===a.type){d=r.geometryToCoordinates(a);var l=f.create(),u=t.getRingsOrPathsBounds(l,[d]),
l=u[0];d=u[1];var g=u[2],u=u[3],l=c?c[0]:(l+g)/2,u=c?c[1]:(u+d)/2,h=a.clone(),m=h.points;for(a=0;a<m.length;a++)c=m[a],d=c[0],g=c[1],c=(d-l)*e+l,d=(g-u)*b+u,m[a]=[c,d];return h}if("extent"===a.type)return d=a.xmin,l=a.xmax,g=a.ymin,u=a.ymax,h=c?c[0]:(d+l)/2,c=c?c[1]:(u+g)/2,a=a.clone(),a.xmin=(d-h)*e+h,a.ymax=(u-c)*b+c,a.xmax=(l-h)*e+h,a.ymin=(g-c)*b+c,a.xmin>a.xmax&&(e=a.xmin,a.xmin=a.xmax,a.xmax=e),a.ymin>a.ymax&&(e=a.ymin,a.ymin=a.ymax,a.ymax=e),a;l=r.geometryToCoordinates(a);d=f.create();h=t.getRingsOrPathsBounds(d,
l);g=h[0];d=h[1];for(var u=h[2],h=h[3],u=c?c[0]:(g+u)/2,h=c?c[1]:(h+d)/2,m=a.clone(),q="polyline"===m.type?m.paths:m.rings,n=0;n<l.length;n++){var C=l[n];for(a=0;a<C.length;a++)c=C[a],d=c[0],g=c[1],c=(d-u)*e+u,d=(g-h)*b+h,q[n][a]=[c,d]}"paths"in m?m.paths=q:m.rings=q;return m};b.getScaleRatio=function(a,e,b,d,c,g){return Math.sqrt((c-a)*(c-a)+(g-e)*(g-e))/Math.sqrt((b-a)*(b-a)+(d-e)*(d-e))};b.getRotationAngle=function(a,e,b,d,c,g){return 180*Math.atan2(e-g,a-c)/Math.PI-180*Math.atan2(e-d,a-b)/Math.PI}})},
"esri/views/interactive/GraphicManipulator":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Collection ../../core/Logger ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ../../geometry/support/webMercatorUtils ../../symbols/support/defaults ../../views/3d/support/projectionUtils ../draw/support/drawUtils ../../views/support/drapedUtils".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g,E,B,h,m,q,n){Object.defineProperty(b,"__esModule",{value:!0});var C=a.getLogger("esri.views.interactive.GraphicManipulator");v=function(a){function b(c){c=a.call(this)||this;c.layer=null;c.interactive=!0;c.selectable=!1;c.dragging=!1;c._handlers=new u;c._circleCollisionCache=null;c._originalSymbol=null;return c}t(b,a);Object.defineProperty(b.prototype,"graphic",{get:function(){return this._get("graphic")},set:function(a){"mesh"===e.get(a.geometry,"type")?C.error("Mesh geometries are not supported"):
(this._circleCollisionCache=null,this._originalSymbol=a.symbol,this._set("graphic",a))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"focusedSymbol",{set:function(a){a!==this._get("focusedSymbol")&&(this._set("focusedSymbol",a),this._updateGraphicSymbol(),this._circleCollisionCache=null)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"grabbing",{set:function(a){if(a!==this._get("grabbing")){var c=this._focused;this._set("grabbing",a);this._updateGraphicSymbol(c)}},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hovering",{set:function(a){if(a!==this._get("hovering")){var c=this._focused;this._set("hovering",a);this._updateGraphicSymbol(c)}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"selected",{set:function(a){a!==this._get("selected")&&(this._set("selected",a),this._updateGraphicSymbol())},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_focused",{get:function(){return this._get("hovering")||this._get("grabbing")},
enumerable:!0,configurable:!0});b.prototype.destroy=function(){this._resetGraphicSymbol();this._handlers.removeAll();this._handlers=null;this._set("view",null)};b.prototype.intersectionDistance=function(a){var c=this._get("graphic"),d=this._get("focusedSymbol"),d=e.isSome(d)?d:c.symbol,b=c.geometry;if(e.isNone(b))return null;var n=this._get("view");return"2d"===n.type?this._intersect2D(a,n,b,d):this._intersect3D(a,n,c)};b.prototype.attemptDragTo=function(a,c){if(e.isNone(this.graphic.geometry)||"mesh"===
this.graphic.geometry.type)return!1;var d=this.view.toMap(c.previous),b=this.view.toMap(a.screenPoint),n=a.screenPoint.x-c.previous.x;c=a.screenPoint.y-c.previous.y;var p=0,g=0;if(!d||!b)return!1;g=[0,0,0,0,0,0];m.bufferToBuffer([d.x,d.y,0,b.x,b.y,0],d.spatialReference,0,g,this.graphic.geometry.spatialReference,0,2);p=g[3]-g[0];g=g[4]-g[1];if(0===p&&0===g)return!0;this.graphic.geometry=q.move(this.graphic.geometry.clone(),p,g);var h={screenPoint:a.screenPoint,dxMap:p,dyMap:g,dx:n,dy:c};this._handlers.forEach(function(a){var c=
a.handler;"drag"===a.type&&c(h)});return!0};b.prototype.click=function(a){this._handlers.forEach(function(c){"click"===c.type&&c.handler(a)})};b.prototype.on=function(a,c){this._handlers.push({type:a,handler:c})};b.prototype.attach=function(){e.isNone(this.layer)||this.layer.add(this.graphic)};b.prototype.detach=function(){this._resetGraphicSymbol();e.isNone(this.layer)||this.layer.remove(this.graphic)};b.prototype._updateGraphicSymbol=function(a){void 0===a&&(a=this._focused);a!==this._focused&&
(a=this.graphic.symbol,a!==this._originalSymbol&&a!==this.focusedSymbol&&(this._originalSymbol=a));this.graphic.symbol=this._focused&&e.isSome(this.focusedSymbol)?this.focusedSymbol:this._originalSymbol};b.prototype._resetGraphicSymbol=function(){this.graphic.symbol=this._originalSymbol};b.prototype._intersect2D=function(a,d,b,q){q=q||h.getDefaultSymbol2D(b);if(e.isNone(q))return null;var p=this._circleCollisionCache;if("point"!==b.type||"simple-marker"!==q.type)return p=n.intersectsDrapedGeometry(a,
b,d),e.isSome(p)?1:null;if(e.isNone(p)||!p.originalPoint.equals(b)){var m=d.spatialReference;B.canProject(b,m)&&(p=B.project(b,m),this._circleCollisionCache=p={originalPoint:b.clone(),mapPoint:p,radiusPx:l.pt2px(q.size)})}return e.isSome(p)?(a=l.screenPointObjectToArray(a,A),d=d.state.toScreen(z,p.mapPoint.x,p.mapPoint.y),p=p.radiusPx,c.vec2.squaredDistance(a,d)<p*p?1:null):null};b.prototype._intersect3D=function(a,c,d){a=c.toMap(a,{include:[d]});if(!a)return null;d=y;return c.renderCoordsHelper.toRenderCoords(a,
d)?g.vec3.distance(d,c.state.camera.eye):null};f([d.property({constructOnly:!0,nonNullable:!0})],b.prototype,"graphic",null);f([d.property({constructOnly:!0,nonNullable:!0})],b.prototype,"view",void 0);f([d.property({value:null})],b.prototype,"focusedSymbol",null);f([d.property({constructOnly:!0})],b.prototype,"layer",void 0);f([d.property()],b.prototype,"interactive",void 0);f([d.property()],b.prototype,"selectable",void 0);f([d.property({value:!1})],b.prototype,"grabbing",null);f([d.property()],
b.prototype,"dragging",void 0);f([d.property()],b.prototype,"hovering",null);f([d.property({value:!1})],b.prototype,"selected",null);return b=f([d.subclass("esri.views.interactive.GraphicManipulator")],b)}(d.declared(r));b.GraphicManipulator=v;var y=E.vec3f64.create(),A=l.createScreenPointArray(),z=l.createScreenPointArray()})},"esri/views/support/drapedUtils":function(){define("require exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils".split(" "),
function(v,b,f,t,r,u){function a(a,d,c,b){void 0===b&&(b=new f.Extent);var e;if("2d"===c.type)e=d*c.resolution;else if("3d"===c.type){var g=c.basemapTerrain,h=g.overlayManager,h=h?h.overlayPixelSizeInMapUnits(a):1;e=g&&!g.spatialReference.equals(c.spatialReference)?r.getMetersPerUnitForSR(g.spatialReference)/r.getMetersPerUnitForSR(c.spatialReference):d*h}d=a.x-e;g=a.y-e;h=a.x+e;a=a.y+e;c=c.spatialReference;b.xmin=Math.min(d,h);b.ymin=Math.min(g,a);b.xmax=Math.max(d,h);b.ymax=Math.max(g,a);b.spatialReference=
c;return b}Object.defineProperty(b,"__esModule",{value:!0});b.createQueryGeometry=a;b.intersectsDrapedGeometry=function(b,d,c){b=c.toMap(b);if(t.isNone(b))return null;var g=u.calculateTolerance();return a(b,g,c,e).intersects(d)?b:null};var e=new f.Extent})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(v,b){function f(b,a){return a&&a.xoffset?Math.max(b,Math.abs(a.xoffset)):a&&a.yoffset?Math.max(b,Math.abs(a.yoffset)):b}function t(b,a){if("number"===
typeof b)return b;if(b&&b.stops&&b.stops.length){b=b.stops;for(var e=a=0,f=0;f<b.length;f++){var d=b[f].size;"number"===typeof d&&(a+=d,e++)}return a/e}return a}function r(b,a){if(!a)return b;a=a.filter(function(a){return"size"===a.type}).map(function(a){var c=a.minSize;return(t(a.maxSize,b)+t(c,b))/2});var e=0,f=a.length;if(0===f)return b;for(var d=0;d<f;d++)e+=a[d];return Math.max(Math.floor(e/f),b)}Object.defineProperty(b,"__esModule",{value:!0});b.calculateTolerance=function(b){if(!b)return 6;
var a="visualVariables"in b?r(6,b.visualVariables):6;if("simple"===b.type)return f(a,b.symbol);if("unique-value"===b.type){var e=a;b.uniqueValueInfos.forEach(function(a){e=f(e,a.symbol)});return e}if("class-breaks"===b.type){var l=a;b.classBreakInfos.forEach(function(a){l=f(l,a.symbol)});return l}return a}})},"esri/views/interactive/InteractiveToolBase":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/accessorSupport/decorators ./interactiveToolUtils ./ManipulatorCollection".split(" "),
function(v,b,f,t,r,u,a,e,l){Object.defineProperty(b,"__esModule",{value:!0});v=function(b){function c(a){a=b.call(this,a)||this;a.manipulators=new l.ManipulatorCollection;a._attached=!1;a._editableFlags=[];a._manipulatorHandles=new u;return a}f(c,b);Object.defineProperty(c.prototype,"active",{get:function(){return null!=this.view&&this.view.activeTool===this},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isSupported",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"visible",{set:function(a){this._set("visible",a);this._attached&&(a?this._show():this._hide())},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"editable",{get:function(){return this.hasEditableFlag(0)},set:function(a){this.setEditableFlag(0,a)},enumerable:!0,configurable:!0});c.prototype.attach=function(){if(!this._attached&&this.isSupported){this.manipulators.attach();this.onAttach();if(this.visible)this.onShow();this._attached=!0}};c.prototype.detach=function(){this._attached&&
(this.onHide(),this.onDetach(),this.manipulators.detach(),this._manipulatorHandles.removeAll(),this._attached=!1)};c.prototype.handleInputEvent=function(a){if(this._attached)this.onInputEvent(a)};c.prototype.destroy=function(){this.manipulators.destroy();this._manipulatorHandles.removeAll();this._manipulatorHandles=null;this._set("view",null)};c.prototype.setEditableFlag=function(a,c){this._editableFlags[a]=c;this.manipulators.isToolEditable=this._editableFlags.every(function(a){return null==a||a});
this._updateManipulatorAttachment();0===a&&this.notifyChange("editable");this.onEditableChange()};c.prototype.hasEditableFlag=function(a){a=this._editableFlags[a];return null==a?!0:a};c.prototype.onAttach=function(){};c.prototype.onDetach=function(){};c.prototype.onShow=function(){};c.prototype.onHide=function(){};c.prototype.onEditableChange=function(){};c.prototype.onInputEvent=function(a){};Object.defineProperty(c.prototype,"internallyEditable",{get:function(){return this.hasEditableFlag(0)&&this.hasEditableFlag(1)},
enumerable:!0,configurable:!0});c.prototype._show=function(){this._updateManipulatorAttachment();this.onShow()};c.prototype._hide=function(){e.setActive(this,!1);this._updateManipulatorAttachment();this.onHide()};c.prototype._updateManipulatorAttachment=function(){this.visible?this.manipulators.attach():this.manipulators.detach()};t([a.property({constructOnly:!0})],c.prototype,"view",void 0);t([a.property({dependsOn:["view.activeTool"],readOnly:!0})],c.prototype,"active",null);t([a.property({value:!0})],
c.prototype,"visible",null);t([a.property({value:!0})],c.prototype,"editable",null);t([a.property({readOnly:!0})],c.prototype,"manipulators",void 0);return c=t([a.subclass("esri.views.interactive.InteractiveToolBase")],c)}(a.declared(r));b.InteractiveToolBase=v})},"esri/views/interactive/ManipulatorCollection":function(){define(["require","exports","../../core/tsSupport/decorateHelper","../../core/Collection","../../core/maybe"],function(v,b,f,t,r){Object.defineProperty(b,"__esModule",{value:!0});
v=function(){function b(){this._isToolEditable=!0;this._manipulators=new t;this._nextManipulatorId=0;this._resourceContexts={manipulator3D:{}};this._attached=!1}Object.defineProperty(b.prototype,"isToolEditable",{set:function(a){this._isToolEditable=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"length",{get:function(){return this._manipulators.length},enumerable:!0,configurable:!0});b.prototype.add=function(a,b){void 0===b&&(b=0);return this.addMany([a],b)[0]};b.prototype.addMany=
function(a,b){var e=this;void 0===b&&(b=0);return a.map(function(a){var c=e._nextManipulatorId++;a={id:c,manipulator:a,visibilityPredicate:b,attached:!1};e._manipulators.add(a);e._attached&&e._updateManipulatorAttachment(a);return c})};b.prototype.remove=function(a){if("number"===typeof a){for(var b=0;b<this._manipulators.length;b++)if(this._manipulators.getItemAt(b).id===a)return a=this._manipulators.splice(b,1)[0],this._detachManipulator(a),a.id;return null}for(b=0;b<this._manipulators.length;b++)if(this._manipulators.getItemAt(b).manipulator===
a)return a=this._manipulators.splice(b,1)[0],this._detachManipulator(a),a.id;return null};b.prototype.removeAll=function(){var a=this;this._manipulators.forEach(function(b){a._detachManipulator(b)});this._manipulators.removeAll()};b.prototype.attach=function(){var a=this;this._manipulators.forEach(function(b){a._updateManipulatorAttachment(b)});this._attached=!0};b.prototype.detach=function(){var a=this;this._manipulators.forEach(function(b){a._detachManipulator(b)});this._attached=!1};b.prototype.destroy=
function(){this._manipulators.forEach(function(a){a=a.manipulator;a.destroy&&a.destroy()});this._manipulators.destroy();this._resourceContexts=null};b.prototype.on=function(a,b){return this._manipulators.on("change",function(a){b(a)})};b.prototype.forEach=function(a){for(var b=0,f=this._manipulators.items;b<f.length;b++)a(f[b])};b.prototype.intersect=function(a,b){var e=null,d=Number.MAX_VALUE;this._manipulators.forEach(function(c){var f=c.id,l=c.manipulator;c.attached&&l.interactive&&(c=l.intersectionDistance(a,
b),r.isSome(c)&&c<d&&(d=c,e=f))});return e};b.prototype.findById=function(a){if(r.isNone(a))return null;for(var b=0,f=this._manipulators.items;b<f.length;b++){var d=f[b];if(a===d.id)return d.manipulator}return null};b.prototype._updateManipulatorAttachment=function(a){this._isManipulatorItemVisible(a)?this._attachManipulator(a):this._detachManipulator(a)};b.prototype._attachManipulator=function(a){a.attached||(a.manipulator.attach(this._resourceContexts),a.attached=!0)};b.prototype._detachManipulator=
function(a){if(a.attached){var b=a.manipulator;b.grabbing=!1;b.dragging=!1;b.hovering=!1;b.selected=!1;b.detach(this._resourceContexts);a.attached=!1}};b.prototype._isManipulatorItemVisible=function(a){return 2===a.visibilityPredicate?!0:this._isToolEditable?0===a.visibilityPredicate:1===a.visibilityPredicate};return b}();b.ManipulatorCollection=v})},"esri/views/3d/interactive/editingTools/graphicReshape3D/GraphicReshape3DTool":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ./isSupportedGraphic ./ReshapeOperation ./reshapeUtils ../../../../interactive/InteractiveToolBase".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g,E,B){Object.defineProperty(b,"__esModule",{value:!0});var h=a.getLogger("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshape3DTool");v=function(a){function b(b){b=a.call(this,b)||this;b._handles=new u;b._reshapeOperation=null;b._internalGeometryUpdate=!1;b.type="reshape-3d";return b}t(b,a);b.prototype.destroy=function(){this._handles.removeAll();this._set("view",null);this._set("graphic",null)};Object.defineProperty(b.prototype,"graphic",{set:function(a){e.isSome(a)&&
!c.isSupportedGraphic(a)?h.error("Only polyline and polygon geometries are supported"):this._set("graphic",a)},enumerable:!0,configurable:!0});b.prototype._updateGeometry=function(){e.isSome(this.graphic)&&E.isReshapeGeometry(this.graphic.geometry)?this._reshapeOperation.inputGeometry=this.graphic.geometry.clone():this._reshapeOperation.inputGeometry=null};b.prototype._updateGraphic=function(){var a=this;this._handles.remove("onGraphicGeometryChange");this._updateGeometry();var b=this.watch("graphic.geometry",
function(){!1===a._internalGeometryUpdate&&a._updateGeometry()},!0);this._handles.add(b,"onGraphicGeometryChange")};b.prototype._onReshapeGeometryChanged=function(){e.isNone(this.graphic)||(this._internalGeometryUpdate=!0,this.graphic.geometry=this._reshapeOperation.outputGeometry.clone(),this._internalGeometryUpdate=!1)};b.prototype.initialize=function(){var a=this;this._reshapeOperation=new g.ReshapeOperation({view:this.view,manipulators:this.manipulators});this._handles.add([this._reshapeOperation.watch("cursor",
function(){a.cursor=a._reshapeOperation.cursor}),this._reshapeOperation.on("reshape-operation-start",function(b){e.isNone(a.graphic)||(b.graphic=a.graphic,a.emit("reshape-start",b))}),this._reshapeOperation.on("vertex-move",function(b){a._onReshapeGeometryChanged();e.isSome(a.graphic)&&(b.graphic=a.graphic,a.emit("vertex-move",b))}),this._reshapeOperation.on("translate",function(b){a._onReshapeGeometryChanged();e.isSome(a.graphic)&&(b.graphic=a.graphic,a.emit("translate",b))}),this._reshapeOperation.on("vertex-add",
function(b){a._onReshapeGeometryChanged();e.isSome(a.graphic)&&(b.graphic=a.graphic,a.emit("vertex-add",b))}),this._reshapeOperation.on("vertex-remove",function(b){a._onReshapeGeometryChanged();e.isSome(a.graphic)&&(b.graphic=a.graphic,a.emit("vertex-remove",b))}),this._reshapeOperation.on("reshape-operation-stop",function(b){e.isNone(a.graphic)||(b.graphic=a.graphic,a.emit("reshape-stop",b))}),this._reshapeOperation.on("click",function(){return a.emit("click")}),l.init(this,"graphic",function(){a._updateGraphic()},
!0)])};b.prototype.handleInputEvent=function(a){"key-down"!==a.type||"Delete"!==a.key&&"Backspace"!==a.key||this._reshapeOperation.removeSelectedVertices()};b.prototype.reset=function(){this.graphic=null};f([d.property({constructOnly:!0,nonNullable:!0})],b.prototype,"view",void 0);f([d.property({value:null})],b.prototype,"graphic",null);f([d.property({readOnly:!0})],b.prototype,"type",void 0);f([d.property({value:null})],b.prototype,"cursor",void 0);return b=f([d.subclass("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshape3DTool")],
b)}(d.declared(r.EventedMixin(B.InteractiveToolBase)));b.GraphicReshape3DTool=v})},"esri/views/3d/interactive/editingTools/graphicReshape3D/isSupportedGraphic":function(){define(["require","exports","../../../../../core/maybe"],function(v,b,f){function t(b){return f.isSome(b)&&("polygon"===b.type||"polyline"===b.type)}Object.defineProperty(b,"__esModule",{value:!0});b.isSupportedGeometry=t;b.isSupportedGraphic=function(b){return t(b.geometry)}})},"esri/views/3d/interactive/editingTools/graphicReshape3D/ReshapeOperation":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/accessorSupport/decorators ../../../../../layers/graphics/dehydratedFeatures ./ReshapeMoveManipulator ./reshapeUtils ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryUtil ../../../../interactive/Manipulator3D ../../../../interactive/manipulatorUtils".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g,E,B){Object.defineProperty(b,"__esModule",{value:!0});var h=function(){return function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!1);this.isDragging=a;this.fromTranslation=b;this.graphic=null;this.type="reshape-start"}}();b.ReshapeStartEvent=h;var m=function(){return function(a){this.coords=a;this.graphic=null;this.type="vertex-move"}}();b.VertexMoveEvent=m;var q=function(){return function(a,b){this.dxScreen=a;this.dyScreen=b;this.graphic=null;this.type="translate"}}();
b.TranslateEvent=q;var n=function(){return function(a){this.coords=a;this.graphic=null;this.type="vertex-add"}}();b.VertexAddEvent=n;var C=function(){return function(a){this.coords=a;this.graphic=null;this.type="vertex-remove"}}();b.VertexRemoveEvent=C;var y=function(){return function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!1);this.isDragging=a;this.fromTranslation=b;this.graphic=null;this.type="reshape-stop"}}();b.ReshapeStopEvent=y;v=function(b){function e(a){a=b.call(this,a)||this;a._vertexManipulatorMaterial=
B.createManipulatorMaterial([1,.5,0],1);a._edgeManipulatorMaterial=B.createManipulatorMaterial([.5,.5,.5],1);a._selectedManipulatorMaterial=B.createManipulatorMaterial([1,1,1],1);a._manipulatorGeometry=new c(g.createSphereGeometry(1,16,16),"reshape-manipulator");a._handles=new u;a._manipulatorInfos=[];a._reshapeHelper=null;a._moveManipulator=null;a._numDragging=0;a.manipulators=null;return a}t(e,b);e.prototype.destroy=function(){this._clear()};Object.defineProperty(e.prototype,"inputGeometry",{get:function(){return this._reshapeHelper?
this._reshapeHelper.geometry:null},set:function(a){this._recreateManipulators(a)},enumerable:!0,configurable:!0});e.prototype.removeSelectedVertices=function(){var a=this._manipulatorInfos.filter(function(a){return a.manipulator.selected&&"vertex"===a.handle.type});this._removeVertices(a)};e.prototype._clear=function(){this._handles.removeAll();this.manipulators.removeAll();this._manipulatorInfos=[];this._reshapeHelper=this._moveManipulator=null;this._numDragging=0};e.prototype._recreateManipulators=
function(a){var b=this;this._clear();this._reshapeHelper=d.createReshapeHelper(a,"global"===this.view.viewingMode);if(!this._reshapeHelper)return null;this._reshapeHelper.components.forEach(function(a){a.vertices.forEach(function(a){return b._createManipulator(a)});a.edges.forEach(function(a){return b._createManipulator(a)})});this._moveManipulator=new l.ReshapeMoveManipulator({view:this.view,reshapeHelper:this._reshapeHelper,selectable:!1});this._handles.add(this._moveManipulator.watch("grabbing",
function(a){b._manipulatorInfos.forEach(function(b){b.manipulator.interactive=!a})},!0),this._moveManipulator);this._handles.add(this._moveManipulator.watch("dragging",function(a){!0===a?(++b._numDragging,1===b._numDragging&&b.emit("reshape-operation-start",new h(!0,!0))):(--b._numDragging,0===b._numDragging&&b.emit("reshape-operation-stop",new y(!0,!0)))},!0),this._moveManipulator);this._handles.add(this._moveManipulator.watch("hovering",function(a){b.cursor=a?"move":null},!0),this._moveManipulator);
this._moveManipulator.on("drag",function(a){return b._moveManipulatorDragCallback(a)});this._moveManipulator.on("click",function(){return b.emit("click")});this.manipulators.add(this._moveManipulator)};e.prototype._clearManipulatorSelection=function(){this._manipulatorInfos.forEach(function(a){a.manipulator.selected=!1})};e.prototype._createManipulator=function(a){var b=this,c=new E.Manipulator3D({view:this.view,renderObjects:[{geometry:this._manipulatorGeometry,material:this._vertexManipulatorMaterial,
stateMask:z.Vertex|4},{geometry:this._manipulatorGeometry,material:this._edgeManipulatorMaterial,stateMask:z.Edge|4},{geometry:this._manipulatorGeometry,material:this._selectedManipulatorMaterial,stateMask:8}],radius:5});c.alignment="on-the-ground";"vertex"===a.type?(c.state=z.Vertex,c.selectable=!0):(c.state=z.Edge,c.selectable=!1);var d={manipulator:c,handle:a};this._manipulatorInfos.push(d);this.manipulators.add(c);this._setManipulatorPosition(d);this._handles.add(c.watch("grabbing",function(a){b._moveManipulator.interactive=
!a},!0),c);this._handles.add(c.watch("dragging",function(a){!0===a?(++b._numDragging,1===b._numDragging&&b.emit("reshape-operation-start",new h(!0))):(--b._numDragging,0===b._numDragging&&b.emit("reshape-operation-stop",new y(!0)))},!0),c);this._handles.add(c.watch("hovering",function(a){b.cursor=a?"vertex"===d.handle.type?"move":"copy":null},!0),c);c.on("drag",function(){return b._manipulatorMoveCallback(d)});c.on("click",function(a){return b._manipulatorClickCallback(a,d)});return c};e.prototype._removeManipulator=
function(a){a&&(this._handles.remove(a.manipulator),this._manipulatorInfos.splice(this._manipulatorInfos.indexOf(a),1),this.manipulators.remove(a.manipulator))};e.prototype._getManipulatorInfoFromHandle=function(a){if(a)for(var b=0,c=this._manipulatorInfos;b<c.length;b++){var d=c[b];if(a===d.handle)return d}return null};e.prototype._setManipulatorPosition=function(a){a&&("vertex"===a.handle.type?a.manipulator.mapPoint=this._reshapeHelper.getVertexPositionAsPoint(a.handle,A):"edge"===a.handle.type&&
(a.manipulator.mapPoint=this._reshapeHelper.getEdgePositionAsPoint(a.handle,.5,A)))};e.prototype._splitEdgeManipulator=function(a){if("edge"===a.handle.type){var b=this._reshapeHelper.splitEdge(a.handle,.5);a.handle=b;a.manipulator.state=z.Vertex;a.manipulator.selectable=!0;b.left&&this._createManipulator(b.left);b.right&&this._createManipulator(b.right);return b}return null};e.prototype._manipulatorMoveCallback=function(a){var b=this;"edge"===a.handle.type&&this._splitEdgeManipulator(a);if(a.handle&&
"vertex"===a.handle.type){!1===a.manipulator.selected&&(this._clearManipulatorSelection(),a.manipulator.selected=!0);var c=a.handle.pos,d=a.manipulator.mapPoint.x-c[0],e=a.manipulator.mapPoint.y-c[1],c=this._manipulatorInfos.filter(function(a){return a.manipulator.selected&&"vertex"===a.handle.type});c.forEach(function(c){var m=c.handle;m.pos[0]+=d;m.pos[1]+=e;a!==c&&(A.x=m.pos[0],A.y=m.pos[1],A.spatialReference=b._reshapeHelper.geometry.spatialReference,c.manipulator.mapPoint=A)});this.outputGeometry=
this._reshapeHelper.commit();c.forEach(function(a){a=a.handle;b._setManipulatorPosition(b._getManipulatorInfoFromHandle(a.left));b._setManipulatorPosition(b._getManipulatorInfoFromHandle(a.right))});c=c.map(function(a){return a.handle.unnormalizedPos});c=new m(c);this.emit("vertex-move",c)}};e.prototype._removeVertices=function(a){var b=this,c=[];a.forEach(function(a){"vertex"===a.handle.type&&b._reshapeHelper.canRemoveVertex(a.handle)&&(0===c.length&&b.emit("reshape-operation-start",new h),c.push(a.handle.unnormalizedPos),
b._removeManipulator(a),b._removeManipulator(b._getManipulatorInfoFromHandle(a.handle.left)),b._removeManipulator(b._getManipulatorInfoFromHandle(a.handle.right)),(a=b._reshapeHelper.removeVertex(a.handle))&&b._createManipulator(a))});0<c.length&&(this.outputGeometry=this._reshapeHelper.commit(),a=new C(c),this.emit("vertex-remove",a),this.emit("reshape-operation-stop",new y))};e.prototype._manipulatorClickCallback=function(a,b){"vertex"===b.handle.type&&2===a.button&&this._removeVertices([b]);"edge"===
b.handle.type&&0===a.button&&(this.emit("reshape-operation-start",new h),a=this._splitEdgeManipulator(b),this.outputGeometry=this._reshapeHelper.commit(),a=new n([a.unnormalizedPos]),this.emit("vertex-add",a),this.emit("reshape-operation-stop",new y))};e.prototype._moveManipulatorDragCallback=function(a){var b=this,c=[],d=!0;this._manipulatorInfos.forEach(function(e){"vertex"===e.handle.type&&(e.manipulator.grabbing?d=!1:"vertex"===e.handle.type&&(e.handle.pos[0]+=a.dxGeometry,e.handle.pos[1]+=a.dyGeometry,
c.push(e.handle.pos),b._setManipulatorPosition(e)))});this._manipulatorInfos.forEach(function(a){"vertex"!==a.handle.type&&b._setManipulatorPosition(a)});this.outputGeometry=this._reshapeHelper.commit();if(d)this.emit("translate",new q(a.dxScreen,a.dyScreen));else{var e=new m(c);this.emit("vertex-move",e)}};f([a.property({value:null,nonNullable:!0})],e.prototype,"view",void 0);f([a.property({value:null})],e.prototype,"inputGeometry",null);f([a.property({value:null})],e.prototype,"cursor",void 0);
f([a.property({value:null})],e.prototype,"outputGeometry",void 0);f([a.property({constructOnly:!0})],e.prototype,"manipulators",void 0);return e=f([a.subclass("esri.views.3d.interactive.editingTools.graphicReshape3D.ReshapeOperation")],e)}(a.declared(r.EventedAccessor));b.ReshapeOperation=v;var A=e.makeDehydratedPoint(0,0,null,null),z;(function(a){a.Vertex=16;a.Edge=32})(z||(z={}))})},"esri/views/3d/interactive/editingTools/graphicReshape3D/ReshapeMoveManipulator":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/Accessor ../../../../../core/Collection ../../../../../core/maybe ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../views/3d/support/projectionUtils ../../../../../views/3d/support/stack ../../../../../views/support/drapedUtils".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g,E){Object.defineProperty(b,"__esModule",{value:!0});v=function(b){function d(a){a=b.call(this)||this;a._handlers=new u;a.interactive=!0;a.selectable=!1;a.grabbing=!1;a.dragging=!1;a.hovering=!1;a.selected=!1;return a}t(d,b);d.prototype.initialize=function(){};d.prototype.destroy=function(){this._handlers.removeAll();this._handlers=null;this._set("view",null)};d.prototype.intersectionDistance=function(b){if(!this.reshapeHelper.geometry)return null;b=E.intersectsDrapedGeometry(b,
this.reshapeHelper.geometry,this.view);if(a.isNone(b))return null;var c=g.sv3d.get();return this.view.renderCoordsHelper.toRenderCoords(b,c)?l.vec3.distance(B,this.view.state.camera.eye):null};d.prototype.attemptDragTo=function(a,b){if(null==this.reshapeHelper.geometry)return!1;var d=this.view.toMap(b.previous),e=this.view.toMap(a.screenPoint),f=0,m=0,n=0,h=0,q=0,g=0;d&&e&&(f=[0,0,0,0,0,0],c.bufferToBuffer([d.x,d.y,0,e.x,e.y,0],d.spatialReference,0,f,this.reshapeHelper.geometry.spatialReference,0,
2),n=f[3]-f[0],h=f[4]-f[1],f=e.x-d.x,m=e.y-d.y,q=a.screenPoint.x-b.previous.x,g=a.screenPoint.y-b.previous.y);var l={screenPoint:a.screenPoint,dxMap:f,dyMap:m,dxGeometry:n,dyGeometry:h,dxScreen:q,dyScreen:g,toMS:e};this._handlers.forEach(function(a){"drag"===a.type&&a.handler(l)});return!0};d.prototype.click=function(a){this._handlers.forEach(function(b){"click"===b.type&&b.handler(a)})};d.prototype.on=function(a,b){this._handlers.push({type:a,handler:b})};d.prototype.attach=function(){};d.prototype.detach=
function(){};f([e.property()],d.prototype,"reshapeHelper",void 0);f([e.property({constructOnly:!0,nonNullable:!0})],d.prototype,"view",void 0);f([e.property()],d.prototype,"interactive",void 0);f([e.property()],d.prototype,"selectable",void 0);f([e.property()],d.prototype,"grabbing",void 0);f([e.property()],d.prototype,"dragging",void 0);f([e.property()],d.prototype,"hovering",void 0);f([e.property()],d.prototype,"selected",void 0);return d=f([e.subclass("esri.views.interactive.GeometryManipulator")],
d)}(e.declared(r));b.ReshapeMoveManipulator=v;var B=d.vec3f64.create()})},"esri/views/3d/interactive/editingTools/graphicReshape3D/reshapeUtils":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../../../../../core/libs/gl-matrix-2/vec2 ../../../../../core/libs/gl-matrix-2/vec2f64 ../../../../../geometry/support/coordsUtils ../../../../../geometry/support/spatialReferenceUtils".split(" "),function(v,
b,f,t,r,u,a,e,l){function d(b,c,d){void 0===d&&(d=a.vec2f64.create());return u.vec2.set(d,b,c)}Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(){this.vertices=[];this.edges=[]}a.prototype.makeVertex=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);a={pos:a,unnormalizedPos:a,left:b,right:c,type:"vertex",component:this};this.vertices.push(a);return a};a.prototype.makeEdge=function(a,b){var c={v0:a,v1:b,type:"edge",component:this};a.right=c;b.left=c;this.edges.push(c);
return c};a.prototype.removeVertex=function(a){this.vertices.splice(this.vertices.indexOf(a),1);a.left&&this.removeEdge(a.left);a.right&&this.removeEdge(a.right)};a.prototype.removeEdge=function(a){this.edges.splice(this.edges.indexOf(a),1);a.v0.right=null;a.v1.left=null};return a}();b.Component=c;b.makeMapPoint=d;v=function(){function b(a,b){this.geometry=a;this.doUnnormalization=b;this.components=[];(a=l.getInfo(this.geometry.spatialReference))?(this._spanMin=a.valid[0],this._spanMax=a.valid[1],
this._span=this._spanMax-this._spanMin):this.doUnnormalization=!1}b.prototype.getVertexPositionAsPoint=function(a,b){b.x=a.pos[0];b.y=a.pos[1];b.z=null;b.spatialReference=this.geometry.spatialReference;return b};b.prototype.getEdgePosition=function(b,c,e){void 0===e&&(e=a.vec2f64.create());return d((b.v1.unnormalizedPos[0]-b.v0.unnormalizedPos[0])*c+b.v0.unnormalizedPos[0],(b.v1.unnormalizedPos[1]-b.v0.unnormalizedPos[1])*c+b.v0.unnormalizedPos[1],e)};b.prototype.getEdgePositionAsPoint=function(a,
b,c){a=this.getEdgePosition(a,b,B);c.x=a[0];c.y=a[1];c.z=null;c.spatialReference=this.geometry.spatialReference;return c};b.prototype.canRemoveVertex=function(a){return!0};b.prototype.removeVertex=function(a){var b=a.component,c=a.left,d=a.right;b.removeVertex(a);return c&&d?b.makeEdge(c.v0,d.v1):null};b.prototype.splitEdge=function(a,b){var c=a.component;b=c.makeVertex(this.getEdgePosition(a,b));var d=a.v0,e=a.v1;c.removeEdge(a);c.makeEdge(d,b);c.makeEdge(b,e);return b};return b}();b.ReshapeHelper=
v;var g=function(a){function b(b,f){f=a.call(this,b,f)||this;f.geometry=b;b=f.geometry.rings;for(var g=0;g<b.length;++g){for(var h=b[g],n=new c,l=h.length-1,m=0;m<l;++m){var q=d(h[m][0],h[m][1]);n.makeVertex(q)}h=n.vertices.length-1;for(l=0;l<h;++l)n.makeEdge(n.vertices[l],n.vertices[l+1]);n.makeEdge(n.vertices[n.vertices.length-1],n.vertices[0]);f.doUnnormalization&&e.computeUnnormalizedVertexPositionsOnDateLineCrossing(n.vertices,f._spanMin,f._spanMax,f._span);f.components.push(n)}return f}t(b,
a);b.prototype.canRemoveVertex=function(a){return 3<a.component.vertices.length};b.prototype.commit=function(){var a=this,b=[];this.components.forEach(function(c){var d=[];a.doUnnormalization&&e.computeUnnormalizedVertexPositionsOnDateLineCrossing(c.vertices,a._spanMin,a._spanMax,a._span);var f=c.vertices[0],g=f;do d.push(f.unnormalizedPos),f=f.right.v1;while(f&&f!==g);d.push(c.vertices[0].unnormalizedPos);b.push(d)});this.geometry.rings=b;return this.geometry};return b}(v),E=function(a){function b(b,
f){f=a.call(this,b,f)||this;f.geometry=b;b=f.geometry.paths;for(var g=0;g<b.length;++g){for(var h=b[g],l=new c,n=h.length,m=0;m<n;++m){var q=d(h[m][0],h[m][1]);l.makeVertex(q)}h=l.vertices.length-1;for(n=0;n<h;++n)l.makeEdge(l.vertices[n],l.vertices[n+1]);f.doUnnormalization&&e.computeUnnormalizedVertexPositionsOnDateLineCrossing(l.vertices,f._spanMin,f._spanMax,f._span);f.components.push(l)}return f}t(b,a);b.prototype.canRemoveVertex=function(a){return 2<a.component.vertices.length};b.prototype.commit=
function(){var a=this,b=[];this.components.forEach(function(c){var d=[];a.doUnnormalization&&e.computeUnnormalizedVertexPositionsOnDateLineCrossing(c.vertices,a._spanMin,a._spanMax,a._span);var f=c=c.vertices[0];do d.push(c.unnormalizedPos),c=c.right?c.right.v1:null;while(c&&c!==f);b.push(d)});this.geometry.paths=b;return this.geometry};return b}(v);b.isReshapeGeometry=function(a){return r.isSome(a)&&("polygon"===a.type||"polyline"===a.type)};b.createReshapeHelper=function(a,b){return a?"polygon"===
a.type?new g(a,b):new E(a,b):null};var B=a.vec2f64.create()})},"esri/views/interactive/Manipulator3D":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Collection ../../core/compilerUtils ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f64 ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/mat4f64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec3 ../../core/libs/gl-matrix-2/vec3f64 ../../geometry/support/aaBoundingRect ../../layers/graphics/dehydratedFeatures ../3d/support/geometryUtils ../3d/support/projectionUtils ../3d/support/stack ../3d/webgl-engine/lib/Intersector ../3d/webgl-engine/lib/intersectorUtils ../3d/webgl-engine/lib/Layer ../3d/webgl-engine/lib/Object3D".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g,E,B,h,m,q,n,C,y,A,z,T,K,p,ca,G,U){function V(a){return 0!==a[12]||0!==a[13]||0!==a[14]}Object.defineProperty(b,"__esModule",{value:!0});v=function(b){function k(a){a=b.call(this)||this;a.hideOnGrab=!1;a.moveOnDrag=!0;a.snapToPointer=!0;a.collisionType={type:"point"};a.collisionPriority=0;a.renderObjects=[];a.autoScaleRenderObjects=!0;a._radius=10;a._worldSized=!1;a._focusMultiplier=2;a._touchMultiplier=2.5;a.interactive=!0;a.selectable=!1;a.dragging=!1;a._areAnyEngineObjectsVisible=
!1;a._position=C.vec3f64.create();a._modelTransform=h.mat4f64.create();a._dragOffset=null;a._dirtyScreenPoint=l.createScreenPoint();a._dirtyScreenPointArray=l.createScreenPointArray();a._dirtyRenderScreenPointArray=l.createRenderScreenPointArray3();a._dirtyOriginScreenPointArray=l.createScreenPointArray();a._dirtyScreenPixelSize=1;a._screenPositionDirty=!0;a._engineResourcesAddedToStage=!1;a._engineResources=null;a._attached=!1;a._engineLayerId=null;a._materialIdReferences=null;a._hitResult={onSurface:!1,
surfaceType:"ground"};a._handlers=new u;return a}t(k,b);k.prototype.initialize=function(){this._intersector=new p(this.view.viewingMode);this._mapPoint=A.makeDehydratedPoint(0,0,0,this.view.spatialReference)};k.prototype.destroy=function(){this._handlers.removeAll();this._handlers=null;this._removeResourcesFromStage();this._engineResources=null;this._set("view",null);this._camera=null};Object.defineProperty(k.prototype,"alignment",{get:function(){return this._get("alignment")},set:function(a){this._set("alignment",
a);this.constructed&&this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"visible",{set:function(a){a!==this._get("visible")&&(this._set("visible",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"radius",{get:function(){return this._radius},set:function(a){a!==this._radius&&(this._radius=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"worldSized",{get:function(){return this._worldSized},
set:function(a){a!==this._worldSized&&(this._worldSized=a,this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focusMultiplier",{get:function(){return this._focusMultiplier},set:function(a){this._focusMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"touchMultiplier",{get:function(){return this._touchMultiplier},set:function(a){this._touchMultiplier=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"modelTransform",
{get:function(){return this._modelTransform},set:function(a){V(a)&&(this._screenPositionDirty=!0);B.mat4.copy(this._modelTransform,a);this._updateEngineObject()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"position",{get:function(){return this._position},set:function(a){this.view.renderCoordsHelper.fromRenderCoords(a,this._mapPoint,this._mapPoint.spatialReference);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"mapPoint",{get:function(){return this._mapPoint},
set:function(a){A.clonePoint(a,this._mapPoint);this._refreshMapPoint()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"grabbing",{set:function(a){a!==this._get("grabbing")&&(this._set("grabbing",a),this._updateEngineObject());a||(this._dragOffset=null)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"hovering",{set:function(a){a!==this._get("hovering")&&(this._set("hovering",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"selected",{set:function(a){a!==this._get("selected")&&(this._set("selected",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"state",{set:function(a){a!==this._get("state")&&(this._set("state",a),this._updateEngineObject())},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"areAnyEngineObjectsVisible",{get:function(){return this._areAnyEngineObjectsVisible},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"surfaceType",
{get:function(){return this._hitResult.onSurface?this._hitResult.surfaceType:null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_focused",{get:function(){return this._get("hovering")||this._get("grabbing")},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"screenPoint",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPoint},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_screenPointArray",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_renderScreenPointArray",{get:function(){this._updateScreenSpaceProperties();return this._dirtyRenderScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_originScreenPointArray",{get:function(){this._updateScreenSpaceProperties();
return this._dirtyOriginScreenPointArray},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"_screenPixelSize",{get:function(){this._updateScreenSpaceProperties();return this._dirtyScreenPixelSize},enumerable:!0,configurable:!0});k.prototype._updateScreenSpaceProperties=function(){if(this._screenPositionDirty){this._screenPositionDirty=!1;this._dirtyScreenPixelSize=this._camera.computeScreenPixelSizeAt(this._position);var a=V(this._modelTransform),b;a?(b=this._calculateModelTransformOffset(da),
b=n.vec3.add(b,b,this._position)):b=this._position;this._camera.projectPoint(b,this._dirtyRenderScreenPointArray);this._camera.renderToScreen(this._dirtyRenderScreenPointArray,this._dirtyScreenPointArray);l.screenPointArrayToObject(this._dirtyScreenPointArray,this._dirtyScreenPoint);a?(this._camera.projectPoint(this._position,L),this._camera.renderToScreen(L,this._dirtyOriginScreenPointArray)):m.vec2.copy(this._dirtyOriginScreenPointArray,this._dirtyScreenPointArray)}};k.prototype.intersectionDistance=
function(b,c){if(!this._get("visible"))return null;var d=l.screenPointObjectToArray(b,M),e=this._getCollisionRadius(c);c=-1*this._get("collisionPriority");switch(this.collisionType.type){case "point":if(m.vec2.squaredDistance(this._screenPointArray,d)<e*e)return this._renderScreenPointArray[2]+c;break;case "line":var f=this.collisionType.paths;b=this._getWorldToScreenObjectScale();b=this._calculateObjectTransform(b,N);for(var e=e*this._screenPixelSize,d=z.ray.fromScreen(this._camera,d,Q),h=0,p=f;h<
p.length;h++)if(f=p[h],0!==f.length)for(var k=n.vec3.transformMat4(Y,f[0],b),F=1;F<f.length;F++){var H=n.vec3.transformMat4(Z,f[F],b),q=z.lineSegment.closestRayDistance2(z.lineSegment.fromPoints(k,H,W),d);if(null!=q&&q<e*e)return b=n.vec3.add(K.sv3d.get(),k,H),n.vec3.scale(b,b,.5),e=l.castRenderScreenPointArray(K.sv3d.get()),this._camera.projectPoint(b,e),e[2]+c;n.vec3.copy(k,H)}break;case "disc":k=this.collisionType.direction;b=this._getWorldToScreenObjectScale();b=this._calculateObjectTransform(b,
N);e*=this._screenPixelSize;d=z.ray.fromScreen(this._camera,d,Q);F=g.mat3.fromMat4(O,b);F=n.vec3.transformMat3(aa,k,F);k=this._calculateModelTransformPosition(R);z.plane.fromPositionAndNormal(k,F,P);h=S;if(z.plane.intersectRay(P,d,h)&&n.vec3.squaredDistance(h,k)<e*e)return this._renderScreenPointArray[2]+c;break;case "ribbon":b=this.collisionType;f=b.paths;k=b.direction;b=this._getWorldToScreenObjectScale();b=this._calculateObjectTransform(b,N);e*=this._camera.computeScreenPixelSizeAt(this._position);
d=z.ray.fromScreen(this._camera,d,Q);F=g.mat3.fromMat4(O,b);F=n.vec3.transformMat3(aa,k,F);k=this._calculateModelTransformPosition(R);z.plane.fromPositionAndNormal(k,F,P);h=S;if(!z.plane.intersectRay(P,d,h))break;d=0;for(p=f;d<p.length;d++)if(f=p[d],0!==f.length)for(k=n.vec3.transformMat4(Y,f[0],b),F=1;F<f.length;F++){H=n.vec3.transformMat4(Z,f[F],b);q=z.lineSegment.distance2(z.lineSegment.fromPoints(k,H,W),h);if(null!=q&&q<e*e)return b=n.vec3.add(K.sv3d.get(),k,H),n.vec3.scale(b,b,.5),e=l.castRenderScreenPointArray(K.sv3d.get()),
this._camera.projectPoint(b,e),e[2]+c;n.vec3.copy(k,H)}break;default:a.neverReached(this.collisionType)}return null};k.prototype.attemptDragTo=function(a){if(!this.moveOnDrag)return this._handlers.forEach(function(b){var c=b.handler;"drag"===b.type&&c(a)}),!1;var b=l.screenPointObjectToArray(a.screenPoint,M);e.isNone(this._dragOffset)&&this.grabbing&&!this.snapToPointer&&(this._dragOffset=m.vec2.subtract(q.vec2f32.create(),b,this._originScreenPointArray));e.isSome(this._dragOffset)&&m.vec2.subtract(b,
b,this._dragOffset);var b=this.view.sceneIntersectionHelper.intersectToolIntersectorScreen(b,this._intersector,"on-the-ground"===this.alignment?w:null).results.min,c=S;b.getIntersectionPoint(c)?(this.position=c,this._hitResult.onSurface=!0,this._hitResult.surfaceType="TerrainRenderer"===b.intersector?"ground":"feature",this._handlers.forEach(function(b){var c=b.handler;"drag"===b.type&&c(a)})):this._hitResult.onSurface=!1;return this._hitResult.onSurface};k.prototype.grab=function(a){this._handlers.forEach(function(b){var c=
b.handler;"grab"===b.type&&c(a)})};k.prototype.click=function(a){this._handlers.forEach(function(b){var c=b.handler;"click"===b.type&&c(a)})};k.prototype.on=function(a,b){this._handlers.push({type:a,handler:b})};k.prototype.attach=function(a){void 0===a&&(a={manipulator3D:{}});if(this.view._stage){a=a.manipulator3D;this._engineLayerId=a.engineLayerId;if(e.isNone(this._engineLayerId)){var b=new G("manipulator-3d",{isPickable:!1});this.view._stage.add(0,b);this.view._stage.addToViewContent([b.id]);
this._engineLayerId=b.id;a.engineLayerId=b.id}a.engineLayerReferences=(a.engineLayerReferences||0)+1;this._materialIdReferences=a.materialIdReferences;e.isNone(this._materialIdReferences)&&(this._materialIdReferences=new Map,a.materialIdReferences=this._materialIdReferences);this._camera=this.view.state.camera;this._attached=!0;this._updateEngineObject();T.canProject(this._mapPoint.spatialReference,this.view.spatialReference)||(this.mapPoint=A.makeDehydratedPoint(0,0,0,this.view.spatialReference))}};
k.prototype.detach=function(a){void 0===a&&(a={manipulator3D:{}});a=a.manipulator3D;a.engineLayerReferences--;var b=0===a.engineLayerReferences;b&&(a.engineLayerId=null);this._removeResourcesFromStage(b);this._camera=this._materialIdReferences=this._engineLayerId=this._engineResources=null;this._attached=!1};k.prototype.onCameraChange=function(a){this._camera=a;this._screenPositionDirty=!0;this._updateEngineObject()};k.prototype.onElevationChange=function(a){this.view.renderCoordsHelper.fromRenderCoords(this.position,
I,a.spatialReference)&&y.containsPoint(a.extent,I)&&this._refreshMapPoint(!0)};k.prototype._refreshMapPoint=function(b){void 0===b&&(b=!1);switch(this.alignment){case "none":break;case "on-the-ground":var c=this.view.elevationProvider.getElevation(this.mapPoint,"ground");if(c===this._mapPoint.z&&b)return;this._mapPoint.z=c;break;default:a.neverReached(this.alignment)}this._screenPositionDirty=!0;this._hitResult.onSurface=!1;this.view.renderCoordsHelper.toRenderCoords(this._mapPoint,this._position);
this._updateEngineObject()};k.prototype._updateEngineObject=function(){this._areAnyEngineObjectsVisible=!1;if(this._attached)if(!1===this._get("visible"))this._removeResourcesFromStage();else{var a=this._getWorldToScreenObjectScale(),b=N;!0===this._get("autoScaleRenderObjects")&&(a*=this._getFocusedSize(this._radius,this._focused));this._calculateObjectTransform(a,b);for(var a=this._ensureEngineResources().objectsByState,c=(this._focused?2:1)|(this._get("selected")?8:4),d=this._get("hideOnGrab")&&
this._get("grabbing"),e=0;e<a.length;e++){var f=a[e],g=f.stateMask,f=f.objects;if(d)for(var g=0,h=f;g<h.length;g++)f=h[g],f.hideAllComponents();else if(h=0===(g&15)||(c&g)===(g&15),g=0===(g&65520)||(this._get("state")&g)===(g&65520),h&&g)for(g=0,h=f;g<h.length;g++)f=h[g],f.unhideAllComponents(),f.objectTransformation=b,this._areAnyEngineObjectsVisible=!0;else for(g=0,h=f;g<h.length;g++)f=h[g],f.hideAllComponents()}}};k.prototype._ensureEngineResources=function(){if(e.isNone(this._engineResources)){var a=
this.view._stage.getContent(0,e.expect(this._engineLayerId)),b=[],c=new Set;this.renderObjects.forEach(function(a){a=a.material;c.has(a)||(b.push(a),c.add(a))});var d=function(a,b){var c=b.geometry,d=b.material,f=b.transform;Array.isArray(c)?c.forEach(function(b){return a.addGeometry(b,d,f)}):a.addGeometry(c,d,f)},f=new Map;this.renderObjects.forEach(function(a){var b=new U({idHint:"manipulator"});d(b,a);a=a.stateMask||0;var c=f.get(a)||[];c.push(b);f.set(a,c)});var g=[];f.forEach(function(a,b){g.push({stateMask:b,
objects:a})});this._engineResources={objectsByState:g,layer:a,materials:b}}this._addResourcesToStage();return this._engineResources};k.prototype._addResourcesToStage=function(){var a=this;if(!this._engineResourcesAddedToStage&&!e.isNone(this._engineResources)){var b=this._engineResources,c=b.objectsByState,d=b.layer;b.materials.forEach(function(b){var c=e.expect(a._materialIdReferences),d=c.get(b.id)||0;0===d&&a.view._stage.add(3,b);c.set(b.id,d+1)});c.forEach(function(b){b.objects.forEach(function(b){d.addObject(b);
a.view._stage.add(1,b)})});this._engineResourcesAddedToStage=!0}};k.prototype._removeResourcesFromStage=function(a){var b=this;void 0===a&&(a=!1);if(this._engineResourcesAddedToStage&&!e.isNone(this._engineResources)){var c=this._engineResources,d=c.layer,f=c.materials;c.objectsByState.forEach(function(a){a.objects.forEach(function(a){d.removeObject(a);b.view._stage.remove(1,a.id)})});f.forEach(function(a){var c=e.expect(b._materialIdReferences),d=c.get(a.id);1===d?(b.view._stage.remove(3,a.id),c.delete(a.id)):
c.set(a.id,d-1)});a&&this.view._stage.remove(0,d.id);this._engineResourcesAddedToStage=!1}};k.prototype._getCollisionRadius=function(a){return this._getFocusedSize(this._radius,!0)*("touch"===a?this._touchMultiplier:1)};k.prototype._getFocusedSize=function(a,b){return a*(b?this._focusMultiplier:1)};k.prototype._getWorldToScreenObjectScale=function(){return this._worldSized?1:this._screenPixelSize};k.prototype._calculateModelTransformPosition=function(a){var b=this._getWorldToScreenObjectScale(),b=
this._calculateObjectTransform(b,ba);return n.vec3.set(a,b[12],b[13],b[14])};k.prototype._calculateModelTransformOffset=function(a){var b=this._calculateModelTransformPosition(a);return n.vec3.subtract(a,b,this._position)};k.prototype._calculateObjectTransform=function(a,b){B.mat4.set(b,a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);B.mat4.multiply(b,b,this._modelTransform);b[12]+=this._position[0];b[13]+=this._position[1];b[14]+=this._position[2];b[15]=1;return b};f([d.property({constructOnly:!0,nonNullable:!0})],
k.prototype,"view",void 0);f([d.property({value:"none",nonNullable:!0})],k.prototype,"alignment",null);f([d.property()],k.prototype,"hideOnGrab",void 0);f([d.property()],k.prototype,"moveOnDrag",void 0);f([d.property()],k.prototype,"snapToPointer",void 0);f([d.property()],k.prototype,"collisionType",void 0);f([d.property({type:c.Integer})],k.prototype,"collisionPriority",void 0);f([d.property({constructOnly:!0})],k.prototype,"renderObjects",void 0);f([d.property()],k.prototype,"autoScaleRenderObjects",
void 0);f([d.property({value:!0})],k.prototype,"visible",null);f([d.property()],k.prototype,"radius",null);f([d.property()],k.prototype,"worldSized",null);f([d.property()],k.prototype,"focusMultiplier",null);f([d.property()],k.prototype,"touchMultiplier",null);f([d.property()],k.prototype,"interactive",void 0);f([d.property()],k.prototype,"selectable",void 0);f([d.property({value:!1})],k.prototype,"grabbing",null);f([d.property()],k.prototype,"dragging",void 0);f([d.property({value:!1})],k.prototype,
"hovering",null);f([d.property({value:!1})],k.prototype,"selected",null);f([d.property({value:0})],k.prototype,"state",null);f([d.property({dependsOn:["hovering","grabbing"]})],k.prototype,"focused",null);return k=f([d.subclass("esri.views.interactive.Manipulator3D")],k)}(d.declared(r));b.Manipulator3D=v;var w={include:new Set};w.include.add(ca.TERRAIN_ID);var M=l.createScreenPointArray(),L=l.createRenderScreenPointArray3(),W=z.lineSegment.create(),Q=z.ray.create(),O=E.mat3f64.create(),ba=h.mat4f64.create(),
N=h.mat4f64.create(),P=z.plane.create(),Y=C.vec3f64.create(),Z=C.vec3f64.create(),S=C.vec3f64.create(),aa=C.vec3f64.create(),R=C.vec3f64.create(),da=C.vec3f64.create(),I=C.vec3f64.create()})},"esri/views/interactive/manipulatorUtils":function(){define("require exports ../../core/libs/gl-matrix-2/mat4 ../../core/libs/gl-matrix-2/vec3 ../3d/support/stack ../3d/webgl-engine/lib/Geometry ../3d/webgl-engine/lib/GeometryUtil ../3d/webgl-engine/materials/DefaultMaterial ./Manipulator3D".split(" "),function(v,
b,f,t,r,u,a,e,l){function d(a,b){var c=1!==b;a=new e({diffuse:a,transparent:c,writeDepth:!c,cullFace:"back",opacity:b,castShadows:!1,softwareInstanced:!0},"manipulator");a.renderOccluded=4;return a}function c(a,b,c,d){a=t.vec3.normalize(r.sv3d.get(),a);b=t.vec3.normalize(r.sv3d.get(),b);var f=t.vec3.cross(r.sv3d.get(),a,b);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=0;d[4]=b[0];d[5]=b[1];d[6]=b[2];d[7]=0;d[8]=f[0];d[9]=f[1];d[10]=f[2];d[11]=0;d[12]=c[0];d[13]=c[1];d[14]=c[2];d[15]=1;return d}Object.defineProperty(b,
"__esModule",{value:!0});b.createManipulatorMaterial=d;b.createSphereManipulator=function(b,c,f){return new l.Manipulator3D({view:b,renderObjects:[{geometry:new u(a.createSphereGeometry(1,32,32),"manipulator"),material:d(c,f)}]})};b.calculateInputRotationTransform=function(a,b,d,e){a=t.vec3.subtract(r.sv3d.get(),a,d);e=t.vec3.cross(r.sv3d.get(),e,a);d=c(a,e,d,r.sm4d.get());f.mat4.invert(d,d);b=t.vec3.transformMat4(r.sv3d.get(),b,d);return Math.atan2(b[1],b[0])};b.calculateTranslateRotateFromBases=
c})},"esri/views/3d/interactive/editingTools/graphicTransform3D/GraphicTransform3DTool":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/scheduling ../../../../../core/screenUtils ../../../../../core/unitUtils ../../../../../core/watchUtils ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/mat4 ../../../../../core/libs/gl-matrix-2/mat4f64 ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../../../core/libs/gl-matrix-2/math/common ../../../../../geometry/Point ../../../../../layers/graphics/dehydratedFeatures ./graphicTransform3DToolConfig ./isSupportedGraphic ../../../support/geometryUtils ../../../support/mathUtils ../../../support/projectionUtils ../../../support/stack ../../../webgl-engine/lib/Geometry ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/InteractiveToolBase ../../../../interactive/Manipulator3D ../../../../interactive/manipulatorUtils".split(" "),
function(v,b,f,t,r,u,a,e,l,d,c,g,E,B,h,m,q,n,C,y,A,z,T,K,p,ca,G,U,V,w,M,L,W,Q,O,ba){function N(a){var b=new M(L.createCylinderGeometry(p.DISC_HEIGHT,1,p.GEOMETRY_SEGMENTS,A.vec3f64.fromValues(0,0,1),A.vec3f64.fromValues(0,0,0)),"graphic-transform-disc"),c=I(),d=I(.5),f=n.mat4.fromScaling(C.mat4f64.create(),A.vec3f64.fromValues(p.DISC_RADIUS,p.DISC_RADIUS,p.DISC_RADIUS));a=new O.Manipulator3D({view:a,renderObjects:[{geometry:b,material:c,stateMask:x.RingUnfocused|x.ArrowUnfocused,transform:f},{geometry:b,
material:d,transform:f}],autoScaleRenderObjects:!1,radius:p.DISC_COLLISION_RADIUS,focusMultiplier:1,touchMultiplier:1,snapToPointer:!1,alignment:"on-the-ground",collisionType:{type:"disc",direction:A.vec3f64.fromValues(0,0,1)}});a.visible=!1;return a}function P(a){for(var b=function(a,b,c){for(var d=[],f=Math.ceil(p.GEOMETRY_SEGMENTS*(b-a)/(2*Math.PI)),e=0;e<f+1;e++){var J=a+e*(b-a)/f;d.push(A.vec3f64.fromValues(c*Math.cos(J),c*Math.sin(J),0))}return d},c=function(a){return b(0,2*Math.PI,a)},d=function(a,
b){return new M(L.createPathExtrusionGeometry([[-b/2,0],[b/2,0],[b/2,p.RING_HEIGHT/2],[-b/2,p.RING_HEIGHT/2]],a,[],[],!1),"graphic-transform-ring")},f=c(p.RING_RADIUS),e=d(f,p.RING_THICKNESS),g=[],h=[],l=[],k=0;2>k;k++){var D=k*Math.PI-Math.PI/4,m=Math.PI/2-p.ROTATE_INDICATOR_ARC_LENGTH,q=D+m,D=D+Math.PI/2-m,m=b(q,D,p.INNER_INDICATOR_RADIUS),t=d(m,p.INDICATOR_THICKNESS);l.push(m);g.push(t);h.push(t);for(t=0;2>t;t++){var u=0===t,r=C.mat4f64.create();if(u){n.mat4.scale(r,r,[1,-1,1]);n.mat4.rotate(r,
r,-q,[0,0,1]);var v=Math.round(p.ROTATE_INDICATOR_ARROW_PLACEMENT_PERCENTAGE*(m.length-1))}else n.mat4.rotate(r,r,D,[0,0,1]),v=Math.round((1-p.ROTATE_INDICATOR_ARROW_PLACEMENT_PERCENTAGE)*(m.length-1));r[12]=m[v][0];r[13]=m[v][1];r[14]=m[v][2];v=L.createExtrudedTriangle(p.ROTATE_INDICATOR_ARROW_TIP_LENGTH,0,p.ROTATE_INDICATOR_ARROW_TIP_RADIUS,p.RING_HEIGHT);L.transformInPlace(v,r);r=new M(v,"graphic-transform-ring-rotate");(u?g:h).push(r)}}t=[];for(k=0;2>k;k++)D=k*Math.PI-Math.PI/4,m=Math.PI/2-p.SCALE_INDICATOR_ARC_LENGTH,
q=D+m,D=D+Math.PI/2-m,m=b(q,D,p.OUTER_INDICATOR_RADIUS),t.push(d(m,p.INDICATOR_THICKNESS));k=c(p.RING_RADIUS+p.SCALE_INDICATOR_OFFSET1);q=c(p.RING_RADIUS+p.SCALE_INDICATOR_OFFSET2);k=d(k,p.INDICATOR_THICKNESS);q=d(q,p.INDICATOR_THICKNESS);D=c(p.RING_RADIUS-p.SCALE_INDICATOR_OFFSET1);m=c(p.RING_RADIUS-p.SCALE_INDICATOR_OFFSET2);c=d(D,p.INDICATOR_THICKNESS);d=d(m,p.INDICATOR_THICKNESS);D=I();m=I(.66);u=I(.5);r=I(.33);e=[{geometry:e,material:D,stateMask:x.DiscUnfocused|x.ArrowUnfocused},{geometry:e,
material:u},{geometry:t,material:D,stateMask:x.Unlocked|x.RingFocused},{geometry:k,material:m,stateMask:x.ScaleIn|2},{geometry:q,material:r,stateMask:x.ScaleIn|2},{geometry:c,material:m,stateMask:x.ScaleOut|2},{geometry:d,material:r,stateMask:x.ScaleOut|2},{geometry:g,material:D,stateMask:x.Unlocked|x.RingFocused},{geometry:g,material:D,stateMask:x.RotateLeft|2},{geometry:h,material:D,stateMask:x.RotateRight|2}];f=[f].concat(l);return new O.Manipulator3D({view:a,renderObjects:e,autoScaleRenderObjects:!1,
radius:p.RING_THICKNESS,focusMultiplier:1,touchMultiplier:1.5,moveOnDrag:!1,alignment:"on-the-ground",collisionType:{type:"ribbon",paths:f,direction:A.vec3f64.fromValues(0,0,1)}})}function Y(a){var b=Math.sqrt(p.DISC_TRANSLATE_ARROW_SIZE*p.DISC_TRANSLATE_ARROW_SIZE*3/4),c=L.createExtrudedTriangle(b,p.DISC_TRANSLATE_ARROW_SIZE/2,p.DISC_TRANSLATE_ARROW_SIZE/2,p.DISC_HEIGHT);L.transformInPlace(c,n.mat4.fromTranslation(w.sm4d.get(),y.vec3.set(w.sv3d.get(),0,-b/3,0)));var c=new M(c,"graphic-transform-disc-arrow"),
d=I(),f=I(.5);a=new O.Manipulator3D({view:a,renderObjects:[{geometry:c,material:f,stateMask:x.DiscFocused|1},{geometry:c,material:f,stateMask:x.ArrowFocused|1},{geometry:c,material:d,stateMask:x.TouchInput|x.ArrowUnfocused|x.DiscUnfocused|x.RingUnfocused},{geometry:c,material:d,stateMask:2}],autoScaleRenderObjects:!1,radius:b,focusMultiplier:1,touchMultiplier:1,snapToPointer:!1,alignment:"on-the-ground",collisionType:{type:"disc",direction:A.vec3f64.fromValues(0,0,1)}});a.visible=!1;return a}function Z(a,
b){var c=this,d=a.allLayerViews.find(function(a){return a.layer===b.layer}),f=b.symbol;return g.all(f.symbolLayers.map(function(a){return u(c,void 0,void 0,function(){var b,c;return r(this,function(e){switch(e.label){case 0:c=b=null,"object"===a.type&&(b=a.heading),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,d.whenSymbolLayerSize(f,a)];case 2:return c=e.sent(),[3,4];case 3:return e.sent(),c=null,[3,4];case 4:return[2,{heading:b,size:c}]}})})}).toArray()).then(function(a){return{symbolLayers:a}})}
function S(a){return(a=a.symbol.symbolLayers.find(function(a){return"object"===a.type}))&&a.heading||0}function aa(a,b,d,f){a.symbolLayers.forEach(function(a,e){var J=b.symbolLayers[e];e=J.heading;J=J.size;"object"===a.type&&(a.heading=(c.isSome(e)?e:0)-z.toDegree(d),c.isSome(J)&&"width"in J&&(a.width=J.width*f,a.depth=J.depth*f,a.height=J.height*f))})}function R(a){var b=y.vec3.subtract(w.sv3d.get(),a.startPoint,a.origin);a=y.vec3.subtract(w.sv3d.get(),a.endPoint,a.origin);b=y.vec3.length(b);a=y.vec3.length(a);
return 0===b?0:a/b}function da(a,b){var c=a.origin,d=a.startPoint,f=a.endPoint,e=a.plane;a=X(d,b,w.sv3d.get());f=X(f,b,w.sv3d.get());if(y.vec3.squaredDistance(a,f)<p.DRAG_THRESHOLD_PX*p.DRAG_THRESHOLD_PX)return null;var g=y.vec3.subtract(w.sv3d.get(),d,c),e=y.vec3.cross(w.sv3d.get(),g,e),d=y.vec3.add(w.sv3d.get(),d,e),c=X(c,b,w.sv3d.get());b=X(d,b,w.sv3d.get());d=y.vec3.subtract(w.sv3d.get(),b,a);b=y.vec3.subtract(w.sv3d.get(),a,c);a=G.ray.wrap(a,d);b=G.ray.wrap(c,b);return G.ray.distance2(a,f)<G.ray.distance2(b,
f)?"rotate":"scale"}function I(a){void 0===a&&(a=1);var b=p.HANDLE_COLOR.concat([a]);a=new W({color:b,transparent:1!==a,cullFace:"back"},"graphic-transform");a.renderOccluded=2;return a}function X(a,b,c){a=b.projectPoint(a,B.castRenderScreenPointArray(ma));b=b.renderToScreen(a,na);return y.vec3.set(c,b[0],b[1],0)}function k(a){return"local"===a.viewingMode?!0:a.scale<p.ALIGN_ARROWS_SCALE_THRESHOLD}Object.defineProperty(b,"__esModule",{value:!0});var F=l.getLogger("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransform3DTool"),
H=function(){return function(a){this.graphic=a}}();b.GraphicTranslateStartEvent=H;var ea=function(){return function(a){this.graphic=a}}();b.GraphicTranslateStopEvent=ea;var fa=function(){return function(a){this.graphic=a}}();b.GraphicRotateStartEvent=fa;var ia=function(){return function(a){this.graphic=a}}();b.GraphicRotateStopEvent=ia;var ga=function(){return function(a){this.graphic=a}}();b.GraphicScaleStartEvent=ga;var ja=function(){return function(a){this.graphic=a}}();b.GraphicScaleStopEvent=
ja;var ha=function(){return function(a,b,c){this.graphic=a;this.dx=b;this.dy=c;this.type="translate"}}();b.GraphicTranslateEvent=ha;var ka=function(){return function(a,b){this.graphic=a;this.angle=b;this.type="rotate"}}();b.GraphicRotateEvent=ka;var la=function(){return function(a,b){this.graphic=a;this.scale=b;this.type="scale"}}();b.GraphicScaleEvent=la;v=function(a){function b(b){b=a.call(this,b)||this;b.enableRotation=!0;b.enableScaling=!0;b.discManipulator=null;b.ringManipulator=null;b.arrowManipulators=
null;b.type="transform-3d";b._handles=new e;b._arrowDragData=null;b._ringDragData=null;b._startSymbolDataPromise=null;b._startSymbolData=null;b._ringDelayedFocusFrameTask=null;b._ringManipulatorHasDelayedFocused=!1;b._scaleAnimationFrameTask=null;b._lastPointerEventType=null;return b}t(b,a);b.prototype.destroy=function(){this._removeFrameTasks();this.graphic=null;this._handles.destroy();this._handles=null;this._set("view",null)};Object.defineProperty(b.prototype,"graphic",{set:function(a){c.isSome(a)&&
!ca.isSupportedGraphic(a)?F.error("Only graphics from a graphics layer with point geometries and object symbology are supported"):this._set("graphic",a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_ringMode",{get:function(){return c.isSome(this._ringDragData)&&this._ringDragData.mode||this._ringModeFromOptions},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_ringModeFromOptions",{get:function(){var a=this._shouldAllowModeType("scale"),b=this._shouldAllowModeType("rotate");
return a||b?b?a?null:{type:"rotate",startAngle:0}:{type:"scale"}:{type:"disabled"}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"_manipulatorState",{get:function(){var a=this._ringMode,b="touch"===this._lastPointerEventType?x.TouchInput:0,b=c.isNone(a)?b|x.Unlocked:"rotate"===a.type?b|(c.isSome(this._ringDragData)&&0>this._ringDragData.angleDir?x.RotateLeft:x.RotateRight):b|(c.isSome(this._ringDragData)&&0>this._ringDragData.scaleDir?x.ScaleIn:x.ScaleOut),b=b|(this.discManipulator.focused?
x.DiscFocused:x.DiscUnfocused),b=b|(this._ringManipulatorHasDelayedFocused?x.RingFocused:x.RingUnfocused);return b|=this.arrowManipulators.some(function(a){return a.manipulator.focused})?x.ArrowFocused:x.ArrowUnfocused},enumerable:!0,configurable:!0});b.prototype.reset=function(){this.graphic=null};b.prototype.handleInputEvent=function(a){"pointer-move"!==a.type&&"pointer-down"!==a.type&&"pointer-up"!==a.type||a.pointerType===this._lastPointerEventType||(this._lastPointerEventType=a.pointerType,this._updateManipulators())};
b.prototype.initialize=function(){for(var a=this,b=N(this.view),d=P(this.view),f=[],e=0;4>e;e++){var g=Y(this.view),h=C.mat4f64.create();this._calculateArrowManipulatorTransform(e,h);f.push({manipulator:g,transform:h})}this.discManipulator=b;this.ringManipulator=d;this.arrowManipulators=f;this._handles.add([b.watch("grabbing",function(c){a._setSingleManipulatorInteractive(b,c)},!0),b.watch("dragging",function(b){c.isSome(a.graphic)&&(b?a.emit("graphic-translate-start",new H(a.graphic)):a.emit("graphic-translate-stop",
new ea(a.graphic)))},!0),m.watch(b,"focused",function(){c.isNone(a._scaleAnimationFrameTask)&&a._updateManipulators()}),m.init(this,"graphic.geometry",function(){c.isSome(a.graphic)&&c.isSome(a.graphic.geometry)&&"point"===a.graphic.geometry.type&&(b.mapPoint=K.clonePoint(a.graphic.geometry,oa));a._updateManipulators()},!0)]);f.forEach(function(b,d){var f=b.manipulator;f.on("drag",function(b){a._handleArrowDrag(d)});a._handles.add([m.watch(f,"focused",function(){a._updateManipulators()}),m.watch(f,
"grabbing",function(b){a._setSingleManipulatorInteractive(f,b)}),m.watch(f,"dragging",function(b){c.isNone(a.graphic)||(b?a.emit("graphic-translate-start",new H(a.graphic)):(a._arrowDragData=null,a.emit("graphic-translate-stop",new ea(a.graphic))))})])});b.on("drag",function(d){if(!c.isNone(a.graphic)&&!c.isNone(a.graphic.geometry)&&"point"===a.graphic.geometry.type){d=a.graphic.geometry.z;var f=a.graphic.geometry,e=K.clonePoint(b.mapPoint,new T);e.z=d;a.graphic.geometry=e;a.emit("graphic-translate",
new ha(a.graphic,e.x-f.x,e.y-f.y))}});this._handles.add([d.watch("grabbing",function(b){a._setSingleManipulatorInteractive(d,b)},!0),d.watch("dragging",function(b){if(!1===b){if(b=a._ringDragData,a._ringDragData=null,a._startSymbolDataPromise=null,a._startSymbolData=null,c.isSome(b)){var d=b.mode;c.isNone(d)||c.isSome(d)&&"scale"===d.type?(d=R(b),a._startScaleResetAnimation(d)):a._updateManipulators();if(c.isSome(a.graphic)&&c.isSome(b.mode))switch(b.mode.type){case "rotate":a.emit("graphic-rotate-stop",
new ia(a.graphic));break;case "scale":a.emit("graphic-scale-stop",new ja(a.graphic))}}}else if(c.isSome(a.graphic)&&c.isSome(a._ringMode)&&"disabled"!==a._ringMode.type)switch(a._ringMode.type){case "rotate":a.emit("graphic-rotate-start",new fa(a.graphic));break;case "scale":a.emit("graphic-scale-start",new ga(a.graphic))}},!0),m.watch(d,"focused",function(){c.isNone(a._scaleAnimationFrameTask)&&a._startRingFocusFrameTask()})]);d.on("drag",function(b){a._handleRingDrag(b.screenPoint)});this.manipulators.add(b);
this.manipulators.add(d);f.forEach(function(b){return a.manipulators.add(b.manipulator)})};b.prototype.onHide=function(){this._removeFrameTasks()};b.prototype._handleArrowDrag=function(a){if(!c.isNone(this.graphic)&&!c.isNone(this.graphic.geometry)&&"point"===this.graphic.geometry.type){var b=this.arrowManipulators[a].manipulator,d=this.graphic.geometry,f=this.graphic.geometry.spatialReference,e=b.mapPoint,e=V.vectorToPoint(y.vec3.set(w.sv3d.get(),e.x,e.y,e.z),e.spatialReference,f),g=y.vec3.subtract(w.sv3d.get(),
b.position,this.discManipulator.position);b.position=this.discManipulator.position;var b=d.longitude,l=e.longitude;null==b||null==l?b=!1:(b=U.cyclicalDeg.shortestSignedDiff(b,l),b=90>Math.abs(b));if(b){b=1/h.getMetersPerUnitForSR(f)*1E-4;if(c.isNone(this._arrowDragData)){if(k(this.view)){if(a=this._calculateArrowManipulatorDirection(a,w.sv3d.get()),G.vector.projectPoint(a,g,g),a=y.vec3.add(g,g,this.discManipulator.position),!this.view.renderCoordsHelper.fromRenderCoords(a,e,f))return}else 0===a||
2===a?e.x=d.x:e.y=d.y;f=K.clonePoint(d,new T);a=e.x-d.x;g=e.y-d.y;if(Math.abs(a)>b||Math.abs(g)>b)a=A.vec3f64.fromValues(a,g,0),y.vec3.normalize(a,a),this._arrowDragData={startPoint:f,dxDyMapConstrained:a}}c.isSome(this._arrowDragData)&&(f=this._arrowDragData,a=f.dxDyMapConstrained,f=f.startPoint,Math.abs(a[0])<b?e.x=f.x:Math.abs(a[1])<b?e.y=f.y:(b=e.x-f.x,g=e.y-f.y,b=G.vector.projectPoint(a,y.vec3.set(w.sv3d.get(),b,g,0),w.sv3d.get()),e.x=f.x+b[0],e.y=f.y+b[1]),f=e.x-d.x,b=e.y-d.y,e.z=d.z,this.graphic.geometry=
e,this.emit("graphic-translate",new ha(this.graphic,f,b)))}}};b.prototype._handleRingDrag=function(a){var b=this,f=this.graphic;if(!c.isNone(f)&&!c.isNone(f.symbol)&&!c.isSome(this._startSymbolDataPromise)){var e=this._ringDragData,g=this._startSymbolData;a=B.screenPointObjectToArray(a,B.castScreenPointArray(w.sv2d.get()));a=G.ray.fromScreen(this.view.state.camera,a,pa);var h=this.discManipulator.modelTransform;if(c.isNone(e)||c.isNone(g))e=A.vec3f64.fromValues(0,0,1),y.vec3.transformMat4(e,e,h),
g=A.vec3f64.clone(this.ringManipulator.position),h=G.plane.fromPositionAndNormal(g,e),e=A.vec3f64.create(),G.plane.intersectRay(h,a,e)&&(this._ringDragData={origin:g,plane:h,angle:0,angleDir:0,scale:1,scaleDir:0,startPoint:e,endPoint:A.vec3f64.clone(e),mode:null},this._startSymbolDataPromise=Z(this.view,f),this._startSymbolDataPromise.then(function(a){b._startSymbolData=a;b._startSymbolDataPromise=null},function(){b._startSymbolDataPromise=null}));else if(h=e.plane,G.plane.intersectRay(h,a,e.endPoint)){a=
R(e);var h=ba.calculateInputRotationTransform(e.startPoint,e.endPoint,e.origin,h),k=U.cyclicalPI.shortestSignedDiff(e.angle,h);e.angleDir=d.clamp(e.angleDir+k,-p.ROTATE_INDICATOR_DIRECTION_BUFFER,p.ROTATE_INDICATOR_DIRECTION_BUFFER);e.angle=h;e.scaleDir=d.clamp(e.scaleDir+(a-e.scale),-p.SCALE_INDICATOR_DIRECTION_BUFFER,p.SCALE_INDICATOR_DIRECTION_BUFFER);e.scale=a;var k=null,l=this._ringMode;if(c.isSome(l))k=l;else if(l=da(e,this.view.state.camera),c.isSome(l)){switch(l){case "rotate":this.emit("graphic-rotate-start",
new fa(f));break;case "scale":this.emit("graphic-scale-start",new ga(f))}k="scale"===l?{type:"scale"}:{type:"rotate",startAngle:h}}e.mode=k;this._updateManipulators();if(c.isSome(k)&&"disabled"!==k.type){var e=f.symbol.clone(),l=this._calculateSymbolRotateAngle(k),m=this._calculateSymbolScaleFactor(k);aa(e,g,l,m);f.symbol=e;switch(k.type){case "rotate":this.emit("graphic-rotate",new ka(f,z.toDegree(h)));break;case "scale":this.emit("graphic-scale",new la(f,a))}}}}};b.prototype._calculateSymbolRotateAngle=
function(a){void 0===a&&(a=this._ringMode);return c.isNone(a)||"rotate"!==a.type||c.isNone(this._ringDragData)?0:this._ringDragData.angle-a.startAngle};b.prototype._calculateSymbolScaleFactor=function(a){void 0===a&&(a=this._ringMode);return c.isNone(a)||"scale"!==a.type||c.isNone(this._ringDragData)?1:this._ringDragData.scale};b.prototype._shouldAllowModeType=function(a){return"scale"===a?this.enableScaling:c.isNone(this.graphic)||!this.enableRotation?!1:this.graphic.symbol.symbolLayers.some(function(a){return"object"===
a.type})};b.prototype._updateManipulators=function(a){if(!a){var b=this._calculateSymbolScaleFactor();a=n.mat4.fromScaling(w.sm4d.get(),y.vec3.set(w.sv3d.get(),b,b,1))}var d=this._manipulatorState,e=this._getManipulatorRotationAngle(),b=n.mat4.identity(w.sm4d.get());0!==e&&n.mat4.rotate(b,b,e,A.vec3f64.fromValues(0,0,1));var f=this.discManipulator.position,e=this.view.renderCoordsHelper.basisMatrixAtPosition(f,w.sm4d.get());a=a?n.mat4.multiply(w.sm4d.get(),e,a):e;var g=c.isSome(this.graphic)&&null!=
this.graphic.geometry,h=k(this.view)?n.mat4.multiply(w.sm4d.get(),a,b):a;this.discManipulator.state=d;this.discManipulator.modelTransform=h;this.discManipulator.visible=g;this.arrowManipulators.forEach(function(a){var b=a.manipulator;a=a.transform;a=n.mat4.multiply(w.sm4d.get(),h,a);b.state=d;b.position=f;b.modelTransform=a;b.visible=g});b=n.mat4.multiply(w.sm4d.get(),a,b);this.ringManipulator.state=d;this.ringManipulator.position=this.discManipulator.position;this.ringManipulator.modelTransform=
b;b=this._ringMode;b=c.isSome(b)&&"disabled"===b.type;this.ringManipulator.visible=g&&!b};b.prototype._setSingleManipulatorInteractive=function(a,b){b?(this.discManipulator.interactive=this.discManipulator===a,this.ringManipulator.interactive=this.ringManipulator===a,this.arrowManipulators.forEach(function(b){b=b.manipulator;b.interactive=b===a})):(this.discManipulator.interactive=!0,this.ringManipulator.interactive=!0,this.arrowManipulators.forEach(function(a){a.manipulator.interactive=!0}))};b.prototype._startRingFocusFrameTask=
function(){var a=this;this._removeFrameTasks();var b=0;this._ringDelayedFocusFrameTask=E.addFrameTask({update:function(c){b+=c.deltaTime;a.ringManipulator.focused?b>p.RING_INDICATOR_DELAY_MS&&(a._ringManipulatorHasDelayedFocused=!0,a._removeFrameTasks(),a._updateManipulators()):(a._ringManipulatorHasDelayedFocused=!1,a._removeFrameTasks(),a._updateManipulators())}})};b.prototype._startScaleResetAnimation=function(a){var b=this;this._removeFrameTasks();var c=a;this._scaleAnimationFrameTask=E.addFrameTask({update:function(a){c+=
((c+1)/2-c)*Math.min(a.deltaTime*p.RING_RESET_ANIMATION_SPEED_FACTOR,1);.01>Math.abs(c-1)?(b._removeFrameTasks(),b._updateManipulators()):(b._ringManipulatorHasDelayedFocused=!1,a=n.mat4.fromScaling(w.sm4d.get(),y.vec3.set(w.sv3d.get(),c,c,1)),b._updateManipulators(a))}})};b.prototype._getManipulatorRotationAngle=function(){var a=c.isSome(this.graphic)?S(this.graphic):0,a=z.toRadian(-a);if(c.isNone(this._ringDragData)||c.isSome(this._ringDragData.mode))return a;var b=this._ringDragData;return a+ba.calculateInputRotationTransform(b.startPoint,
b.endPoint,b.origin,b.plane)};b.prototype._calculateArrowManipulatorTransform=function(a,b){var c=n.mat4.identity(w.sm4d.get());n.mat4.fromZRotation(c,a*Math.PI/2);a=n.mat4.identity(w.sm4d.get());n.mat4.fromTranslation(a,y.vec3.set(w.sv3d.get(),0,p.DISC_TRANSLATE_ARROW_OFFSET,0));return n.mat4.multiply(b,c,a)};b.prototype._calculateArrowManipulatorDirection=function(a,b){var c=this.discManipulator.modelTransform;return 0===a||2===a?y.vec3.set(b,c[4],c[5],c[6]):y.vec3.set(b,c[0],c[1],c[2])};b.prototype._removeFrameTasks=
function(){this.ringManipulator&&(this._ringManipulatorHasDelayedFocused=this.ringManipulator.focused);c.isSome(this._ringDelayedFocusFrameTask)&&(this._ringDelayedFocusFrameTask.remove(),this._ringDelayedFocusFrameTask=null);c.isSome(this._scaleAnimationFrameTask)&&(this._scaleAnimationFrameTask.remove(),this._scaleAnimationFrameTask=null)};f([q.property({constructOnly:!0,nonNullable:!0})],b.prototype,"view",void 0);f([q.property({value:null})],b.prototype,"graphic",null);f([q.property()],b.prototype,
"enableRotation",void 0);f([q.property()],b.prototype,"enableScaling",void 0);f([q.property({readOnly:!0})],b.prototype,"type",void 0);return b=f([q.subclass("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransform3DTool")],b)}(q.declared(a.EventedMixin(Q.InteractiveToolBase)));b.GraphicTransform3DTool=v;var ma=A.vec3f64.create(),na=B.createScreenPointArray(),x;(function(a){a.Unlocked=16;a.ScaleIn=32;a.ScaleOut=64;a.RotateLeft=128;a.RotateRight=256;a.DiscFocused=512;a.DiscUnfocused=
1024;a.RingFocused=2048;a.RingUnfocused=4096;a.ArrowFocused=8192;a.ArrowUnfocused=16384;a.TouchInput=32768})(x||(x={}));var pa=G.ray.create(),oa=K.makeDehydratedPoint(0,0,0,null)})},"esri/views/3d/interactive/editingTools/graphicTransform3D/graphicTransform3DToolConfig":function(){define(["require","exports"],function(v,b){Object.defineProperty(b,"__esModule",{value:!0});b.HANDLE_COLOR=[1,.5,0];b.GEOMETRY_SEGMENTS=128;b.DISC_RADIUS=70;b.DISC_COLLISION_RADIUS=80;b.DISC_HEIGHT=.02;b.DISC_TRANSLATE_ARROW_SIZE=
54;b.DISC_TRANSLATE_ARROW_OFFSET=100;b.RING_RADIUS=160;b.RING_HEIGHT=.5;b.RING_THICKNESS=24;b.INDICATOR_THICKNESS=9;b.INNER_INDICATOR_RADIUS=b.RING_RADIUS+30;b.OUTER_INDICATOR_RADIUS=b.RING_RADIUS+53;b.ROTATE_INDICATOR_ARROW_TIP_LENGTH=60;b.ROTATE_INDICATOR_ARROW_TIP_RADIUS=23;b.ROTATE_INDICATOR_ARC_LENGTH=5*Math.PI/12;b.SCALE_INDICATOR_ARC_LENGTH=1*Math.PI/3;b.DRAG_THRESHOLD_PX=10;b.ROTATE_INDICATOR_ARROW_PLACEMENT_PERCENTAGE=.2;b.SCALE_INDICATOR_OFFSET1=30;b.SCALE_INDICATOR_OFFSET2=53;b.SCALE_INDICATOR_DIRECTION_BUFFER=
.2;b.ROTATE_INDICATOR_DIRECTION_BUFFER=.3;b.RING_INDICATOR_DELAY_MS=200;b.RING_RESET_ANIMATION_SPEED_FACTOR=3;b.ALIGN_ARROWS_SCALE_THRESHOLD=1E6})},"esri/views/3d/interactive/editingTools/graphicTransform3D/isSupportedGraphic":function(){define(["require","exports","../../../../../core/maybe"],function(v,b,f){Object.defineProperty(b,"__esModule",{value:!0});b.isSupportedGraphic=function(b){var r=f.isSome(b.symbol)&&"point-3d"===b.symbol.type&&b.symbol.symbolLayers;return!!r&&0<r.length&&r.some(function(b){return"object"===
b.type})&&f.isSome(b.geometry)&&"point"===b.geometry.type&&"graphics"===b.layer.type}})},"*noref":1}});define(["require","exports","./editingTools/graphicMove3D/GraphicMove3DTool","./editingTools/graphicReshape3D/GraphicReshape3DTool","./editingTools/graphicTransform3D/GraphicTransform3DTool"],function(v,b,f,t,r){Object.defineProperty(b,"__esModule",{value:!0});b.GraphicMove3DTool=f.GraphicMove3DTool;b.GraphicReshape3DTool=t.GraphicReshape3DTool;b.GraphicTransform3DTool=r.GraphicTransform3DTool});