// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(q,l,m){Object.defineProperty(l,"__esModule",{value:!0});q=function(){function d(){this._reference=null}Object.defineProperty(d.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(f){this.reference&&this.reference.hasData&&(f||this.reference.isDirty)&&(this.reference.isDirty=f)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"index",{get:function(){return this._reference&&
this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"reference",{get:function(){return this._reference},set:function(f){this._reference=f},enumerable:!0,configurable:!0});d.prototype.reset=function(f,g,d){var t=f.state;f=f.renderingOptions;var q=d.layerView.tileRenderer,h=this.reference;if(!h||!h.hasData)return!1;g&&(h.isDirty=!0);g=h.transforms.labelMat2d;for(var l=g[4],x=g[5],u=0,y=h.displayObjects;u<y.length;u++)for(var n=y[u],v=q.featuresView.attributeView,
v=d.hasVV()?v.getVVSize(n.id):0,w=0,n=n.metrics;w<n.length;w++){var c=n[w];d.hasVV()&&c.computeOffset(v,d.vvEval);var k=c.bounds.center,a=c.bounds.centerT;h.isDirty&&(c.minZoom=-1);var b=m.vec2.copy(a,c.anchor);t.rotation?m.vec2.transformMat2d(b,b,g):(a[0]=b[0]+l,a[1]=b[1]+x);m.vec2.add(a,b,k);a[0]+=c.offsetX;a[1]+=c.offsetY;var b=t.size,k=b[0],b=b[1],p=c.bounds,e=p.halfHeight,p=p.halfWidth,r=f.edgeLabelsVisible?-1:1;"polyline"!==d.geometryType&&(0>a[0]-p*r||a[0]+p*r>k||0>a[1]-e*r||a[1]+e*r>b)&&(c.minZoom=
255);if(c.boxes)for(a=0,k=c.boxes;a<k.length;a++)b=k[a],e=b.centerT,m.vec2.add(e,c.anchor,b.center),t.rotation?m.vec2.transformMat2d(e,e,g):(e[0]+=l,e[1]+=x)}return!0};return d}();l.default=q});