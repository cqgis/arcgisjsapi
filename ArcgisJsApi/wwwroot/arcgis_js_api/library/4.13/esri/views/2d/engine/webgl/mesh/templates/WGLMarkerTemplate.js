// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(w,z,H,f,E,I,q,F,A,y,J,g,G,K,L){Object.defineProperty(z,
"__esModule",{value:!0});w=function(w){function n(m,a,f,v,k,l,p,r,h,n,B,C,y,D,b,x,t,u){var d=w.call(this)||this;d.height=p;d.width=l;d.xOffset=a;d.yOffset=f;var c=F.vec2f32.create(),e=I.mat2df32.create();B=(D===A.Alignment.MAP?1:0)|(B?1:0)<<1|(y?1:0)<<2|(C?1:0)<<3;C=b&&b.sdf;E.mat2d.translate(e,e,F.vec2f32.fromValues(a,-f));v&&E.mat2d.rotate(e,e,3.14159265359/180*v);m=G.MarkerMaterialKey.load(G.createMaterialKey(d.geometryType,m,!1));m.sdf=C;m.pattern=!0;m.textureBinding=b.textureBinding;d._materialKey=
m.data;d._fillColor=k;d._outlineColor=h;d._sizeOutlineWidth=g.i8888to32(Math.round(Math.sqrt(256*l)),Math.round(Math.sqrt(256*p)),Math.round(Math.sqrt(256*n)),Math.round(Math.sqrt(256*r)));k=b.rect.x;r=b.rect.y;h=k+b.rect.width;n=r+b.rect.height;x=.5-((.5+x)*b.width+1)/b.rect.width;t=.5-((.5+t)*b.height+1)/b.rect.height;m=Math.round(Math.min(64*u,255));l*=b.rect.width/b.width*u;p*=b.rect.height/b.height*u;b=(x-.5)*l;t=(t-.5)*p;d._bitestAndDistRatio=g.i8888to32(0,0,B,m);q.vec2.set(c,b,t);q.vec2.transformMat2d(c,
c,e);d._offsetUpperLeft=g.i1616to32(16*c[0],16*c[1]);d._texUpperLeft=g.i1616to32(k,r);q.vec2.set(c,b+l,t);q.vec2.transformMat2d(c,c,e);d._offsetUpperRight=g.i1616to32(16*c[0],16*c[1]);d._texUpperRight=g.i1616to32(h,r);q.vec2.set(c,b,t+p);q.vec2.transformMat2d(c,c,e);d._offsetBottomLeft=g.i1616to32(16*c[0],16*c[1]);d._texBottomLeft=g.i1616to32(k,n);q.vec2.set(c,b+l,t+p);q.vec2.transformMat2d(c,c,e);d._offsetBottomRight=g.i1616to32(16*c[0],16*c[1]);d._texBottomRight=g.i1616to32(h,n);return d}H(n,w);
n.fromCIMMarker=function(m,a,e){var v=a.size,k=(e&&e.width||1)/(e&&e.height||1)*a.scaleX,l=a.scaleSymbolsProportionally&&a.frameHeight?v/a.frameHeight:1,p=y.premultiplyAlphaRGBA(a.color),r=y.premultiplyAlphaRGBA(a.outlineColor),h=f.pt2px(v),g=h*k,q=f.pt2px(a.offsetX||0),w=f.pt2px(a.offsetY||0),l=f.pt2px(a.outlineWidth||0)*l,z=a.alignment||A.Alignment.SCREEN,D=f.pt2px(a.referenceSize),b=a.rotation||0;a.rotateClockwise||(b=-b);var x=0,t=0,u=a.anchorPoint;u&&(a.isAbsoluteAnchorPoint?v&&(x=-u.x/(v*k),
t=u.y/v):(x=u.x,t=u.y));return new n(m,q,w,b,p,g,h,D,r,l,a.colorLocked,a.scaleSymbolsProportionally,!1,z,e,x,t,a.sizeRatio)};n.fromPictureMarker=function(m,a,e){var g=Math.round(f.pt2px(a.width)),k=Math.round(f.pt2px(a.height)),l=J.PICTURE_FILL_COLOR,p=Math.round(f.pt2px(a.xoffset||0)),r=Math.round(f.pt2px(a.yoffset||0));return new n(m,p,r,a.angle,l,g,k,k,0,0,!1,!1,!1,A.Alignment.SCREEN,e,0,0,1)};n.fromSimpleMarker=function(g,a,e){var m=y.premultiplyAlphaRGBA(a.color),k=Math.round(f.pt2px(a.size)),
l=Math.round(f.pt2px(a.xoffset||0)),p=Math.round(f.pt2px(a.yoffset||0)),r=a.style,h=a.outline,q=(h&&h.color&&y.premultiplyAlphaRGBA(h.color))|0,h=(h&&h.width&&Math.round(f.pt2px(h.width)))|0;return new n(g,l,p,a.angle,m,k,k,k,q,h,!1,!1,"cross"===r||"x"===r,A.Alignment.SCREEN,e,0,0,1.96875)};return n}(K.default(L.default));z.default=w});