// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(k,l,m,p,n,q,r){Object.defineProperty(l,"__esModule",{value:!0});k=function(h){function c(){var a=null!==h&&h.apply(this,arguments)||this;a.defines=[];a._desc={path:"fx/integrate",attributes:{a_position:0}};return a}m(c,h);c.prototype.bind=function(a){};c.prototype.unbind=function(a){};c.prototype.draw=function(a,f){if(f.size){var d=a.context,b=
a.renderingOptions;this._quad||(this._quad=new q(d,[0,0,1,0,0,1,1,1]));var c=d.getBoundFramebufferObject(),e=d.getViewport(),h=e.x,k=e.y,l=e.width,e=e.height;f.bindTextures(d);var g=f.getBlock(n.ATTRIBUTE_DATA_ANIMATION);if(!p.isNone(g)){var m=g.getFBO(d),g=g.getFBO(d,1);d.setViewport(0,0,f.size,f.size);this._computeDelta(a,g,b.labelsAnimationTime);this._updateAnimationState(a,g,m);d.bindFramebuffer(c);d.setViewport(h,k,l,e)}}};c.prototype._computeDelta=function(a,c,d){var b=a.context,f=a.displayLevel,
e=a.painter.materialManager.getProgram(a,this._desc,["delta"]);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(e);e.setUniform1i("u_maskTexture",n.TEXTURE_BINDING_ATTRIBUTE_DATA_0);e.setUniform1i("u_sourceTexture",n.TEXTURE_BINDING_ATTRIBUTE_DATA_1);e.setUniform1f("u_timeDelta",a.timeDelta);e.setUniform1f("u_animationTime",d/1E3);e.setUniform1f("u_zoomLevel",Math.round(10*f));this._quad.draw()};c.prototype._updateAnimationState=function(a,c,d){var b=a.context;
a=a.painter.materialManager.getProgram(a,this._desc,["update"]);b.bindTexture(c.colorTexture,1);b.bindProgram(a);a.setUniform1i("u_sourceTexture",1);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);this._quad.draw()};return c}(r.Effect);l.AnimationEffect=k});