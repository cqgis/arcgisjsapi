// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/layers/features/tileRenderers/BaseTileRenderer":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators".split(" "),function(m,f,c,g,v,h){Object.defineProperty(f,"__esModule",{value:!0});m=function(f){function a(a){a=f.call(this,a)||this;a.tiles=new Map;return a}c(a,f);a.prototype.destroy=function(){this.tiles.clear();
this.layer=this.layerView=this.tileInfoView=this.tiles=null};Object.defineProperty(a.prototype,"updating",{get:function(){return this.isUpdating()},enumerable:!0,configurable:!0});a.prototype.acquireTile=function(a){var c=this,p=this.createTile(a);p.once("isReady",function(){return c.notifyChange("updating")});this.tiles.set(a.id,p);return p};a.prototype.lockAttributeTextureUpload=function(){};a.prototype.unlockAttributeTextureUpload=function(){};a.prototype.forceAttributeTextureUpload=function(){};
a.prototype.forEachTile=function(a){this.tiles.forEach(a)};a.prototype.releaseTile=function(a){this.tiles.delete(a.key.id);this.disposeTile(a)};a.prototype.isUpdating=function(){var a=!0;this.tiles.forEach(function(c){a=a&&c.isReady});return!a};a.prototype.setHighlight=function(a,c){};a.prototype.invalidateLabels=function(){};a.prototype.requestUpdate=function(){this.layerView.requestUpdate()};g([h.property()],a.prototype,"layer",void 0);g([h.property()],a.prototype,"layerView",void 0);g([h.property()],
a.prototype,"tileInfoView",void 0);g([h.property()],a.prototype,"updating",null);return a=g([h.subclass("esri.views.2d.layers.features.tileRenderers.BaseTileRenderer")],a)}(h.declared(v.HandleOwner));f.default=m})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define(["require","exports","../../../../../../core/screenUtils","../../../../engine","../../../../../3d/layers/support/FastSymbolUpdates"],function(m,f,c,g,v){function h(a){return{value:a.value,size:c.toPt(a.size)}}
function n(a){return a.map(function(a){return h(a)})}function a(a){return"string"===typeof a||"number"===typeof a?c.toPt(a):{type:"size",expression:a.expression,stops:n(a.stops)}}function u(a){var c={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(g.Utils.isString(a.field))if(a.stops){if(8<a.stops.length)return null;var b=a.stops;for(a=0;8>a;++a){var t=b[Math.min(a,b.length-1)];c.values[a]=t.value;c.opacities[a]=t.opacity}}else return null;else if(a.stops&&0<=a.stops.length)for(b=a.stops&&
0<=a.stops.length&&a.stops[0].opacity,a=0;8>a;a++)c.values[a]=Infinity,c.opacities[a]=b;else return null;return c}Object.defineProperty(f,"__esModule",{value:!0});var r=g.enums.WGLVVFlag;f.getVisualVariableSizeValueRepresentationRatio=function(a,c){if(!a||!c)return a;switch(c){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};f.stopToSizeStop=h;f.normalizeSizeStops=n;f.normalizeSizeElement=a;f.getVisualVariablesFields=function(a){var c=a&&0<a.length?{}:null;c&&a.forEach(function(a){var b=
a.type;a.field&&(c[b]=a.field)});return c};f.convertVisualVariables=function(f){var h=f&&0<f.length?{}:null,b=h?{}:null;if(!h)return{vvFields:h,vvRanges:b};for(var t=0;t<f.length;t++){var q=f[t],k=q.type;q.field&&(h[k]=q.field);if("size"===k){b.size||(b.size={});var l=q;switch(g.getTypeOfSizeVisualVariable(l)){case r.SIZE_MINMAX_VALUE:b.size.minMaxValue={minDataValue:l.minDataValue,maxDataValue:l.maxDataValue,minSize:a(l.minSize),maxSize:a(l.maxSize)};break;case r.SIZE_SCALE_STOPS:b.size.scaleStops=
{stops:n(l.stops)};break;case r.SIZE_FIELD_STOPS:for(var q=[],k=[],l=n(l.stops),x=l.length,p=0;6>p;p++){var m=l[Math.min(p,x-1)];q.push(m.value);k.push(c.pt2px(m.size))}b.size.fieldStops={values:q,sizes:k};break;case r.SIZE_UNIT_VALUE:b.size.unitValue={unit:l.valueUnit,valueRepresentation:l.valueRepresentation}}}else if("color"===k)for(q=v.convertVisualVariables([q],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}),b.color=q.color,p=0;32>p;p+=4)g.color.premultiplyAlpha(b.color.colors,
p,!0);else"opacity"===k?b.opacity=u(q):"rotation"===k&&(b.rotation={type:q.rotationType})}return{vvFields:h,vvRanges:b}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(m,f,c,g,v,h,n,a,u,r,p,y){function b(e){return null!==e&&void 0!==e}function t(e){return"number"===typeof e}function q(e){return"string"===typeof e}function k(e,d){e&&e.push(d)}function l(e,d,a,I,c){var w=e.minSize,l=e.maxSize;if(e.expression)return k(c,"Could not convert size info: expression not supported"),!1;if(e.useSymbolValue)return e=I.symbolSize[a],d.minSize[a]=e,d.maxSize[a]=e,d.offset[a]=d.minSize[a],d.factor[a]=0,d.type[a]=1,!0;if(b(e.field)){if(b(e.stops)){if(2===e.stops.length&&
t(e.stops[0].size)&&t(e.stops[1].size))return x(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,d,a),d.type[a]=1,!0;k(c,"Could not convert size info: stops only supported with 2 elements");return!1}if(t(w)&&t(l)&&b(e.minDataValue)&&b(e.maxDataValue))return x(w,l,e.minDataValue,e.maxDataValue,d,a),d.type[a]=1,!0;if(null!=p.meterIn[e.valueUnit])return d.minSize[a]=-Infinity,d.maxSize[a]=Infinity,d.offset[a]=0,d.factor[a]=1/p.meterIn[e.valueUnit],d.type[a]=1,!0;if("unknown"===e.valueUnit)return k(c,
"Could not convert size info: proportional size not supported"),!1;k(c,"Could not convert size info: scale-dependent size not supported");return!1}if(!b(e.field)){if(e.stops&&e.stops[0]&&t(e.stops[0].size))return d.minSize[a]=e.stops[0].size,d.maxSize[a]=e.stops[0].size,d.offset[a]=d.minSize[a],d.factor[a]=0,d.type[a]=1,!0;if(t(w))return d.minSize[a]=w,d.maxSize[a]=w,d.offset[a]=w,d.factor[a]=0,d.type[a]=1,!0}k(c,"Could not convert size info: unsupported variant of sizeInfo");return!1}function x(e,
a,w,b,c,l){b=0<Math.abs(b-w)?(a-e)/(b-w):0;c.minSize[l]=0<b?e:a;c.maxSize[l]=0<b?a:e;c.offset[l]=e-w*b;c.factor[l]=b}function G(e,a,b,c){if(e.normalizationField||e.valueRepresentation)return k(c,"Could not convert size info: unsupported property"),null;var d=e.field;if(null!=d&&!q(d))return k(c,"Could not convert size info: field is not a string"),null;if(!a.size)a.size={field:e.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(e.field)if(!a.size.field)a.size.field=
e.field;else if(e.field!==a.size.field)return k(c,"Could not convert size info: multiple fields in use"),null;switch(e.axis){case "width":return(d=l(e,a.size,0,b,c))?a:null;case "height":return(d=l(e,a.size,2,b,c))?a:null;case "depth":return(d=l(e,a.size,1,b,c))?a:null;case "width-and-depth":return(d=l(e,a.size,0,b,c))&&l(e,a.size,1,b,c),d?a:null;case null:case void 0:case "all":return(d=(d=(d=l(e,a.size,0,b,c))&&l(e,a.size,1,b,c))&&l(e,a.size,2,b,c))?a:null;default:return k(c,'Could not convert size info: unknown axis "'+
e.axis+'""'),null}}function H(e,a,b){for(var d=0;3>d;++d){var c=a.unitInMeters;1===e.type[d]&&(c*=a.modelSize[d],e.type[d]=2);e.minSize[d]/=c;e.maxSize[d]/=c;e.offset[d]/=c;e.factor[d]/=c}if(0!==e.type[0])a=0;else if(0!==e.type[1])a=1;else if(0!==e.type[2])a=2;else return k(b,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===e.type[d]&&(e.minSize[d]=e.minSize[a],e.maxSize[d]=e.maxSize[a],e.offset[d]=e.offset[a],e.factor[d]=e.factor[a],e.type[d]=e.type[a]);return!0}function F(e,
a,b){e[4*a+0]=b.r/255;e[4*a+1]=b.g/255;e[4*a+2]=b.b/255;e[4*a+3]=b.a}function J(a,d,b){if(a.normalizationField)return k(b,"Could not convert color info: unsupported property"),null;if(q(a.field))if(a.stops){if(8<a.stops.length)return k(b,"Could not convert color info: too many color stops"),null;d.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};b=a.stops;for(a=0;8>a;++a){var e=b[Math.min(a,b.length-1)];d.color.values[a]=e.value;
F(d.color.colors,a,e.color)}}else return k(b,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(b=a.stops&&0<=a.stops.length&&a.stops[0].color,d.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)d.color.values[a]=Infinity,F(d.color.colors,a,b);else return k(b,"Could not convert color info: no field and no colors/stops"),null;return d}function K(a,d,b){if(a.normalizationField)return k(b,
"Could not convert opacity info: unsupported property"),null;if(q(a.field))if(a.stops){if(8<a.stops.length)return k(b,"Could not convert opacity info: too many opacity stops"),null;d.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};b=a.stops;for(a=0;8>a;++a){var e=b[Math.min(a,b.length-1)];d.opacity.values[a]=e.value;d.opacity.opacityValues[a]=e.opacity}}else return k(b,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(b=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,d.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)d.opacity.values[a]=Infinity,d.opacity.opacityValues[a]=b;else return k(b,"Could not convert opacity info: no field and no opacities/stops"),null;return d}function C(a,d,b,c){a=2===b&&"arithmetic"===a.rotationType;d.offset[b]=a?90:0;d.factor[b]=a?-1:1;d.type[b]=1}function L(a,d,b){if(!q(a.field))return k(b,"Could not convert rotation info: field is not a string"),
null;if(!d.rotation)d.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!d.rotation.field)d.rotation.field=a.field;else if(a.field!==d.rotation.field)return k(b,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return C(a,d.rotation,0,b),d;case "roll":return C(a,d.rotation,1,b),d;case null:case void 0:case "heading":return C(a,d.rotation,2,b),d;default:return k(b,'Could not convert rotation info: unknown axis "'+a.axis+
'""'),null}}function D(a,d,b){if(!a)return null;var e=!d.supportedTypes||!!d.supportedTypes.size,l=!d.supportedTypes||!!d.supportedTypes.color,f=!d.supportedTypes||!!d.supportedTypes.rotation,h=!!d.supportedTypes&&!!d.supportedTypes.opacity,g=a.reduce(function(a,g){if(!a)return a;if(g.valueExpression)return k(b,"Could not convert visual variables: arcade expressions not supported"),null;switch(g.type){case "size":return e?G(g,a,d,b):a;case "color":return l?J(g,a,b):a;case "opacity":return h?K(g,a,
b):null;case "rotation":return f?L(g,a,b):a;default:return c.neverReached(g),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&g&&!g.size&&!g.color&&!g.opacity&&!g.rotation||g&&g.size&&!H(g.size,d,b)?null:g}function A(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function E(b,d){var e={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,
vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},c=b&&null!=b.size;b&&b.size?(e.vvSizeEnabled=!0,e.vvSizeMinSize=b.size.minSize,e.vvSizeMaxSize=b.size.maxSize,e.vvSizeOffset=b.size.offset,e.vvSizeFactor=b.size.factor):b&&c&&(e.vvSizeValue=d.transformation.scale);if(b&&c){e.vvSymbolAnchor=d.transformation.anchor;e.vvSymbolRotationMatrix=
h.mat3f64.create();n.mat4.identity(z);var l=d.transformation.rotation[2],c=d.transformation.rotation[0],g=d.transformation.rotation[1];d=z;void 0===d&&(d=a.mat4f64.create());l=l||0;c=c||0;g=g||0;0!==l&&n.mat4.rotateZ(d,d,-l/180*Math.PI);0!==c&&n.mat4.rotateX(d,d,c/180*Math.PI);0!==g&&n.mat4.rotateY(d,d,g/180*Math.PI);v.mat3.fromMat4(e.vvSymbolRotationMatrix,z)}b&&b.color&&(e.vvColorEnabled=!0,e.vvColorValues=b.color.values,e.vvColorColors=b.color.colors);b&&b.opacity&&(e.vvOpacityEnabled=!0,e.vvOpacityValues=
b.opacity.values,e.vvOpacityOpacities=b.opacity.opacityValues);return e}Object.defineProperty(f,"__esModule",{value:!0});f.convertVisualVariables=D;f.initFastSymbolUpdatesState=function(a,b){return!a||y.DISABLE_FAST_UPDATES?{enabled:!1}:(a=D(a.visualVariables,b))?{enabled:!0,visualVariables:a,materialParameters:E(a,b),requiresShaderTransformation:a&&null!=a.size}:{enabled:!1}};f.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;b=D(b.visualVariables,c);
if(!(b&&A(d.size,b.size,"size")&&A(d.color,b.color,"color")&&A(d.rotation,b.rotation,"rotation")&&A(d.opacity,b.opacity,"opacity")))return!1;a.visualVariables=b;a.materialParameters=E(b,c);a.requiresShaderTransformation=b&&null!=b.size;return!0};f.getMaterialParams=E;var B;(function(b){var d=a.mat4f64.create(),c=r.vec3f64.create();b.evaluateModelTransform=function(a,b,e){if(!a.vvSizeEnabled)return e;n.mat4.copy(d,e);e=a.vvSymbolRotationMatrix;n.mat4.set(z,e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],
e[8],0,0,0,0,1);n.mat4.multiply(d,d,z);for(e=0;3>e;++e)c[e]=g.clamp(a.vvSizeOffset[e]+b[0]*a.vvSizeFactor[e],a.vvSizeMinSize[e],a.vvSizeMaxSize[e]);n.mat4.scale(d,d,c);n.mat4.translate(d,d,a.vvSymbolAnchor);return d};b.evaluateModelTransformScale=function(a,b,e){if(!b.vvSizeEnabled)return u.vec3.set(a,1,1,1);for(var d=0;3>d;++d)a[d]=g.clamp(b.vvSizeOffset[d]+e[0]*b.vvSizeFactor[d],b.vvSizeMinSize[d],b.vvSizeMaxSize[d]);return a}})(B||(B={}));var z=a.mat4f64.create();f.evaluateModelTransform=B.evaluateModelTransform;
f.evaluateModelTransformScale=B.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(m,f,c){Object.defineProperty(f,"__esModule",{value:!0});f.mat3f64=c})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(m,f){Object.defineProperty(f,"__esModule",{value:!0});f.create=function(){return[1,0,0,0,1,0,0,0,1]};f.clone=function(c){return[c[0],c[1],c[2],c[3],c[4],c[5],c[6],
c[7],c[8]]};f.fromValues=function(c,g,f,h,n,a,u,m,p){return[c,g,f,h,n,a,u,m,p]};f.createView=function(c,g){return new Float64Array(c,g,9)}})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(m,f,c){Object.defineProperty(f,"__esModule",{value:!0});f.mat4f64=c})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(m,f){Object.defineProperty(f,"__esModule",{value:!0});f.create=function(){return[1,0,
0,0,0,1,0,0,0,0,1,0,0,0,0,1]};f.clone=function(c){return[c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15]]};f.fromValues=function(c,g,f,h,n,a,u,m,p,y,b,t,q,k,l,x){return[c,g,f,h,n,a,u,m,p,y,b,t,q,k,l,x]};f.createView=function(c,g){return new Float64Array(c,g,16)}})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(m,f,c,g,v,h){return new (function(f){function a(){var a=null!==f&&f.apply(this,arguments)||this;a.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;a.SCENEVIEW_LOCKING_LOG=!1;a.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;a.HIGHLIGHTS_VISUALIZE_BLOCKS=!1;a.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;a.DECONFLICTOR_SHOW_OUTLINES=!1;a.DECONFLICTOR_SHOW_GRID=!1;a.LABELS_SHOW_BORDER=!1;a.OVERLAY_DRAW_TEST_TEXTURE=!1;a.OVERLAY_SHOW_CENTER=!1;a.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;a.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=
!1;a.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1;a.DRAW_MESH_GEOMETRY_NORMALS=!1;a.FEATURE_TILE_FETCH_SHOW_TILES=!1;a.FEATURE_TILE_TREE_SHOW_TILES=!1;a.TERRAIN_TILE_TREE_SHOW_TILES=!1;a.I3S_TREE_SHOW_TILES=!1;a.ENABLE_PROFILE_DEPTH_RANGE=!1;a.DISABLE_FAST_UPDATES=!1;a.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;a.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;a.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return a}c(a,f);g([h.property()],a.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);g([h.property()],
a.prototype,"SCENEVIEW_LOCKING_LOG",void 0);g([h.property()],a.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);g([h.property()],a.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0);g([h.property()],a.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);g([h.property()],a.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0);g([h.property()],a.prototype,"DECONFLICTOR_SHOW_GRID",void 0);g([h.property()],a.prototype,"LABELS_SHOW_BORDER",void 0);g([h.property()],a.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0);
g([h.property()],a.prototype,"OVERLAY_SHOW_CENTER",void 0);g([h.property()],a.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);g([h.property()],a.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);g([h.property()],a.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);g([h.property()],a.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0);g([h.property()],a.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);g([h.property()],a.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0);g([h.property()],
a.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0);g([h.property()],a.prototype,"I3S_TREE_SHOW_TILES",void 0);g([h.property()],a.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);g([h.property()],a.prototype,"DISABLE_FAST_UPDATES",void 0);g([h.property()],a.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0);g([h.property()],a.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);g([h.property()],a.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return a=g([h.subclass("esri.views.3d.support.DebugFlags")],
a)}(h.declared(v)))})},"esri/views/2d/layers/features/tileRenderers/support/WGLFeatureView":function(){define("require exports ../../../../../../core/tsSupport/assignHelper ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/promiseUtils ../../../../engine ../../../../engine/FeatureContainer ../../../../engine/webgl/enums".split(" "),function(m,f,c,g,v,h,n,a,u,r){Object.defineProperty(f,
"__esModule",{value:!0});m=function(c){function f(a,g,f){a=c.call(this,a,g.clips)||this;a._pointToCallbacks=new Map;a._layer=f;a._layerView=g;return a}g(f,c);f.prototype.renderChildren=function(a){this.hasAnimation&&a.painter.effects.integrate.draw(a,a.attributeView);c.prototype.renderChildren.call(this,a)};f.prototype.hitTest=function(a,c){a=[a,c];c=n.createResolver();this._pointToCallbacks.set(a,c);this.requestRender();return c.promise};f.prototype.doRender=function(a){var b=this._layer,g=b.maxScale,
f=a.state.scale;f<=(b.minScale||Infinity)&&f>=g&&c.prototype.doRender.call(this,a)};Object.defineProperty(f.prototype,"hasAnimation",{get:function(){return this.hasLabels},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"hasLabels",{get:function(){return!(!this._layer.labelingInfo||!this._layer.labelingInfo.length)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"labelsVisible",{get:function(){return this._layer.labelsVisible},enumerable:!0,configurable:!0});f.prototype.prepareRenderPasses=
function(b){var g=this,f=b.registerRenderPass({name:"label",brushes:[a.brushes.Label],target:function(){return g.children},drawPhase:r.WGLDrawPhase.LABEL|r.WGLDrawPhase.LABEL_ALPHA}),k=b.registerRenderPass({name:"geometry",brushes:[a.brushes.Fill,a.brushes.Line,a.brushes.Marker,a.brushes.Text],target:function(){return g.children},effects:[{apply:b.effects.highlight,enable:function(){return!!g._layerView.hasHighlight()}},{apply:b.effects.hittest,enable:function(){return!!g._pointToCallbacks.size},
args:function(){return g._pointToCallbacks}}]});return c.prototype.prepareRenderPasses.call(this,b).concat([k,f])};return f}(u.FeatureContainer);f.WGLFeatureView=m})},"esri/views/2d/engine/FeatureContainer":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/promiseUtils ../../../core/promiseUtils ../../../geometry/support/aaBoundingRect ../engine".split(" "),
function(m,f,c,g,v,h,n,a,u,r){Object.defineProperty(f,"__esModule",{value:!0});m=function(f){function m(a,c){a=f.call(this,a,c)||this;a._rendererInfo=new r.WGLRendererInfo;a.attributeView=new r.AttributeStoreView;return a}v(m,f);m.prototype.destroy=function(){this.removeAllChildren();this.children.forEach(function(a){return a.destroy()});this.attributeView.destroy()};m.prototype.whenAttached=function(){var a=this;return this.attached?n.resolve():n.create(function(b){return a.once("attached",function(){return b()})})};
m.prototype.setRendererInfo=function(a,c,f){this._rendererInfo.setInfo(a,c,f);this.requestRender()};m.prototype.getMaterialItems=function(b,f){return g(this,void 0,void 0,function(){var g,k,l,h;return c(this,function(c){switch(c.label){case 0:return b&&0!==b.length?[4,this.whenAttached()]:[2,null];case 1:return c.sent(),g=this.stage.painter.textureManager,k=b.map(function(a){return g.rasterizeItem(a.symbol,a.glyphIds,f)}),[4,a.all(k)];case 2:return l=c.sent(),h=l.map(function(a,c){return{id:b[c].id,
mosaicItem:a}}),[2,h]}})})};m.prototype.onTileData=function(a,c){if(!(c.addOrUpdate&&"tileDisplayData"in c.addOrUpdate)){var b=c.addOrUpdate&&r.TileData.decode(c.addOrUpdate);c=h({},c,{addOrUpdate:b})}a.setData(c,this.hasLabels,this.labelsVisible);this.contains(a)||this.addChild(a);this.requestRender()};m.prototype.onTileError=function(a){a.clear();this.contains(a)||this.addChild(a)};m.prototype.renderChildren=function(a){this._rendererInfo.update(a.state);this.attributeView.bindTextures(this.stage.context);
f.prototype.renderChildren.call(this,a)};m.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(u.create(),a);return new r.WGLTile(a,b)};m.prototype.destroyTile=function(a){this.removeChild(a);a.destroy()};m.prototype.attach=function(){this._initializeExtensions();return f.prototype.attach.call(this)};m.prototype.createRenderParams=function(a){return h({},f.prototype.createRenderParams.call(this,a),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})};m.prototype._initializeExtensions=
function(){var a=this.stage.context.capabilities;a.textureFloat;a.vao};return m}(r.TileContainer);f.FeatureContainer=m})},"*noref":1}});
define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/accessorSupport/decorators ../../../../../geometry/support/aaBoundingRect ../../../engine ../support/rendererUtils ./BaseTileRenderer ./support/visualVariablesUtils ./support/WGLFeatureView".split(" "),function(m,f,c,g,v,h,n,a,u,
r,p,y,b,t){Object.defineProperty(f,"__esModule",{value:!0});m=function(f){function k(){return null!==f&&f.apply(this,arguments)||this}c(k,f);k.prototype.install=function(a){var b=new t.WGLFeatureView(this.tileInfoView,this.layerView,this.layer);this.featuresView=b;a.addChild(b)};k.prototype.uninstall=function(a){a.removeChild(this.featuresView);this.featuresView.destroy()};k.prototype.hitTest=function(a,b){return this.featuresView.hitTest(a,b)};k.prototype.supportsRenderer=function(a){return null!=
a&&-1!==["simple","class-breaks","unique-value","dot-density","dictionary"].indexOf(a.type)};k.prototype.onConfigUpdate=function(){var a=null;"visualVariables"in this.layer.renderer&&(a=(p.simplifyVVRenderer(this.layer.renderer).visualVariables||[]).map(function(a){var b=a.clone();"normalizationField"in a&&(b.normalizationField=null);a.valueExpression&&"$view.scale"!==a.valueExpression&&(b.valueExpression=null,b.field="nop");return b}),a=b.convertVisualVariables(a));this.featuresView.setRendererInfo(this.layer.renderer,
a,this.layerView.effects);this.featuresView.setClips(this.layerView.clips)};k.prototype.onTileData=function(a){var b=this.tiles.get(a.tileKey);if(b)this.featuresView.onTileData(b,a.data);this.layerView.view.labelManager.requestUpdate()};k.prototype.onTileError=function(a){if(a=this.tiles.get(a.tileKey))this.featuresView.onTileError(a)};k.prototype.forceAttributeTextureUpload=function(){this.featuresView.attributeView.forceTextureUpload()};k.prototype.lockAttributeTextureUpload=function(){this.featuresView.attributeView.lockTextureUpload()};
k.prototype.unlockAttributeTextureUpload=function(){this.featuresView.attributeView.unlockTextureUpload()};k.prototype.getMaterialItems=function(a){return n(this,void 0,void 0,function(){return h(this,function(b){return[2,this.featuresView.getMaterialItems(a)]})})};k.prototype.invalidateLabels=function(){this.layer.labelingInfo&&this.layer.labelsVisible&&(this.tiles.forEach(function(a){return a.isDirty=!0}),this.layerView.view.labelManager.requestUpdate())};k.prototype.createTile=function(a){var b=
this.tileInfoView.getTileBounds(u.create(),a);a=new r.WGLTile(a,b);this.layer.labelingInfo&&this.layerView.view.labelManager.addTile(this.layerView,a);return a};k.prototype.disposeTile=function(a){this.featuresView.removeChild(a);this.layer.labelingInfo&&this.layerView.view.labelManager.removeTile(this.layerView,a.key.id);a.destroy();this.layerView.view.labelManager.requestUpdate()};return k=g([a.subclass("esri.views.2d.layers.features.tileRenderers.SymbolTileRenderer")],k)}(a.declared(y.default));
f.default=m});