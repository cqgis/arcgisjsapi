// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),function(m,n,p,q,r,t){Object.defineProperty(n,"__esModule",{value:!0});m=function(){function l(a,c){this.brushes=a;this.name=c.name;this.drawPhase=c.drawPhase||t.WGLDrawPhase.MAP;this._targetFn=c.target;this.effects=c.effects||[];this.has=c.has}l.prototype.render=function(a){var c=a.context,e=a.profiler,g=this._targetFn(),d=this.drawPhase&a.drawPhase;e.recordPassStart(this.name);
if(d&&(!this.has||q(this.has))){this._doRender(a,g);e.recordPassEnd(this.name);for(var d=0,h=this.effects;d<h.length;d++){var f=h[d];if(f.enable()){var b=f.apply;e.recordPassStart(this.name+"."+b.name);e.recordBrushStart(b.name);var f=f.args&&f.args(),k=c.getViewport(),l=k.x,m=k.y,n=k.width,k=k.height,p=c.getBoundFramebufferObject();b.bind(a,f);this._doRender(a,g,b.defines);b.draw(a,f);b.unbind(a,f);c.bindFramebuffer(p);c.setViewport(l,m,n,k);e.recordBrushEnd(b.name);e.recordPassEnd(this.name+"."+
b.name)}}}};l.prototype._doRender=function(a,c,e){if(!r.isNone(c))if(p.isArrayLike(c))for(var g=0;g<c.length;g++){var d=c[g];if(d.isReady)for(var h=0,f=this.brushes;h<f.length;h++){var b=f[h];a.profiler.recordBrushStart(b.name);b.prepareState(a,d,e);b.draw(a,d,e);a.profiler.recordBrushEnd(b.name)}}else for(g=0,d=this.brushes;g<d.length;g++)b=d[g],a.profiler.recordBrushStart(b.name),b.prepareState(a,c,e),b.draw(a,c,e),a.profiler.recordBrushEnd(b.name)};return l}();n.default=m});