// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/assignHelper ../../request ../../core/Logger ../../core/promiseUtils".split(" "),function(w,b,c,h,l,m,n,p){function q(a,d){return c(this,void 0,void 0,function(){var b,f;return h(this,function(e){switch(e.label){case 0:if(a.data||!a.styleUrl||!a.styleName)return[2,a];b=a.styleName;f=a;return[4,t(b,a.styleUrl,d)];case 1:return f.data=e.sent(),[2,a]}})})}function t(a,d,r){return c(this,
void 0,void 0,function(){var f,e;return h(this,function(c){if(g.has(a))return[2,g.get(a).then(function(a){return b.makeSymbolRef(a.data)})];try{return f=d+"/resources/styles/cim/"+a+".json",e=m(f,l({responseType:"json",query:{f:"json"}},r)),g.set(a,e),[2,e.then(function(a){return b.makeSymbolRef(a.data)})]}catch(u){return v.error("error requesting "+a+", reason is "+u.message),g.has(a)&&g.delete(a),[2,null]}})})}var k=this;Object.defineProperty(b,"__esModule",{value:!0});var v=n.getLogger("esri/symbols/support/cimSymbolUtils");
b.expandSymbols=function(a,d){return c(k,void 0,void 0,function(){return h(this,function(c){return[2,p.all(a.map(function(a){return b.expandSymbol(a,d)}))]})})};b.expandSymbol=function(a,b){return c(k,void 0,void 0,function(){return h(this,function(d){return a?"cim"===a.type?[2,q(a,b)]:"web-style"===a.type?[2,a.fetchCIMSymbol(b)]:[2,a]:[2,null]})})};b.makeSymbolRef=function(a,b){return null===a?null:"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a,primitiveOverrides:b}};var g=new Map});