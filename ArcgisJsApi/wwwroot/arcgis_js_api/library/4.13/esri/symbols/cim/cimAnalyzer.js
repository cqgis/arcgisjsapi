// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../Color ../../core/Logger ../../core/promiseUtils ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ./utils ../../views/2d/arcade/utils".split(" "),function(Ba,M,x,y,ga,ha,ia,ja,U,D,B,da,E,V){function F(a){return a?{r:a[0],g:a[1],b:a[2],a:a[3]/255}:{r:0,g:0,b:0,a:0}}function N(a){switch(a){case "Butt":return B.CapType.BUTT;case "Square":return B.CapType.SQUARE;
default:return B.CapType.ROUND}}function O(a){switch(a){case "Bevel":return B.JoinType.BEVEL;case "Miter":return B.JoinType.MITER;default:return B.JoinType.ROUND}}function ka(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function la(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function ma(a){var c="normal",b="normal";a&&(a=a.toLowerCase(),-1!==
a.indexOf("italic")?c="italic":-1!==a.indexOf("oblique")&&(c="oblique"),-1!==a.indexOf("bold")?b="bold":-1!==a.indexOf("light")&&(b="lighter"));return{style:c,weight:b}}function na(a,c,b,m,l,h){return y(this,void 0,void 0,function(){var d,k,n,g,f,e,w;return x(this,function(u){switch(u.label){case 0:if(!a)return[2];d=a.symbolLayers;if(!d)return[2];n=D.CIMSymbolHelper.getSize(a);"CIMPointSymbol"===a.type&&"Map"===a.angleAlignment&&(k=B.Alignment.MAP);g=d.length;u.label=1;case 1:if(!g--)return[3,23];
f=d[g];if(!f||!1===f.enable)return[3,1];e=[];D.OverrideHelper.findApplicableOverrides(f,c,e);w=f.type;switch(w){case "CIMSolidFill":return[3,2];case "CIMPictureFill":return[3,4];case "CIMHatchFill":return[3,6];case "CIMGradientFill":return[3,8];case "CIMSolidStroke":return[3,10];case "CIMPictureStroke":return[3,12];case "CIMGradientStroke":return[3,14];case "CIMCharacterMarker":return[3,16];case "CIMPictureMarker":return[3,17];case "CIMVectorMarker":return[3,19]}return[3,21];case 2:return[4,oa(f,
e,m,l)];case 3:return u.sent(),[3,22];case 4:return[4,pa(f,e,m,l)];case 5:return u.sent(),[3,22];case 6:return[4,qa(f,e,m,l)];case 7:return u.sent(),[3,22];case 8:return[4,ra(f,e,m,l)];case 9:return u.sent(),[3,22];case 10:return[4,sa(f,e,m,l,"CIMPolygonSymbol"===a.type,n)];case 11:return u.sent(),[3,22];case 12:return[4,ta(f,e,m,l,"CIMPolygonSymbol"===a.type,n)];case 13:return u.sent(),[3,22];case 14:return[4,ua(f,e,m,l,"CIMPolygonSymbol"===a.type,n)];case 15:return u.sent(),[3,22];case 16:return[3,
22];case 17:return[4,va(f,e,m,l,k,n)];case 18:return u.sent(),[3,22];case 19:return[4,wa(f,e,b,m,l,k,n,h)];case 20:return u.sent(),[3,22];case 21:xa.error("Cannot analyze CIM layer",f.type),u.label=22;case 22:return[3,1];case 23:return[2]}})})}function oa(a,c,b,m){return y(this,void 0,void 0,function(){var l,h,d,k,n,g;return x(this,function(f){switch(f.label){case 0:return l=a.primitiveName,h=F(a.color),d=E.hashString(JSON.stringify(a)).toString(),n=(k=m).push,g={type:"fill",templateHash:d,materialHash:0===
c.length?d:function(a,b,c){return d},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,q(l,"Color",c,b,h,G)];case 1:return n.apply(k,[(g.color=f.sent(),g.height=0,g.angle=0,g.offsetX=0,g.offsetY=0,g.scaleX=1,g)]),[2]}})})}function pa(a,c,b,m){return y(this,void 0,void 0,function(){var l,h,d,k,n,g,f;return x(this,function(e){switch(e.label){case 0:return l=a.primitiveName,h=F(a.tintColor),d=E.hashString(JSON.stringify(a)).toString(),k=E.hashString(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),
g=(n=m).push,f={type:"fill",templateHash:d,materialHash:0===c.length?k:function(a,b,c){return k},cim:a,materialOverrides:null,colorLocked:a.colorLocked},[4,q(l,"TintColor",c,b,h,G)];case 1:return f.color=e.sent(),[4,q(l,"Height",c,b,a.height)];case 2:return f.height=e.sent(),[4,q(l,"ScaleX",c,b,a.scaleX)];case 3:return f.scaleX=e.sent(),[4,q(l,"Rotation",c,b,a.rotation)];case 4:return f.angle=e.sent(),[4,q(l,"OffsetX",c,b,a.offsetX)];case 5:return f.offsetX=e.sent(),[4,q(l,"OffsetY",c,b,a.offsetY)];
case 6:return g.apply(n,[(f.offsetY=e.sent(),f)]),[2]}})})}function qa(a,c,b,m){return y(this,void 0,void 0,function(){var l,h,d,k,n,g,f,e;return x(this,function(w){switch(w.label){case 0:l=["Rotation","OffsetX","OffsetY"];h=c.filter(function(b){return b.primitiveName!==a.primitiveName&&-1===l.indexOf(b.propertyName)});d=a.primitiveName;k=E.hashString(JSON.stringify(a)).toString();g=(n=m).push;f={type:"fill",templateHash:k};if(0!==c.length)return[3,1];e=k;return[3,3];case 1:return[4,P(k,h,b)];case 2:e=
w.sent(),w.label=3;case 3:return f.materialHash=e,f.cim=a,f.materialOverrides=h,f.colorLocked=a.colorLocked,f.color={r:128,g:128,b:128,a:1},f.height=0,f.scaleX=1,[4,q(d,"Rotation",c,b,a.rotation)];case 4:return f.angle=w.sent(),[4,q(d,"OffsetX",c,b,a.offsetX)];case 5:return f.offsetX=w.sent(),[4,q(d,"OffsetY",c,b,a.offsetY)];case 6:return g.apply(n,[(f.offsetY=w.sent(),f)]),[2]}})})}function ra(a,c,b,m){return y(this,void 0,void 0,function(){var l,h,d,k,n;return x(this,function(g){switch(g.label){case 0:l=
E.hashString(JSON.stringify(a)).toString();d=(h=m).push;k={type:"fill",templateHash:l};if(0!==c.length)return[3,1];n=l;return[3,3];case 1:return[4,P(l,c,b)];case 2:n=g.sent(),g.label=3;case 3:return d.apply(h,[(k.materialHash=n,k.cim=a,k.materialOverrides=null,k.colorLocked=a.colorLocked,k.color={r:128,g:128,b:128,a:1},k.height=0,k.angle=0,k.offsetX=0,k.offsetY=0,k.scaleX=1,k)]),[2]}})})}function sa(a,c,b,m,l,h){return y(this,void 0,void 0,function(){var d,k,n,g,f,e,w,u,r,v;return x(this,function(p){switch(p.label){case 0:return d=
E.hashString(JSON.stringify(a)).toString(),k=a.primitiveName,n=F(a.color),g=void 0!==a.width?a.width:4,f=N(a.capStyle),e=O(a.joinStyle),w=a.miterLimit,r=(u=m).push,v={type:"line",templateHash:d,materialHash:0===c.length?d:function(a,b,c){return d},cim:a,materialOverrides:null,isOutline:l,colorLocked:a.colorLocked},[4,q(k,"Color",c,b,n,G)];case 1:return v.color=p.sent(),[4,q(k,"Width",c,b,g)];case 2:return v.width=p.sent(),[4,q(k,"CapStyle",c,b,f)];case 3:return v.cap=p.sent(),[4,q(k,"JoinStyle",c,
b,e)];case 4:return v.join=p.sent(),[4,q(k,"MiterLimit",c,b,w)];case 5:return r.apply(u,[(v.miterLimit=p.sent(),v.referenceWidth=h,v.zOrder=Q(a.name),v.isDashed=!1,v)]),[2]}})})}function ta(a,c,b,m,l,h){return y(this,void 0,void 0,function(){var d,k,n,g,f,e,w,u,r,v,p;return x(this,function(A){switch(A.label){case 0:return d=E.hashString(""+a.url+JSON.stringify(a.colorSubstitutions)).toString(),k=a.primitiveName,n=F(a.tintColor),g=void 0!==a.width?a.width:4,f=N(a.capStyle),e=O(a.joinStyle),w=a.miterLimit,
u=E.hashString(JSON.stringify(a)).toString(),v=(r=m).push,p={type:"line",templateHash:u,materialHash:0===c.length?d:function(a,b,c){return d},cim:a,materialOverrides:null,isOutline:l,colorLocked:a.colorLocked},[4,q(k,"TintColor",c,b,n,G)];case 1:return p.color=A.sent(),[4,q(k,"Width",c,b,g)];case 2:return p.width=A.sent(),[4,q(k,"CapStyle",c,b,f)];case 3:return p.cap=A.sent(),[4,q(k,"JoinStyle",c,b,e)];case 4:return p.join=A.sent(),[4,q(k,"MiterLimit",c,b,w)];case 5:return v.apply(r,[(p.miterLimit=
A.sent(),p.referenceWidth=h,p.zOrder=Q(a.name),p.isDashed=!1,p)]),[2]}})})}function ua(a,c,b,m,l,h){return y(this,void 0,void 0,function(){var d,k,n,g,f,e,w,u,r,v;return x(this,function(p){switch(p.label){case 0:d=a.primitiveName;k=void 0!==a.width?a.width:4;n=N(a.capStyle);g=O(a.joinStyle);f=a.miterLimit;e=E.hashString(JSON.stringify(a)).toString();u=(w=m).push;r={type:"line",templateHash:e};if(0!==c.length)return[3,1];v=e;return[3,3];case 1:return[4,P(e,c,b)];case 2:v=p.sent(),p.label=3;case 3:return r.materialHash=
v,r.cim=a,r.materialOverrides=null,r.isOutline=l,r.colorLocked=a.colorLocked,r.color={r:128,g:128,b:128,a:1},[4,q(d,"Width",c,b,k)];case 4:return r.width=p.sent(),[4,q(d,"CapStyle",c,b,n)];case 5:return r.cap=p.sent(),[4,q(d,"JoinStyle",c,b,g)];case 6:return r.join=p.sent(),[4,q(d,"MiterLimit",c,b,f)];case 7:return u.apply(w,[(r.miterLimit=p.sent(),r.referenceWidth=h,r.zOrder=Q(a.name),r.isDashed=!1,r)]),[2]}})})}function va(a,c,b,m,l,h){return y(this,void 0,void 0,function(){var d,k,n,g,f,e,w,u,
r,v,p,A,H,y,D,z;return x(this,function(t){switch(t.label){case 0:d=a.primitiveName;k=a.size;n=a.scaleX;g=a.rotation;f=a.offsetX;e=a.offsetY;w=F(a.tintColor);u=E.hashString(""+a.url+JSON.stringify(a.colorSubstitutions)).toString();r=!1;v="";p=0;for(A=c;p<A.length;p++)H=A[p],H.primitiveName===d&&(void 0!==H.value?v+="|"+H.primitiveName+"|"+H.propertyName+"|"+JSON.stringify(H.value):H.valueExpressionInfo&&(r=!0));D=(y=m).push;z={type:"marker",templateHash:E.hashString(JSON.stringify(a)+v).toString(),
materialHash:r?function(a,b,c){return u}:u,cim:a,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:!1,alignment:l,anchorPoint:a.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==a.anchorPointUnits};return[4,q(d,"Size",c,b,k)];case 1:return z.size=t.sent(),[4,q(d,"ScaleX",c,b,n)];case 2:return z.scaleX=t.sent(),[4,q(d,"Rotation",c,b,g)];case 3:return z.rotation=t.sent(),[4,q(d,"OffsetX",c,b,f)];case 4:return z.offsetX=t.sent(),[4,q(d,"OffsetY",c,b,e)];case 5:return z.offsetY=
t.sent(),[4,q(d,"TintColor",c,b,w,G)];case 6:return D.apply(y,[(z.color=t.sent(),z.outlineColor={r:0,g:0,b:0,a:0},z.outlineWidth=0,z.frameHeight=0,z.rotateClockwise=a.rotateClockwise,z.referenceSize=h,z.sizeRatio=1,z)]),[2]}})})}function wa(a,c,b,m,l,h,d,k){return y(this,void 0,void 0,function(){var n,g,f,e,w,u,r,q;return x(this,function(p){switch(p.label){case 0:n=a.markerGraphics;if(!n)return[2];g=0;a.scaleSymbolsProportionally&&(f=a.frame)&&(g=f.ymax-f.ymin);e=[];w=0;for(u=n;w<u.length;w++)if(r=
u[w])if(q=r.symbol)switch(q.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":e.push(ya(a,r,c,m,l,h,d,g,k));break;case "CIMTextSymbol":e.push(za(a,r,c,b,m,l,h,d,g))}return[4,ja.all(e)];case 1:return p.sent(),[2]}})})}function za(a,c,b,m,l,h,d,k,n){return y(this,void 0,void 0,function(){var g,f,e,w,u,r,v,p,A,H,y,ea,z,t,S,K,R,B,G,T,J,W,X,C;return x(this,function(x){switch(x.label){case 0:g=[];D.OverrideHelper.findApplicableOverrides(c,b,g);f=c.geometry;if(!("x"in f&&"y"in f))return[2];
e=c.symbol;w=e.underline?"underline":e.strikethrough?"line-through":"none";u=ma(e.fontStyleName);e.font=ga({family:e.fontFamilyName,decoration:w},u);r=a.frame;v=f.x-.5*(r.xmin+r.xmax);p=f.y-.5*(r.ymin+r.ymax);A=a.size/n;H=a.primitiveName;y=(e.height||0)*A;ea=e.angle||0;z=((e.offsetX||0)+v)*A;t=((e.offsetY||0)+p)*A;S=F(D.CIMSymbolHelper.getFillColor(e));K=F(D.CIMSymbolHelper.getStrokeColor(e));R=D.CIMSymbolHelper.getStrokeWidth(e);R||(K=F(D.CIMSymbolHelper.getFillColor(e.haloSymbol)),R=e.haloSize*
A);B="";G=0;for(T=b;G<T.length;G++)J=T[G],J.primitiveName===H&&void 0!==J.value&&(B+="|"+J.primitiveName+"|"+J.propertyName+"|"+JSON.stringify(J.value));X=(W=h).push;C={type:"text",templateHash:E.hashString(JSON.stringify(c)+B).toString(),materialHash:function(a,b,c){return E.hashString(JSON.stringify(e.font)).toString()},cim:e,materialOverrides:null,colorLocked:a.colorLocked,alignment:d,anchorPoint:{x:a.anchorPoint?a.anchorPoint.x:0,y:a.anchorPoint?a.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==
a.anchorPointUnits,fontName:e.fontFamilyName,decoration:"none",weight:"normal",style:"normal"};return[4,q(H,"Height",b,l,y)];case 1:return C.size=x.sent(),[4,q(H,"Rotation",b,l,ea)];case 2:return C.angle=x.sent(),[4,q(H,"OffsetX",b,l,z)];case 3:return C.offsetX=x.sent(),[4,q(H,"OffsetY",b,l,t)];case 4:return X.apply(W,[(C.offsetY=x.sent(),C.horizontalAlignment=ka(e.horizontalAlignment),C.verticalAlignment=la(e.verticalAlignment),C.text=Aa(m,l,c.textString,e.textCase),C.color=S,C.outlineColor=K,C.outlineSize=
R,C.referenceSize=k,C.sizeRatio=1,C)]),[2]}})})}function ya(a,c,b,m,l,h,d,k,n){return y(this,void 0,void 0,function(){var g,f,e,w,u,r;return x(this,function(v){switch(v.label){case 0:g=c.symbol;f=c.geometry;if(!f)return[2];e=da.getExtent(f);if("CIMTextSymbol"===g.type)return[2];w=g.symbolLayers;if(!w)return[2];u=w.length;r=function(){var g,r,v,y,B,z,t,S,K,R,M,P,T,J,W,X,C,N,O,Z,Q,L,aa,U,V,Y,I,ba,ca;return x(this,function(p){switch(p.label){case 0:return(g=w[u])&&!1!==g.enable?n?[4,fa(a,c,b,m,l,h,d,
k)]:[3,2]:[2,"continue"];case 1:return p.sent(),[2,"continue"];case 2:r=g.type;switch(r){case "CIMSolidFill":return[3,3];case "CIMSolidStroke":return[3,3]}return[3,15];case 3:v=da.getSDFMetrics(e,a.frame,a.size,a.anchorPoint,"Relative"!==a.anchorPointUnits);y=v[0];B=v[1];z=v[2];t="CIMSolidFill"===g.type;S={type:"sdf",geom:f,asFill:t};K=a.primitiveName;R=a.size;M=a.rotation;P=a.offsetX;T=a.offsetY;J=g.primitiveName;W=t?F(D.CIMSymbolHelper.getFillColor(g)):F(D.CIMSymbolHelper.getStrokeColor(g));X=t?
{r:0,g:0,b:0,a:0}:F(D.CIMSymbolHelper.getStrokeColor(g));C=D.CIMSymbolHelper.getStrokeWidth(g);if(!t&&!C)return[3,16];N=!1;O="";Z=0;for(Q=b;Z<Q.length;Z++)if(L=Q[Z],L.primitiveName===J||L.primitiveName===K)void 0!==L.value?O+="|"+L.primitiveName+"|"+L.propertyName+"|"+JSON.stringify(L.value):L.valueExpressionInfo&&(N=!0);aa=E.hashString(JSON.stringify(S)).toString();U=E.hashString(JSON.stringify(g)+JSON.stringify(c)+O).toString();Y=(V=l).push;I={type:"marker",templateHash:U,materialHash:N?function(a,
b,c){return aa}:aa,cim:S,materialOverrides:null,colorLocked:a.colorLocked,scaleSymbolsProportionally:a.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:B,y:z},isAbsoluteAnchorPoint:!1};return[4,q(K,"Size",b,m,R)];case 4:return I.size=p.sent(),I.scaleX=1,[4,q(K,"Rotation",b,m,M)];case 5:return I.rotation=p.sent(),[4,q(K,"OffsetX",b,m,P)];case 6:return I.offsetX=p.sent(),[4,q(K,"OffsetY",b,m,T)];case 7:return I.offsetY=p.sent(),[4,q(J,"Color",b,m,W,G)];case 8:I.color=p.sent();if(!t)return[3,9];
ba={r:0,g:0,b:0,a:0};return[3,11];case 9:return[4,q(J,"Color",b,m,X,G)];case 10:ba=p.sent(),p.label=11;case 11:I.outlineColor=ba;if(!t)return[3,12];ca=0;return[3,14];case 12:return[4,q(J,"Width",b,m,C)];case 13:ca=p.sent(),p.label=14;case 14:return Y.apply(V,[(I.outlineWidth=ca,I.frameHeight=k,I.rotateClockwise=a.rotateClockwise,I.referenceSize=d,I.sizeRatio=y,I)]),[3,16];case 15:return fa(a,c,b,m,l,h,d,k),[3,16];case 16:return[2]}})};v.label=1;case 1:return u--?[5,r()]:[3,3];case 2:return v.sent(),
[3,1];case 3:return[2]}})})}function fa(a,c,b,m,l,h,d,k){return y(this,void 0,void 0,function(){var n,g,f,e,w,u,r,v,p,A,y,B,G,z,t,F;return x(this,function(x){switch(x.label){case 0:n={type:a.type,enable:!0,name:a.name,colorLocked:a.colorLocked,primitiveName:a.primitiveName,anchorPoint:a.anchorPoint,anchorPointUnits:a.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:a.rotateClockwise,rotation:0,size:a.size,billboardMode3D:a.billboardMode3D,depth3D:a.depth3D,frame:a.frame,markerGraphics:[c],scaleSymbolsProportionally:a.scaleSymbolsProportionally,
respectFrame:a.respectFrame,clippingPath:a.clippingPath};g=[];f=["Rotation","OffsetX","OffsetY"];g=b.filter(function(b){return b.primitiveName===a.primitiveName&&-1===f.indexOf(b.propertyName)});e=D.CIMSymbolHelper.getTextureAnchor(n);w=e[0];u=e[1];r=JSON.stringify(n);v=a.primitiveName;p=a.rotation;A=a.offsetX;y=a.offsetY;B=E.hashString(JSON.stringify(n)).toString();z=(G=l).push;t={type:"marker",templateHash:B};if(0!==g.length)return[3,1];F=B;return[3,3];case 1:return[4,P(r,g,m)];case 2:F=x.sent(),
x.label=3;case 3:return t.materialHash=F,t.cim=n,t.materialOverrides=g,t.colorLocked=a.colorLocked,t.scaleSymbolsProportionally=a.scaleSymbolsProportionally,t.alignment=h,t.anchorPoint={x:w,y:u},t.isAbsoluteAnchorPoint=!1,t.size=a.size,t.scaleX=1,[4,q(v,"Rotation",b,m,p)];case 4:return t.rotation=x.sent(),[4,q(v,"OffsetX",b,m,A)];case 5:return t.offsetX=x.sent(),[4,q(v,"OffsetY",b,m,y)];case 6:return z.apply(G,[(t.offsetY=x.sent(),t.color={r:0,g:0,b:0,a:0},t.outlineColor={r:0,g:0,b:0,a:0},t.outlineWidth=
0,t.frameHeight=k,t.rotateClockwise=a.rotateClockwise,t.referenceSize=d,t.sizeRatio=1,t)]),[2]}})})}function Q(a){return a&&0===a.indexOf("Level_")?parseInt(a.substr(6),10):0}function G(a){if(!a||0===a.length)return null;a=(new ha(a)).toRgba();return{r:a[0],g:a[1],b:a[2],a:a[3]}}function q(a,c,b,m,l,h){return y(this,void 0,void 0,function(){var d,k,n,g,f;return x(this,function(e){switch(e.label){case 0:if(!a)return[3,4];d=function(b){var e,g,f;return x(this,function(d){switch(d.label){case 0:if(b.primitiveName!==
a||b.propertyName!==c)return[3,2];if(void 0!==b.value)return[2,{value:h?h(b.value):b.value}];e=b.valueExpressionInfo;if(!e)return[3,2];g=e.expression;return[4,U.createRendererExpression(g,m.spatialReference,m.fields)];case 1:return f=d.sent(),[2,{value:function(a,b,c){a=V.callWithFeature(f,a,{$view:c},m.geometryType,b);null!==a&&h&&(a=h(a));return null!==a?a:l}}];case 2:return[2]}})};k=0;n=b;e.label=1;case 1:if(!(k<n.length))return[3,4];g=n[k];return[5,d(g)];case 2:f=e.sent();if("object"===typeof f)return[2,
f.value];e.label=3;case 3:return k++,[3,1];case 4:return[2,l]}})})}function Y(a,c){switch(c){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function Aa(a,c,b,m){if(!a||-1===b.indexOf("["))return Y(b,m);c=function(a){for(var b=a.length;b--;)if(-1===" /-,\n".indexOf(a.charAt(b)))return!1;return!0};var l=[],h=0,d=-1;do d=b.indexOf("[",h),d>=h&&(d>h&&(h=b.substr(h,d-h),l.push([h,null,c(h)])),h=d+1,d=b.indexOf("]",h),d>=h&&(d>h&&(h=b.substr(h,d-h),(h=a[h])&&
l.push([null,h,!1])),h=d+1));while(-1!==d);h<b.length-1&&(h=b.substr(h),l.push([h,null,c(h)]));return function(a,b,c){b="";c=null;for(var f=0;f<l.length;f++){var e=l[f],d=e[0],g=e[1],e=e[2];if(d)e?c=d:(c&&(b+=c,c=null),b+=d);else if(d=a.attributes[g])c&&(b+=c,c=null),b+=d}return Y(b,m)}}function P(a,c,b){return y(this,void 0,void 0,function(){var m,l,h,d;return x(this,function(k){switch(k.label){case 0:m=function(a){var c,d,e;return x(this,function(f){switch(f.label){case 0:c=a.valueExpressionInfo;
if(!c)return[3,2];d=c.expression;return[4,U.createRendererExpression(d,b.spatialReference,b.fields)];case 1:e=f.sent(),a.fn=function(a,c,d){return V.callWithFeature(e,a,{$view:d},b.geometryType,c)},f.label=2;case 2:return[2]}})},l=0,h=c,k.label=1;case 1:if(!(l<h.length))return[3,4];d=h[l];return[5,m(d)];case 2:k.sent(),k.label=3;case 3:return l++,[3,1];case 4:return[2,function(b,d,f){for(var e=0;e<c.length;e++){var g=c[e];g.fn&&(g.value=g.fn(b,d,f))}return E.hashString(a+D.OverrideHelper.buildOverrideKey(c)).toString()}]}})})}
Object.defineProperty(M,"__esModule",{value:!0});var xa=ia.getLogger("esri.symbols.cim.cimAnalyzer");M.analyzeCIMSymbol=function(a,c,b,m,l){return y(this,void 0,void 0,function(){var h,d,k,n;return x(this,function(g){switch(g.label){case 0:h=m?m:[];if(!a)return[2,h];"CIMSymbolReference"===a.type?(d=a.symbol,k=a.primitiveOverrides):(d=a,k=null);n=d.type;switch(n){case "CIMPointSymbol":return[3,1];case "CIMLineSymbol":return[3,1];case "CIMPolygonSymbol":return[3,1];case "CIMTextSymbol":return[3,3]}return[3,
4];case 1:return[4,na(d,k,c,b,h,l)];case 2:return g.sent(),[3,4];case 3:return[3,4];case 4:return[2,h]}})})};M.analyzeCIMResource=function(a,c,b){if(!b||0===b.length)return c;a=JSON.parse(JSON.stringify(c));D.OverrideHelper.applyOverrides(a,b);return a};M.applyCIMLayerProperties=function(a,c){}});