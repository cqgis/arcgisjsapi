// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.13/esri/copyright.txt for details.
//>>built
define("require exports ./nextTick ./now ./PooledArray ./promiseUtils ./requestAnimationFrame".split(" "),function(D,b,n,x,p,g,y){function z(a){void 0===a&&(a=b.now());b.debug.rafId=null;0<c.length&&(b.debug.rafId=d());0<e&&(k=Math.min(a-e,k));b.debug.executeFrameTasks(a)}function d(){return b.debug.requestNextFrame?b.debug.requestNextFrame(q):q()}function r(){c.forEach(function(a){a.removed&&f.push(a)});c.removeUnorderedMany(f.data,f.length);f.clear()}function t(){for(;l.length;){var a=l.shift();
a.isActive&&(a.isActive=!1,a.callback())}b.debug.willDispatch=!1}function q(){return y(z)}Object.defineProperty(b,"__esModule",{value:!0});b.now=x;var A=function(){return function(a){this.phases=a;this.paused=!1;this.ticks=-1;this.removed=!1}}(),B=function(){function a(a){this.callback=a;this.isActive=!0}a.prototype.remove=function(){this.isActive=!1};return a}(),e=-1,m=0,k=1E3,h={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},u=["prepare","preRender","render","postRender","update"],l=[],
c=new p,v=function(){function a(a){this._task=a}a.prototype.remove=function(){this._task.removed=!0};a.prototype.pause=function(){this._task.paused=!0};a.prototype.resume=function(){this._task.paused=!1};return a}();b.FrameTaskHandle=v;b.debug={frameTasks:c,rafId:null,requestNextFrame:null,willDispatch:!1,clearFrameTasks:function(a){void 0===a&&(a=!1);c.forEach(function(a){a.removed=!0});a&&r()},dispatch:t,executeFrameTasks:function(a){void 0===a&&(a=b.now());0>e&&(e=a);var f=a-e,w=0<m?m:k,C=Math.max(0,
f-w);e=a;for(var g=function(d){var e=u[d];c.forEach(function(c){c.paused||c.removed||(0===d&&c.ticks++,c.phases[e]&&(h.time=a,h.deltaTime=0===c.ticks?0:f,h.elapsedFrameTime=b.now()-a,h.frameDuration=w-C,c.phases[e].call(c,h)))})},d=0;d<u.length;d++)g(d);r()}};b.schedule=function(a){a=new B(a);l.push(a);b.debug.willDispatch||(b.debug.willDispatch=!0,n(t));return a};b.addFrameTask=function(a){a=new A(a);c.push(a);b.debug.rafId||(e=-1,b.debug.rafId=d());return new v(a)};b.setFrameDuration=function(a){m=
Math.max(0,a)};b.requestNextFrame=d;var f=new p;b.waitTicks=function(a,b){void 0===a&&(a=1);var c=g.createResolver(),d=function(){g.isAborted(b)?c.reject(g.createAbortError()):0===a?c():(--a,n(function(){return d()}))};d();return c.promise}});