// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ./color ./size ./support/utils ../support/utils ../../support/AuthoringInfo".split(" "),function(C,p,f,h,n,k,w,q,r,l,x){function y(a){return n(this,void 0,void 0,function(){var b,c,e,m,d;return h(this,function(g){switch(g.label){case 0:if(!(a&&a.layer&&(a.field||a.valueExpression||a.sqlExpression)))throw new k("univariate-colorsize-visual-variables:missing-parameters",
"'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new k("univariate-colorsize-visual-variables:missing-parameters","View is required when 'valueExpression' is specified");b=f({},a);c=[0,2,1,3];e=l.createLayerAdapter(b.layer,c);b.layer=e;if(!e)throw new k("univariate-colorsize-visual-variables:invalid-parameters","'layer' must be one of these types: "+l.getLayerTypeLabels(c).join(", "));return[4,e.load()];case 1:g.sent();
m=l.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression});if(d=r.verifyBasicFieldValidity(e,m,"univariate-colorsize-visual-variables:invalid-parameters"))throw d;return[2,b]}})})}function t(a,b){a=f({},a);b=0===b?a.colorOptions:a.sizeOptions;delete a.sizeOptions;delete a.colorOptions;return f({},a,b)}function z(a){return n(this,void 0,void 0,function(){var b,c,e,m,d;return h(this,function(g){switch(g.label){case 0:if(!(a&&a.layer&&(a.field||a.valueExpression||
a.sqlExpression)))throw new k("univariate-colorsize-continuous-renderer:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(a.valueExpression&&!a.sqlExpression&&!a.view)throw new k("univariate-colorsize-continuous-renderer:missing-parameters","View is required when 'valueExpression' is specified");b=f({},a);b.symbolType=b.symbolType||"2d";c=[0,2,1,3];e=l.createLayerAdapter(b.layer,c);b.layer=e;if(!e)throw new k("univariate-colorsize-continuous-renderer:invalid-parameters",
"'layer' must be one of these types: "+l.getLayerTypeLabels(c).join(", "));return[4,e.load()];case 1:g.sent();m=l.getFieldsList({field:b.field,normalizationField:b.normalizationField,valueExpression:b.valueExpression});if(d=r.verifyBasicFieldValidity(e,m,"univariate-colorsize-continuous-renderer:invalid-parameters"))throw d;return[2,b]}})})}function A(a){a=f({},a);var b=f({},a.sizeOptions);delete a.sizeOptions;delete a.colorOptions;delete b.sizeOptimizationEnabled;return f({},a,b)}function B(a){a=
f({},a);var b=a.symbolType,c=-1<b.indexOf("3d-volumetric");delete a.symbolType;delete a.defaultSymbolEnabled;if(a.worldScale=c)a.sizeOptions=f({},a.sizeOptions),a.sizeOptions.axis="3d-volumetric-uniform"===b?"all":"height";return a}function u(a){return n(this,void 0,void 0,function(){var b,c,e,m,d,g,f,v,k,l,n;return h(this,function(h){switch(h.label){case 0:return[4,y(a)];case 1:return b=h.sent(),[4,w.createVisualVariable(t(b,0))];case 2:return e=h.sent(),m=t(b,1),m.statistics=e.statistics,c=e,[4,
q.createVisualVariables(m)];case 3:return d=h.sent(),g=c.visualVariable,f=d.visualVariables,v=g.stops.length,f.forEach(function(a){null!=a.minDataValue&&(a.minDataValue=g.stops[0].value,a.maxDataValue=g.stops[v-1].value)}),k=c.authoringInfo.visualVariables[0],l=d.authoringInfo.visualVariables[0],n=new x({type:"univariate-color-size",visualVariables:[k.clone(),l.clone()]}),[2,{basemapId:d.basemapId,statistics:c.statistics,defaultValuesUsed:c.defaultValuesUsed,color:{visualVariable:g,colorScheme:c.colorScheme},
size:{visualVariables:f,sizeScheme:d.sizeScheme},authoringInfo:n}]}})})}Object.defineProperty(p,"__esModule",{value:!0});p.createVisualVariables=u;p.createContinuousRenderer=function(a){return n(this,void 0,void 0,function(){var b,c,e,f,d,g,k;return h(this,function(h){switch(h.label){case 0:return[4,z(a)];case 1:return b=h.sent(),[4,q.createContinuousRenderer(A(b))];case 2:return e=h.sent(),f=B(b),f.statistics=e.statistics,c=e,[4,u(f)];case 3:return d=h.sent(),g=c.renderer,k=d.size.visualVariables.map(function(a){return a.clone()}),
k.push(d.color.visualVariable.clone()),g.visualVariables=k,g.authoringInfo=d.authoringInfo&&d.authoringInfo.clone(),[2,{renderer:g,statistics:c.statistics,defaultValuesUsed:c.defaultValuesUsed,color:d.color,size:d.size,basemapId:d.basemapId}]}})})}});