// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/assignHelper ../../request ../../core/asyncUtils ../../core/Logger ../../core/promiseUtils".split(" "),function(z,b,g,l,t,u,v,w,m){function x(a,f,d){return g(this,void 0,void 0,function(){var c,h,n,b;return l(this,function(e){switch(e.label){case 0:if(a.data||!a.styleUrl||!a.styleName)return[2,a];c=a.styleName;if(!Array.isArray(c))return[3,2];h=c.map(function(e){return v.safeCast(p(e,
a.styleUrl,f,d))});n=a;return[4,m.all(h)];case 1:return n.data=e.sent(),[3,4];case 2:return b=a,[4,p(c,a.styleUrl,f,d)];case 3:b.data=e.sent(),e.label=4;case 4:return[2,a]}})})}function p(a,f,d,b){return g(this,void 0,void 0,function(){var h,c;return l(this,function(g){if(k.has(a))return[2,k.get(a).then(function(a){return q(a.data)})];try{return h=d(f,a),c=u(h,t({responseType:"json",query:{f:"json"}},b)),k.set(a,c),[2,c.then(function(a){return q(a.data)})]}catch(e){return y.error("error requesting "+
a+", reason is "+e.message),k.has(a)&&k.delete(a),[2,null]}})})}var r=this;Object.defineProperty(b,"__esModule",{value:!0});var y=w.getLogger("esri/symbols/support/cimSymbolUtils");b.constructUrlFn=function(a,b){return a+"/resources/styles/cim/"+b+".json"};b.expandSymbols=function(a,f,d){return g(r,void 0,void 0,function(){return l(this,function(c){return[2,m.all(a.map(function(a){return b.expandSymbol(a,f,d)}))]})})};b.expandSymbol=function(a,b,d){return g(r,void 0,void 0,function(){return l(this,
function(c){return a?"cim"===a.type?[2,x(a,b,d)]:"web-style"===a.type?[2,a.fetchCIMSymbol(d)]:[2,a]:[2,null]})})};var q=function(a){return null===a?null:"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}},k=new Map});