// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/promiseUtils ../../intl/date ../../intl/number ./FieldsIndex ./fieldUtils ../../support/arcadeOnDemand".split(" "),function(u,f,A,B,p,g,v,h,w,x,q,y){function z(){return g(this,void 0,void 0,function(){return p(this,function(b){return[2,v.create(function(a){u(["../../core/sql/WhereClause"],a)})]})})}function r(b,a,c,
d){b=q.getField(d,b);if(!b)return a;if(null==c[b.name])return"";if(a=b.domain)if("codedValue"===a.type||"coded-value"===a.type){d=c[b.name];var e=0;for(a=a.codedValues;e<a.length;e++){var k=a[e];if(k.code===d)return k.name}}else if("range"===a.type&&(d=+c[b.name],e="range"in a?a.range[1]:a.maxValue,("range"in a?a.range[0]:a.minValue)<=d&&d<=e))return a.name;c=c[b.name];"date"===b.type||"esriFieldTypeDate"===b.type?c=h.formatDate(c,h.convertDateFormatToIntlOptions("short-date")):q.isNumericField(b)&&
(c=w.formatNumber(+c));return c?c:""}Object.defineProperty(f,"__esModule",{value:!0});var t={type:"simple",evaluate:function(b){return null}};f.createLabelFunction=function(b,a,c){return g(this,void 0,void 0,function(){var d,e,k,f,l,n,g,h;return p(this,function(m){switch(m.label){case 0:if(!b||!b.symbol)return[2,t];d=b.where;e=b.getLabelExpression();return d?[4,z()]:[3,2];case 1:return f=m.sent(),[3,3];case 2:f=null,m.label=3;case 3:return k=f,"arcade"!==e.type?[3,5]:[4,y.createLabelExpression(e.expression,
c,a)];case 4:return n=m.sent(),l={type:"arcade",evaluate:function(a){a=n.evaluate({$feature:n.repurposeFeature(a)});return null!=a?a.toString():null}},[3,6];case 5:l={type:"simple",evaluate:function(b){var c=b&&b.attributes;return c?e.expression.replace(/{[^}]*}/g,function(b){return r(b.slice(1,-1),b,c,a)}):null}},m.label=6;case 6:if(d){try{g=k.WhereClause.create(d,new x(a))}catch(C){return[2,t]}h=l.evaluate;l.evaluate=function(a){return g.testFeature(a)?h(a):null}}return[2,l]}})})};f.formatField=
r});