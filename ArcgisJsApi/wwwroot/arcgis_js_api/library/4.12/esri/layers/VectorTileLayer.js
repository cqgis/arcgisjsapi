// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/accessorSupport/decorators ./ArcGISService ../support/serviceTileInfoProperty ../support/TilemapCache".split(" "),function(l,f,m,d,b,a,c,n,g,e){return function(h){function k(){var a=null!==h&&h.apply(this,arguments)||this;a.copyright=null;a.minScale=0;a.maxScale=0;a.spatialReference=
null;a.tileInfo=null;a.tilemapCache=null;return a}d(k,h);k.prototype.readMinScale=function(a,c){return null!=c.minLOD&&null!=c.maxLOD?a:0};k.prototype.readMaxScale=function(a,c){return null!=c.minLOD&&null!=c.maxLOD?a:0};Object.defineProperty(k.prototype,"supportsBlankTile",{get:function(){return 10.2<=this.version},enumerable:!0,configurable:!0});k.prototype.readTilemapCache=function(a,c){return c.capabilities&&-1<c.capabilities.indexOf("Tilemap")?new e({layer:this}):null};b([c.property({json:{read:{source:"copyrightText"}}})],
k.prototype,"copyright",void 0);b([c.property()],k.prototype,"minScale",void 0);b([c.reader("service","minScale")],k.prototype,"readMinScale",null);b([c.property()],k.prototype,"maxScale",void 0);b([c.reader("service","maxScale")],k.prototype,"readMaxScale",null);b([c.property({type:a.SpatialReference})],k.prototype,"spatialReference",void 0);b([c.property({readOnly:!0,dependsOn:["version"]})],k.prototype,"supportsBlankTile",null);b([c.property(g.serviceTileInfoProperty)],k.prototype,"tileInfo",void 0);
b([c.property()],k.prototype,"tilemapCache",void 0);b([c.reader("service","tilemapCache",["capabilities"])],k.prototype,"readTilemapCache",null);b([c.property()],k.prototype,"version",void 0);return k=b([c.subclass("esri.layers.mixins.ArcGISCachedService")],k)}(c.declared(n))})},"esri/layers/support/serviceTileInfoProperty":function(){define(["require","exports","../../core/tsSupport/assignHelper","./TileInfo"],function(l,f,m,d){function b(a,c,b,g){if(!a)return null;b=c.minScale;var e=c.maxScale,
h=c.minLOD,k=c.maxLOD;if(null!=h&&null!=k)return g&&g.ignoreMinMaxLOD?d.fromJSON(a):d.fromJSON(m({},a,{lods:a.lods.filter(function(a){a=a.level;return null!=a&&a>=h&&a<=k})}));if(0!==b&&0!==e){var n=b?Math.round(1E4*b)/1E4:Infinity,f=e?Math.round(1E4*e)/1E4:-Infinity;return d.fromJSON(m({},a,{lods:a.lods.filter(function(a){a=Math.round(1E4*a.scale)/1E4;return a<=n&&a>=f})}))}return d.fromJSON(a)}Object.defineProperty(f,"__esModule",{value:!0});f.serviceTileInfoProperty={type:d,json:{origins:{service:{read:{source:["tileInfo",
"minScale","maxScale","minLOD","maxLOD"],reader:b}}}}};f.readServiceTileInfo=b})},"esri/layers/support/TilemapCache":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/urlUtils ../../core/watchUtils ../../core/accessorSupport/decorators ./Tilemap".split(" "),
function(l,f,m,d,b,a,c,n,g,e,h,k,q,u,p,t,r){var v=e.getLogger("esri.layers.support.TilemapCache");return function(c){function e(e){e=c.call(this)||this;e._handles=new g;e._pendingTilemapRequests={};e._availableLevels={};e.levels=5;e.cacheByteSize=2097152;e.request=a;return e}d(e,c);f=e;e.prototype.initialize=function(){var a=this;this._tilemapCache=new h(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],function(){return a._initializeTilemapDefinition()}),
p.init(this,"layer.tileInfo.lods",function(c){return a._initializeAvailableLevels(c)},!0)]);this._initializeTilemapDefinition()};e.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};e.prototype.castLevels=function(a){return 2>=a?(v.error("Minimum levels for Tilemap is 3, but got ",a),3):a};Object.defineProperty(e.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0});e.prototype.getTilemap=function(a,c,e){return this._tilemapFromCache(a,
c,e,this._tmpTilemapDefinition)};e.prototype.fetchTilemap=function(a,c,e,g){var h=this;if(!this._availableLevels[a])return q.reject(new n("tilemap-cache:level-unavailable","Level "+a+" is unavailable in the service"));var b=this._tmpTilemapDefinition;if(a=this._tilemapFromCache(a,c,e,b))return q.resolve(a);var k=g&&g.signal;g=m({},g,{signal:null});return q.create(function(a,c){q.onAbort(k,function(){return c(q.createAbortError())});var e=r.tilemapDefinitionId(b),n=h._pendingTilemapRequests[e];if(!n){var n=
r.Tilemap.fromDefinition(b,g).then(function(a){h._tilemapCache.put(e,a,a.byteSize);return a}),d=function(){return delete h._pendingTilemapRequests[e]};h._pendingTilemapRequests[e]=n;n.then(d,d)}n.then(a,c)})};e.prototype.getAvailability=function(a,c,e){return this._availableLevels[a]?(a=this.getTilemap(a,c,e))?a.getAvailability(c,e):"unknown":"unavailable"};e.prototype.getAvailabilityUpsample=function(a,c,e,g){g.level=a;g.row=c;g.col=e;a=this.layer.tileInfo;for(a.updateTileInfo(g);;)if(c=this.getAvailability(g.level,
g.row,g.col),"unavailable"===c){if(!a.upsampleTile(g))return"unavailable"}else return c};e.prototype.fetchAvailability=function(a,c,e,g){return this._availableLevels[a]?this.fetchTilemap(a,c,e,g).catch(function(a){return a}).then(function(g){return g instanceof r.Tilemap?(g=g.getAvailability(c,e),"unavailable"===g?q.reject(new n("tile-map:tile-unavailable","Tile is not available",{level:a,row:c,col:e})):g):q.isAbortError(g)?q.reject(g):"unknown"}):q.reject(new n("tilemap-cache:level-unavailable",
"Level "+a+" is unavailable in the service"))};e.prototype.fetchAvailabilityUpsample=function(a,c,e,g,h){var b=this;g.level=a;g.row=c;g.col=e;var k=this.layer.tileInfo;k.updateTileInfo(g);var n=!1,d=this.fetchAvailability(a,c,e,h).catch(function(a){if(q.isAbortError(a))throw a;if(k.upsampleTile(g))return b.fetchAvailabilityUpsample(g.level,g.row,g.col,g);throw a;}).then(function(a){n=!0;return a},function(a){n=!0;throw a;});if(n)return d;var r={id:g.id,level:a,row:c,col:e},v=q.createAbortController(),
A=m({},h,{signal:v.signal});a=function(a){var c=p.fetchAvailability(r.level,r.row,r.col,A);f._prefetches.push(c);a=function(){f._prefetches.removeUnordered(c)};c.then(a,a)};var p=this;for(c=0;f._prefetches.length<f._maxPrefetch&&k.upsampleTile(r);++c)a(c);d.then(function(){return v.abort()},function(){return v.abort()});return d};e.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var a=this.layer.parsedUrl,c=a.query;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:a.path,
query:c?u.objectToQuery(c):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};e.prototype._tilemapFromCache=function(a,c,e,g){a=this._getTilemapDefinition(a,c,e,g);a=r.tilemapDefinitionId(a);return this._tilemapCache.get(a)};e.prototype._getTilemapDefinition=function(a,c,e,g){g.level=a;g.row=c-c%this.size;g.col=e-e%this.size;return g};e.prototype._initializeAvailableLevels=function(a){var c=this;this._availableLevels=
{};a&&a.forEach(function(a){return c._availableLevels[a.level]=!0})};var f;e._maxPrefetch=4;e._prefetches=new k({initialSize:f._maxPrefetch});b([t.property({constructOnly:!0,type:Number})],e.prototype,"levels",void 0);b([t.cast("levels")],e.prototype,"castLevels",null);b([t.property({readOnly:!0,dependsOn:["levels"],type:Number})],e.prototype,"size",null);b([t.property({constructOnly:!0,type:Number})],e.prototype,"cacheByteSize",void 0);b([t.property({constructOnly:!0})],e.prototype,"layer",void 0);
b([t.property({constructOnly:!0})],e.prototype,"request",void 0);return e=f=b([t.subclass("esri.layers.support.TilemapCache")],e)}(t.declared(c))})},"esri/core/LRUCache":function(){define(["require","exports","./MemCache"],function(l,f,m){return function(){function d(b,a){this._storage=new m.MemCacheStorage;this._storage.maxSize=b;a&&this._storage.registerRemoveFunc("",a)}d.prototype.put=function(b,a,c){this._storage.put(b,a,c,1)};d.prototype.pop=function(b){return this._storage.pop(b)};d.prototype.get=
function(b){return this._storage.get(b)};d.prototype.clear=function(){this._storage.clearAll()};d.prototype.destroy=function(){this._storage.clearAll()};return d}()})},"esri/core/MemCache":function(){define(["require","exports","./iteratorUtils","./PooledArray","./string"],function(l,f,m,d,b){Object.defineProperty(f,"__esModule",{value:!0});l=function(){function a(a,b,g){this._namespace=a;this._storage=b;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";
g&&(this._storage.registerRemoveFunc(this._namespace,g),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},
enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,b,g,e){void 0===e&&(e=1);this._storage.put(this._namespace+a,b,g,e)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=
this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();f.MemCache=l;l=function(){function a(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=
new d}a.prototype.register=function(a){this._users.push(a)};a.prototype.deregister=function(a){this._users.removeUnordered(a)};a.prototype.registerRemoveFunc=function(a,b){this._removeFuncs.push([a,b])};a.prototype.deregisterRemoveFunc=function(a){this._removeFuncs=this._removeFuncs.filter(function(c){return c[0]!==a})};Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._maxSize},
set:function(a){this._maxSize=Math.max(a,0);this._size>this._maxSize&&this._removeEntries()},enumerable:!0,configurable:!0});a.prototype.put=function(a,b,g,e){if(this._db.has(a)){var c=this._db.get(a);this._size-=c.size;this._db.delete(a);this._notifyRemoved(a,c.entry)}g>this._maxSize?this._notifyRemoved(a,b):void 0===b?console.warn("Refusing to cache undefined entry "):!g||0>g?console.warn("Refusing to cache entry with invalid size "+g):(this._db.set(a,{entry:b,size:g,lifetime:e,lives:e}),this._size+=
g,this._size>this._maxSize&&this._removeEntries())};a.prototype.pop=function(a){if(this._db.has(a)){var c=this._db.get(a);this._size-=c.size;this._db.delete(a);++this._hit;return c.entry}++this._miss};a.prototype.get=function(a){var c=this._db.get(a);if(void 0===c)++this._miss;else return this._db.delete(a),c.lives=c.lifetime,this._db.set(a,c),++this._hit,c.entry};a.prototype.getStats=function(){var a=this,n={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*
this._getHitRate())+"%",Entries:this._db.size.toString()},g={},e=[];this._db.forEach(function(c,h){var k=c.lifetime;e[k]=(e[k]||0)+1;a._users.forEach(function(a){a=a.namespace;if(b.startsWith(h,a))return g[a]=(g[a]||0)+c.size,!1})});var h={};this._users.forEach(function(a){var c=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(g[c]=g[c]||0,h[c]=Math.round(100*a.hitRate)+"%"):h[c]="0%"});var k=Object.keys(g);k.forEach(function(c){return g[c]=g[c]/a._size*100});k.sort(function(a,c){return g[c]-g[a]});k.forEach(function(a){return n[a]=
Math.round(g[a])+"% / "+h[a]});for(k=0;k<e.length;++k){var d=e[k];d&&(n["Lifetime "+k]=Math.round(d/this._db.size*100)+"%")}return n};a.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};a.prototype.clear=function(a){var c=this;this._db.forEach(function(g,e){b.startsWith(e,a)&&(c._size-=g.size,c._db.delete(e),c._notifyRemoved(e,g.entry))})};a.prototype.clearAll=function(){var a=this;this._db.forEach(function(c,g){a._notifyRemoved(g,c.entry)});
this._size=0;this._db.clear()};a.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};a.prototype._notifyRemoved=function(a,n){this._removeFuncs.forEach(function(c){if(b.startsWith(a,c[0]))c[1](n)})};a.prototype._removeEntries=function(){var a=this;m.everyMap(this._db,function(c,g){a._db.delete(g);1>=c.lives?(a._size-=c.size,a._notifyRemoved(g,c.entry)):(--c.lives,a._db.set(g,c));return a._size>.9*a.maxSize})};return a}();f.MemCacheStorage=l})},"esri/core/iteratorUtils":function(){define(["require",
"exports"],function(l,f){Object.defineProperty(f,"__esModule",{value:!0});f.everyMap=Map.prototype.entries?function(f,d){f=f.entries();for(var b=f.next();!b.done;b=f.next())if(!1===d(b.value[1],b.value[0]))return!1;return!0}:function(f,d){var b=!0;f.forEach(function(a,c){b&&(b=!1!==d(a,c))});return b}})},"esri/core/PooledArray":function(){define(["require","exports","./tsSupport/generatorHelper","./arrayUtils","./HeapSort"],function(l,f,m,d,b){return function(){function a(a){var c=this;this.data=
[];this._length=0;this._allocator=null;this._deallocator=function(){};this._shrink=function(){};this._hint=new d.RemoveHint;a&&(a.initialSize&&(this.data=Array(a.initialSize)),a.allocator?(this._allocator=a.allocator,this._deallocator=a.deallocator):"deallocator"in a&&(this._deallocator=a.deallocator),a.shrink&&(this._shrink=function(){c.data.length>1.5*c.length&&(c.data.length=Math.floor(1.1*c.length))}))}a.prototype.toArray=function(){return this.data.slice(0,this.length)};Object.defineProperty(a.prototype,
"length",{get:function(){return this._length},set:function(a){if(a>this._length)if(this._allocator)for(;this._length<a;)this.data[this._length++]=this._allocator(this.data[this._length]);else this._length=a;else{if(this._deallocator)for(var c=a;c<this._length;++c)this.data[c]=this._deallocator(this.data[c]);this._length=a;this._shrink()}},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.length=0};a.prototype.prune=function(){this.clear();this.data=[]};a.prototype.equal=function(a){return d.equals(this.data,
a.data)};a.prototype.push=function(a){return this.data[this._length++]=a};a.prototype.pushArray=function(a,b){void 0===b&&(b=a.length);for(var c=0;c<b;c++)this.data[this._length++]=a[c];return this.back()};a.prototype.pushNew=function(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));++this._length;return this.back()};a.prototype.pop=function(){if(0!==this.length){var a=this.data[this.length-1];--this.length;this._shrink();return a}};a.prototype.removeMany=function(a){var c=
this,g=[];this.data=this.data.filter(function(e,b){if(b>=c.length)return!1;if(0>a.indexOf(e))return!0;g.push(e);return!1});this._length=this.data.length;return g};a.prototype.iterableRemoveMany=function(a,b){var c,e;return m(this,function(g){switch(g.label){case 0:c=[],e=0,g.label=1;case 1:if(!(e<this.length)||e>=this.length)return[3,4];0>a.indexOf(this.data[e])&&c.push(this.data[e]);return b()?[4]:[3,3];case 2:g.sent(),g.label=3;case 3:return++e,[3,1];case 4:return this.data=c,this._length=this.data.length,
[2]}})};a.prototype.removeUnordered=function(a){a=d.removeUnordered(this.data,a,this.length,this._hint);void 0!==a&&--this.length;return a};a.prototype.removeUnorderedIndex=function(a){if(!(a>=this.length||0>a))return this.swapElements(a,this.length-1),this.pop()};a.prototype.removeUnorderedMany=function(a,b,g){void 0===b&&(b=a.length);this.length=d.removeUnorderedMany(this.data,a,this.length,b,this._hint,g)};a.prototype.front=function(){if(0!==this.length)return this.data[0]};a.prototype.back=function(){if(0!==
this.length)return this.data[this.length-1]};a.prototype.swapElements=function(a,b){var c;a>=this.length||b>=this.length||a===b||(c=[this.data[b],this.data[a]],this.data[a]=c[0],this.data[b]=c[1])};a.prototype.sort=function(a){b.sort(this.data,0,this.length,a)};a.prototype.iterableSort=function(a,n){return b.iterableSort(this.data,0,this.length,a,n)};a.prototype.some=function(a,b){for(var c=0;c<this.length;++c)if(a.call(b,this.data[c],c,this.data))return!0;return!1};a.prototype.find=function(a,b){for(var c=
0;c<this.length;++c){var e=this.data[c];if(a.call(b,e,c,this.data))return e}};a.prototype.filterInPlace=function(a,b){for(var c=0,e=0;e<this._length;++e){var h=this.data[e];a.call(b,h,e,this.data)&&(this.data[e]=this.data[c],this.data[c]=h,c++)}if(this._deallocator)for(e=c;e<this._length;e++)this.data[e]=this._deallocator(this.data[e]);this._length=c;return this};a.prototype.forEach=function(a,b){for(var c=this.length,e=0;e<Math.min(this.length,c);++e)a.call(b,this.data[e],e,this.data)};a.prototype.iterableForEach=
function(){var a;return m(this,function(c){switch(c.label){case 0:a=0,c.label=1;case 1:return a<this.length?[4,this.data[a]]:[3,4];case 2:c.sent(),c.label=3;case 3:return++a,[3,1];case 4:return[2]}})};a.prototype.map=function(a,b){for(var c=Array(this.length),e=0;e<this.length;++e)c[e]=a.call(b,this.data[e],e,this.data);return c};return a}()})},"esri/core/HeapSort":function(){define(["require","exports","./tsSupport/generatorHelper"],function(l,f,m){var d;(function(b){function a(a,c,e,b){for(var g=
c,h=e>>>1,d=a[g-1];c<=h;){c=g<<1;c<e&&0>b(a[c-1],a[c])&&++c;var n=a[c-1];if(0>=b(n,d))break;a[g-1]=n;g=c}a[g-1]=d}function c(a,c){return a<c?-1:a>c?1:0}b.sort=function(b,g,e,h){void 0===g&&(g=0);void 0===e&&(e=b.length);void 0===h&&(h=c);for(var k=e>>>1;k>g;k--)a(b,k,e,h);for(var d=g+1,k=e-1;k>g;k--)e=b[g],b[g]=b[k],b[k]=e,a(b,d,k,h)};b.iterableSort=function(b,g,e,h,k){var d,n,f;return m(this,function(q){switch(q.label){case 0:void 0===g&&(g=0),void 0===e&&(e=b.length),void 0===h&&(h=c),d=e>>>1,q.label=
1;case 1:if(!(d>g))return[3,4];a(b,d,e,h);return k&&k()?[4]:[3,3];case 2:q.sent(),q.label=3;case 3:return d--,[3,1];case 4:n=g+1,d=e-1,q.label=5;case 5:if(!(d>g))return[3,8];f=b[g];b[g]=b[d];b[d]=f;a(b,n,d,h);return k&&k()?[4]:[3,7];case 6:q.sent(),q.label=7;case 7:return d--,[3,5];case 8:return[2]}})}})(d||(d={}));return d})},"esri/layers/support/Tilemap":function(){define("require exports ../../core/tsSupport/assignHelper ../../request ../../core/Error ../../core/lang ../../core/promiseUtils".split(" "),
function(l,f,m,d,b,a,c){function n(a){var c;"vector-tile"===a.service.type?c=a.service.url+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height:(c=a.service.tileServers,c=(c&&c.length?c[a.row%c.length]:a.service.url)+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height);(a=a.service.query)&&(c=c+"?"+a);return c}Object.defineProperty(f,"__esModule",{value:!0});l=function(){function g(){this.location={left:0,top:0,width:0,height:0};this.byteSize=40}g.prototype.getAvailability=
function(a,c){if(this._isAllAvailable)return"available";if(this._isAllUnvailable)return"unavailable";a=(a-this.location.top)*this.location.width+(c-this.location.left);c=a>>3;var b=this._tileAvailabilityBitSet;return 0>c||c>b.length?"unknown":b[c]&1<<a%8?"available":"unavailable"};g.prototype._updateFromData=function(a){for(var c=!0,b=!0,e=new Uint8Array(Math.ceil(this.location.width*this.location.height/8)),g=0,d=0;d<a.length;d++){var n=d%8;a[d]?(b=!1,e[g]|=1<<n):c=!1;7===n&&++g}this._isAllUnvailable=
b;this._isAllAvailable=c;this._isAllAvailable||this._isAllUnvailable||(this._tileAvailabilityBitSet=e,this.byteSize+=e.length)};g.fromDefinition=function(a,h){var e=a.service.request||d,f=a.row,l=a.col,p=a.width,t=a.height,r={query:{f:"json"}};h=h?m({},r,h):r;return e(n(a),h).then(function(a){return a.data}).catch(function(a){if(a&&a.details&&422===a.details.httpStatus){a=[];for(var b=0,e=p*t;b<e;b++)a[b]=0;return{location:{top:f,left:l,width:p,height:t},valid:!0,data:a}}return c.reject(a)}).then(function(a){if(a.location&&
(a.location.top!==f||a.location.left!==l||a.location.width!==p||a.location.height!==t))throw new b("tilemap:location-mismatch","Tilemap response for different location than requested",{response:a,definition:{top:f,left:l,width:p,height:t}});return g.fromJSON(a)})};g.fromJSON=function(c){g.validateJSON(c);var b=new g;b.location=Object.freeze(a.clone(c.location));b._updateFromData(c.data);return Object.freeze(b)};g.validateJSON=function(a){if(!a||!a.location)throw new b("tilemap:missing-location","Location missing from tilemap response");
if(!1===a.valid)throw new b("tilemap:invalid","Tilemap response was marked as invalid");if(!a.data)throw new b("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(a.data))throw new b("tilemap:data-mismatch","Data must be an array of numbers");if(a.data.length!==a.location.width*a.location.height)throw new b("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return g}();f.Tilemap=l;f.tilemapDefinitionId=function(a){return a.level+"/"+
a.row+"/"+a.col+"/"+a.width+"/"+a.height};f.tilemapDefinitionUrl=n;f.default=l})},"esri/layers/support/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/promiseUtils".split(" "),function(l,f,m,d,b,a,c,n,g){Object.defineProperty(f,"__esModule",{value:!0});l=function(){function e(a,c){this.baseURL=a;this.devicePixelRatio=
c;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}Object.defineProperty(e.prototype,"spriteNames",{get:function(){var a=[],c;for(c in this._spritesData)a.push(c);a.sort();return a},enumerable:!0,configurable:!0});e.prototype.getSpriteInfo=function(a){return this._spritesData[a]};e.prototype.load=function(b){return c(this,void 0,void 0,function(){return a(this,function(a){switch(a.label){case 0:g.throwIfAborted(b);this.loadStatus="loading";
if(!this.baseURL)return[2,g.resolve(this)];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._loadSprites(b)];case 2:return a.sent(),this.loadStatus="loaded",[3,4];case 3:return a.sent(),this.loadStatus="failed",[3,4];case 4:return[2,this]}})})};e.prototype._loadSprites=function(a){var c=this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var e=this.baseURL,h=this._isRetina?"@2x":"",d=""+e+h+".png";return g.all([n(e+h+".json",a),n(d,b({responseType:"image"},a))]).then(function(a){var b=a[0];
a=a[1];var e=Object.keys(b.data);if(!e||0===e.length||1===e.length&&"_ssl"===e[0]||!a||!a.data)return c._spritesData=c.image=null,c.width=c.height=0,g.resolve(null);c._spritesData=b.data;b=a.data;c.width=b.width;c.height=b.height;a=document.createElement("canvas");e=a.getContext("2d");a.width=b.width;a.height=b.height;e.drawImage(b,0,0,b.width,b.height);b=e.getImageData(0,0,b.width,b.height);b=new Uint8Array(b.data);for(e=0;e<b.length;e+=4)a=b[e+3]/255,b[e]*=a,b[e+1]*=a,b[e+2]*=a;c.image=b})};return e}();
f.default=l})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../config ../../request ../../core/promiseUtils ../../core/urlUtils ../../views/2d/engine/vectorTiles/style/VectorTileSource".split(" "),function(l,f,m,d,b,a,c,n,g,e){function h(a){a&&(a=g.getOrigin(a),t&&-1===t.indexOf(a)&&t.push(a))}function k(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];
for(var c=void 0,b=0;b<a.length;++b)g.isProtocolRelative(a[b])?c&&(c=c.split("://")[0]+":"+a[b].trim()):c=g.isAbsolute(a[b])?a[b]:g.join(c,a[b]);return c}function q(a,e,k,f,q){return b(this,void 0,void 0,function(){var b,l,r,v,t,w;return d(this,function(d){switch(d.label){case 0:n.throwIfAborted(q);if("string"!==typeof k)return[3,2];v=g.normalize(k);h(v);t=g.urlToObject(v);return[4,c(t.path,m({query:{f:"json"},responseType:"json"},q))];case 1:return r=d.sent(),l=b=v,[3,3];case 2:r={data:k},b=k.jsonUrl||
null,l=f,d.label=3;case 3:return w=r.data,r.ssl&&(b&&(b=b.replace(/^http:/i,"https:")),l&&(l=l.replace(/^http:/i,"https:"))),w.sources?(a.styleUrl=b||null,[2,u(a,w,l,q)]):w.sources?[2,n.reject("You must specify the URL or the JSON for a service or for a style.")]:a.sourceUrl?[2,p(a,w,l,!1,e,q)]:(a.sourceUrl=b||null,[2,p(a,w,l,!0,e,q)])}})})}function u(a,c,e,f){return b(this,void 0,void 0,function(){var b,m,l,p,r,u;return d(this,function(d){switch(d.label){case 0:b=e?g.removeFile(e):g.appBaseUrl;a.styleBase=
b;a.style=c;a.styleUrl&&h(a.styleUrl);m=[];if(!c.sources||!c.sources.esri)return[3,3];l=c.sources.esri;return l.url?[4,q(a,"esri",k(b,l.url),void 0,f)]:[3,2];case 1:return d.sent(),[3,3];case 2:m.push(q(a,"esri",l,b,f)),d.label=3;case 3:p=0;for(r=Object.keys(c.sources);p<r.length;p++)u=r[p],"esri"!==u&&"vector"===c.sources[u].type&&(c.sources[u].url?m.push(q(a,u,k(b,c.sources[u].url),void 0,f)):m.push(q(a,u,c.sources[u],b,f)));return[4,n.all(m)];case 4:return d.sent(),[2]}})})}function p(a,c,f,m,
l,p){return b(this,void 0,void 0,function(){var b,u,r,t;return d(this,function(d){b=f?g.removeTrailingSlash(f)+"/":g.appBaseUrl;d=b;if(c.hasOwnProperty("tileInfo"))u=c;else{for(var w={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},v=78271.51696400007,x=2.958287637957775E8,y=[],L=c.hasOwnProperty("minzoom")?parseFloat(c.minzoom):0,A=c.hasOwnProperty("maxzoom")?parseFloat(c.maxzoom):16,z=0;z<=A;z++)z>=L&&y.push({level:z,
scale:x,resolution:v}),v/=2,x/=2;v=0;for(x=c.tiles;v<x.length;v++)h(k(d,x[v]));u={capabilities:"TilesOnly",initialExtent:w,fullExtent:w,minScale:y[0].scale,maxScale:y[y.length-1].scale,tiles:c.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:y,spatialReference:{wkid:102100}}}}r=new e(l,b,u);if(!m&&a.primarySourceName in a.sourceNameToSource){t=a.sourceNameToSource[a.primarySourceName];if(!t.isCompatibleWith(r))return[2,n.resolve()];null!=
r.fullExtent&&(null!=t.fullExtent?t.fullExtent.union(r.fullExtent):t.fullExtent=r.fullExtent.clone());t.tileInfo.lods.length<r.tileInfo.lods.length&&(t.tileInfo=r.tileInfo)}m?(a.sourceBase=b,a.source=c,a.validatedSource=u,a.primarySourceName=l,a.sourceUrl&&h(a.sourceUrl)):h(b);a.sourceNameToSource[l]=r;return a.style?[2]:null==c.defaultStyles?[2,n.reject()]:"string"===typeof c.defaultStyles?[2,q(a,"",k(b,c.defaultStyles,"root.json"),void 0,p)]:[2,q(a,"",c.defaultStyles,k(b,"root.json"),p)]})})}Object.defineProperty(f,
"__esModule",{value:!0});var t=a.defaults&&a.defaults.io.corsEnabledServers;f.loadMetadata=function(a,c){return b(this,void 0,void 0,function(){var b,e,n,f,m,l;return d(this,function(d){switch(d.label){case 0:return b={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:""},e="string"===typeof a?[a,null]:[null,a.jsonUrl],n=e[0],f=e[1],m=n?g.urlToObject(n):null,[4,q(b,"esri",a,f,c)];case 1:return d.sent(),l=
{layerDefinition:b.validatedSource,url:n,parsedUrl:m,serviceUrl:b.sourceUrl,style:b.style,styleUrl:b.styleUrl,spriteUrl:b.style.sprite&&k(b.styleBase,b.style.sprite),glyphsUrl:b.style.glyphs&&k(b.styleBase,b.style.glyphs),sourceNameToSource:b.sourceNameToSource,primarySourceName:b.primarySourceName},h(l.spriteUrl),h(l.glyphsUrl),[2,l]}})})}})},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TileIndex".split(" "),
function(l,f,m,d,b,a,c,n,g,e){return function(){function h(h,d,f){this.tileMapURL="";this.fullExtent=this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;this.name=h;if(this.sourceUrl=d)this.parsedUrl=a.urlToObject(this.sourceUrl);h=b.clone(f);var k=h.tiles;d&&k.forEach(function(c,b){a.isAbsolute(c)||(k[b]=a.join(d,c))});this.tileServers=k;f.tileMap&&(this.tileMapURL=a.join(d,f.tileMap));var q=f.capabilities&&f.capabilities.split(",").map(function(a){return a.toLowerCase().trim()}),
m=!!f.exportTilesAllowed,q=!!q&&-1!==q.indexOf("tilemap"),l=m&&f.hasOwnProperty("maxExportTilesCount")?f.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:m,supportsTileMap:q},exportTiles:m?{maxExportTilesCount:+l}:null};this.tileInfo=n.readServiceTileInfo(h.tileInfo,h,null,{ignoreMinMaxLOD:!0});q&&(this.type="vector-tile",this.tilemapCache=new g({layer:this}),this.tileIndex=new e(this.tilemapCache));this.fullExtent=c.fromJSON(f.fullExtent)}h.prototype.getRefKey=function(a,
c){return d(this,void 0,void 0,function(){return m(this,function(b){return this.tileIndex?[2,this.tileIndex.dataKey(a,c)]:[2,a]})})};h.prototype.getSourceTileUrl=function(a,c,b){var e=this.tileServers[c%this.tileServers.length];return e=e.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,c.toString()).replace(/\{x\}/gi,b.toString())};h.prototype.isCompatibleWith=function(a){var c=this.tileInfo;a=a.tileInfo;if(!c.spatialReference.equals(a.spatialReference)||!c.origin.equals(a.origin)||Math.round(c.dpi)!==
Math.round(a.dpi))return!1;c=c.lods;a=a.lods;for(var b=Math.min(c.length,a.length),e=0;e<b;e++){var g=c[e],h=a[e];if(g.level!==h.level||Math.round(g.scale)!==Math.round(h.scale))return!1}return!0};return h}()})},"esri/views/2d/engine/vectorTiles/TileIndex":function(){define(["require","exports","../../../../core/promiseUtils","../../../../layers/support/TilemapCache","../../tiling/TileKey"],function(l,f,m,d,b){return function(){function a(a){if(a instanceof d)this._tilemapCache=a;else if(a&&"index"in
a)this._tilemap=a.index;else throw Error("Invalid tilemap!");}a.prototype.dataKey=function(a,d){if(this._tilemapCache){var c=a.level,e=a.row,h=a.col,k=new b(a);return this._tilemapCache.fetchAvailabilityUpsample(c,e,h,k,d).then(function(){return k}).catch(function(a){if(m.isAbortError(a))throw a;k.level=c;k.row=e;k.col=h;return k})}return this._getIndexedDataKey(a)};a.prototype.forEach=function(a,b,g,e,h){this._callback=h;this._maxLevel=b+a;this._forEach(this._tilemap,b,g,e)};a.prototype._forEach=
function(a,b,g,e){0!==a&&(this._callback(b,g,e),b!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],b+1,2*g,2*e),this._forEach(a[1],b+1,2*g,2*e+1),this._forEach(a[2],b+1,2*g+1,2*e),this._forEach(a[3],b+1,2*g+1,2*e+1)))};a.prototype._getIndexedDataKey=function(a){var c=[a];if(0>a.level||0>a.row||0>a.col||0<a.row>>a.level||0<a.col>>a.level)return m.resolve(null);for(;0!==a.level;)a=new b(a.level-1,a.row>>1,a.col>>1,a.world),c.push(a);a=this._tilemap;var g=c.pop(),e,h;if(1===a)return m.resolve(g);
for(;c.length;)if(e=c.pop(),h=(e.col&1)+((e.row&1)<<1),a){if(0===a[h]){g=null;break}if(1===a[h]){g=e;break}g=e;a=a[h]}return m.resolve(g)};return a}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(l,f,m){return function(){function d(b,a,c,d){this.set(b,a,c,d)}d.from=function(b,a,c,f){return d.pool.acquire(b,a,c,f)};d.getId=function(b,a,c,d){return"object"===typeof b?b.level+"/"+b.row+"/"+b.col+"/"+b.world:b+"/"+a+"/"+c+"/"+d};Object.defineProperty(d.prototype,
"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});d.prototype.equals=function(b){return this.level===b.level&&this.row===b.row&&this.col===b.col&&this.world===b.world};d.prototype.release=function(){this.world=this.col=this.row=this.level=0};d.prototype.set=function(b,a,c,d){null==b?this.world=this.col=this.row=this.level=0:"object"===typeof b?(this.level=b.level||0,this.row=
b.row||0,this.col=b.col||0,this.world=b.world||0):"string"===typeof b?(b=b.split("/"),a=b[1],c=b[2],d=b[3],this.level=parseFloat(b[0]),this.row=parseFloat(a),this.col=parseFloat(c),this.world=parseFloat(d)):(this.level=+b,this.row=+a,this.col=+c,this.world=+d||0);return this};d.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};d.prototype.getChildKeys=function(){var b=this.level+1,a=this.row<<1,c=this.col<<1,f=this.world;return[d.pool.acquire(b,a,c,f),d.pool.acquire(b,
a,c+1,f),d.pool.acquire(b,a+1,c,f),d.pool.acquire(b,a+1,c+1,f)]};d.prototype.compareRowMajor=function(b){return this.row<b.row?-1:this.row>b.row?1:this.col<b.col?-1:this.col>b.col?1:0};d.sort=function(b){return b.map(function(a){return d.from(a)}).sort(function(a,c){return a.compareRowMajor(c)}).map(function(a){return a.id})};d.pool=new m(d,!0,null,25,50);return d}()})},"esri/portal/support/jsonContext":function(){define(["require","exports","../../core/urlUtils","../Portal"],function(l,f,m,d){Object.defineProperty(f,
"__esModule",{value:!0});f.createForItem=function(b){return{origin:"portal-item",url:m.urlToObject(b.itemUrl),portal:b.portal||d.getDefault()}}})},"esri/views/2d/engine/vectorTiles/SchemaHelper":function(){define(["require","exports","../../../../layers/support/LOD","../../../../layers/support/TileInfo"],function(l,f,m,d){return function(){function b(a,c){this.lockedSchemaPixelSize=a;this.isGCS=c}b.prototype.getLevelRowColumn=function(a){return this.isGCS?[a[0],a[1]>>1,a[2]>>1]:256===this.lockedSchemaPixelSize&&
0<a[0]?[a[0]-1,a[1]>>1,a[2]>>1]:a};b.prototype.adjustLevel=function(a){return this.isGCS?a:256===this.lockedSchemaPixelSize?0<a?a-1:0:a};b.prototype.getShift=function(a,c){var b=0,g=0;if(256===this.lockedSchemaPixelSize||this.isGCS)a[2]%2&&(b=2*c),a[1]%2&&(g=2*c);return[b,g]};b.prototype.getScale=function(a){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 2}else if(256===this.lockedSchemaPixelSize&&0===a)return.5;return 1};b.create256x256CompatibleTileInfo=function(a){if(!a)return null;
if(256===a.size[0]&&256===a.size[1])return a;for(var b=a.spatialReference.isGeographic,f=[],g=a.lods.length,e=0;e<g;e++){var h=a.lods[e];f.push(new m({level:h.level,scale:h.scale,resolution:b?h.resolution:2*h.resolution}))}return new d({size:[256,256],dpi:a.dpi,format:a.format,compressionQuality:a.compressionQuality,origin:a.origin,spatialReference:a.spatialReference,lods:f})};b.create512x512CompatibleTileInfo=function(a){if(!a||256===a.size[0]||256===a.size[1])return null;for(var b=[],f=a.lods.length,
g=0;g<f;g++){var e=a.lods[g];b.push(new m({level:e.level,scale:e.scale,resolution:.5*e.resolution}))}return new d({size:[512,512],dpi:a.dpi,format:a.format,compressionQuality:a.compressionQuality,origin:a.origin,spatialReference:a.spatialReference,lods:b})};return b}()})},"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["require","exports","../../../../layers/support/TileInfo"],function(l,f,m){Object.defineProperty(f,"__esModule",{value:!0});f.areSchemasOverlapping=function(d,b){if(d===
b)return!0;if(!d&&null!=b||null!=d&&!b||!d.spatialReference.equals(b.spatialReference)||d.dpi!==b.dpi)return!1;var a=d.origin,c=b.origin;if(1E-6<=Math.abs(a.x-c.x)||1E-6<=Math.abs(a.y-c.y))return!1;d.lods[0].scale>b.lods[0].scale?(a=d,d=b):a=b;for(b=a.lods[0].scale;b>=d.lods[d.lods.length-1].scale-1E-6;b/=2)if(1E-6>Math.abs(b-d.lods[0].scale))return!0;return!1};f.unionTileInfos=function(d,b){if(d===b)return d;if(!d&&null!=b)return b;if(null!=d&&!b)return d;var a=d.size[0],c=d.format,f=d.dpi,g={x:d.origin.x,
y:d.origin.y},e=d.spatialReference.toJSON(),h=d.lods[0].scale>b.lods[0].scale?d.lods[0]:b.lods[0];d=(d.lods[d.lods.length-1].scale<=b.lods[b.lods.length-1].scale?d.lods[d.lods.length-1]:b.lods[b.lods.length-1]).scale;b=[];for(var k=h.scale,h=h.resolution,q=0;k>d;)b.push({level:q,resolution:h,scale:k}),q++,k/=2,h/=2;return new m({size:[a,a],dpi:f,format:c||"pbf",origin:g,lods:b,spatialReference:e})}})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["require","exports",
"../../../../../core/has","./StyleLayer"],function(l,f,m,d){return function(){function b(a,c){this._layerByName={};this.styleJSON=a;this.version=parseFloat(a.version);this.sprite=c?c.spriteUrl:a.sprite;this.glyphs=c?c.glyphsUrl:a.glyphs;if(this.layers=(a.layers||[]).map(b._create))for(a=void 0,c=0;c<this.layers.length;c++)a=this.layers[c],this._layerByName[a.id.toLowerCase()]=a;this._identifyRefLayers()}b.prototype.isPainterDataDriven=function(a){return(a=this._layerByName[a.toLowerCase()])?a.isPainterDataDriven():
!1};b.prototype.getStyleLayerId=function(a){return a>=this.layers.length?null:this.layers[a].id};b.prototype.getLayoutProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.layout:null};b.prototype.getPaintProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.paint:null};b.prototype.setPaintProperties=function(a,c){a=this._layerByName[a.toLowerCase()];if(!a)return"";var d=this.layers.indexOf(a);this.styleJSON.layers[d].paint=c;c=b._recreateLayer({id:a.id,type:a.typeName,
source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:c},a);this.layers[d]=c;this._layerByName[a.id.toLowerCase()]=c;return a.id};b.prototype.setLayoutProperties=function(a,c){a=this._layerByName[a.toLowerCase()];if(!a)return"";var d=this.layers.indexOf(a);this.styleJSON.layers[d].layout=c;c=b._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:c,
paint:a.paint},a);this.layers[d]=c;this._layerByName[a.id.toLowerCase()]=c;return a.id};b.prototype._identifyRefLayers=function(){for(var a=[],b=[],d=0,g=0,e=this.layers;g<e.length;g++){var h=e[g];if(1===h.type){var k=h,f=h.source+"|"+h.sourceLayer,f=f+("|"+JSON.stringify(h.layout&&h.layout.visibility)),f=f+("|"+JSON.stringify(h.minzoom)),f=f+("|"+JSON.stringify(h.maxzoom)),f=f+("|"+JSON.stringify(h.filter));if(k.hasDataDrivenFill||k.hasDataDrivenOutline)f+="|"+JSON.stringify(d);a.push({key:f,layer:h})}2===
h.type&&(k=h,f=h.source+"|"+h.sourceLayer,f+="|"+JSON.stringify(h.layout&&h.layout.visibility),f+="|"+JSON.stringify(h.minzoom),f+="|"+JSON.stringify(h.maxzoom),f+="|"+JSON.stringify(h.filter),f+="|"+JSON.stringify(h.layout&&h.layout["line-cap"]),f+="|"+JSON.stringify(h.layout&&h.layout["line-join"]),k.hasDataDrivenLine&&(f+="|"+JSON.stringify(d)),b.push({key:f,layer:h}));++d}this._assignRefLayers(a);this._assignRefLayers(b)};b.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<
b.key?-1:a.key>b.key?1:0});for(var b,d,g=a.length,e=0;e<g;e++){var h=a[e];if(h.key===b)h.layer.refLayerId=d;else if(b=h.key,d=h.layer.id,1===h.layer.type&&!h.layer.getPaintProperty("fill-outline-color"))for(var k=e+1;k<g;k++){var f=a[k];if(f.key===b){if(f.layer.getPaintProperty("fill-outline-color")){a[e]=f;a[k]=h;d=f.layer.id;break}}else break}}};b._create=function(a,b,f){b=1-1/(f.length+1)*(1+b);switch(a.type){case "background":return new d.BackgroundStyleLayer(0,a,b);case "fill":return new d.FillStyleLayer(1,
a,b);case "line":return new d.LineStyleLayer(2,a,b);case "symbol":return new d.SymbolStyleLayer(3,a,b);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new d.CircleStyleLayer(4,a,b)}throw Error("Unknown vector tile layer");};b._recreateLayer=function(a,b){switch(a.type){case "background":return new d.BackgroundStyleLayer(0,a,b.z);case "fill":return new d.FillStyleLayer(1,a,b.z);case "line":return new d.LineStyleLayer(2,a,b.z);case "symbol":return new d.SymbolStyleLayer(3,
a,b.z);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new d.CircleStyleLayer(4,a,b.z)}};return b}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),function(l,f,m,d,b,a,c){Object.defineProperty(f,"__esModule",{value:!0});l=function(){function c(a,c,g){this.type=a;this.typeName=c.type;this.id=c.id;
this.source=c.source;this.sourceLayer=c["source-layer"];this.minzoom=c.minzoom;this.maxzoom=c.maxzoom;this.filter=c.filter;this.layout=c.layout;this.paint=c.paint;this.z=g;switch(a){case 0:this._layoutDefinition=b.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=b.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=b.StyleDefinition.fillLayoutDefinition;this._paintDefinition=b.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=b.StyleDefinition.lineLayoutDefinition;
this._paintDefinition=b.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=b.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=b.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=b.StyleDefinition.circleLayoutDefinition,this._paintDefinition=b.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}c.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?
this._featureFilter:this._featureFilter=d.createFilter(this.filter)};c.prototype.getLayoutProperty=function(a){var b=this._layoutProperties;if(b)return b[a]};c.prototype.getPaintProperty=function(a){var b=this._paintProperties;if(b)return b[a]};c.prototype.getLayoutValue=function(a,b,c){var e,g=this._layoutProperties;g&&(g=g[a])&&(e=g.getValue(b,c));a=this._layoutDefinition[a];void 0===e&&(e=a["default"]);"enum"===a.type&&(e=a.values.indexOf(e));return e};c.prototype.getPaintValue=function(a,b,c){var e,
g=this._paintProperties;g&&(g=g[a])&&(e=g.getValue(b,c));a=this._paintDefinition[a];void 0===e&&(e=a["default"]);"enum"===a.type&&(e=a.values.indexOf(e));return e};c.prototype.isPainterDataDriven=function(){var a=this._paintProperties;if(a)for(var b in a)if(a[b].isDataDriven)return!0;return!1};c.prototype._parseLayout=function(b){var c={},e;for(e in b){var g=this._layoutDefinition[e];g&&(c[e]=new a(e,g,b[e]))}return c};c.prototype._parsePaint=function(b){var c={},e;for(e in b){var g=this._paintDefinition[e];
g&&(c[e]=new a(e,g,b[e]))}return c};return c}();f.StyleLayer=l;var n=function(a){function b(b,c,e){return a.call(this,b,c,e)||this}m(b,a);return b}(l);f.BackgroundStyleLayer=n;n=function(a){function b(b,c,e){b=a.call(this,b,c,e)||this;c=b.getPaintProperty("fill-color");b.hasDataDrivenColor=c?c.isDataDriven:!1;c=b.getPaintProperty("fill-opacity");b.hasDataDrivenOpacity=c?c.isDataDriven:!1;b.hasDataDrivenFill=b.hasDataDrivenColor||b.hasDataDrivenOpacity;c=b.getPaintProperty("fill-outline-color");b.outlineUsesFillColor=
!c;b.hasDataDrivenOutlineColor=c?c.isDataDriven:!1;b.hasDataDrivenOutline=(c?b.hasDataDrivenOutlineColor:b.hasDataDrivenColor)||b.hasDataDrivenOpacity;return b}m(b,a);return b}(l);f.FillStyleLayer=n;n=function(a){function e(e,g,d){e=a.call(this,e,g,d)||this;d=e.getPaintProperty("line-color");e.hasDataDrivenColor=d?d.isDataDriven:!1;d=e.getPaintProperty("line-opacity");e.hasDataDrivenOpacity=d?d.isDataDriven:!1;d=e.getPaintProperty("line-width");e.hasDataDrivenWidth=d?d.isDataDriven:!1;e.hasDataDrivenLine=
e.hasDataDrivenColor||e.hasDataDrivenOpacity||e.hasDataDrivenWidth;g=g.paint["line-width"];g||(g=b.StyleDefinition.linePaintDefinition["line-width"].default);e.isThinLine=!e.hasDataDrivenWidth&&"number"===typeof g&&g<c.THIN_LINE_THRESHOLD;return e}m(e,a);return e}(l);f.LineStyleLayer=n;n=function(a){function b(b,c,e){b=a.call(this,b,c,e)||this;c=b.getPaintProperty("icon-color");b.hasDataDrivenIconColor=c?c.isDataDriven:!1;c=b.getPaintProperty("icon-opacity");b.hasDataDrivenIconOpacity=c?c.isDataDriven:
!1;c=b.getLayoutProperty("icon-size");b.hasDataDrivenIconSize=c?c.isDataDriven:!1;b.hasDataDrivenIcon=b.hasDataDrivenIconColor||b.hasDataDrivenIconOpacity||b.hasDataDrivenIconSize;c=b.getPaintProperty("text-color");b.hasDataDrivenTextColor=c?c.isDataDriven:!1;c=b.getPaintProperty("text-opacity");b.hasDataDrivenTextOpacity=c?c.isDataDriven:!1;c=b.getLayoutProperty("text-size");b.hasDataDrivenTextSize=c?c.isDataDriven:!1;b.hasDataDrivenText=b.hasDataDrivenTextColor||b.hasDataDrivenTextOpacity||b.hasDataDrivenTextSize;
return b}m(b,a);return b}(l);f.SymbolStyleLayer=n;l=function(a){function b(b,c,e){b=a.call(this,b,c,e)||this;c=b.getPaintProperty("circle-radius");b.hasDataDrivenRadius=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-color");b.hasDataDrivenColor=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-opacity");b.hasDataDrivenOpacity=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-width");b.hasDataDrivenStrokeWidth=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-color");b.hasDataDrivenStrokeColor=
c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-opacity");b.hasDataDrivenStrokeOpacity=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-blur");b.hasDataDrivenBlur=c?c.isDataDriven:!1;return b}m(b,a);return b}(l);f.CircleStyleLayer=l;l=function(){return function(a,b,c){this.cap=a.getLayoutValue("line-cap",b,c);this.join=a.getLayoutValue("line-join",b,c);this.miterLimit=a.getLayoutValue("line-miter-limit",b,c);this.roundLimit=a.getLayoutValue("line-round-limit",b,c)}}();f.LineLayout=l;l=function(){return function(a,
b,c,d){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b,d);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",b,d);this.optional=a.getLayoutValue("icon-optional",b,d);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b,d);this.size=a.getLayoutValue("icon-size",b,d);this.rotate=a.getLayoutValue("icon-rotate",b,d);this.padding=a.getLayoutValue("icon-padding",b,d);this.keepUpright=a.getLayoutValue("icon-keep-upright",b,d);this.offset=a.getLayoutValue("icon-offset",
b,d);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();f.IconLayout=l;l=function(){return function(a,b,c,d){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b,d);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b,d);this.optional=a.getLayoutValue("text-optional",b,d);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",b,d);this.fontArray=a.getLayoutValue("text-font",b,d);this.maxWidth=a.getLayoutValue("text-max-width",b,d);this.lineHeight=a.getLayoutValue("text-line-height",
b,d);this.letterSpacing=a.getLayoutValue("text-letter-spacing",b,d);this.justify=a.getLayoutValue("text-justify",b,d);this.anchor=a.getLayoutValue("text-anchor",b,d);this.maxAngle=a.getLayoutValue("text-max-angle",b,d);this.size=a.getLayoutValue("text-size",b,d);this.rotate=a.getLayoutValue("text-rotate",b,d);this.padding=a.getLayoutValue("text-padding",b,d);this.keepUpright=a.getLayoutValue("text-keep-upright",b,d);this.transform=a.getLayoutValue("text-transform",b,d);this.offset=a.getLayoutValue("text-offset",
b,d);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();f.TextLayout=l})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["require","exports"],function(l,f){return function(){function f(d,b,a){this._op=d;"$type"===b?(this._val=a instanceof Array?a.map(function(a){return f._types.indexOf(a)}):f._types.indexOf(a),this._op+=11):(this._key=b,this._val=a)}f.prototype.filter=function(d){switch(this._op){case 0:return this._val;case 1:return d.values[this._key]===this._val;
case 2:return d.values[this._key]!==this._val;case 3:return d.values[this._key]<this._val;case 4:return d.values[this._key]>this._val;case 5:return d.values[this._key]<=this._val;case 6:return d.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(d.values[this._key]);case 8:return-1===this._val.indexOf(d.values[this._key]);case 9:for(var b=0,a=this._val;b<a.length;b++){var c=a[b];if(c.filter(d))return!0}return!1;case 10:b=0;for(a=this._val;b<a.length;b++)if(c=a[b],!c.filter(d))return!1;
return!0;case 11:b=0;for(a=this._val;b<a.length;b++)if(c=a[b],c.filter(d))return!1;return!0;case 12:return d.type===this._val;case 13:return d.type!==this._val;case 14:return d.type<this._val;case 15:return d.type>this._val;case 16:return d.type>=this._val;case 17:return d.type<=this._val;case 18:return-1!==this._val.indexOf(d.type);case 19:return-1===this._val.indexOf(d.type);case 20:return void 0!==d.values[this._key];case 21:return void 0===d.values[this._key]}};f.createFilter=function(d){if(!d)return new f(0,
void 0,!0);var b=d[0];if(1>=d.length)return new f(0,void 0,"any"!==b);switch(b){case "\x3d\x3d":return new f(1,d[1],d[2]);case "!\x3d":return new f(2,d[1],d[2]);case "\x3e":return new f(4,d[1],d[2]);case "\x3c":return new f(3,d[1],d[2]);case "\x3e\x3d":return new f(6,d[1],d[2]);case "\x3c\x3d":return new f(5,d[1],d[2]);case "in":return new f(7,d[1],d.slice(2));case "!in":return new f(8,d[1],d.slice(2));case "any":return new f(9,void 0,d.slice(1).map(f.createFilter.bind(this)));case "all":return new f(10,
void 0,d.slice(1).map(f.createFilter.bind(this)));case "none":return new f(11,void 0,d.slice(1).map(f.createFilter.bind(this)));case "has":return new f(20,d[1],void 0);case "!has":return new f(21,d[1],void 0);default:throw Error("invalid operator: "+b);}};f._types=["Unknown","Point","LineString","Polygon"];return f}()})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(l,f){Object.defineProperty(f,"__esModule",{value:!0});l=function(){function f(){}
f.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};f.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};f.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",
default:1.05}};f.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},"icon-rotation-alignment":{type:"enum",values:["map",
"viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",minimum:0,default:2},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},
"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",default:0},
"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}};f.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};f.backgroundPaintDefinition=
{"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}};f.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map",
"viewport"],default:"map"},"fill-pattern":{type:"string"}};f.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",default:[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",
minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}};f.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};f.rasterPaintDefinition={"raster-opacity":{type:"number",
minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};f.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",
minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}};return f}();f.StyleDefinition=l})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["require",
"exports","../../../../../Color","../GeometryUtils"],function(l,f,m,d){return function(){function b(a,c,d){this.isDataDriven=!1;switch(c.type){case "number":a=!0;break;case "color":a=!0;d=b._parseColor(d);break;case "array":a="number"===c.value;break;default:a=!1}null==d&&(d=c.default);a&&"interval"===d.type&&(a=!1);var f=d&&d.stops&&0<d.stops.length;if(f)for(var e=0,h=d.stops;e<h.length;e++){var k=h[e];k[1]=this._validate(k[1],c)}if(this.isDataDriven=d?!!d.property:!1)if(void 0!==d.default&&(d.default=
this._validate(d.default,c)),f)switch(d.type){case "identity":this.getValue=this._buildIdentity(d,c);break;case "categorical":this.getValue=this._buildCategorical(d,c);break;default:this.getValue=a?this._buildInterpolate(d,c):this._buildInterval(d,c)}else this.getValue=this._buildIdentity(d,c);else f?this.getValue=a?this._buildZoomInterpolate(d):this._buildZoomInterval(d):(d=this._validate(d,c),this.getValue=this._buildSimple(d))}b.prototype._validate=function(a,b){if("number"===b.type){if(a<b.minimum)return b.minimum;
if(a>b.maximum)return b.maximum}return a};b.prototype._buildSimple=function(a){return function(){return a}};b.prototype._buildIdentity=function(a,c){var d=this;return function(f,e){var g;e&&(g=e.values[a.property],"color"===c.type&&(g=b._parseColor(g)));void 0===g&&(g=a.default);return void 0!==g?d._validate(g,c):c.default}};b.prototype._buildCategorical=function(a,b){var c=this;return function(d,e){var f;e&&(f=e.values[a.property]);f=c._categorical(f,a.stops);return void 0!==f?f:void 0!==a.default?
a.default:b.default}};b.prototype._buildInterval=function(a,b){var c=this;return function(d,e){var f;e&&(f=e.values[a.property]);return"number"===typeof f?c._interval(f,a.stops):void 0!==a.default?a.default:b.default}};b.prototype._buildInterpolate=function(a,b){var c=this;return function(d,e){var f;e&&(f=e.values[a.property]);return"number"===typeof f?c._interpolate(f,a.stops,a.base||1):void 0!==a.default?a.default:b.default}};b.prototype._buildZoomInterpolate=function(a){var b=this;return function(c){return b._interpolate(c,
a.stops,a.base||1)}};b.prototype._buildZoomInterval=function(a){var b=this;return function(c){return b._interval(c,a.stops)}};b.prototype._categorical=function(a,b){for(var c=b.length,d=0;d<c;d++)if(b[d][0]===a)return b[d][1]};b.prototype._interval=function(a,b){for(var c=b.length,d=0,e=0;e<c;e++)if(b[e][0]<=a)d=e;else break;return b[d][1]};b.prototype._interpolate=function(a,b,f){for(var c,e,h=b.length,k=0;k<h;k++){var l=b[k];if(l[0]<=a)c=l;else{e=l;break}}if(c&&e){k=e[0]-c[0];a-=c[0];f=1===f?a/
k:(Math.pow(f,a)-1)/(Math.pow(f,k)-1);if(Array.isArray(c[1])){c=c[1];e=e[1];a=[];for(k=0;k<c.length;k++)a.push(d.interpolate(c[k],e[k],f));return a}return d.interpolate(c[1],e[1],f)}if(c)return c[1];if(e)return e[1]};b._isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};b._parseColor=function(a){if(Array.isArray(a))return a;if("string"===typeof a){if(a=new m(a),!this._isEmpty(a))return m.toUnitRGBA(a)}else return a&&a.default&&(a.default=b._parseColor(a.default)),a&&a.stops&&
(a.stops=a.stops.map(function(a){return[a[0],b._parseColor(a[1])]})),a};return b}()})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(l,f){function m(b,a){b%=a;return 0<=b?b:b+a}Object.defineProperty(f,"__esModule",{value:!0});f.C_INFINITY=Number.POSITIVE_INFINITY;f.C_PI=Math.PI;f.C_2PI=2*f.C_PI;f.C_PI_BY_2=f.C_PI/2;f.C_RAD_TO_256=128/f.C_PI;f.C_256_TO_RAD=f.C_PI/128;f.C_DEG_TO_256=256/360;f.C_DEG_TO_RAD=f.C_PI/180;f.C_SQRT2=1.414213562;f.C_SQRT2_INV=
1/f.C_SQRT2;var d=1/Math.LN2;f.positiveMod=m;f.radToByte=function(b){return m(b*f.C_RAD_TO_256,256)};f.degToByte=function(b){return m(b*f.C_DEG_TO_256,256)};f.log2=function(b){return Math.log(b)*d};f.sqr=function(b){return b*b};f.interpolate=function(b,a,c){return b*(1-c)+a*c};f.between=function(b,a,c){return b>=a&&b<=c||b>=c&&b<=a}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(l,f){Object.defineProperty(f,"__esModule",{value:!0});f.WEBGL_MAX_STOPS=8;
f.WEBGL_MAX_INNER_STOPS=f.WEBGL_MAX_STOPS-2;f.NAN_MAGIC_NUMBER=1E-30;f.EXTRUDE_SCALE=64;f.PICTURE_FILL_COLOR=4294967295;f.TILE_SIZE=512;f.ANGLE_FACTOR_256=256/360;f.DEBUG_LABELS=!1;f.COLLISION_BUCKET_SIZE=128;f.DOT_DENSITY_MAX_FIELDS=8;f.COLLISION_MAX_ZOOM_DELTA=3;f.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;f.COLLISION_BOX_PADDING=8;f.COLLISION_TILE_BOX_SIZE=f.TILE_SIZE/f.COLLISION_BUCKET_SIZE;f.COLLISION_PLACEMENT_PADDING=8;f.HEURISTIC_GLYPHS_PER_LINE=50;f.HEURISTIC_GLYPHS_PER_FEATURE=10;f.GLYPH_SIZE=
24;f.TEXT_LINE_HEIGHT=1.2*f.GLYPH_SIZE;f.TEXT_MAX_WIDTH=10*f.GLYPH_SIZE;f.TEXT_SPACING=0;f.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};f.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;f.TEXTURE_BINDING_SPRITE_ATLAS=0;f.TEXTURE_BINDING_GLYPH_ATLAS=0;f.TEXTURE_BINDING_HIGHLIGHT_0=2;f.TEXTURE_BINDING_HIGHLIGHT_1=3;f.TEXTURE_BINDING_ATTRIBUTE_DATA_0=4;f.TEXTURE_BINDING_ATTRIBUTE_DATA_1=5;f.TEXTURE_BINDING_ATTRIBUTE_DATA_2=6;f.TEXTURE_BINDING_RENDERER_0=7;f.TEXTURE_BINDING_RENDERER_1=
8;f.MAX_FILTERS=2;f.FILTER_FLAG_0=1;f.EFFECT_FLAG_0=2;f.THIN_LINE_THRESHOLD=2.5})},"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../request ../core/Error ../core/global ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/urlUtils ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ArcGISCachedService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/SpriteSource ./support/TileInfo ./support/TilemapCache ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/2d/engine/vectorTiles/SchemaHelper ../views/2d/engine/vectorTiles/tileInfoUtils ../views/2d/engine/vectorTiles/style/StyleRepository".split(" "),function(l,
f,m,d,b,a,c,n,g,e,h,k,q,u,p,t,r,v,w,x,E,D,F,G,H,I,J,B,C,K){return function(f){function h(a,b){a=f.call(this)||this;a._spriteSourceMap=new Map;a.currentStyleInfo=null;a.style=null;a.isReference=null;a.operationalLayerType="VectorTileLayer";a.type="vector-tile";a.url=null;return a}d(h,f);h.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?m({url:a},b):a};h.prototype.load=function(b){var d=this,e=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},b).then(function(){return c(d,
void 0,void 0,function(){var c,d;return a(this,function(a){switch(a.label){case 0:if(!this.portalItem||!this.portalItem.id)return[2];c=this.portalItem.itemUrl+"/resources/styles/root.json";return[4,n(c,m({},b,{query:{f:"json"}}))];case 1:return d=a.sent(),d.data&&this.read({url:c},J.createForItem(this.portalItem)),[2]}})})}).then(function(){return d.loadStyle(null,b)},function(){return d.loadStyle(null,b)});this.addResolvingPromise(e);return this.when()};Object.defineProperty(h.prototype,"attributionDataUrl",
{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&u.urlToObject(a.serviceUrl))?this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"capabilities",{get:function(){var a=this._getPrimarySource();return a?a.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"fullExtent",{get:function(){var a=this._getPrimarySource();return a?
a.fullExtent:null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parsedUrl",{get:function(){return this.serviceUrl?q.urlToObject(this.serviceUrl):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,
configurable:!0});Object.defineProperty(h.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0});h.prototype.writeStyleUrl=function(a,b){a&&u.isProtocolRelative(a)&&(a="https:"+a);b.styleUrl=a};Object.defineProperty(h.prototype,"tileIndexType",{get:function(){var a=this._getPrimarySource();return a?a.type:""},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"tileIndexUrl",{get:function(){var a=this._getPrimarySource();
return a?a.tileMapURL:""},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"tileInfo",{get:function(){var a=[],b;for(b in this.sourceNameToSource)a.push(this.sourceNameToSource[b]);b=this._getPrimarySource().tileInfo;if(1<a.length)for(var c=0;c<a.length;c++)C.areSchemasOverlapping(b,a[c].tileInfo)&&(b=C.unionTileInfos(b,a[c].tileInfo));return b},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"tilemapCache",{get:function(){var a=this._getPrimarySource();return a?
a.capabilities.operations.supportsTileMap?a.tilemapCache:null:null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"tileServers",{get:function(){var a=this._getPrimarySource();return a?a.tileServers:[]},enumerable:!0,configurable:!0});h.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};Object.defineProperty(h.prototype,"compatibleTileInfo256",{get:function(){return B.create256x256CompatibleTileInfo(this.tileInfo)},enumerable:!0,
configurable:!0});Object.defineProperty(h.prototype,"compatibleTileInfo512",{get:function(){return B.create512x512CompatibleTileInfo(this.tileInfo)},enumerable:!0,configurable:!0});h.prototype.loadSpriteSource=function(b,d){void 0===b&&(b=1);return c(this,void 0,void 0,function(){var c,e;return a(this,function(a){this._spriteSourceMap.has(b)||(c=new F.default(this.styleRepository.sprite,b),this._spriteSourceMap.set(b,c.load()));e=this._spriteSourceMap.get(b);return[2,k.create(function(a,b){e.then(a,
b);k.onAbortOrThrow(d,b)})]})})};h.prototype.loadStyle=function(b,d){return c(this,void 0,void 0,function(){var c,f,g,h=this;return a(this,function(a){c=b||this.style||this.url;if(this._loadingPromise&&"string"===typeof c&&this.url===c&&k.isAborted(this._abortController))return[2,this._loadingPromise];(f=this._abortController)&&f.abort();g=k.createAbortController();this._loadingPromise=k.create(function(a,b){var f={signal:g.signal};h._getSourceAndStyle(c,f).then(function(){h.loadSpriteSource(e.devicePixelRatio||
1,f);a()}).catch(b);k.onAbort(d,function(){g.abort()})});this._abortController=g;return[2,this._loadingPromise]})})};h.prototype.getStyleLayerId=function(a){return this.styleRepository.getStyleLayerId(a)};h.prototype.getPaintProperties=function(a){return this.styleRepository.getPaintProperties(a)};h.prototype.setPaintProperties=function(a,b){var c=this.styleRepository.isPainterDataDriven(a),d=this.styleRepository.setPaintProperties(a,b),e=this.styleRepository.isPainterDataDriven(a);this.emit("paint-change",
{layer:d,paint:b});(c||e)&&this.emit("layout-change",{layer:d,layout:this.styleRepository.getLayoutProperties(a)})};h.prototype.getLayoutProperties=function(a){return this.styleRepository.getLayoutProperties(a)};h.prototype.setLayoutProperties=function(a,b){a=this.styleRepository.setLayoutProperties(a,b);this.emit("layout-change",{layer:a,layout:b})};h.prototype.getTileUrl=function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,
b.toString()).replace(/\{x\}/gi,c.toString())};h.prototype.write=function(a,b){return b&&b.origin&&!this.styleUrl?(b.messages&&b.messages.push(new g("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,[a,b])};h.prototype.importLayerViewModule=function(b){return c(this,void 0,void 0,function(){return a(this,function(a){switch(b.type){case "2d":return[2,k.create(function(a){return l(["../views/2d/layers/VectorTileLayerView2D"],
a)})];case "3d":return[2,k.create(function(a){return l(["../views/3d/layers/VectorTileLayerView3D"],a)})]}return[2]})})};h.prototype._getSourceAndStyle=function(b,d){return c(this,void 0,void 0,function(){var c;return a(this,function(a){switch(a.label){case 0:return b?[4,I.loadMetadata(b,d)]:[2,k.reject(Error("invalid style!"))];case 1:return c=a.sent(),this._set("currentStyleInfo",{serviceUrl:c.serviceUrl,styleUrl:c.styleUrl,spriteUrl:c.spriteUrl,glyphsUrl:c.glyphsUrl,style:c.style,layerDefinition:c.layerDefinition}),
"string"===typeof b?(this.url=b,this.style=null):(this.url=null,this.style=b),this._set("sourceNameToSource",c.sourceNameToSource),this._set("primarySourceName",c.primarySourceName),this._set("styleRepository",new K(c.style,c)),this.read(c.layerDefinition,{origin:"service"}),[2]}})})};h.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta|basemapsdev)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3]&&
b[3].toLowerCase()))for(var b=b[2]||"",c=0,d="OpenStreetMap_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84".split(" ");c<d.length;c++){var e=d[c];if(-1<e.toLowerCase().indexOf(a))return u.normalize("//static.arcgis.com/attribution/Vector"+b+"/"+e)}};h.prototype._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:
null};b([p.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],h.prototype,"attributionDataUrl",null);b([p.property({type:["show","hide"]})],h.prototype,"listMode",void 0);b([p.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"capabilities",null);b([p.property({readOnly:!0})],h.prototype,"currentStyleInfo",void 0);b([p.property({json:{read:!1},readOnly:!0,type:t,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"fullExtent",
null);b([p.property()],h.prototype,"style",void 0);b([p.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],h.prototype,"isReference",void 0);b([p.property({type:["VectorTileLayer"]})],h.prototype,"operationalLayerType",void 0);b([p.property({readOnly:!0,dependsOn:["serviceUrl"]})],h.prototype,"parsedUrl",null);b([p.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],h.prototype,"serviceUrl",null);b([p.property({type:r,dependsOn:["tileInfo"],
readOnly:!0})],h.prototype,"spatialReference",null);b([p.property({readOnly:!0})],h.prototype,"styleRepository",void 0);b([p.property({readOnly:!0})],h.prototype,"sourceNameToSource",void 0);b([p.property({readOnly:!0})],h.prototype,"primarySourceName",void 0);b([p.property({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],h.prototype,"styleUrl",null);b([p.writer(["portal-item","web-document"],
"styleUrl")],h.prototype,"writeStyleUrl",null);b([p.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"tileIndexType",null);b([p.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"tileIndexUrl",null);b([p.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:G,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"tileInfo",null);b([p.property({json:{read:!1},
readOnly:!0,type:H,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"tilemapCache",null);b([p.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],h.prototype,"tileServers",null);b([p.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],h.prototype,"type",void 0);b([p.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],h.prototype,"url",void 0);b([p.property({readOnly:!0})],
h.prototype,"version",void 0);b([p.reader("version",["version","currentVersion"])],h.prototype,"readVersion",null);b([p.property({readOnly:!0,dependsOn:["tileInfo"]})],h.prototype,"compatibleTileInfo256",null);b([p.property({readOnly:!0,dependsOn:["tileInfo"]})],h.prototype,"compatibleTileInfo512",null);return h=b([p.subclass("esri.layers.VectorTileLayer")],h)}(p.declared(v,x,E,D,h,w))});