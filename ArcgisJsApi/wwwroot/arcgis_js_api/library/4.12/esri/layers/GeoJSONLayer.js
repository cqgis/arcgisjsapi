// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/paramHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../geometry ../PopupTemplate ../renderers ../core/asyncUtils ../core/jsonMap ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ./Layer ./graphics/editingSupport ./graphics/sources/GeoJSONSource ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/FeatureReduction ./support/FeatureReductionSelection ./support/FeatureTemplate ./support/FeatureType ./support/Field ./support/FieldsIndex ./support/fieldUtils ./support/LabelClass ../support/popupUtils ../symbols/support/ElevationInfo ../tasks/support/Query".split(" "),
function(h,P,q,c,Q,R,r,t,f,u,k,v,w,x,l,y,b,z,A,B,C,D,E,F,G,H,I,J,K,g,L,M,N,e){var O=new w.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"});return function(m){function a(d){d=m.call(this)||this;d.copyright=null;d.definitionExpression=null;d.displayField=null;d.editingEnabled=!0;d.elevationInfo=null;d.featureReduction=null;d.fields=null;d.fullExtent=null;d.geometryType=null;d.hasZ=void 0;d.labelsVisible=!0;d.labelingInfo=
null;d.legendEnabled=!0;d.objectIdField=null;d.popupEnabled=!0;d.popupTemplate=null;d.screenSizePerspectiveEnabled=!0;d.source=null;d.spatialReference=f.SpatialReference.WGS84;d.templates=null;d.title="GeoJSON";d.type="geojson";d.typeIdField=null;d.types=null;d.url=null;return d}q(a,m);a.prototype.load=function(d){var a=this,b=new B.default({layer:this});this._set("source",b);this.addResolvingPromise(b.load(d).then(function(){a.read(b.layerDefinition,{origin:"service",url:a.parsedUrl});a.revert(["objectIdField",
"fields","timeInfo"],"service");g.fixRendererFields(a.renderer,a.fields);g.fixTimeInfoFields(a.timeInfo,a.fields)}));return this.when()};Object.defineProperty(a.prototype,"capabilities",{get:function(){return this.source?this.source.capabilities:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fieldsIndex",{get:function(){return new K(this.fields)},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isTable",{get:function(){return this.loaded&&null==this.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"parsedUrl",{get:function(){return this.url?y.urlToObject(this.url):null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"renderer",{set:function(a){g.fixRendererFields(a,this.fields);this._set("renderer",a)},enumerable:!0,configurable:!0});a.prototype.applyEdits=function(a){return v.safeCast(A.applyEdits(this,
a))};a.prototype.on=function(a,b){return this.inherited(arguments)};a.prototype.createPopupTemplate=function(a){return M.createPopupTemplate(this,a)};a.prototype.createQuery=function(){var a=new e,b=this.get("capabilities.data");a.returnGeometry=!0;b&&b.supportsZ&&(a.returnZ=!0);a.outFields=["*"];a.where=this.definitionExpression||"1\x3d1";return a};a.prototype.getFieldDomain=function(a,b){var d=this,c,n=!1;b=(b=b&&b.feature)&&b.attributes;var e=this.typeIdField&&b&&b[this.typeIdField];null!=e&&this.types&&
(n=this.types.some(function(b){return b.id==e?((c=b.domains&&b.domains[a])&&"inherited"===c.type&&(c=d._getLayerDomain(a)),!0):!1}));n||c||(c=this._getLayerDomain(a));return c};a.prototype.getField=function(a){return this.fieldsIndex.get(a)};a.prototype.queryFeatures=function(a,b){var c=this;return this.load().then(function(){return c.source.queryFeatures(e.from(a)||c.createQuery(),b)}).then(function(a){if(a&&a.features)for(var b=0,d=a.features;b<d.length;b++){var p=d[b];p.layer=p.sourceLayer=c}return a})};
a.prototype.queryObjectIds=function(a,b){var c=this;return this.load().then(function(){return c.source.queryObjectIds(e.from(a)||c.createQuery(),b)})};a.prototype.queryFeatureCount=function(a,b){var c=this;return this.load().then(function(){return c.source.queryFeatureCount(e.from(a)||c.createQuery(),b)})};a.prototype.queryExtent=function(a,b){var c=this;return this.load().then(function(){return c.source.queryExtent(e.from(a)||c.createQuery(),b)})};a.prototype.importLayerViewModule=function(a){return t(this,
void 0,void 0,function(){return r(this,function(b){switch(a.type){case "2d":return[2,l.create(function(a){return h(["../views/2d/layers/FeatureLayerView2D"],a)})];case "3d":return[2,l.create(function(a){return h(["../views/3d/layers/FeatureLayerView3D"],a)})]}return[2]})})};a.prototype._getLayerDomain=function(a){if(!this.fields)return null;var b=null;this.fields.some(function(c){c.name===a&&(b=c.domain);return!!b});return b};c([b.property({readOnly:!0,dependsOn:["source.capabilities"],json:{read:!1,
write:!1}})],a.prototype,"capabilities",null);c([b.property({type:String})],a.prototype,"copyright",void 0);c([b.property({readOnly:!0,dependsOn:["fields","title"]})],a.prototype,"defaultPopupTemplate",null);c([b.property({type:String})],a.prototype,"definitionExpression",void 0);c([b.property({type:String})],a.prototype,"displayField",void 0);c([b.property({type:Boolean})],a.prototype,"editingEnabled",void 0);c([b.property({type:N})],a.prototype,"elevationInfo",void 0);c([b.property({types:{key:"type",
base:F.default,typeMap:{selection:G.default}}})],a.prototype,"featureReduction",void 0);c([b.property({type:[J]})],a.prototype,"fields",void 0);c([b.property({readOnly:!0,dependsOn:["fields"]})],a.prototype,"fieldsIndex",null);c([b.property({type:f.Extent,aliasOf:"source.fullExtent"})],a.prototype,"fullExtent",void 0);c([b.property({type:["point","polygon","polyline","multipoint"],json:{read:{reader:O.read}}})],a.prototype,"geometryType",void 0);c([b.property({type:Boolean})],a.prototype,"hasZ",void 0);
c([b.property({type:String})],a.prototype,"id",void 0);c([b.property({type:Boolean,readOnly:!0,dependsOn:["loaded"]})],a.prototype,"isTable",null);c([b.property({type:Boolean})],a.prototype,"labelsVisible",void 0);c([b.property({type:[L]})],a.prototype,"labelingInfo",void 0);c([b.property({type:Boolean})],a.prototype,"legendEnabled",void 0);c([b.property({type:["show","hide"]})],a.prototype,"listMode",void 0);c([b.property({type:String})],a.prototype,"objectIdField",void 0);c([b.property({readOnly:!0,
dependsOn:["url"]})],a.prototype,"parsedUrl",null);c([b.property({type:Boolean})],a.prototype,"popupEnabled",void 0);c([b.property({type:u})],a.prototype,"popupTemplate",void 0);c([b.property({types:k.rendererTypes,json:{read:{source:"drawingInfo.renderer",reader:k.read}}})],a.prototype,"renderer",null);c([b.property({type:Boolean})],a.prototype,"screenSizePerspectiveEnabled",void 0);c([b.property({readOnly:!0})],a.prototype,"source",void 0);c([b.property({type:f.SpatialReference})],a.prototype,"spatialReference",
void 0);c([b.property({type:[H]})],a.prototype,"templates",void 0);c([b.property()],a.prototype,"title",void 0);c([b.property({json:{read:!1},readOnly:!0})],a.prototype,"type",void 0);c([b.property({type:String,readOnly:!0})],a.prototype,"typeIdField",void 0);c([b.property({type:[I]})],a.prototype,"types",void 0);c([b.property({type:String})],a.prototype,"url",void 0);return a=c([b.subclass("esri.layers.GeoJSONLayer")],a)}(b.declared(z,D,C,x,E))});