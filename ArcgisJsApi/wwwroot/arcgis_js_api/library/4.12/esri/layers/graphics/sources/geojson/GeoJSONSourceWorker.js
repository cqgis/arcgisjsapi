// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(B,a,q,p,b,c,d,f){function n(a,m){return a?m?4:3:m?3:2}function w(a,m){return Math.round((m-a.translate[0])/a.scale[0])}function C(a,m){return Math.round((a.translate[1]-m)/a.scale[1])}function u(a,m){return m*a.scale[0]+a.translate[0]}function G(a,m){return a.translate[1]-
m*a.scale[1]}function A(a){a=a.coords;return{x:a[0],y:a[1]}}function H(a,m){a.coords[0]=m.x;a.coords[1]=m.y;return a}function F(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function D(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.z;return a}function k(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function v(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.m;return a}function r(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function h(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.z;a.coords[3]=
m.m;return a}function l(a,m){return a&&m?h:a?D:m?v:H}function y(a,m,b){if(!a)return null;for(var h=n(m,b),f=[],d=0;d<a.coords.length;d+=h){for(var c=[],l=0;l<h;l++)c.push(a.coords[d+l]);f.push(c)}return m?b?{points:f,hasZ:m,hasM:b}:{points:f,hasZ:m}:b?{points:f,hasM:b}:{points:f}}function t(a,m,b){void 0===b&&(b=n(m.hasZ,m.hasM));a.lengths[0]=m.points.length;var h=a.coords,f=0,d=0;for(m=m.points;d<m.length;d++)for(var c=m[d],l=0;l<b;l++)h[f++]=c[l];return a}function M(a,m,b){if(!a)return null;var h=
n(m,b),f=a.coords,d=[],c=0,l=0;for(a=a.lengths;l<a.length;l++){for(var r=a[l],k=[],t=0;t<r;t++){for(var y=[],v=0;v<h;v++)y.push(f[c++]);k.push(y)}d.push(k)}return m?b?{paths:d,hasZ:m,hasM:b}:{paths:d,hasZ:m}:b?{paths:d,hasM:b}:{paths:d}}function Q(a,m,b){void 0===b&&(b=n(m.hasZ,m.hasM));var h=a.lengths,d=a.coords,f=0,c=0;for(m=m.paths;c<m.length;c++){for(var l=m[c],r=0,k=l;r<k.length;r++)for(var t=k[r],y=0;y<b;y++)d[f++]=t[y];h.push(l.length)}return a}function la(a,m,b){if(!a)return null;var h=n(m,
b),d=a.coords,f=[],c=0,l=0;for(a=a.lengths;l<a.length;l++){for(var r=a[l],k=[],t=0;t<r;t++){for(var y=[],v=0;v<h;v++)y.push(d[c++]);k.push(y)}f.push(k)}return m?b?{rings:f,hasZ:m,hasM:b}:{rings:f,hasZ:m}:b?{rings:f,hasM:b}:{rings:f}}function ma(a,m,b,h){void 0===b&&(b=m.hasZ);void 0===h&&(h=m.hasM);b=n(b,h);h=a.lengths;var f=a.coords,d=0,c=h.length=f.length=0;for(m=m.rings;c<m.length;c++){for(var l=m[c],r=0,k=l;r<k.length;r++)for(var t=k[r],y=0;y<b;y++)f[d++]=t[y];h.push(l.length)}return a}function N(a,
m,b,h,d,r){a.length=0;if(!b){for(h=0;h<m.length;h++)d=m[h],a.push(new c.default(null,d.attributes,null,d.attributes[r]));return a}switch(b){case "esriGeometryPoint":h=l(h,d);for(d=0;d<m.length;d++){var k=m[d];b=k.geometry;var k=k.attributes,y=void 0;b&&(y=h(new f.default,b));a.push(new c.default(y,k,null,k[r]))}break;case "esriGeometryMultipoint":h=n(h,d);for(d=0;d<m.length;d++)k=m[d],b=k.geometry,k=k.attributes,y=void 0,b&&(y=t(new f.default,b,h)),a.push(new c.default(y,k,null,k[r]));break;case "esriGeometryPolyline":h=
n(h,d);for(d=0;d<m.length;d++)k=m[d],b=k.geometry,k=k.attributes,y=void 0,b&&(y=Q(new f.default,b,h)),a.push(new c.default(y,k,null,k[r]));break;case "esriGeometryPolygon":for(b=0;b<m.length;b++){var v=m[b],k=v.geometry,y=v.centroid,v=v.attributes,E=void 0;k&&(E=ma(new f.default,k,h,d));y?a.push(new c.default(E,v,H(new f.default,y),v[r])):a.push(new c.default(E,v,null,v[r]))}break;default:I.error("convertToFeatureSet:unknown-geometry",new q("Unable to parse unknown geometry type '"+b+"'")),a.length=
0}return a}function S(a,m,b,h,d){a.length=0;switch(b){case "esriGeometryPoint":b=A;h&&d?b=r:h?b=F:d&&(b=k);for(h=0;h<m.length;h++){var f=m[h];d=f.geometry;f=f.attributes;d=d?b(d):null;a.push({attributes:f,geometry:d})}break;case "esriGeometryMultipoint":for(b=0;b<m.length;b++){var c=m[b],f=c.geometry,c=c.attributes,l=void 0;f&&(l=y(f,h,d));a.push({attributes:c,geometry:l})}break;case "esriGeometryPolyline":for(b=0;b<m.length;b++)c=m[b],f=c.geometry,c=c.attributes,l=void 0,f&&(l=M(f,h,d)),a.push({attributes:c,
geometry:l});break;case "esriGeometryPolygon":for(b=0;b<m.length;b++){var l=m[b],c=l.geometry,f=l.attributes,t=l.centroid,l=void 0;c&&(l=la(c,h,d));t?(c=A(t),a.push({attributes:f,centroid:c,geometry:l})):a.push({attributes:f,geometry:l})}break;default:I.error("convertToFeatureSet:unknown-geometry",new q("Unable to parse unknown geometry type '"+b+"'"))}return a}function m(a,m,b,h,d,f){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;d=
X[d];var c=m.coords;m=m.lengths;var l=n(b,h);b=b?h?ha:Y:h?Y:ia;if(!m.length)return b(a.coords,c,0,0,w(f,c[0]),C(f,c[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=l,a;for(var k,r,y,t=0,v,E=0,A=0;A<m.length;A++){var D=m[A];if(!(D<d)){var M=0;v=E;r=h=w(f,c[t]);y=k=C(f,c[t+1]);b(a.coords,c,v,t,r,y);M++;t+=l;v+=l;for(var W=1;W<D;W++,t+=l)if(r=w(f,c[t]),y=C(f,c[t+1]),r!==h||y!==k)b(a.coords,c,v,t,r-h,y-k),v+=l,M++,h=r,k=y;M>=d&&(a.lengths.push(M),E=v)}}a.coords.length=E;return a.coords.length?
a:null}function E(a,m,b,h,d,f,c){for(var l=c-b,r=0,k=0,y,t=f+b;t<c-b;t+=b){y=m[t];var n=m[t+1],v=m[f],A=m[f+1],D=m[l],M=m[l+1];v===D?y=Math.abs(y-v):(D=(M-A)/(D-v),y=Math.abs(D*y-n+(A-D*v))/Math.sqrt(D*D+1));y>r&&(k=t,r=y)}r>h?(E(a,m,b,h,d,f,k+b),E(a,m,b,h,d,k,c)):(d(a,m,a.length,f,m[f],m[f+1]),d(a,m,a.length,l,m[l],m[l+1]))}function pa(a,m,b,h,d){var f=m.coords,c=m.lengths,l=b?h?ha:Y:h?Y:ia;b=n(b,h);if(!f.length)return a!==m&&(a.lengths.length=0,a.coords.length=0),a;if(!c.length)return l(a.coords,
f,0,0,u(d,f[0]),G(d,f[1])),a!==m&&(a.lengths.length=0,a.coords.length=b),a;var r=d.scale;h=r[0];for(var r=r[1],k=0,y=0;y<c.length;y++){var t=c[y];a.lengths[y]=t;var v=u(d,f[k]),E=G(d,f[k+1]);l(a.coords,f,k,k,v,E);for(var k=k+b,A=1;A<t;A++,k+=b)v+=f[k]*h,E-=f[k+1]*r,l(a.coords,f,k,k,v,E)}a!==m&&(a.lengths.length=c.length,a.coords.length=f.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var I=p.getLogger("esri.tasks.support.optimizedFeatureSet"),X={esriGeometryPoint:0,esriGeometryPolyline:2,
esriGeometryPolygon:3,esriGeometryMultipoint:0},ia=function(a,m,b,h,d,f){a[b]=d;a[b+1]=f},Y=function(a,m,b,h,d,f){a[b]=d;a[b+1]=f;a[b+2]=m[h+2]},ha=function(a,m,b,h,d,f){a[b]=d;a[b+1]=f;a[b+2]=m[h+2];a[b+3]=m[h+3]};a.quantizeX=w;a.quantizeY=C;a.hydrateX=u;a.hydrateY=G;a.convertToPoint=function(a,m,b){return a?m?b?r(a):F(a):b?k(a):A(a):null};a.convertFromPoint=function(a,m,b){void 0===b&&(b=l(null!=m.z,null!=m.m));return b(a,m)};a.convertToMultipoint=y;a.convertFromMultipoint=t;a.convertToPolyline=
M;a.convertToPolygon=la;a.convertFromPolygon=ma;var K=[],T=[];a.convertFromFeature=function(a,m,b,h,d){K[0]=a;a=N(T,K,m,b,h,d)[0];K.length=T.length=0;return a};a.convertFromFeatures=N;a.convertToFeature=function(a,m,b,h){T[0]=a;S(K,T,m,b,h);a=K[0];K.length=T.length=0;return a};a.convertFromGeometry=function(a,m,h){if(!a)return null;var d=new f.default;"hasZ"in a&&null==m&&(m=a.hasZ);"hasM"in a&&null==h&&(h=a.hasM);if(b.isPoint(a))return l(null!=m?m:null!=a.z,null!=h?h:null!=a.m)(d,a);if(b.isPolygon(a))return ma(d,
a,m,h);if(b.isPolyline(a))return Q(d,a,n(m,h));if(b.isMultipoint(a))return t(d,a,n(m,h));I.error("convertFromGeometry:unknown-geometry",new q("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=function(a,m,b,h){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(m){case "esriGeometryPoint":return m=A,b&&h?m=r:b?m=F:h&&(m=k),m(a);case "esriGeometryMultipoint":return y(a,b,h);case "esriGeometryPolyline":return M(a,b,h);case "esriGeometryPolygon":return la(a,b,h);default:I.error("convertToGeometry:unknown-geometry",
new q("Unable to parse unknown geometry type '"+m+"'"))}};a.convertToFeatures=S;a.convertToFeatureSet=function(a){var m=a.objectIdFieldName,b=a.spatialReference,h=a.transform,d=a.fields,f=a.hasM,c=a.hasZ,l=a.geometryType,k=a.exceededTransferLimit;a={features:S([],a.features,l,c,f),fields:d,geometryType:l,objectIdFieldName:m,spatialReference:b};h&&(a.transform=h);k&&(a.exceededTransferLimit=k);f&&(a.hasM=f);c&&(a.hasZ=c);return a};a.convertFromFeatureSet=function(a,m){var b=new d.default,h=a.hasM,
f=a.hasZ,c=a.features,l=a.objectIdFieldName,k=a.spatialReference,r=a.geometryType,y=a.exceededTransferLimit,t=a.transform;b.fields=a.fields;b.geometryType=r;b.objectIdFieldName=l||m;b.spatialReference=k;if(!b.objectIdFieldName)return I.error(new q("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),b;c&&N(b.features,c,r,f,h,b.objectIdFieldName);y&&(b.exceededTransferLimit=y);h&&(b.hasM=h);f&&(b.hasZ=f);t&&(b.transform=t);return b};a.hydrateOptimizedFeatureSet=function(a){var m=
a.transform,b=a.hasM,h=a.hasZ;if(!m)return a;for(var d=0,f=a.features;d<f.length;d++){var c=f[d];c.geometry&&pa(c.geometry,c.geometry,b,h,m);c.centroid&&pa(c.centroid,c.centroid,b,h,m)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var h=b.geometryType,d=b.features,l=b.hasM,k=b.hasZ;if(!a)return b;for(var r=0;r<d.length;r++){var y=d[r],t=new c.default(new f.default,y.attributes);m(t.geometry,y.geometry,l,k,h,a);y.centroid&&(t.centroid=new f.default,m(t.centroid,y.centroid,
l,k,"esriGeometryPoint",a));d[r]=t}b.transform=a;return b};a.quantizeOptimizedGeometry=m;a.quantizeOptimizedGeometryRemoveCollinear=function(a,m,b,h,d,f){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;d=X[d];var c=m.coords;m=m.lengths;var l=n(b,h);b=b?h?ha:Y:h?Y:ia;if(!m.length)return b(a.coords,c,0,0,w(f,c[0]),C(f,c[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=l,a;for(var k,r,y,t=0,v,E=0,A=0;A<m.length;A++){var D=m[A];
if(!(D<d)){var M=0;v=E;h=k=w(f,c[t]);y=r=C(f,c[t+1]);b(a.coords,c,v,t,h,y);M++;for(var t=t+l,p=!1,H=0,S=0,u=1;u<D;u++,t+=l)if(h=w(f,c[t]),y=C(f,c[t+1]),h!==k||y!==r)k=h-k,r=y-r,p&&(0===H&&0===k||0===S&&0===r)?(H+=k,S+=r):(p=!0,H=k,S=r,v+=l,M++),b(a.coords,c,v,t,H,S),k=h,r=y;p&&(v+=l,b(a.coords,c,v,t,H,S));M>=d&&(a.lengths.push(M),E=v)}}a.coords.length!==E&&(a.coords.length=E);return a.coords.length?a:null};a.generalizeOptimizedGeometry=function(a,m,b,h,d,f){a.lengths.length&&(a.lengths.length=0);
a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;d=X[d];var c=m.coords;m=m.lengths;var l=n(b,h);b=b?h?ha:Y:h?Y:ia;if(!m.length)return b(a.coords,c,0,0,c[0],c[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=l,a;for(var k=h=0;k<m.length;k++){var r=m[k];if(!(r<d)){var y=a.coords.length/l;E(a.coords,c,l,f,b,h,h+r*l);var t=a.coords.length/l-y;t>=d?a.lengths.push(t):a.coords.length=y*l}h+=r*l}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,m,b,h){b=
n(b,h);var d=h=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(m&&m.coords){m=m.coords;for(var l=0;l<m.length;l+=b){var k=m[l],r=m[l+1];h=Math.min(h,k);f=Math.max(f,k);d=Math.min(d,r);c=Math.max(c,r)}}a[0]=h;a[1]=d;a[2]=f;a[3]=c;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,m,b,h){b=n(b,h);h=m.coords;var d=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY,k=0,r=0;for(m=m.lengths;r<m.length;r++)for(var y=
m[r],t=h[k],v=h[k+1],d=Math.min(t,d),f=Math.min(v,f),c=Math.max(t,c),l=Math.max(v,l),k=k+b,E=1;E<y;E++,k+=b){var A=h[k],D=h[k+1],t=t+A,v=v+D;0>A&&(d=Math.min(d,t));0<A&&(c=Math.max(c,t));0>D?f=Math.min(f,v):0<D&&(l=Math.max(l,v))}a[0]=d;a[1]=f;a[2]=c;a[3]=l;return a};a.hydrateOptimizedGeometry=pa})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/extendsHelper @dojo/framework/shim/Map ../../../core/Error ../../../core/Evented ../../../core/has ../../../core/Logger ../../../core/maybe ../../../core/libs/rbush/rbush ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(B,a,q,p,b,c,d,f,n,w,C,u,G,A,H,F){Object.defineProperty(a,"__esModule",{value:!0});var D=[],k=w.getLogger("esri.layers.graphics.data.FeatureStore"),v={minX:0,minY:0,maxX:0,maxY:0};B=function(){function a(a,b,d){this._geometryInfo=a;this._onFeatureAdd=b;this._onFeatureRemove=d;this._featuresById=new c.default;this._boundsByFeature=new c.default;this._featuresByBounds=new c.default;this._index=u(9,n("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]",
"[2]","[3]"]);this.events=new f;this.featureAdapter=F.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var a=A.create(A.NEGATIVE_INFINITY);this._boundsByFeature.forEach(function(b){b&&(a[0]=Math.min(b[0],a[0]),a[1]=Math.min(b[1],a[1]),a[2]=Math.max(b[2],a[2]),a[3]=Math.max(b[3],a[3]))});return a},enumerable:!0,configurable:!0});a.prototype.add=function(a){this._add(a,D);this._index.load(D);this._emitChanged();D.length=
0};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b],D);this._index.load(D);this._emitChanged();D.length=0};a.prototype.clear=function(){this._featuresById.clear();this._boundsByFeature.clear();this._featuresByBounds.clear();this._index.clear();this._emitChanged()};a.prototype.removeById=function(a){var b=this._featuresById.get(a);if(!b)return null;var h=this._boundsByFeature.get(b);h&&(this._index.remove(h),this._featuresByBounds.delete(h));this._boundsByFeature.delete(b);
this._featuresById.delete(a);this._emitChanged();return b};a.prototype.removeIf=function(a,b){var h=this;this._featuresById.forEach(function(d,f){b(d)&&(h._remove(d),a.push(d))});this._emitChanged()};a.prototype.removeManyById=function(a){for(var b=0;b<a.length;b++){var h=a[b],d=this._featuresById.get(h);if(d){var f=this._boundsByFeature.get(d);f&&(this._index.remove(f),this._featuresByBounds.delete(f));this._boundsByFeature.delete(d)}this._featuresById.delete(h)}this._emitChanged()};a.prototype.forEachBounds=
function(a,b,d){for(var h=0;h<a.length;h++){var f=this._boundsByFeature.get(a[h]);f&&b(G.fromRect(d,f))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var d=0,h=this._index;v.minX=a[0];v.minY=a[1];v.maxX=a[2];v.maxY=a[3];for(a=h.search(v);d<a.length;d++)b(this._featuresByBounds.get(a[d]))};
a.prototype.transferById=function(a,b){if(b=this._featuresById.get(b))this._remove(b),a.add(b),this._emitChanged()};a.prototype.transferByIds=function(a,b){for(var d=[],f=0;f<b.length;f++){var h=this._featuresById.get(b[f]);h&&(this._remove(h),d.push(h))}a.addMany(d);this._emitChanged()};a.prototype.transferIdRange=function(a,b,d){for(var f=[];b<d;b++){var h=this._featuresById.get(b);h&&(this._remove(h),f.push(h))}a.addMany(f);this._emitChanged()};a.prototype.transferIf=function(a,b){var d=this,f=
[];this._featuresById.forEach(function(a,h){b(a)&&(d._remove(a),f.push(a))});a.addMany(f);this._emitChanged()};a.prototype.transferAll=function(a){var b=this,d=[];this._featuresById.forEach(function(a,f){b._remove(a);d.push(a)});a.addMany(d);this._emitChanged()};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a,b){if(a){var f=a.objectId;if(null==f)k.error(new d("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var h=this._featuresById.get(f),
c;h?(c=this._boundsByFeature.get(h),a.localId=h.localId,c&&(this._index.remove(c),this._boundsByFeature.delete(h),this._featuresByBounds.delete(c))):C.isSome(this._onFeatureAdd)&&this._onFeatureAdd(a);a.geometry?(c=H.getBoundsOptimizedGeometry(c||A.create(),a.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(a,c),this._featuresByBounds.set(c,a),this._featuresById.set(f,a),b.push(c)):(this._boundsByFeature.set(a,null),this._featuresById.set(f,a))}}};a.prototype._remove=
function(a){var b;if(a){C.isSome(this._onFeatureRemove)&&this._onFeatureRemove(a);if(b=this._boundsByFeature.get(a))this._index.remove(b),this._boundsByFeature.delete(a),this._featuresByBounds.delete(b);this._featuresById.delete(a.objectId)}};return a}();a.default=B})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(B){function a(b,d){if(!(this instanceof a))return new a(b,d);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));
d&&("function"===typeof d?this.toBBox=d:this._initFormat(d));this.clear()}function q(a,b){p(a,0,a.children.length,b,a)}function p(a,d,f,c,k){k||(k=u(null));k.minX=Infinity;k.minY=Infinity;k.maxX=-Infinity;k.maxY=-Infinity;for(var v;d<f;d++)v=a.children[d],b(k,a.leaf?c(v):v);return k}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function d(a,b){return a.minY-b.minY}
function f(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function n(a){return a.maxX-a.minX+(a.maxY-a.minY)}function w(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function C(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function u(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function G(a,b,d,f,c){for(var k=[b,d],r;k.length;)d=k.pop(),b=k.pop(),d-b<=f||(r=b+Math.ceil((d-b)/f/2)*f,B(a,r,b,d,c),
k.push(b,r,r,d))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,d=[],f=this.toBBox;if(!C(a,b))return d;for(var c=[],v,r,h,l;b;){v=0;for(r=b.children.length;v<r;v++)h=b.children[v],l=b.leaf?f(h):h,C(a,l)&&(b.leaf?d.push(h):w(a,l)?this._all(h,d):c.push(h));b=c.pop()}return d},collides:function(a){var b=this.data,d=this.toBBox;if(!C(a,b))return!1;for(var f=[],c,v,r,h;b;){c=0;for(v=b.children.length;c<v;c++)if(r=b.children[c],h=b.leaf?d(r):r,C(a,h)){if(b.leaf||
w(a,h))return!0;f.push(r)}b=f.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,d=a.length;b<d;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},
clear:function(){this.data=u([]);return this},remove:function(a,b){if(!a)return this;for(var d=this.data,f=this.toBBox(a),c=[],v=[],r,h,l,y;d||c.length;){d||(d=c.pop(),h=c[c.length-1],r=v.pop(),y=!0);if(d.leaf){a:{l=a;var t=d.children,n=b;if(n){for(var p=0;p<t.length;p++)if(n(l,t[p])){l=p;break a}l=-1}else l=t.indexOf(l)}if(-1!==l){d.children.splice(l,1);c.push(d);this._condense(c);break}}y||d.leaf||!w(d,f)?h?(r++,d=h.children[r],y=!1):d=null:(c.push(d),v.push(r),r=0,h=d,d=d.children[0])}return this},
toBBox:function(a){return a},compareMinX:c,compareMinY:d,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var d=[];a;)a.leaf?b.push.apply(b,a.children):d.push.apply(d,a.children),a=d.pop();return b},_build:function(a,b,d,f){var c=d-b+1,v=this._maxEntries,r;if(c<=v)return r=u(a.slice(b,d+1)),q(r,this.toBBox),r;f||(f=Math.ceil(Math.log(c)/Math.log(v)),v=Math.ceil(c/Math.pow(v,f-1)));r=u([]);r.leaf=!1;r.height=f;var c=Math.ceil(c/v),v=c*Math.ceil(Math.sqrt(v)),
h,l,y;for(G(a,b,d,v,this.compareMinX);b<=d;b+=v)for(l=Math.min(b+v-1,d),G(a,b,l,c,this.compareMinY),h=b;h<=l;h+=c)y=Math.min(h+c-1,l),r.children.push(this._build(a,h,y,f-1));q(r,this.toBBox);return r},_chooseSubtree:function(a,b,d,c){for(var k,v,r,h,l,y,t,n;;){c.push(b);if(b.leaf||c.length-1===d)break;t=n=Infinity;k=0;for(v=b.children.length;k<v;k++)r=b.children[k],l=f(r),y=(Math.max(r.maxX,a.maxX)-Math.min(r.minX,a.minX))*(Math.max(r.maxY,a.maxY)-Math.min(r.minY,a.minY))-l,y<n?(n=y,t=l<t?l:t,h=r):
y===n&&l<t&&(t=l,h=r);b=h||b.children[0]}return b},_insert:function(a,d,f){var c=this.toBBox;f=f?a:c(a);var c=[],k=this._chooseSubtree(f,this.data,d,c);k.children.push(a);for(b(k,f);0<=d;)if(c[d].children.length>this._maxEntries)this._split(c,d),d--;else break;this._adjustParentBBoxes(f,c,d)},_split:function(a,b){var d=a[b],f=d.children.length,c=this._minEntries;this._chooseSplitAxis(d,c,f);f=this._chooseSplitIndex(d,c,f);f=u(d.children.splice(f,d.children.length-f));f.height=d.height;f.leaf=d.leaf;
q(d,this.toBBox);q(f,this.toBBox);b?a[b-1].children.push(f):this._splitRoot(d,f)},_splitRoot:function(a,b){this.data=u([a,b]);this.data.height=a.height+1;this.data.leaf=!1;q(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,d){var c,k,v,r,h,l,y;h=l=Infinity;for(c=b;c<=d-b;c++)k=p(a,0,c,this.toBBox),v=p(a,c,d,this.toBBox),r=Math.max(0,Math.min(k.maxX,v.maxX)-Math.max(k.minX,v.minX))*Math.max(0,Math.min(k.maxY,v.maxY)-Math.max(k.minY,v.minY)),k=f(k)+f(v),r<h?(h=r,y=c,l=k<l?k:l):r===h&&k<l&&(l=
k,y=c);return y},_chooseSplitAxis:function(a,b,f){var n=a.leaf?this.compareMinX:c,k=a.leaf?this.compareMinY:d,v=this._allDistMargin(a,b,f,n);b=this._allDistMargin(a,b,f,k);v<b&&a.children.sort(n)},_allDistMargin:function(a,d,f,c){a.children.sort(c);c=this.toBBox;var k=p(a,0,d,c),v=p(a,f-d,f,c),r=n(k)+n(v),h,l;for(h=d;h<f-d;h++)l=a.children[h],b(k,a.leaf?c(l):l),r+=n(k);for(h=f-d-1;h>=d;h--)l=a.children[h],b(v,a.leaf?c(l):l),r+=n(v);return r},_adjustParentBBoxes:function(a,d,f){for(;0<=f;f--)b(d[f],
a)},_condense:function(a){for(var b=a.length-1,d;0<=b;b--)0===a[b].children.length?0<b?(d=a[b-1].children,d.splice(d.indexOf(a[b]),1)):this.clear():q(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],
function(){function B(p,b,c,d,f){for(;d>c;){if(600<d-c){var n=d-c+1,w=b-c+1,C=Math.log(n),u=.5*Math.exp(2*C/3),C=.5*Math.sqrt(C*u*(n-u)/n)*(0>w-n/2?-1:1);B(p,b,Math.max(c,Math.floor(b-w*u/n+C)),Math.min(d,Math.floor(b+(n-w)*u/n+C)),f)}n=p[b];w=c;u=d;a(p,c,b);for(0<f(p[d],n)&&a(p,c,d);w<u;){a(p,w,u);w++;for(u--;0>f(p[w],n);)w++;for(;0<f(p[u],n);)u--}0===f(p[c],n)?a(p,c,u):(u++,a(p,u,d));u<=b&&(c=u+1);b<=u&&(d=u-1)}}function a(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function q(a,b){return a<b?-1:a>b?1:0}
return function(a,b,c,d,f){B(a,b,c||0,d||a.length-1,f||q)}})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(B,a,q,p,b){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,
b){return new p.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,d){a.centroid||(a.centroid=q.getCentroidOptimizedGeometry(new b.default,a.geometry,d.hasZ,d.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(B,a){function q(a,c,d,f,n,w){w=n?w?4:3:w?3:2;var b=d,p=d+w,G=0,A=0,q=d=0,F=0,D=0;for(--f;D<f;D++,b+=w,p+=w){var k=c[b],v=c[b+1],
r=c[b+2],h=c[p],l=c[p+1],y=c[p+2],t=k*l-h*v,q=q+t,G=G+(k+h)*t,A=A+(v+l)*t;n&&(t=k*y-h*r,d+=(r+y)*t,F+=t);k<a[0]&&(a[0]=k);k>a[1]&&(a[1]=k);v<a[2]&&(a[2]=v);v>a[3]&&(a[3]=v);n&&(r<a[4]&&(a[4]=r),r>a[5]&&(a[5]=r))}0<q&&(q*=-1);0<F&&(F*=-1);if(!q)return null;a=[G,A,.5*q];n&&(a[3]=d,a[4]=.5*F);return a}function p(a,c,d,f,n){n=f?n?4:3:n?3:2;for(var b=c,p=c+n,u=0,q=0,A=0,H=0,F=0,D=d-1;F<D;F++,b+=n,p+=n){var k=a[b],v=a[b+1],r=a[b+2],h=a[p],l=a[p+1],y=a[p+2],t;if(f){t=h-k;var M=l-v,Q=y-r;t=Math.sqrt(t*t+
M*M+Q*Q)}else t=h-k,M=l-v,t=Math.sqrt(t*t+M*M);t&&(u+=t,f?(k=[k+.5*(h-k),v+.5*(l-v),r+.5*(y-r)],q+=t*k[0],A+=t*k[1],H+=t*k[2]):(k=[k+.5*(h-k),v+.5*(l-v)],q+=t*k[0],A+=t*k[1]))}return 0<u?f?[q/u,A/u,H/u]:[q/u,A/u]:0<d?f?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,c,d,f){if(!c||!c.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var b=a.coords,w=[],C=d?[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],u=c.lengths,G=c.coords,A=d?f?4:3:f?3:2,H=0,F=0;F<u.length;F++){var D=u[F],k=q(C,G,H,D,d,f);k&&w.push(k);H+=D*A}w.sort(function(a,b){var f=a[2]-b[2];0===f&&d&&(f=a[4]-b[4]);return f});w.length&&(A=6*w[0][2],b[0]=w[0][0]/A,b[1]=w[0][1]/A,d&&(A=6*w[0][4],b[2]=0!==A?w[0][3]/A:
0),b[0]<C[0]||b[0]>C[1]||b[1]<C[2]||b[1]>C[3]||d&&(b[2]<C[4]||b[2]>C[5]))&&(b.length=0);if(!b.length)if(c=c.lengths[0]?p(G,0,u[0],d,f):null)b[0]=c[0],b[1]=c[1],d&&2<c.length&&(b[2]=c[2]);else return null;return a};a.lineCentroid=p})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(B,a,q,p,b,c,d,f,n){function w(a,b){var d;if(!b)return null;if("x"in b){var f={x:0,y:0};a=a(b.x,b.y,A);f.x=a[0];f.y=a[1];null!=b.z&&(f.z=b.z);null!=b.m&&(f.m=b.m);return f}if("xmin"in b)return f={xmin:0,ymin:0,xmax:0,ymax:0},d=a(b.xmin,b.ymin,A),f.xmin=d[0],f.ymin=d[1],a=a(b.xmax,b.ymax,A),f.xmax=a[0],f.ymax=a[1],b.hasZ&&(f.zmin=b.zmin,f.zmax=b.zmax,f.hasZ=!0),b.hasM&&(f.mmin=b.mmin,f.mmax=b.mmax,f.hasM=!0),f;if("rings"in b)return{rings:C(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:C(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:u(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function C(a,b){for(var d=[],f=0;f<a.length;f++)d.push(u(a[f],b));return d}function u(a,b){for(var d=[],f=0;f<a.length;f++){var c=a[f],k=b(c[0],c[1],[0,0]);d.push(k);2<c.length&&k.push(c[2]);3<c.length&&k.push(c[3])}return d}function G(a,b){return!f.isValid(a)||!f.isValid(b)||f.equals(a,b)||n.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var A=[0,0];a.checkProjectionSupport=function(a,
f){return p(this,void 0,void 0,function(){var c,h,l;return q(this,function(k){if(!f)return[2];if(Array.isArray(a)){c=0;for(h=a;c<h.length;c++)if(l=h[c],G(l.geometry&&l.geometry.spatialReference,f)){if(d.isSupported())return[2,d.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:f});}return[2]}if(!G(a,f))return[2];if(d.isSupported())return[2,d.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,
outSpatialReference:f});})})};var H=w.bind(null,n.lngLatToXY),F=w.bind(null,n.xyToLngLat);a.project=function(a,b,c){c||(c=b,b=a.spatialReference);return f.isValid(b)&&f.isValid(c)&&!f.equals(b,c)?n.canProject(b,c)?f.isWebMercator(c)?H(a):F(a):d.projectMany([a],b,c,null,!0)[0]:a};var D=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,d){return p(this,void 0,void 0,function(){var h,k=this;return q(this,function(l){a&&a.length&&
b&&d&&!f.equals(b,d)||c.resolve(a);h={geometries:a,inSpatialReference:b,outSpatialReference:d,resolve:null};this._jobs.push(h);return[2,c.create(function(a){h.resolve=a;null===k._timer&&(k._timer=setTimeout(k._process,10))},function(){var a=k._jobs.indexOf(h);-1<a&&k._jobs.splice(a,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=a.inSpatialReference,l=a.outSpatialReference,a=a.resolve;n.canProject(c,l)?f.isWebMercator(l)?a(b.map(H)):
a(b.map(F)):a(d.projectMany(b,c,l,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,d){return p(this,void 0,void 0,function(){return q(this,function(f){return[2,D.push(a,b,d)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(B,a,q,p,b,c){function d(a,d,w,p,q){void 0===p&&(p=null);void 0===q&&(q=!1);if(null===p){var D=
c.cacheKey(d,w);void 0!==C[D]?p=C[D]:(p=f(d,w,null),null===p&&(p=new c),C[D]=p)}return n._project(a,d,w instanceof b||!1===q?w:new b(w),p,q)}function f(a,b,d){void 0===d&&(d=null);a=n._getTransformation(a,b,d);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var n=null;a.isLoaded=function(){return!!n&&p.isLoaded()};a.isSupported=function(){return p.isSupported()};var w=null;a.load=function(){return w?w:w=q.create(function(a,b){var d=p.load();B(["./geometryEngine"],
function(f){n=f;d.then(function(){n._enableProjection(p);a()},function(a){b(a)})})})};a.project=function(a,b,f){void 0===f&&(f=null);return a instanceof Array?0===a.length?[]:d(a,a[0].spatialReference,b,f):d([a],a.spatialReference,b,f)[0]};var C={};a.projectMany=d;a.getTransformation=f;a.getTransformations=function(a,b,d){void 0===d&&(d=null);a=n._getTransformationBySuitability(a,b,d);if(null!==a){b=[];for(d=0;d<a.length;d++)b.push(c.fromGE(a[d]));return b}return[]}})},"esri/geometry/pe":function(){define(["require",
"exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(B,a,q,p,b){function c(b){function d(a,b,d){a[b]=d(a[b])}a._pe=b;u.init();G.init();A.init();H.init();F.init();a.PeGCSExtent=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}q(d,b);d.prototype.destroy=function(){a._pe.destroy(this)};return d}(a._pe.PeGCSExtent);for(var f=0,c=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,
a._pe.PeUnit];f<c.length;f++)b=c[f],d(b.prototype,"getName",function(a){return function(){return a.call(this,Array(u.PE_NAME_MAX))}});f=0;for(c=[a._pe.PeGeogtran,a._pe.PeProjcs];f<c.length;f++)b=c[f],d(b.prototype,"getParameters",function(b){return function(){for(var d=Array(u.PE_PARM_MAX),f=b.call(this),c=0;c<d.length;c++){var h=a._pe.getValue(f,"*");d[c]=h?a._pe.wrapPointer(h,a._pe.PeParameter):null;f+=Int32Array.BYTES_PER_ELEMENT}return d}});d(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=
this.getSize();if(!b)return null;var d=[],f=a.call(this);w(d,b,f);return d}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var d=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var f=null,c=b.call(this);if(!a._pe.compare(c,a._pe.NULL)){var f=[c],h=this.getSteps();if(1<h)for(var c=a._pe.getPointer(c),l=1;l<h;l++)f.push(a._pe.wrapPointer(c+d*l,a._pe.PeGTlistExtendedGTs))}return f}});var h=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var d=this._cache;d||
(this._cache=d=new Map);if(d.has(b))return d.get(b);var f=null,c=b.call(this);if(!a._pe.compare(c,a._pe.NULL)){var f=[c],l=c.getNump();if(1<l)for(var c=a._pe.getPointer(c),k=1;k<l;k++)f.push(a._pe.wrapPointer(c+h*k,a._pe.PeHorizon))}d.set(b,f);return f}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=u.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var d=a._pe.getPointer(this),f=a._pe.ensureInt8(Array(u.PE_BUFFER_MAX));
return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(d,b,f))}}function d(b){if(b){var d=a._pe.getClass(b);d&&(d=a._pe.getCache(d))&&(b=a._pe.getPointer(b))&&delete d[b]}}function f(b,d){var f=[];d=Array(d);for(var c=0;c<b;c++)f.push(a._pe.ensureInt8(d));return f}function n(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function w(b,d,f,c){void 0===c&&(c=!1);if(c)for(c=0;c<2*d;c++)b[c]=a._pe.getValue(f+c*Float64Array.BYTES_PER_ELEMENT,"double");else{var h=
0===b.length;for(c=0;c<d;c++)h&&(b[c]=Array(2)),b[c][0]=a._pe.getValue(f,"double"),b[c][1]=a._pe.getValue(f+Float64Array.BYTES_PER_ELEMENT,"double"),f+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var C;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!p("esri-wasm")};a.load=function(){return C?C:C=b.create(function(a,b){B(["./support/pe-wasm"],function(d){d({locateFile:function(a){return B.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){c(b);
a()})})})};(function(b){function d(b,d,f){a._pe.ensureCache.prepare();var c=n(f),h=f===c,c=a._pe.ensureFloat64(c);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),d,c))&&w(f,d,c,h);return b}function f(a,b,d){return c(a,b,d,0)}function c(b,d,f,c){a._pe.ensureCache.prepare();var h=n(f),l=f===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),d,h,c))&&w(f,d,h,l);return b}b.geogToProj=d;b.projGeog=function(a,b,c,k){switch(k){case u.PE_TRANSFORM_P_TO_G:return f(a,b,c);case u.PE_TRANSFORM_G_TO_P:return d(a,
b,c)}return 0};b.projToGeog=f;b.projToGeogCenter=c})(a.PeCSTransformations||(a.PeCSTransformations={}));var u;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;
b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=
a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;
b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(u=a.PeDefs||(a.PeDefs={}));(function(b){function d(b,d){var h=null,l=c[b];l||(l={},c[b]=l);l.hasOwnProperty(String(d))?h=l[d]:(b=a._pe.PeFactory.prototype.factoryByType(b,d),a._pe.compare(b,a._pe.NULL)||(h=b,l[d]=h));return h=f(h)}function f(b){if(b){var d=b.getType();switch(d){case u.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);
break;case u.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case u.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:d&u.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var c={},h={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return d(u.PE_TYPE_COORDSYS,a)};b.factoryByType=d;b.fromString=function(b,d){var c=null,l=h[b];l||(l={},h[b]=l);l.hasOwnProperty(d)?c=l[d]:(b=a._pe.PeFactory.prototype.fromString(b,d),
a._pe.compare(b,a._pe.NULL)||(c=b,l[d]=c));return c=f(c)};b.geogcs=function(a){return d(u.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return d(u.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return d(u.PE_TYPE_PROJCS,a)};b.unit=function(a){return d(u.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var G;(function(b){var d;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
d=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,f,c,l,k,n){var h=null,r=new a._pe.PeInteger(n);try{var t=a._pe.PeGTlistExtended.prototype.getGTlist(b,f,c,l,k,r);if(n=r.val)if(h=[t],1<n){var y=a._pe.getPointer(t);for(b=1;b<n;b++)h.push(a._pe.wrapPointer(y+d*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(r)}return h}})(G=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var f=0;f<b.length;f++){var c=b[f];d(c);c.getEntries().forEach(function(a){d(a);
a=a.getGeogtran();d(a);a.getParameters().forEach(d);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){d(a);var b=a.getDatum();d(b);d(b.getSpheroid());d(a.getPrimem());d(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,d,f,c,l){a._pe.ensureCache.prepare();var h=n(f),k=f===h,h=a._pe.ensureFloat64(h),r=0;c&&(r=a._pe.ensureFloat64(c));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),d,h,r,
l))&&w(f,d,h,k);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function d(b,d,c,k,t,w){a._pe.ensureCache.prepare();var h,l;switch(b){case "dd":h=a._pe._pe_geog_to_dd;l=u.PE_DD_MAX;break;case "ddm":h=a._pe._pe_geog_to_ddm;l=u.PE_DDM_MAX;break;case "dms":h=a._pe._pe_geog_to_dms,l=u.PE_DMS_MAX}b=0;d&&(b=a._pe.getPointer(d));d=n(k);d=a._pe.ensureFloat64(d);l=f(c,l);k=a._pe.ensureInt32(l);if(t=h(b,c,d,t,k))for(h=0;h<c;h++)w[h]=a._pe.UTF8ToString(l[h]);return t}function c(b,
d,f,c,k){a._pe.ensureCache.prepare();var h;switch(b){case "dd":h=a._pe._pe_dd_to_geog;break;case "ddm":h=a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}b=0;d&&(b=a._pe.getPointer(d));d=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(d);d=a._pe.ensureFloat64(Array(2*f));(h=h(b,f,c,d))&&w(k,f,d);return h}b.geog_to_dms=function(a,b,f,c,k){return d("dms",a,b,f,c,k)};b.dms_to_geog=function(a,b,d,f){return c("dms",a,b,d,f)};b.geog_to_ddm=function(a,b,f,c,k){return d("ddm",
a,b,f,c,k)};b.ddm_to_geog=function(a,b,d,f){return c("ddm",a,b,d,f)};b.geog_to_dd=function(a,b,f,c,k){return d("dd",a,b,f,c,k)};b.dd_to_geog=function(a,b,d,f){return c("dd",a,b,d,f)}})(a.PeNotationDms||(a.PeNotationDms={}));var A;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,d,c,h,l,y,t){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=n(c);c=a._pe.ensureFloat64(b);b=f(d,u.PE_MGRS_MAX);var r=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_mgrs_extended(k,d,c,h,l,y,r))for(l=0;l<d;l++)t[l]=a._pe.UTF8ToString(b[l]);return h};b.mgrs_to_geog_extended=function(b,d,f,c,n){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});
f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(c=a._pe._pe_mgrs_to_geog_extended(h,d,f,c,b))&&w(n,d,b);return c}})(A=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,d,c,h,l,w,t){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=n(c);c=a._pe.ensureFloat64(b);b=f(d,u.PE_MGRS_MAX);var r=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_usng(k,d,c,h,l,w,r))for(l=0;l<d;l++)t[l]=a._pe.UTF8ToString(b[l]);return h};b.usng_to_geog=function(b,d,f,c){a._pe.ensureCache.prepare();
var h=0;b&&(h=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(h=a._pe._pe_usng_to_geog(h,d,f,b))&&w(c,d,b);return h}})(a.PeNotationUsng||(a.PeNotationUsng={}));var H;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
d,c,h,l){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=n(c);c=a._pe.ensureFloat64(b);b=f(d,u.PE_UTM_MAX);var t=a._pe.ensureInt32(b);if(h=a._pe._pe_geog_to_utm(k,d,c,h,t))for(k=0;k<d;k++)l[k]=a._pe.UTF8ToString(b[k]);return h};b.utm_to_geog=function(b,d,f,c,n){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(c=a._pe._pe_utm_to_geog(h,d,f,c,b))&&w(n,d,b);return c}})(H=
a.PeNotationUtm||(a.PeNotationUtm={}));var F;(function(b){var d=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(f,c){void 0===c&&(c=b.PE_PCSINFO_OPTION_DOMAIN);var h,n;d.has(f)&&(n=d.get(f),n[c]&&(h=n[c]));h||(h=a._pe.PePCSInfo.prototype.generate(f,
c),n||(n=[],d.set(f,n)),n[c]=h);return h}})(F=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(B,a,q){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<
a.length;b++){var d=a[b];d instanceof q?this.steps.push(d):this.steps.push(new q({wkid:d.wkid,wkt:d.wkt,isInverse:d.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(b){var c=new a,d="",f=0;for(b=b.steps;f<b.length;f++){var n=q.fromGE(b[f]);c.steps.push(n);d+=n.uid.toString()+
","}c._cached_projection={};c._gtlistentry=null;c._chain=d;return c};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var c=this.steps.length-1;0<=c;c--)b.steps.push(this.steps[c].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",c=0,d=this.steps;c<d.length;c++)a+=d[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,c,d){this._cached_projection[a.cacheKey(b,
c)]=d};a.prototype.getCachedGeTransformation=function(b,c){for(var d="",f=0,n=this.steps;f<n.length;f++)d+=n[f].uid.toString()+",";d!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=d);b=this._cached_projection[a.cacheKey(b,c)];return void 0===b?null:b};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(B,a){var q=0;return function(){function a(a){void 0===a&&(a=null);this.uid=q++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var c=new a;c._wkt=b.wkt;c._wkid=b.wkid;c._isInverse=b.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=q++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array @dojo/framework/shim/Map @dojo/framework/shim/Set ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(B,a,q,p,b,c,d,f,n,w,C,u,G,A,H,F,D,k,v,r,h,l,y,t,M,Q,la,ma){Object.defineProperty(a,"__esModule",{value:!0});var N=C.getLogger("esri.layers.graphics.data.QueryEngine");B=function(){return function(a,b,d,f,c){this.attributes=a;this.localId=b;this.geometry=d;this.centroid=f;this.filterFlags=c}}();a.Feature=B;var S=new f.default,m=new u.MemCacheStorage(2E6),E=0;B=function(){function a(a){var b=this;this.capabilities={query:l.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;
this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.gdbVersion=a.gdbVersion;this.historicMoment=a.historicMoment;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new u.MemCache(E++ +"$$",m));this.fieldsIndex=
new la(a.fields);a.scheduler&&a.priority&&(this._frameQueue=new ma.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.priority,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=
null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:Q.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?
this._timeExtent?this._timeExtent:this._timeExtent=M.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,f;return p(this,function(c){switch(c.label){case 0:b=w.clone(a),c.label=1;case 1:return c.trys.push([1,13,,14]),[4,Q.normalizeQuery(b,
this.definitionExpression,this.spatialReference)];case 2:return b=c.sent(),[4,this._reschedule()];case 3:return c.sent(),[4,this._checkQuerySupport(b)];case 4:return b=c.sent(),[4,this._reschedule()];case 5:return c.sent(),[4,this._executeGeometryQuery(b)];case 6:return d=c.sent(),[4,this._reschedule()];case 7:return c.sent(),[4,d.executeObjectIdsQuery(b)];case 8:return d=c.sent(),[4,this._reschedule()];case 9:return c.sent(),[4,d.executeTimeQuery(b)];case 10:return d=c.sent(),[4,this._reschedule()];
case 11:return c.sent(),[4,d.executeAttributesQuery(b)];case 12:return d=c.sent(),[3,14];case 13:f=c.sent();if(f!==Q.QUERY_ENGINE_EMPTY_RESULT)throw f;d=new y.default([],null,this);return[3,14];case 14:return[2,d.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,f;return p(this,function(c){switch(c.label){case 0:b=w.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,c.label=1;case 1:return c.trys.push([1,
13,,14]),[4,Q.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 2:return b=c.sent(),[4,this._reschedule()];case 3:return c.sent(),[4,this._checkQuerySupport(b)];case 4:return b=c.sent(),[4,this._reschedule()];case 5:return c.sent(),[4,this._executeGeometryQuery(b)];case 6:return d=c.sent(),[4,this._reschedule()];case 7:return c.sent(),[4,d.executeObjectIdsQuery(b)];case 8:return d=c.sent(),[4,this._reschedule()];case 9:return c.sent(),[4,d.executeTimeQuery(b)];case 10:return d=
c.sent(),[4,this._reschedule()];case 11:return c.sent(),[4,d.executeAttributesQuery(b)];case 12:return d=c.sent(),[2,d.size];case 13:f=c.sent();if(f!==Q.QUERY_ENGINE_EMPTY_RESULT)throw f;return[2,0];case 14:return[2]}})})};a.prototype.executeQueryForExtent=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,f,c,m,n,l,k;return p(this,function(E){switch(E.label){case 0:b=w.clone(a),f=b.outSR,E.label=1;case 1:return E.trys.push([1,13,,14]),[4,Q.normalizeQuery(b,this.definitionExpression,
this.spatialReference)];case 2:return b=E.sent(),[4,this._reschedule()];case 3:return E.sent(),[4,this._checkQuerySupport(b)];case 4:return b=E.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule()];case 5:return E.sent(),[4,this._executeGeometryQuery(b)];case 6:return d=E.sent(),[4,this._reschedule()];case 7:return E.sent(),[4,d.executeObjectIdsQuery(b)];case 8:return d=E.sent(),[4,this._reschedule()];case 9:return E.sent(),[4,d.executeTimeQuery(b)];case 10:return d=E.sent(),
[4,this._reschedule()];case 11:return E.sent(),[4,d.executeAttributesQuery(b)];case 12:d=E.sent();c=d.size;if(!c)return[2,{count:c,extent:null}];H.set(I,H.NEGATIVE_INFINITY);this.featureStore.forEachBounds(d.items,function(a){return H.expand(I,a)},pa);m={xmin:I[0],ymin:I[1],xmax:I[3],ymax:I[4],spatialReference:Q.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(I[2])&&isFinite(I[5])&&(m.zmin=I[2],m.zmax=I[5]);n=h.project(m,d.spatialReference,f);n.spatialReference=Q.cleanFromGeometryEngine(f||
this.spatialReference);0===n.xmax-n.xmin&&(l=A.getMetersPerUnitForSR(n.spatialReference),n.xmin-=l,n.xmax+=l);0===n.ymax-n.ymin&&(l=A.getMetersPerUnitForSR(n.spatialReference),n.ymin-=l,n.ymax+=l);this.hasZ&&null!=n.zmin&&null!=n.zmax&&0===n.zmax-n.zmin&&(l=A.getMetersPerUnitForSR(n.spatialReference),n.zmin-=l,n.zmax+=l);return[2,{count:c,extent:n}];case 13:k=E.sent();if(k===Q.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw k;case 14:return[2]}})})};a.prototype.executeQueryForIds=
function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){return p(this,function(b){return[2,this.executeQueryForIdSet(a,d).then(function(a){return c.from(a)})]})})};a.prototype.executeQueryForIdSet=function(a,d){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,d,c,m,h,n,l,E;return p(this,function(k){switch(k.label){case 0:b=w.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,k.label=1;case 1:return k.trys.push([1,12,,13]),[4,Q.normalizeQuery(b,this.definitionExpression,
this.spatialReference)];case 2:return b=k.sent(),[4,this._reschedule()];case 3:return k.sent(),[4,this._executeGeometryQuery(b)];case 4:return d=k.sent(),[4,this._reschedule()];case 5:return k.sent(),[4,d.executeObjectIdsQuery(b)];case 6:return d=k.sent(),[4,this._reschedule()];case 7:return k.sent(),[4,d.executeTimeQuery(b)];case 8:return d=k.sent(),[4,this._reschedule()];case 9:return k.sent(),[4,d.executeAttributesQuery(b)];case 10:return d=k.sent(),[4,this._reschedule()];case 11:k.sent();c=d.items;
m=new f.default;h=0;for(n=c;h<n.length;h++)l=n[h],m.add(d.featureAdapter.getObjectId(l));return[2,m];case 12:E=k.sent();if(E===Q.QUERY_ENGINE_EMPTY_RESULT)return[2,new f.default];throw E;case 13:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){var d=this;if(this.timeInfo)return this.executeQuery(a,b).then(function(a){return d._filterLatest(a,d.timeInfo)});N.error(new n("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};a.prototype._reschedule=
function(a){return b(this,void 0,void 0,function(){return p(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a).then(function(a){return a})]:[2,a]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._filterLatest=function(a,b){var c=b.trackIdField,f=b.startTimeField;b=b.endTimeField||f;for(var f=new d.default,m=[],h=0,n=a.features;h<n.length;h++){var l=n[h],k=l.attributes[c],
E=l.attributes[b];(!f.has(k)||f.get(k).attributes[b]<E)&&f.set(k,l)}f.forEach(function(a){return m.push(a)});return q({},a,{features:m})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new y.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return b(this,void 0,void 0,function(){var d,c,m,h,n,l,k,E,r,w,S,u,I,M,la,pa,C,q,A,G,ia,Q,ma,N,D=this;return p(this,function(X){switch(X.label){case 0:d=
a.geometry;c=a.outSR;m=a.spatialRel;h=v.isValid(c)&&!v.equals(this.spatialReference,c);if(n=this.cacheSpatialQueries?h?JSON.stringify({geometry:d,spatialRelationship:m,outSpatialReference:c}):JSON.stringify({geometry:d,spatialRelationship:m}):null)if(l=this._geometryQueryCache.get(n),void 0!==l)return[2,l];k=function(d){return b(D,void 0,void 0,function(){var b;return p(this,function(f){switch(f.label){case 0:return h&&(a.returnGeometry||a.returnCentroid)?[4,d.project(c)]:[3,2];case 1:return b=f.sent(),
n&&this._geometryQueryCache.put(n,b,b.size||1),[2,b];case 2:return n&&this._geometryQueryCache.put(n,d,d.size||1),[2,d]}})})};if(!d)return[2,k(this._getAll())];E=this.featureAdapter;if("esriSpatialRelDisjoint"!==m)return[3,5];r=this._searchFeatures(this._getQueryBBoxes(d));if(!r.length)return[2,k(this._getAll())];u=new f.default;I=0;for(M=r;I<M.length;I++)la=M[I],u.add(E.getObjectId(la));return[4,this._reschedule(u)];case 1:return u=X.sent(),pa=0,w=Array(u.size),this.featureStore.forEach(function(a){return w[pa++]=
a}),S=u,[4,this._reschedule()];case 2:return X.sent(),[4,t.getSpatialQueryOperator(m,d,this)];case 3:return C=X.sent(),q=function(a){return!S.has(E.getObjectId(a))||C(E.getGeometry(a))},G=y.default.bind,[4,this._runSpatialFilter(w,q)];case 4:return A=new (G.apply(y.default,[void 0,X.sent(),d,this])),[2,k(A)];case 5:return ia=this._searchFeatures(this._getQueryBBoxes(d)),ia.length?(Q=this._canExecuteSoloPass(d,a))?[2,k(new y.default(ia,d,this))]:[4,t.getSpatialQueryOperator(m,d,this)]:(A=new y.default([],
d,this),n&&this._geometryQueryCache.put(n,A,A.size||1),[2,A]);case 6:return ma=X.sent(),[4,this._runSpatialFilter(ia,function(a){return ma(E.getGeometry(a))})];case 7:return N=X.sent(),[2,k(new y.default(N,d,this))]}})})};a.prototype._runSpatialFilter=function(a,d){return b(this,void 0,void 0,function(){var f,c,m,h=this;return p(this,function(n){if(!d)return[2,a];if(!this._budget)return[2,a.filter(function(a){return d(a)})];f=0;c=[];m=function(){return b(h,void 0,void 0,function(){var b;return p(this,
function(h){switch(h.label){case 0:if(!(f<a.length))return[3,3];b=a[f];d(b)&&c.push(b);return this._budget.done?[4,this._reschedule()]:[3,2];case 1:return h.sent(),[2,m()];case 2:return++f,[3,0];case 3:return[2]}})})};return[2,this._reschedule().then(function(){return m()}).then(function(){return c})]})})};a.prototype._canExecuteSoloPass=function(a,b){var d=this.geometryType;b=b.spatialRel;return t.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===d&&("esriSpatialRelIntersects"===
b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(t.canQueryWithRBush(a)){if(k.isExtent(a))return[F.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(k.isPolygon(a))return a.rings.map(function(a){return F.fromValues(a[0][0],a[0][1],a[2][0],a[2][1])})}return[D.getBoundsXY(F.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){S.add(a)});var d=Array(S.size),f=0;S.forEach(function(a){return d[f++]=
a});S.clear();return d};a.prototype._checkQuerySupport=function(a){return b(this,void 0,void 0,function(){return p(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new n("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,G.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),t.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),h.checkProjectionSupport(this.spatialReference,
a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,d=a.orderByFields,f=a.returnDistinctValues;d&&0<d.length&&(d=d.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),r.validateFields(this.fieldsIndex,d,"orderByFields contains missing fields"));if(b&&0<b.length)r.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(f)throw new n("feature-store:unsupported-query",
"outFields should be specified for returnDistinctValues",{query:a});r.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b(this,void 0,void 0,function(){var b,d,f,c,m,h,k,l,E,t,w,y;return p(this,function(p){b=a.outStatistics;d=a.groupByFieldsForStatistics;f=a.having;c=d&&d.length;m=b&&b.length;if(f){if(!c||!m)throw new n("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});r.validateHaving(this.fieldsIndex,
f,b)}if(m){if(h=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];k=b.map(function(a){return a.onStatisticField});r.validateFields(this.fieldsIndex,k,"onStatisticFields contains missing fields");c&&r.validateFields(this.fieldsIndex,d,"groupByFieldsForStatistics contains missing fields");l=0;for(E=b;l<E.length;l++){t=E[l];w=t.onStatisticField;y=t.statisticType;if("exceedslimit"===y)throw new n("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:t,
query:a});if((!c||"count"!==y)&&w&&r.hasInvalidFieldType(w,this.fieldsIndex))throw new n("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:t,query:a});}}return[2]})})};return a}();a.default=B;var pa=H.create(),I=H.create()})},"esri/core/MemCache":function(){define(["require","exports","./iteratorUtils","./PooledArray","./string"],function(B,a,q,p,b){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b,c){this._namespace=a;this._storage=
b;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";c&&(this._storage.registerRemoveFunc(this._namespace,c),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,b,c,w){void 0===w&&(w=1);this._storage.put(this._namespace+a,b,c,w)};a.prototype.get=function(a){a=
this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=B;B=function(){function a(a){void 0===
a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new p}a.prototype.register=function(a){this._users.push(a)};a.prototype.deregister=function(a){this._users.removeUnordered(a)};a.prototype.registerRemoveFunc=function(a,b){this._removeFuncs.push([a,b])};a.prototype.deregisterRemoveFunc=function(a){this._removeFuncs=this._removeFuncs.filter(function(b){return b[0]!==a})};Object.defineProperty(a.prototype,"size",{get:function(){return this._size},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._size>this._maxSize&&this._removeEntries()},enumerable:!0,configurable:!0});a.prototype.put=function(a,b,c,w){if(this._db.has(a)){var d=this._db.get(a);this._size-=d.size;this._db.delete(a);this._notifyRemoved(a,d.entry)}c>this._maxSize?this._notifyRemoved(a,b):void 0===b?console.warn("Refusing to cache undefined entry "):!c||0>c?console.warn("Refusing to cache entry with invalid size "+
c):(this._db.set(a,{entry:b,size:c,lifetime:w,lives:w}),this._size+=c,this._size>this._maxSize&&this._removeEntries())};a.prototype.pop=function(a){if(this._db.has(a)){var b=this._db.get(a);this._size-=b.size;this._db.delete(a);++this._hit;return b.entry}++this._miss};a.prototype.get=function(a){var b=this._db.get(a);if(void 0===b)++this._miss;else return this._db.delete(a),b.lives=b.lifetime,this._db.set(a,b),++this._hit,b.entry};a.prototype.getStats=function(){var a=this,f={Size:Math.round(this._size/
1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},c={},w=[];this._db.forEach(function(d,f){var n=d.lifetime;w[n]=(w[n]||0)+1;a._users.forEach(function(a){a=a.namespace;if(b.startsWith(f,a))return c[a]=(c[a]||0)+d.size,!1})});var p={};this._users.forEach(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(c[b]=c[b]||0,p[b]=Math.round(100*a.hitRate)+"%"):p[b]="0%"});var u=Object.keys(c);u.forEach(function(b){return c[b]=
c[b]/a._size*100});u.sort(function(a,b){return c[b]-c[a]});u.forEach(function(a){return f[a]=Math.round(c[a])+"% / "+p[a]});for(u=0;u<w.length;++u){var q=w[u];q&&(f["Lifetime "+u]=Math.round(q/this._db.size*100)+"%")}return f};a.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};a.prototype.clear=function(a){var d=this;this._db.forEach(function(c,f){b.startsWith(f,a)&&(d._size-=c.size,d._db.delete(f),d._notifyRemoved(f,c.entry))})};a.prototype.clearAll=
function(){var a=this;this._db.forEach(function(b,d){a._notifyRemoved(d,b.entry)});this._size=0;this._db.clear()};a.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};a.prototype._notifyRemoved=function(a,c){this._removeFuncs.forEach(function(d){if(b.startsWith(a,d[0]))d[1](c)})};a.prototype._removeEntries=function(){var a=this;q.everyMap(this._db,function(b,d){a._db.delete(d);1>=b.lives?(a._size-=b.size,a._notifyRemoved(d,b.entry)):(--b.lives,a._db.set(d,b));return a._size>
.9*a.maxSize})};return a}();a.MemCacheStorage=B})},"esri/core/iteratorUtils":function(){define(["require","exports"],function(B,a){Object.defineProperty(a,"__esModule",{value:!0});a.everyMap=Map.prototype.entries?function(a,p){a=a.entries();for(var b=a.next();!b.done;b=a.next())if(!1===p(b.value[1],b.value[0]))return!1;return!0}:function(a,p){var b=!0;a.forEach(function(a,d){b&&(b=!1!==p(a,d))});return b}})},"esri/core/PooledArray":function(){define(["require","exports","./tsSupport/generatorHelper",
"./arrayUtils","./HeapSort"],function(B,a,q,p,b){return function(){function a(a){var b=this;this.data=[];this._length=0;this._allocator=null;this._deallocator=function(){};this._shrink=function(){};this._hint=new p.RemoveHint;a&&(a.initialSize&&(this.data=Array(a.initialSize)),a.allocator?(this._allocator=a.allocator,this._deallocator=a.deallocator):"deallocator"in a&&(this._deallocator=a.deallocator),a.shrink&&(this._shrink=function(){b.data.length>1.5*b.length&&(b.data.length=Math.floor(1.1*b.length))}))}
a.prototype.toArray=function(){return this.data.slice(0,this.length)};Object.defineProperty(a.prototype,"length",{get:function(){return this._length},set:function(a){if(a>this._length)if(this._allocator)for(;this._length<a;)this.data[this._length++]=this._allocator(this.data[this._length]);else this._length=a;else{if(this._deallocator)for(var b=a;b<this._length;++b)this.data[b]=this._deallocator(this.data[b]);this._length=a;this._shrink()}},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.length=
0};a.prototype.prune=function(){this.clear();this.data=[]};a.prototype.equal=function(a){return p.equals(this.data,a.data)};a.prototype.push=function(a){return this.data[this._length++]=a};a.prototype.pushArray=function(a,b){void 0===b&&(b=a.length);for(var d=0;d<b;d++)this.data[this._length++]=a[d];return this.back()};a.prototype.pushNew=function(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));++this._length;return this.back()};a.prototype.pop=function(){if(0!==
this.length){var a=this.data[this.length-1];--this.length;this._shrink();return a}};a.prototype.removeMany=function(a){var b=this,d=[];this.data=this.data.filter(function(c,f){if(f>=b.length)return!1;if(0>a.indexOf(c))return!0;d.push(c);return!1});this._length=this.data.length;return d};a.prototype.iterableRemoveMany=function(a,b){var d,c;return q(this,function(f){switch(f.label){case 0:d=[],c=0,f.label=1;case 1:if(!(c<this.length)||c>=this.length)return[3,4];0>a.indexOf(this.data[c])&&d.push(this.data[c]);
return b()?[4]:[3,3];case 2:f.sent(),f.label=3;case 3:return++c,[3,1];case 4:return this.data=d,this._length=this.data.length,[2]}})};a.prototype.removeUnordered=function(a){a=p.removeUnordered(this.data,a,this.length,this._hint);void 0!==a&&--this.length;return a};a.prototype.removeUnorderedIndex=function(a){if(!(a>=this.length||0>a))return this.swapElements(a,this.length-1),this.pop()};a.prototype.removeUnorderedMany=function(a,b,c){void 0===b&&(b=a.length);this.length=p.removeUnorderedMany(this.data,
a,this.length,b,this._hint,c)};a.prototype.front=function(){if(0!==this.length)return this.data[0]};a.prototype.back=function(){if(0!==this.length)return this.data[this.length-1]};a.prototype.swapElements=function(a,b){var d;a>=this.length||b>=this.length||a===b||(d=[this.data[b],this.data[a]],this.data[a]=d[0],this.data[b]=d[1])};a.prototype.sort=function(a){b.sort(this.data,0,this.length,a)};a.prototype.iterableSort=function(a,c){return b.iterableSort(this.data,0,this.length,a,c)};a.prototype.some=
function(a,b){for(var d=0;d<this.length;++d)if(a.call(b,this.data[d],d,this.data))return!0;return!1};a.prototype.find=function(a,b){for(var d=0;d<this.length;++d){var c=this.data[d];if(a.call(b,c,d,this.data))return c}};a.prototype.filterInPlace=function(a,b){for(var d=0,c=0;c<this._length;++c){var f=this.data[c];a.call(b,f,c,this.data)&&(this.data[c]=this.data[d],this.data[d]=f,d++)}if(this._deallocator)for(c=d;c<this._length;c++)this.data[c]=this._deallocator(this.data[c]);this._length=d;return this};
a.prototype.forEach=function(a,b){for(var d=this.length,c=0;c<Math.min(this.length,d);++c)a.call(b,this.data[c],c,this.data)};a.prototype.iterableForEach=function(){var a;return q(this,function(b){switch(b.label){case 0:a=0,b.label=1;case 1:return a<this.length?[4,this.data[a]]:[3,4];case 2:b.sent(),b.label=3;case 3:return++a,[3,1];case 4:return[2]}})};a.prototype.map=function(a,b){for(var d=Array(this.length),c=0;c<this.length;++c)d[c]=a.call(b,this.data[c],c,this.data);return d};return a}()})},
"esri/core/HeapSort":function(){define(["require","exports","./tsSupport/generatorHelper"],function(B,a,q){var p;(function(a){function b(a,b,d,c){for(var f=b,n=d>>>1,p=a[f-1];b<=n;){b=f<<1;b<d&&0>c(a[b-1],a[b])&&++b;var w=a[b-1];if(0>=c(w,p))break;a[f-1]=w;f=b}a[f-1]=p}function d(a,b){return a<b?-1:a>b?1:0}a.sort=function(a,c,p,q){void 0===c&&(c=0);void 0===p&&(p=a.length);void 0===q&&(q=d);for(var f=p>>>1;f>c;f--)b(a,f,p,q);for(var n=c+1,f=p-1;f>c;f--)p=a[c],a[c]=a[f],a[f]=p,b(a,n,f,q)};a.iterableSort=
function(a,c,p,C,u){var f,n,w;return q(this,function(q){switch(q.label){case 0:void 0===c&&(c=0),void 0===p&&(p=a.length),void 0===C&&(C=d),f=p>>>1,q.label=1;case 1:if(!(f>c))return[3,4];b(a,f,p,C);return u&&u()?[4]:[3,3];case 2:q.sent(),q.label=3;case 3:return f--,[3,1];case 4:n=c+1,f=p-1,q.label=5;case 5:if(!(f>c))return[3,8];w=a[c];a[c]=a[f];a[f]=w;b(a,n,f,C);return u&&u()?[4]:[3,7];case 6:q.sent(),q.label=7;case 7:return f--,[3,5];case 8:return[2]}})}})(p||(p={}));return p})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/Set ../../../core/Error ../../../core/sql/WhereClauseCache".split(" "),
function(B,a,q,p,b,c){function d(a,b){return a?w.get(a,b):null}function f(a,c,p,w){void 0===w&&(w=!0);for(var u=[],q=0;q<c.length;q++){var k=c[q];if("*"!==k&&!a.has(k))if(w){var v=n(k);try{var r=d(v,a);if(!r)throw new b("feature-store:unsupported-query","invalid SQL expression",{where:v});if(!r.isStandardized)throw new b("feature-store:unsupported-query","expression is not standard",{clause:r});f(a,r.fieldNames,"expression contains missing fields")}catch(h){if((v=h&&h.details)&&(v.clause||v.where))throw h;
v&&v.missingFields?u.push.apply(u,v.missingFields):u.push(k)}}else u.push(k)}if(u.length)throw new b("feature-store:unsupported-query",p,{missingFields:u});}function n(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var w=new c.WhereClauseCache(50,500),C=new p.default("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,d){if(!d)return!0;var c=
w.get(d,a);if(!c)throw new b("feature-store:unsupported-query","invalid SQL expression",{where:d});if(!c.isStandardized)throw new b("feature-store:unsupported-query","where clause is not standard",{where:d});f(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,d,c){if(!d)return!0;var n=w.get(d,a);if(!n)throw new b("feature-store:unsupported-query","invalid SQL expression",{having:d});if(!n.isAggregate)throw new b("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:d});f(a,n.fieldNames,"having contains missing fields");if(!n.getExpressions().every(function(b){var d=b.aggregateType;b=b.field;var f=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===f&&b.toLowerCase().trim()===d})}))throw new b("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:d});return!0};a.getWhereClause=d;a.validateFields=f;a.getExpressionFromFieldName=n;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!C.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(B,a,q,p){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b){this._cache=new q(a);this._invalidCache=new q(b)}a.prototype.get=function(a,b){var d=b.uid+":"+a,c=this._cache.get(d);if(c)return c;if(void 0!==this._invalidCache.get(d))return null;try{var w=
p.WhereClause.create(a,b);this._cache.put(d,w);return w}catch(C){return this._invalidCache.put(d,null),null}};return a}();a.WhereClauseCache=B})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(B,a,q){return function(){function a(a,c){this._storage=new q.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(B,a,q,p,b,c,d,f){function n(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function w(a,b,d,c,f,h,l,k,t){void 0===
d&&(d="0");void 0===c&&(c="0");void 0===f&&(f="0");void 0===h&&(h="0");void 0===l&&(l="");void 0===k&&(k="0");void 0===t&&(t="0");return"+"===l||"-"===l?(a=n(parseInt(a,10),4)+"-"+n(parseInt(b,10),2)+"-"+n(parseInt(d,10),2),b="",10>parseFloat(h)&&(b="0"),c=n(parseInt(c,10),2)+":"+n(parseInt(f,10),2)+":"+(b+parseFloat(h).toString()),l=""+l+n(parseInt(k,10),2)+":"+n(parseInt(t,10),2),new Date(a+"T"+c+l)):new Date(parseInt(a,10),parseInt(b,10),parseInt(d,10),parseInt(c,10),parseInt(f,10),parseFloat(h))}
function C(a){var b=M.exec(a);if(null!==b){a=b[1];var d=b[2],c=b[3],f=b[4],h=b[5],l=b[6];return w(a,d,c,f,h,l)}b=Q.exec(a);if(null!==b){a=b[1];var d=b[2],c=b[3],f=b[4],h=b[5],l=b[6],k=b[7],n=b[8],b=b[9];return w(a,d,c,f,h,l,k,n,b)}b=la.exec(a);if(null!==b)return a=b[1],d=b[2],c=b[3],f=b[4],h=b[5],k=b[6],n=b[7],b=b[8],w(a,d,c,f,h,"0",k,n,b);b=ma.exec(a);if(null!==b)return a=b[1],d=b[2],c=b[3],f=b[4],h=b[5],w(a,d,c,f,h);b=t.exec(a);if(null!==b)return a=b[1],d=b[2],c=b[3],w(a,d,c);throw Error("SQL Invalid Timestamp");
}function u(a){a=t.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],d=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(d,10))}function G(a){return Array.isArray(a)?a:[a]}function A(a){return null!==a?!0!==a:null}function H(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function F(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function D(a,b){if(null==a)return null;for(var d=!1,c=0;c<b.length;c++){var f=b[c];if(null==f)d=null;else if(a===
f){d=!0;break}}return d}function k(a,b,d){if(null==a)return null;for(var c="",f=0,m=0;m<b.length;m++){var h=b.charAt(m);switch(f){case 0:h===d?f=1:c=0<="-[]/{}()*+?.\\^$|".indexOf(h)?c+("\\"+h):"%"===h?c+".*":"_"===h?c+".":c+h;break;case 1:c=0<="-[]/{}()*+?.\\^$|".indexOf(h)?c+("\\"+h):c+h,f=0}}return(new RegExp("^"+c+"$")).test(a)}function v(a){return a instanceof Date?a.valueOf():a}function r(a,b,d){if(null==b||null==d)return null;b=v(b);d=v(d);switch(a){case "\x3c\x3e":return b!==d;case "\x3d":return b===
d;case "\x3e":return b>d;case "\x3c":return b<d;case "\x3e\x3d":return b>=d;case "\x3c\x3d":return b<=d}}function h(a){for(var b=[],d={},c=0;c<a.length;c++){var f=a[c],h=f.toLowerCase();void 0===d[h]&&(b.push(f),d[h]=1)}return b}function l(a,b,c){if(b instanceof d.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+c.getTime());case "-":return b.valueInMilliseconds()-c.getTime();case "*":return b.valueInMilliseconds()*c.getTime();case "/":return b.valueInMilliseconds()/
c.getTime()}else if(c instanceof d.SqlInterval)switch(a){case "+":return d.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+c.valueInMilliseconds());case "-":return d.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-c.valueInMilliseconds());case "*":return b.valueInMilliseconds()*c.valueInMilliseconds();case "/":return b.valueInMilliseconds()/c.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(c instanceof d.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-c.valueInMilliseconds());case "*":return b.getTime()*c.valueInMilliseconds();case "/":return b.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof c)switch(c*=864E5,b=b.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}else if(c instanceof Date&&"number"===typeof b)switch(b*=864E5,c=c.getTime(),a){case "+":return new Date(b+
c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}switch(a){case "+":return b+c;case "-":return b-c;case "*":return b*c;case "/":return b/c}}function y(a,b,d,c){a=c.getAttribute(a,b);return null!=a&&1===d[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var t=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,Q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
la=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,ma=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,N=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,d,c){return y(a,b,d,c)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,d){return k(a,b,d)};a.ensureArray=function(a){return G(a)};a.applyIn=function(a,b){return D(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,c){return d.SqlInterval.createFromValueAndQualifer(a,b,c)};a.convertInterval=function(a){return a instanceof d.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,d){return r(a,b,d)};a.calculate=function(a,b,d){return l(a,b,d)};a.makeComparable=function(a){return v(a)};a.evaluateFunction=function(a,b){return d.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return A(a)};a.ternaryAnd=function(a,b){return H(a,b)};a.ternaryOr=function(a,b){return F(a,b)};return a}();B=function(){function n(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=f.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var d=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=d}n.create=function(a,b){return new n(a,b)};Object.defineProperty(n.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});n.prototype.testSet=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);for(var c={},f=function(a){c[a]=b.map(function(b){return d.getAttribute(b,a)})},m=0,h=this.fieldNames;m<h.length;m++)f(h[m]);return!!this.evaluateNode(this.parseTree,{attributes:c},a.defaultAttributeAdapter)};n.prototype.calculateValue=
function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,c);return b instanceof d.SqlInterval?b.valueInMilliseconds()/864E5:b};n.prototype.calculateValueCompiled=function(d,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(d,this.parameters,c,this.datefields);if(b("csp-restrictions"))return this.calculateValue(d,c);this.compileMe();return this.parseTree._compiledVersion(d,this.parameters,
c,this.datefields)};n.prototype.testFeature=function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,d)};n.prototype.testFeatureCompiled=function(d,c){void 0===c&&(c=a.defaultAttributeAdapter);if(void 0===this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(d,this.parameters,c,this.datefields);if(b("csp-restrictions"))return this.testFeature(d,c);this.compileMe();return!!this.parseTree._compiledVersion(d,this.parameters,c,this.datefields)};
n.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return h(a)};n.prototype.getExpressions=function(){var a=new p.default;this.visitAll(this.parseTree,function(b){if("function"===b.type){var d=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var c=d+"-"+b;a.has(c)||a.set(c,{aggregateType:d,field:b})}}});return q.from(a.values())};n.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return h(a)};n.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(N)};n.prototype.extractExpressionInfo=function(a){var b=this,f=[],m=!0,l=!0;this.visitAll(this.parseTree,function(h){switch(h.type){case "column_ref":var k=h.column.toUpperCase();if("CURRENT_DATE"!==
k&&"CURRENT_TIMESTAMP"!==k){var n=(k=a.get(h.column))&&k.name;!k||"date"!==k.type&&"esriFieldTypeDate"!==k.type||(b.datefields[k.name]=1);void 0!==n?(f.push(n),h.column=n):f.push(h.column)}break;case "function":k=h.name,h=h.args.value.length,m&&(m=d.isStandardized(k,h)),l&&(l=c.isAggregate(k,h))}});return{referencedFieldNames:h(f),isStandardized:m,isAggregate:l}};n.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);
break;case "case_expression":for(var d=0,c=a.clauses;d<c.length;d++){var f=c[d];this.visitAll(f,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":d=0;for(a=a.value;d<a.length;d++)f=a[d],this.visitAll(f,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};n.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var d="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",c=0;c<a.clauses.length;c++)b+=" ("+d+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";else for(b="( ",c=0;c<a.clauses.length;c++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+
")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";d=0;for(a=a.value;d<a.length;d++)c=a[d],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(c);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+u(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+C(a.value).getTime().toString()+"))";case "column_ref":return"CURRENT_DATE"===
a.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===a.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};n.prototype.evaluateNode=function(a,b,f){switch(a.type){case "interval":return b=this.evaluateNode(a.value,b,f),d.SqlInterval.createFromValueAndQualifer(b,
a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var h=v(this.evaluateNode(a.operand,b,f)),m=0;m<a.clauses.length;m++){if(h===v(this.evaluateNode(a.clauses[m].operand,b,f)))return this.evaluateNode(a.clauses[m].value,b,f)}else for(m=0;m<a.clauses.length;m++)if(!0===this.evaluateNode(a.clauses[m].operand,b,f))return this.evaluateNode(a.clauses[m].value,b,f);return null!==a.else?this.evaluateNode(a.else,b,f):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":h=
[];m=0;for(a=a.value;m<a.length;m++){var n=a[m];h.push(this.evaluateNode(n,b,f))}return h;case "unary_expr":return A(this.evaluateNode(a.expr,b,f));case "binary_expr":switch(a.operator){case "AND":return H(this.evaluateNode(a.left,b,f),this.evaluateNode(a.right,b,f));case "OR":return F(this.evaluateNode(a.left,b,f),this.evaluateNode(a.right,b,f));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,b,f);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,b,f);case "IN":return h=G(this.evaluateNode(a.right,b,f)),D(this.evaluateNode(a.left,b,f),h);case "NOT IN":return h=G(this.evaluateNode(a.right,b,f)),A(D(this.evaluateNode(a.left,b,f),h));case "BETWEEN":return h=this.evaluateNode(a.left,b,f),a=this.evaluateNode(a.right,b,f),null==h||null==a[0]||null==a[1]?null:h>=v(a[0])&&h<=v(a[1]);case "NOTBETWEEN":return h=this.evaluateNode(a.left,b,f),a=this.evaluateNode(a.right,b,f),null==h||null==a[0]||null==a[1]?null:
h<v(a[0])||h>v(a[1]);case "LIKE":return k(this.evaluateNode(a.left,b,f),this.evaluateNode(a.right,b,f),a.escape);case "NOT LIKE":return A(k(this.evaluateNode(a.left,b,f),this.evaluateNode(a.right,b,f),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return r(a.operator,this.evaluateNode(a.left,b,f),this.evaluateNode(a.right,b,f));case "-":case "+":case "*":case "/":return l(a.operator,this.evaluateNode(a.left,b,f),this.evaluateNode(a.right,b,f))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return u(a.value);case "timestamp":return C(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(n=new Date,n.setHours(0,0,0,0),n):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:y(b,a.column,this.datefields,f);case "function":return b=this.evaluateNode(a.args,b,f),this.isAggregate?c.aggregateFunction(a.name,b):d.evaluateFunction(a.name,b)}throw Error("Unsupported sql syntax "+a.type);
};return n}();a.WhereClause=B;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(B,a){function q(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function p(a){for(var b=q(a),c=a.length,n=0,p=0;p<a.length;p++)n+=Math.pow(a[p]-b,2);return 1<c?n/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,d){var c=
b[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(d.length<c.minParams||d.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(d)};a.isAggregate=function(a,d){a=b[a.toLowerCase()];return null!=a&&d>=a.minParams&&d<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,
a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:q(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(p(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:p(a[0])}}}})},
"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(B,a,q){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var d=new a;d.second=b/1E3;return d};a.createFromValueAndQualifer=
function(b,d,f){var c=null,p=new a;p.op="-"===f?"-":"+";if("interval-period"===d.type){a.fixDefaults(d);if("year"===d.period||"month"===d.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))p[d.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(d.start);a.fixDefaults(d.end);if("year"===d.start.period||"month"===d.start.period)throw Error("Year-Month Intervals not supported");if("year"===d.end.period||"month"===d.end.period)throw Error("Year-Month Intervals not supported");
switch(d.start.period){case "day":switch(d.end.period){case "hour":c=/^[0-9]{1,} [0-9]{1,}$/;if(c.test(b))p[d.start.period]=parseFloat(b.split(" ")[0]),p[d.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(c.test(b))p[d.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),p.hour=parseFloat(b[0]),p.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(c.test(b))p[d.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),p.hour=parseFloat(b[0]),p.minute=parseFloat(b[1]),p.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(d.end.period){case "minute":c=/^[0-9]{1,}:[0-9]{1,}$/;if(c.test(b))p.hour=parseFloat(b.split(":")[0]),p.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(c.test(b))b=b.split(":"),p.hour=parseFloat(b[0]),p.minute=parseFloat(b[1]),p.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(d.end.period){case "second":c=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=b.split(":"),p.minute=parseFloat(b[0]),p.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return p};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=B;a.evaluateFunction=function(a,c){var b=p[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(c.length<b.minParams||c.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(c)};a.isStandardized=function(a,c){a=p[a.toLowerCase()];return null!=a&&c>=a.minParams&&
c<=a.maxParams};var p={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],d=a[1];return null==b||null==d?null:b.toString().substring(d-1)}if(3===a.length)return b=a[0],d=a[1],a=a[2],null==b||null==d||null==a?null:0>=a?"":b.toString().substring(d-1,d+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,d=b?a[1]:" ",b=b?a[2]:a[1];if(null==d||null==b)return null;d="("+q.escapeString(d)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
d+"*|"+d+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+d+"*","g"),"");case "TRAILING":return b.replace(new RegExp(d+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",d=0;d<
a.length;d++){if(null==a[d])return null;b+=a[d].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(B,a){var q={};a.setObject("dojo.regexp",q);q.escapeString=function(a,b){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return b&&
-1!=b.indexOf(a)?a:"\\"+a})};q.buildGroupRE=function(a,b,c){if(!(a instanceof Array))return b(a);for(var d=[],f=0;f<a.length;f++)d.push(b(a[f]));return q.group(d.join("|"),c)};q.group=function(a,b){return"("+(b?"?:":"")+a+")"};return q})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(B,a,q){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){}a.parse=function(a){return q.parse(a)};return a}();a.WhereGrammar=B})},"esri/core/sql/sql92grammar":function(){define([],
function(){function B(a,q,p,b){this.message=a;this.expected=q;this.found=p;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,B)}(function(a,q){function p(){this.constructor=a}p.prototype=q.prototype;a.prototype=new p})(B,Error);B.buildMessage=function(a,q){function p(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+p(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+p(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+p(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+p(a)})}var d={literal:function(a){return'"'+b(a.text)+
'"'},"class":function(a){var b="",d;for(d=0;d<a.parts.length;d++)b+=a.parts[d]instanceof Array?c(a.parts[d][0])+"-"+c(a.parts[d][1]):c(a.parts[d]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var f=c,p;p=a[c];p=d[p.type](p);b[f]=p}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=
a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(q?'"'+b(q)+'"':"end of input")+" found."};return{SyntaxError:B,parse:function(a,q){function p(a,b){return{type:"literal",text:a,ignoreCase:b}}function b(a,b,e){return{type:"class",parts:a,inverted:b,ignoreCase:e}}function c(b){var e=Ia[b],d;if(!e){for(d=b-1;!Ia[d];)d--;e=Ia[d];for(e={line:e.line,column:e.column};d<b;)10===a.charCodeAt(d)?(e.line++,e.column=
1):e.column++,d++;Ia[b]=e}return e}function d(a,b){var e=c(a),d=c(b);return{start:{offset:a,line:e.line,column:e.column},end:{offset:b,line:d.line,column:d.column}}}function f(a){g<Z||(g>Z&&(Z=g,Ra=[]),Ra.push(a))}function n(){var a,b,d;a=g;b=z();b!==e?(b=C(),b!==e?(d=z(),d!==e?a=b:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function w(){var a,b,d,c,f,h,k,l;a=g;b=C();if(b!==e){d=[];c=g;f=z();f!==e?(h=Ba(),h!==e?(k=z(),k!==e?(l=C(),l!==e?c=f=[f,h,k,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);for(;c!==
e;)d.push(c),c=g,f=z(),f!==e?(h=Ba(),h!==e?(k=z(),k!==e?(l=C(),l!==e?c=f=[f,h,k,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);if(d!==e){a={type:"expr_list"};b=[b];for(c=0;c<d.length;c++)b.push(d[c][3]);a.value=b}else g=a,a=e}else g=a,a=e;return a}function C(){var a,b,d,c,f,h,k,l;a=g;b=u();if(b!==e){d=[];c=g;f=z();f!==e?(h=oa(),h!==e?(k=z(),k!==e?(l=u(),l!==e?c=f=[f,h,k,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);for(;c!==e;)d.push(c),c=g,f=z(),f!==e?(h=oa(),h!==e?(k=z(),k!==e?(l=u(),l!==e?c=f=[f,
h,k,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);d!==e?a=b=Ca(b,d):(g=a,a=e)}else g=a,a=e;return a}function u(){var a,b,d,c,f,h,k,l;a=g;b=G();if(b!==e){d=[];c=g;f=z();f!==e?(h=ca(),h!==e?(k=z(),k!==e?(l=G(),l!==e?c=f=[f,h,k,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);for(;c!==e;)d.push(c),c=g,f=z(),f!==e?(h=ca(),h!==e?(k=z(),k!==e?(l=G(),l!==e?c=f=[f,h,k,l]:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);d!==e?a=b=Ca(b,d):(g=a,a=e)}else g=a,a=e;return a}function G(){var b,d,c,h,k;b=g;d=na();d===e&&
(d=g,33===a.charCodeAt(g)?(c=$c,g++):(c=e,0===x&&f(ad)),c!==e?(h=g,x++,61===a.charCodeAt(g)?(k=cb,g++):(k=e,0===x&&f(db)),x--,k===e?h=void 0:(g=h,h=e),h!==e?d=c=[c,h]:(g=d,d=e)):(g=d,d=e));d!==e?(c=z(),c!==e?(h=G(),h!==e?b=d={type:"unary_expr",operator:"NOT",expr:h}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e);if(b===e)if(b=g,d=D(),d!==e)if(c=z(),c!==e){var l,m,n;c=[];h=g;k=z();k!==e?(l=A(),l!==e?(m=z(),m!==e?(n=D(),n!==e?h=k=[k,l,m,n]:(g=h,h=e)):(g=h,h=e)):(g=h,h=e)):(g=h,h=e);if(h!==e)for(;h!==e;)c.push(h),
h=g,k=z(),k!==e?(l=A(),l!==e?(m=z(),m!==e?(n=D(),n!==e?h=k=[k,l,m,n]:(g=h,h=e)):(g=h,h=e)):(g=h,h=e)):(g=h,h=e);else c=e;c!==e&&(c={type:"arithmetic",tail:c});c===e&&(c=g,h=F(),h!==e?(k=z(),k!==e?(k=da(),k!==e?(k=z(),k!==e?(k=w(),k!==e?(l=z(),l!==e?(l=ea(),l!==e?c=h={op:h,right:k}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,h=F(),h!==e?(k=z(),k!==e?(k=da(),k!==e?(k=z(),k!==e?(k=ea(),k!==e?c=h={op:h,right:{type:"expr_list",value:[]}}:(g=c,c=e)):(g=c,c=e)):
(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,h=F(),h!==e?(k=z(),k!==e?(k=Q(),k!==e?c=h={op:h,right:k}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e))),c===e&&(c=g,k=na(),k!==e?(h=z(),h!==e?(h=ka(),h!==e?(l=z(),l!==e?(l=D(),l!==e?(m=z(),m!==e?(m=ca(),m!==e?(k=z(),k!==e?(k=D(),k!==e?c=k={op:"NOT"+h,right:{type:"expr_list",value:[l,k]}}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,k=ka(),k!==e?(h=z(),h!==e?(h=D(),h!==e?(l=z(),l!==e?(l=ca(),l!==e?(m=z(),
m!==e?(m=D(),m!==e?c=k={op:k,right:{type:"expr_list",value:[h,m]}}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)),c===e&&(c=g,h=ba(),h!==e?(k=z(),k!==e?(k=na(),k!==e?(k=z(),k!==e?(k=D(),k!==e?c=h={op:h+"NOT",right:k}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,h=ba(),h!==e?(k=z(),k!==e?(k=D(),k!==e?c=h={op:h,right:k}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)),c===e&&(c=g,h=H(),h!==e?(k=z(),k!==e?(k=E(),k!==e?(l=z(),l!==e?(l=g,a.substr(g,6).toLowerCase()===
bd?(m=a.substr(g,6),g+=6):(m=e,0===x&&f(cd)),m!==e?(m=g,x++,n=t(),x--,n===e?m=void 0:(g=m,m=e),m!==e?l="ESCAPE":(g=l,l=e)):(g=l,l=e),l!==e?(l=z(),l!==e?(l=pa(),l!==e?c=h={op:h,right:k,escape:l.value}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e),c===e&&(c=g,h=H(),h!==e?(k=z(),k!==e?(k=E(),k!==e?c=h={op:h,right:k,escape:""}:(g=c,c=e)):(g=c,c=e)):(g=c,c=e))))));c===e&&(c=null);c!==e?(b=d,d=c,""==d||void 0==d||null==d?d=b:(c=null,d=c="arithmetic"==d.type?Ca(b,d.tail):eb(d.op,
b,d.right,d.escape)),b=d):(g=b,b=e)}else g=b,b=e;else g=b,b=e;return b}function A(){var b;a.substr(g,2)===fb?(b=fb,g+=2):(b=e,0===x&&f(dd));b===e&&(62===a.charCodeAt(g)?(b=ed,g++):(b=e,0===x&&f(fd)),b===e&&(a.substr(g,2)===gb?(b=gb,g+=2):(b=e,0===x&&f(gd)),b===e&&(a.substr(g,2)===hb?(b=hb,g+=2):(b=e,0===x&&f(hd)),b===e&&(60===a.charCodeAt(g)?(b=id,g++):(b=e,0===x&&f(jd)),b===e&&(61===a.charCodeAt(g)?(b=cb,g++):(b=e,0===x&&f(db)),b===e&&(a.substr(g,2)===ib?(b=ib,g+=2):(b=e,0===x&&f(kd))))))));return b}
function H(){var a,b,c,d;a=a=g;b=na();b!==e?(c=z(),c!==e?(d=ja(),d!==e?a=b=[b,c,d]:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=ja());return a}function F(){var a,b,c,d;a=a=g;b=na();b!==e?(c=z(),c!==e?(d=ga(),d!==e?a=b=[b,c,d]:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=ga());return a}function D(){var a,b,c,d,f,h,l,m;a=g;b=v();if(b!==e){c=[];d=g;f=z();f!==e?(h=k(),h!==e?(l=z(),l!==e?(m=v(),m!==e?d=f=[f,h,l,m]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);for(;d!==
e;)c.push(d),d=g,f=z(),f!==e?(h=k(),h!==e?(l=z(),l!==e?(m=v(),m!==e?d=f=[f,h,l,m]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);c!==e?a=b=Ca(b,c):(g=a,a=e)}else g=a,a=e;return a}function k(){var b;43===a.charCodeAt(g)?(b=cc,g++):(b=e,0===x&&f(dc));b===e&&(45===a.charCodeAt(g)?(b=ec,g++):(b=e,0===x&&f(fc)));return b}function v(){var a,b,c,d,f,k,l,m;a=g;b=h();if(b!==e){c=[];d=g;f=z();f!==e?(k=r(),k!==e?(l=z(),l!==e?(m=h(),m!==e?d=f=[f,k,l,m]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);for(;d!==e;)c.push(d),
d=g,f=z(),f!==e?(k=r(),k!==e?(l=z(),l!==e?(m=h(),m!==e?d=f=[f,k,l,m]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);c!==e?a=b=Ca(b,c):(g=a,a=e)}else g=a,a=e;return a}function r(){var b;42===a.charCodeAt(g)?(b=ld,g++):(b=e,0===x&&f(md));b===e&&(47===a.charCodeAt(g)?(b=nd,g++):(b=e,0===x&&f(od)));return b}function h(){var b,c,d,h,k,m,n;n=pa();if(n===e){var r,p,v,q;r=g;var u,N,A,S;u=g;N=Y();N!==e?(A=ha(),A!==e?(S=K(),S!==e?u=N=parseFloat(N+A+S):(g=u,u=e)):(g=u,u=e)):(g=u,u=e);u===e&&(u=g,N=Y(),N!==e?(A=
ha(),A!==e?u=N=parseFloat(N+A):(g=u,u=e)):(g=u,u=e),u===e&&(u=g,N=Y(),N!==e?(A=K(),A!==e?u=N=parseFloat(N+A):(g=u,u=e)):(g=u,u=e),u===e&&(u=g,N=Y(),N!==e&&(N=parseFloat(N)),u=N)));p=u;p!==e?(v=g,x++,q=y(),x--,q===e?v=void 0:(g=v,v=e),v!==e?r=p={type:"number",value:p}:(g=r,r=e)):(g=r,r=e);n=r;if(n===e){var D,B;D=g;var G,F,H,T;G=g;a.substr(g,4).toLowerCase()===pd?(F=a.substr(g,4),g+=4):(F=e,0===x&&f(qd));F!==e?(H=g,x++,T=t(),x--,T===e?H=void 0:(g=H,H=e),H!==e?G=F=[F,H]:(g=G,G=e)):(g=G,G=e);B=G;B!==
e&&(B={type:"bool",value:!0});D=B;if(D===e){D=g;var W,ba,Z,na;W=g;a.substr(g,5).toLowerCase()===rd?(ba=a.substr(g,5),g+=5):(ba=e,0===x&&f(sd));ba!==e?(Z=g,x++,na=t(),x--,na===e?Z=void 0:(g=Z,Z=e),Z!==e?W=ba=[ba,Z]:(g=W,W=e)):(g=W,W=e);B=W;B!==e&&(B={type:"bool",value:!1});D=B}n=D;if(n===e){var ja,ca,oa,ka,Ca;ca=g;a.substr(g,4).toLowerCase()===td?(oa=a.substr(g,4),g+=4):(oa=e,0===x&&f(ud));oa!==e?(ka=g,x++,Ca=t(),x--,Ca===e?ka=void 0:(g=ka,ka=e),ka!==e?ca=oa=[oa,ka]:(g=ca,ca=e)):(g=ca,ca=e);ja=ca;
ja!==e&&(ja={type:"null",value:null});n=ja;if(n===e){var xa,Ba,Ia,Fa;xa=g;var Ja,za,jb,Ra;Ja=g;a.substr(g,4).toLowerCase()===vd?(za=a.substr(g,4),g+=4):(za=e,0===x&&f(wd));za!==e?(jb=g,x++,Ra=t(),x--,Ra===e?jb=void 0:(g=jb,jb=e),jb!==e?Ja=za="DATE":(g=Ja,Ja=e)):(g=Ja,Ja=e);Ba=Ja;Ba!==e?(Ia=z(),Ia!==e?(Fa=E(),Fa!==e?xa=Ba={type:"date",value:Fa.value}:(g=xa,xa=e)):(g=xa,xa=e)):(g=xa,xa=e);n=xa;if(n===e){var ya,gc,ab,hc;ya=g;var Ka,Hb,kb,bb;Ka=g;a.substr(g,9).toLowerCase()===xd?(Hb=a.substr(g,9),g+=
9):(Hb=e,0===x&&f(yd));Hb!==e?(kb=g,x++,bb=t(),x--,bb===e?kb=void 0:(g=kb,kb=e),kb!==e?Ka=Hb="TIMESTAMP":(g=Ka,Ka=e)):(g=Ka,Ka=e);gc=Ka;gc!==e?(ab=z(),ab!==e?(hc=E(),hc!==e?ya=gc={type:"timestamp",value:hc.value}:(g=ya,ya=e)):(g=ya,ya=e)):(g=ya,ya=e);n=ya;if(n===e){var O,Sa,Ib,va,Jb,Ta,cb,ic;O=g;Sa=Ga();Sa!==e?(Ib=z(),Ib!==e?(45===a.charCodeAt(g)?(va=ec,g++):(va=e,0===x&&f(fc)),va===e&&(43===a.charCodeAt(g)?(va=cc,g++):(va=e,0===x&&f(dc))),va!==e?(Jb=z(),Jb!==e?(Ta=E(),Ta!==e?(cb=z(),cb!==e?(ic=ma(),
ic!==e?O=Sa={type:"interval",value:Ta,qualifier:ic,op:va}:(g=O,O=e)):(g=O,O=e)):(g=O,O=e)):(g=O,O=e)):(g=O,O=e)):(g=O,O=e)):(g=O,O=e);O===e&&(O=g,Sa=Ga(),Sa!==e?(Ib=z(),Ib!==e?(va=E(),va!==e?(Jb=z(),Jb!==e?(Ta=ma(),Ta!==e?O=Sa={type:"interval",value:va,qualifier:Ta,op:""}:(g=O,O=e)):(g=O,O=e)):(g=O,O=e)):(g=O,O=e)):(g=O,O=e));n=O}}}}}}b=n;if(b===e){var U,jc,db,eb,fb,kc,gb,hb,ib,lc,ub,vb;U=g;var La,Kb,lb,wb;La=g;a.substr(g,7).toLowerCase()===zd?(Kb=a.substr(g,7),g+=7):(Kb=e,0===x&&f(Ad));Kb!==e?(lb=
g,x++,wb=t(),x--,wb===e?lb=void 0:(g=lb,lb=e),lb!==e?La=Kb="EXTRACT":(g=La,La=e)):(g=La,La=e);jc=La;if(jc!==e)if(db=z(),db!==e)if(eb=da(),eb!==e)if(fb=z(),fb!==e){var qa;qa=vc();qa===e&&(qa=wc(),qa===e&&(qa=xc(),qa===e&&(qa=yc(),qa===e&&(qa=zc(),qa===e&&(qa=Ha())))));kc=qa;kc!==e?(gb=z(),gb!==e?(hb=Aa(),hb!==e?(ib=z(),ib!==e?(lc=C(),lc!==e?(ub=z(),ub!==e?(vb=ea(),vb!==e?U=jc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:kc},lc]}}:(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):
(g=U,U=e)):(g=U,U=e)):(g=U,U=e)):(g=U,U=e)}else g=U,U=e;else g=U,U=e;else g=U,U=e;else g=U,U=e;b=U;if(b===e){var R,mc,xb,yb,zb,Lb,Ab,Bb,Cb,Mb,Db,fa,Ua,nc,oc,pc;R=g;var Ma,Nb,mb,Eb;Ma=g;a.substr(g,9).toLowerCase()===Bd?(Nb=a.substr(g,9),g+=9):(Nb=e,0===x&&f(Cd));Nb!==e?(mb=g,x++,Eb=t(),x--,Eb===e?mb=void 0:(g=mb,mb=e),mb!==e?Ma=Nb="SUBSTRING":(g=Ma,Ma=e)):(g=Ma,Ma=e);mc=Ma;if(mc!==e)if(xb=z(),xb!==e)if(yb=da(),yb!==e)if(zb=z(),zb!==e)if(Lb=C(),Lb!==e)if(Ab=z(),Ab!==e)if(Bb=Aa(),Bb!==e)if(Cb=z(),Cb!==
e)if(Mb=C(),Mb!==e)if(Db=z(),Db!==e){fa=g;var Na,Ob,nb,Ac;Na=g;a.substr(g,3).toLowerCase()===Dd?(Ob=a.substr(g,3),g+=3):(Ob=e,0===x&&f(Ed));Ob!==e?(nb=g,x++,Ac=t(),x--,Ac===e?nb=void 0:(g=nb,nb=e),nb!==e?Na=Ob="FOR":(g=Na,Na=e)):(g=Na,Na=e);Ua=Na;Ua!==e?(nc=z(),nc!==e?(oc=C(),oc!==e?(pc=z(),pc!==e?fa=Ua=[Ua,nc,oc,pc]:(g=fa,fa=e)):(g=fa,fa=e)):(g=fa,fa=e)):(g=fa,fa=e);fa===e&&(fa=null);fa!==e?(Ua=ea(),Ua!==e?R=mc={type:"function",name:"substring",args:{type:"expr_list",value:fa?[Lb,Mb,fa[2]]:[Lb,Mb]}}:
(g=R,R=e)):(g=R,R=e)}else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;else g=R,R=e;b=R;if(b===e){var J,Va,Pb,Qb,Rb,ra,Sb,Wa,Tb,Ub,Bc,qc,Cc,Dc;J=g;Va=Qa();Va!==e?(Pb=z(),Pb!==e?(Qb=da(),Qb!==e?(Rb=z(),Rb!==e?(ra=la(),ra===e&&(ra=null),ra!==e?(Sb=z(),Sb!==e?(Wa=C(),Wa!==e?(Tb=z(),Tb!==e?(Ub=Aa(),Ub!==e?(Bc=z(),Bc!==e?(qc=C(),qc!==e?(Cc=z(),Cc!==e?(Dc=ea(),Dc!==e?J=Va={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==ra?"BOTH":ra},Wa,qc]}}:(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e);J===e&&(J=g,Va=Qa(),Va!==e?(Pb=z(),Pb!==e?(Qb=da(),Qb!==e?(Rb=z(),Rb!==e?(ra=la(),ra===e&&(ra=null),ra!==e?(Sb=z(),Sb!==e?(Wa=C(),Wa!==e?(Tb=z(),Tb!==e?(Ub=ea(),Ub!==e?J=Va={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==ra?"BOTH":ra},Wa]}}:(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=
J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e)):(g=J,J=e));b=J;if(b===e){var V,rc,Ec,Fc,Gc,sc,Hc,Ic,Jc,tc,Kc,Lc;V=g;var Oa,Vb,ob,Mc;Oa=g;a.substr(g,8).toLowerCase()===Fd?(Vb=a.substr(g,8),g+=8):(Vb=e,0===x&&f(Gd));Vb!==e?(ob=g,x++,Mc=t(),x--,Mc===e?ob=void 0:(g=ob,ob=e),ob!==e?Oa=Vb="POSITION":(g=Oa,Oa=e)):(g=Oa,Oa=e);rc=Oa;rc!==e?(Ec=z(),Ec!==e?(Fc=da(),Fc!==e?(Gc=z(),Gc!==e?(sc=C(),sc!==e?(Hc=z(),Hc!==e?(Ic=ga(),Ic!==e?(Jc=z(),Jc!==e?(tc=C(),tc!==e?(Kc=z(),Kc!==e?(Lc=ea(),Lc!==e?V=rc={type:"function",
name:"position",args:{type:"expr_list",value:[sc,tc]}}:(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e);b=V;if(b===e){var aa,Wb,Nc,Oc,Pc,Xa,Qc,Rc;aa=g;var sa,pb,qb,wa;sa=g;sa=pb=l();if(sa===e)if(sa=g,96===a.charCodeAt(g)?(pb=Sc,g++):(pb=e,0===x&&f(Tc)),pb!==e){qb=[];Uc.test(a.charAt(g))?(wa=a.charAt(g),g++):(wa=e,0===x&&f(Vc));if(wa!==e)for(;wa!==e;)qb.push(wa),Uc.test(a.charAt(g))?(wa=a.charAt(g),g++):(wa=e,0===x&&f(Vc));else qb=
e;qb!==e?(96===a.charCodeAt(g)?(wa=Sc,g++):(wa=e,0===x&&f(Tc)),wa!==e?sa=pb=qb.join(""):(g=sa,sa=e)):(g=sa,sa=e)}else g=sa,sa=e;Wb=sa;Wb!==e?(Nc=z(),Nc!==e?(Oc=da(),Oc!==e?(Pc=z(),Pc!==e?(Xa=w(),Xa===e&&(Xa=null),Xa!==e?(Qc=z(),Qc!==e?(Rc=ea(),Rc!==e?aa=Wb={type:"function",name:Wb,args:Xa?Xa:{type:"expr_list",value:[]}}:(g=aa,aa=e)):(g=aa,aa=e)):(g=aa,aa=e)):(g=aa,aa=e)):(g=aa,aa=e)):(g=aa,aa=e)):(g=aa,aa=e);b=aa;if(b===e){var Xb,L,Ya,Yb,Za,Zb,Da,ta,rb,Wc,Xc;L=g;Ya=Fb();if(Ya!==e)if(Yb=z(),Yb!==e)if(Za=
C(),Za!==e)if(Zb=z(),Zb!==e){Da=[];for(ta=X();ta!==e;)Da.push(ta),ta=X();Da!==e?(ta=z(),ta!==e?(rb=Gb(),rb!==e?L=Ya={type:"case_expression",format:"simple",operand:Za,clauses:Da,else:null}:(g=L,L=e)):(g=L,L=e)):(g=L,L=e)}else g=L,L=e;else g=L,L=e;else g=L,L=e;else g=L,L=e;if(L===e)if(L=g,Ya=Fb(),Ya!==e)if(Yb=z(),Yb!==e)if(Za=C(),Za!==e)if(Zb=z(),Zb!==e){Da=[];for(ta=X();ta!==e;)Da.push(ta),ta=X();Da!==e?(ta=z(),ta!==e?(rb=ia(),rb!==e?(Wc=z(),Wc!==e?(Xc=Gb(),Xc!==e?L=Ya={type:"case_expression",format:"simple",
operand:Za,clauses:Da,else:rb.value}:(g=L,L=e)):(g=L,L=e)):(g=L,L=e)):(g=L,L=e)):(g=L,L=e)}else g=L,L=e;else g=L,L=e;else g=L,L=e;else g=L,L=e;Xb=L;if(Xb===e){var P,$a,$b,Ea,ua,sb,Yc,Zc;P=g;$a=Fb();if($a!==e)if($b=z(),$b!==e){Ea=[];for(ua=I();ua!==e;)Ea.push(ua),ua=I();Ea!==e?(ua=z(),ua!==e?(sb=Gb(),sb!==e?P=$a={type:"case_expression",format:"searched",clauses:Ea,else:null}:(g=P,P=e)):(g=P,P=e)):(g=P,P=e)}else g=P,P=e;else g=P,P=e;if(P===e)if(P=g,$a=Fb(),$a!==e)if($b=z(),$b!==e){Ea=[];for(ua=I();ua!==
e;)Ea.push(ua),ua=I();Ea!==e?(ua=z(),ua!==e?(sb=ia(),sb!==e?(Yc=z(),Yc!==e?(Zc=Gb(),Zc!==e?P=$a={type:"case_expression",format:"searched",clauses:Ea,else:sb.value}:(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e)):(g=P,P=e)}else g=P,P=e;else g=P,P=e;Xb=P}b=Xb;if(b===e){var tb,Pa,uc,ac,bc;Pa=g;uc=y();if(uc!==e){ac=[];for(bc=M();bc!==e;)ac.push(bc),bc=M();ac!==e?Pa=uc+=ac.join(""):(g=Pa,Pa=e)}else g=Pa,Pa=e;tb=Pa;tb!==e&&(tb={type:"column_ref",table:"",column:tb});b=tb;b===e&&(b=Q(),b===e&&(b=g,c=da(),c!==
e?(d=z(),d!==e?(h=C(),h!==e?(k=z(),k!==e?(m=ea(),m!==e?(h.paren=!0,b=c=h):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)))}}}}}}}return b}function l(){var a,b,c,d;a=g;b=y();if(b!==e){c=[];for(d=t();d!==e;)c.push(d),d=t();c!==e?a=b+=c.join(""):(g=a,a=e)}else g=a,a=e;return a}function y(){var b;Hd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(Id));return b}function t(){var b;Jd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(Kd));return b}function M(){var b;Ld.test(a.charAt(g))?(b=
a.charAt(g),g++):(b=e,0===x&&f(Md));return b}function Q(){var b,c,d;b=g;64===a.charCodeAt(g)?(c=Nd,g++):(c=e,0===x&&f(Od));c!==e?(d=l(),d!==e?b=c=[c,d]:(g=b,b=e)):(g=b,b=e);b!==e&&(b={type:"param",value:b[1]});return b}function la(){var b,c,d;b=g;a.substr(g,7).toLowerCase()===Pd?(c=a.substr(g,7),g+=7):(c=e,0===x&&f(Qd));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="LEADING":(g=b,b=e)):(g=b,b=e);b===e&&(b=g,a.substr(g,8).toLowerCase()===Rd?(c=a.substr(g,8),g+=8):(c=e,0===x&&f(Sd)),c!==
e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="TRAILING":(g=b,b=e)):(g=b,b=e),b===e&&(b=g,a.substr(g,4).toLowerCase()===Td?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ud)),c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="BOTH":(g=b,b=e)):(g=b,b=e)));return b}function ma(){var b,c,d;b=g;var h,k;c=g;d=N();d!==e?(h=z(),h!==e?(h=da(),h!==e?(h=z(),h!==e?(h=m(),h!==e?(k=z(),k!==e?(k=ea(),k!==e?c=d={type:"interval-period",period:d.value,precision:h,secondary:null}:(g=c,c=e)):(g=c,c=e)):(g=c,c=
e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e)):(g=c,c=e);c===e&&(c=g,d=N(),d!==e&&(d=ub(d)),c=d);if(c!==e)if(d=z(),d!==e)if(d=g,a.substr(g,2).toLowerCase()===Vd?(h=a.substr(g,2),g+=2):(h=e,0===x&&f(Wd)),h!==e?(h=g,x++,k=t(),x--,k===e?h=void 0:(g=h,h=e),h!==e?d="TO":(g=d,d=e)):(g=d,d=e),d!==e)if(d=z(),d!==e){var l;d=g;h=N();h!==e&&(h={type:"interval-period",period:h.value,precision:null,secondary:null});d=h;d===e&&(d=g,h=Ha(),h!==e?(h=z(),h!==e?(h=da(),h!==e?(h=z(),h!==e?(h=m(),h!==e?(k=z(),k!==e?(k=Ba(),k!==
e?(k=z(),k!==e?(k=S(),k!==e?(l=z(),l!==e?(l=ea(),l!==e?d=h=vb(h,k):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,h=Ha(),h!==e?(h=z(),h!==e?(h=da(),h!==e?(h=z(),h!==e?(h=m(),h!==e?(k=z(),k!==e?(k=ea(),k!==e?d=h={type:"interval-period",period:"second",precision:h,secondary:null}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,h=Ha(),h!==e&&(h={type:"interval-period",period:"second",
precision:null,secondary:null}),d=h)));d!==e?b=c={type:"interval-qualifier",start:c,end:d}:(g=b,b=e)}else g=b,b=e;else g=b,b=e;else g=b,b=e;else g=b,b=e;b===e&&(b=g,d=N(),d!==e?(c=z(),c!==e?(c=da(),c!==e?(c=z(),c!==e?(c=S(),c!==e?(h=z(),h!==e?(h=ea(),h!==e?b=d={type:"interval-period",period:d.value,precision:c,secondary:null}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e),b===e&&(b=g,d=N(),d!==e&&(d=ub(d)),b=d,b===e&&(b=g,d=Ha(),d!==e?(c=z(),c!==e?(c=da(),c!==e?(c=z(),
c!==e?(c=m(),c!==e?(h=z(),h!==e?(h=Ba(),h!==e?(d=z(),d!==e?(d=S(),d!==e?(h=z(),h!==e?(h=ea(),h!==e?b=d=vb(c,d):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e),b===e&&(b=g,d=Ha(),d!==e?(c=z(),c!==e?(c=da(),c!==e?(c=z(),c!==e?(c=S(),c!==e?(h=z(),h!==e?(h=ea(),h!==e?b=d={type:"interval-period",period:"second",precision:c,secondary:null}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e),b===e&&(b=g,d=Ha(),
d!==e&&(d={type:"interval-period",period:"second",precision:null,secondary:null}),b=d)))));return b}function N(){var a;a=g;a=xc();a!==e&&(a={type:"string",value:"day"});a===e&&(a=g,a=yc(),a!==e&&(a={type:"string",value:"hour"}),a===e&&(a=g,a=zc(),a!==e&&(a={type:"string",value:"minute"}),a===e&&(a=g,a=wc(),a!==e&&(a={type:"string",value:"month"}),a===e&&(a=g,a=vc(),a!==e&&(a={type:"string",value:"year"})))));return a}function S(){var a;a=T();a!==e&&(a=parseFloat(a));return a}function m(){var a;a=
T();a!==e&&(a=parseFloat(a));return a}function E(){var a;a=pa();a===e&&(a=Q());return a}function pa(){var b,c,d;b=g;39===a.charCodeAt(g)?(c=wb,g++):(c=e,0===x&&f(xb));c===e&&(a.substr(g,2)===yb?(c=yb,g+=2):(c=e,0===x&&f(Xd)));if(c!==e){c=[];d=g;a.substr(g,2)===Fa?(d=Fa,g+=2):(d=e,0===x&&f(zb));d!==e&&(d="'");d===e&&(Ab.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===x&&f(Bb)));for(;d!==e;)c.push(d),d=g,a.substr(g,2)===Fa?(d=Fa,g+=2):(d=e,0===x&&f(zb)),d!==e&&(d="'"),d===e&&(Ab.test(a.charAt(g))?(d=
a.charAt(g),g++):(d=e,0===x&&f(Bb)));c!==e?(39===a.charCodeAt(g)?(d=wb,g++):(d=e,0===x&&f(xb)),d!==e?b=c={type:"string",value:c.join("")}:(g=b,b=e)):(g=b,b=e)}else g=b,b=e;return b}function I(){var a,b,c;a=g;b=ab();b!==e?(b=z(),b!==e?(b=C(),b!==e?(c=z(),c!==e?(c=bb(),c!==e?(c=z(),c!==e?(c=C(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function X(){var a,b,c;a=g;b=ab();b!==e?(b=z(),b!==e?(b=C(),b!==e?(c=z(),
c!==e?(c=bb(),c!==e?(c=z(),c!==e?(c=C(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function ia(){var b,c;b=g;var d,h;c=g;a.substr(g,4).toLowerCase()===Yd?(d=a.substr(g,4),g+=4):(d=e,0===x&&f(Zd));d!==e?(d=g,x++,h=t(),x--,h===e?d=void 0:(g=d,d=e),d!==e?c="ELSE":(g=c,c=e)):(g=c,c=e);c!==e?(c=z(),c!==e?(c=C(),c!==e?b={type:"else_clause",value:c}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e);return b}function Y(){var b,c,d;b=
T();b===e&&(b=g,45===a.charCodeAt(g)?(c=ec,g++):(c=e,0===x&&f(fc)),c===e&&(43===a.charCodeAt(g)?(c=cc,g++):(c=e,0===x&&f(dc))),c!==e?(d=T(),d!==e?b=c=c[0]+d:(g=b,b=e)):(g=b,b=e));return b}function ha(){var b,c;b=g;46===a.charCodeAt(g)?(c=$d,g++):(c=e,0===x&&f(ae));c!==e?(c=T(),c===e&&(c=null),c!==e?b="."+(null!=c?c:""):(g=b,b=e)):(g=b,b=e);return b}function K(){var b,c,d;c=b=g;be.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===x&&f(ce));d!==e?(de.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===x&&f(ee)),
d===e&&(d=null),d!==e?c="e"+(null===d?"":d):(g=c,c=e)):(g=c,c=e);c!==e?(d=T(),d!==e?b=c+d:(g=b,b=e)):(g=b,b=e);return b}function T(){var a,b;a=[];b=W();if(b!==e)for(;b!==e;)a.push(b),b=W();else a=e;a!==e&&(a=a.join(""));return a}function W(){var b;fe.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(ge));return b}function ga(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===he?(c=a.substr(g,2),g+=2):(c=e,0===x&&f(ie));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="IN":(g=b,b=e)):(g=b,b=
e);return b}function ba(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===je?(c=a.substr(g,2),g+=2):(c=e,0===x&&f(ke));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="IS":(g=b,b=e)):(g=b,b=e);return b}function ja(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===le?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(me));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="LIKE":(g=b,b=e)):(g=b,b=e);return b}function na(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===ne?(c=a.substr(g,3),g+=3):(c=e,0===x&&
f(oe));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="NOT":(g=b,b=e)):(g=b,b=e);return b}function ca(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===pe?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(qe));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="AND":(g=b,b=e)):(g=b,b=e);return b}function oa(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===re?(c=a.substr(g,2),g+=2):(c=e,0===x&&f(se));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="OR":(g=b,b=e)):(g=b,b=e);return b}function ka(){var b,
c,d;b=g;a.substr(g,7).toLowerCase()===te?(c=a.substr(g,7),g+=7):(c=e,0===x&&f(ue));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="BETWEEN":(g=b,b=e)):(g=b,b=e);return b}function Aa(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===ve?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(we));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="FROM":(g=b,b=e)):(g=b,b=e);return b}function Qa(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===xe?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(ye));c!==e?(c=g,x++,d=t(),
x--,d===e?c=void 0:(g=c,c=e),c!==e?b="TRIM":(g=b,b=e)):(g=b,b=e);return b}function Ga(){var b,c,d;b=g;a.substr(g,8).toLowerCase()===ze?(c=a.substr(g,8),g+=8):(c=e,0===x&&f(Ae));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="INTERVAL":(g=b,b=e)):(g=b,b=e);return b}function vc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Be?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ce));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="YEAR":(g=b,b=e)):(g=b,b=e);return b}function wc(){var b,c,d;b=g;
a.substr(g,5).toLowerCase()===De?(c=a.substr(g,5),g+=5):(c=e,0===x&&f(Ee));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="MONTH":(g=b,b=e)):(g=b,b=e);return b}function xc(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Fe?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(Ge));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="DAY":(g=b,b=e)):(g=b,b=e);return b}function yc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===He?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ie));c!==e?(c=g,x++,d=t(),x--,d===e?
c=void 0:(g=c,c=e),c!==e?b="HOUR":(g=b,b=e)):(g=b,b=e);return b}function zc(){var b,c,d;b=g;a.substr(g,6).toLowerCase()===Je?(c=a.substr(g,6),g+=6):(c=e,0===x&&f(Ke));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="MINUTE":(g=b,b=e)):(g=b,b=e);return b}function Ha(){var b,c,d;b=g;a.substr(g,6).toLowerCase()===Le?(c=a.substr(g,6),g+=6):(c=e,0===x&&f(Me));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="SECOND":(g=b,b=e)):(g=b,b=e);return b}function Fb(){var b,c,d;b=g;a.substr(g,
4).toLowerCase()===Ne?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Oe));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="CASE":(g=b,b=e)):(g=b,b=e);return b}function Gb(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Pe?(c=a.substr(g,3),g+=3):(c=e,0===x&&f(Qe));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="END":(g=b,b=e)):(g=b,b=e);return b}function ab(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Re?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Se));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=
c,c=e),c!==e?b="WHEN":(g=b,b=e)):(g=b,b=e);return b}function bb(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Te?(c=a.substr(g,4),g+=4):(c=e,0===x&&f(Ue));c!==e?(c=g,x++,d=t(),x--,d===e?c=void 0:(g=c,c=e),c!==e?b="THEN":(g=b,b=e)):(g=b,b=e);return b}function Ba(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=e,0===x&&f(We));return b}function da(){var b;40===a.charCodeAt(g)?(b=Xe,g++):(b=e,0===x&&f(Ye));return b}function ea(){var b;41===a.charCodeAt(g)?(b=Ze,g++):(b=e,0===x&&f($e));return b}function z(){var a,
b;a=[];for(b=Cb();b!==e;)a.push(b),b=Cb();return a}function Cb(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===x&&f(bf));return b}function eb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function Ca(a,b){for(var c=0;c<b.length;c++)a=eb(b[c][1],a,b[c][3]);return a}q=void 0!==q?q:{};var e={},Db={start:n},Eb=n,$c="!",ad=p("!",!1),cb="\x3d",db=p("\x3d",!1),fb="\x3e\x3d",dd=p("\x3e\x3d",!1),ed="\x3e",fd=p("\x3e",!1),gb="\x3c\x3d",gd=p("\x3c\x3d",
!1),hb="\x3c\x3e",hd=p("\x3c\x3e",!1),id="\x3c",jd=p("\x3c",!1),ib="!\x3d",kd=p("!\x3d",!1),cc="+",dc=p("+",!1),ec="-",fc=p("-",!1),ld="*",md=p("*",!1),nd="/",od=p("/",!1),Hd=/^[A-Za-z_\x80-\uFFFF]/,Id=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Jd=/^[A-Za-z0-9_]/,Kd=b([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ld=/^[A-Za-z0-9_.\x80-\uFFFF]/,Md=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Nd="@",Od=p("@",!1),ub=function(a){return{type:"interval-period",period:a.value,
precision:null,secondary:null}},vb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},wb="'",xb=p("'",!1),yb="N'",Xd=p("N'",!1),Fa="''",zb=p("''",!1),Ab=/^[^']/,Bb=b(["'"],!0,!1),$d=".",ae=p(".",!1),fe=/^[0-9]/,ge=b([["0","9"]],!1,!1),be=/^[eE]/,ce=b(["e","E"],!1,!1),de=/^[+\-]/,ee=b(["+","-"],!1,!1),td="null",ud=p("NULL",!0),pd="true",qd=p("TRUE",!0),rd="false",sd=p("FALSE",!0),he="in",ie=p("IN",!0),je="is",ke=p("IS",!0),le="like",me=p("LIKE",!0),bd="escape",cd=
p("ESCAPE",!0),ne="not",oe=p("NOT",!0),pe="and",qe=p("AND",!0),re="or",se=p("OR",!0),te="between",ue=p("BETWEEN",!0),ve="from",we=p("FROM",!0),Dd="for",Ed=p("FOR",!0),Bd="substring",Cd=p("SUBSTRING",!0),zd="extract",Ad=p("EXTRACT",!0),xe="trim",ye=p("TRIM",!0),Fd="position",Gd=p("POSITION",!0),xd="timestamp",yd=p("TIMESTAMP",!0),vd="date",wd=p("DATE",!0),Pd="leading",Qd=p("LEADING",!0),Rd="trailing",Sd=p("TRAILING",!0),Td="both",Ud=p("BOTH",!0),Vd="to",Wd=p("TO",!0),ze="interval",Ae=p("INTERVAL",
!0),Be="year",Ce=p("YEAR",!0),De="month",Ee=p("MONTH",!0),Fe="day",Ge=p("DAY",!0),He="hour",Ie=p("HOUR",!0),Je="minute",Ke=p("MINUTE",!0),Le="second",Me=p("SECOND",!0),Ne="case",Oe=p("CASE",!0),Pe="end",Qe=p("END",!0),Re="when",Se=p("WHEN",!0),Te="then",Ue=p("THEN",!0),Yd="else",Zd=p("ELSE",!0),Ve=",",We=p(",",!1),Xe="(",Ye=p("(",!1),Ze=")",$e=p(")",!1),af=/^[ \t\n\r]/,bf=b([" ","\t","\n","\r"],!1,!1),Sc="`",Tc=p("`",!1),Uc=/^[^`]/,Vc=b(["`"],!0,!1),g=0,Ia=[{line:1,column:1}],Z=0,Ra=[],x=0,za;if("startRule"in
q){if(!(q.startRule in Db))throw Error("Can't start parsing from rule \""+q.startRule+'".');Eb=Db[q.startRule]}za=Eb();if(za!==e&&g===a.length)return za;za!==e&&g<a.length&&f({type:"end"});throw function(a,b,c){return new B(B.buildMessage(a,b),a,b,c)}(Ra,Z<a.length?a.charAt(Z):null,Z<a.length?d(Z,Z+1):d(Z,Z));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(B,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,
supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}})},
"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/Set ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),function(B,a,q,p,b,c,d,
f,n,w,C,u,G,A,H,F){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(w.isValid(a.outSR)&&!w.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=F.cleanFromGeometryEngine(q({spatialReference:a.outSR},A.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=F.cleanFromGeometryEngine(q({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=G.getWhereClause(b.where,this.fieldsIndex);if(!c)return f.resolve(this);if(c.isStandardized){for(var d=0,h=[],k=0,n=this.items;k<n.length;k++){var t=n[k];c.testFeature(t,this.featureAdapter)&&(h[d++]=t)}c=new a(h,this.queryGeometry,this);c.definitionExpression=b.where;return f.resolve(c)}return f.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return f.resolve(this);var d=new c.default(b.objectIds),k=this.featureAdapter.getObjectId;return f.resolve(new a(this.items.filter(function(a){return d.has(k(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=H.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!d.isSome(b))return f.resolve(this);b=this.items.filter(b);return f.resolve(new a(b,this.queryGeometry,this))};a.prototype.project=
function(c){return b(this,void 0,void 0,function(){var b,d,f,k=this;return p(this,function(h){switch(h.label){case 0:if(!c||w.equals(this.spatialReference,c))return[2,this];b=this.featureAdapter;return[4,A.projectMany(this.items.map(function(a){return F.getGeometry(k,b.getGeometry(a))}),this.spatialReference,c)];case 1:return d=h.sent(),f=d.map(function(a,c){return b.cloneWithGeometry(k.items[c],C.convertFromGeometry(a,k.hasZ,k.hasM))}),[2,new a(f,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,f=this.hasM,k=this.hasZ,t=this.objectIdField,p=this.spatialReference,w=a.outFields,u=a.outSR,q=a.quantizationParameters,C=a.resultRecordCount,A=a.resultOffset,m=!1;null!=C&&null!=A&&(C=A+C,m=c.length>
C,c=c.slice(A,Math.min(c.length,C)));return{exceededTransferLimit:m,features:this._createFeatures(a,c),fields:w&&w.map(function(a){return b.fieldsIndex.get(a)}),geometryType:d,hasM:f,hasZ:k,objectIdFieldName:t,spatialReference:F.cleanFromGeometryEngine(u?u:p),transform:q&&n.toQuantizationTransform(q)||null}};a.prototype._createFeatures=function(a,b){var c=new u.default(a,this.featureAdapter,this.fieldsIndex),d=a.quantizationParameters,f=a.returnGeometry,k=a.returnCentroid,t=a.maxAllowableOffset,p=
a.orderByFields;a=[];var w=0;if(b.length&&p&&p.length){var p=p[0].split(" "),v=p[0],q=this.fieldsIndex.get(v),C="DESC"===p[1];b.sort(function(a,b){a=c.getFieldValue(a,v,q);b=c.getFieldValue(b,v,q);if("number"===typeof a&&"number"===typeof b)return C?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(C?a>b:a<b)?-1:(C?a<b:a>b)?1:0})}if(f||k)if(d=n.toQuantizationTransform(d),f&&!k)for(k=0;k<b.length;k++)f=b[k],a[w++]={attributes:c.getAttributes(f),geometry:F.getGeometry(this,
this.featureAdapter.getGeometry(f),t,d)};else if(!f&&k)for(t=0;t<b.length;t++)f=b[t],a[w++]={attributes:c.getAttributes(f),centroid:F.transformCentroid(this,this.featureAdapter.getCentroid(f,this),d)};else for(k=0;k<b.length;k++)f=b[k],a[w++]={attributes:c.getAttributes(f),centroid:F.transformCentroid(this,this.featureAdapter.getCentroid(f,this),d),geometry:F.getGeometry(this,this.featureAdapter.getGeometry(f),t,d)};else for(t=0;t<b.length;t++)f=b[t],(f=c.getAttributes(f))&&(a[w++]={attributes:f});
return a};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,f=0;for(a=a.outStatistics;f<a.length;f++){var k=a[f];if("exceedslimit"===k.statisticType){c=null!=k.maxPointCount?k.maxPointCount:Number.POSITIVE_INFINITY;d=null!=k.maxRecordCount?k.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=k.maxVertexCount?k.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>
c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter,b=this.items.reduce(function(a,b){b=n.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new u.default(a,this.featureAdapter,this.fieldsIndex),
c=a.outStatistics,d=[],f=[],k=a.groupByFieldsForStatistics;a=a.having;for(var n=k&&k.length,k=n&&k[0],p=this.fieldsIndex.get(k),w=!p,q={},C={},A={},B={attributes:{}},m=0;m<c.length;m++){var E=c[m],G=E.outStatisticFieldName,I=E.statisticType,E="exceedslimit"!==I?E.onStatisticField:void 0,D=this.fieldsIndex.get(E),F=n&&(E===k||w)&&"count"===I;if(n){q[E]||(q[E]=this._calculateUniqueValues(b,k,p));var H=q[E],ha;for(ha in H){var K=H[ha],T=K.count,W=K.data,ga=K.items;if(!a||b.validateItems(ga,a)){var K=
C[W]||{attributes:{}},ba=null;F?ba=T:(T=this._calculateStatistics(ga,b,E,D),ga="var"===I?"variance":I,ba=T[ga]);K.attributes[G]=ba;K.attributes[w?"EXPR_1":k]=W;C[W]=K}}}else A[E]||(A[E]=this._calculateStatistics(this.items,b,E,D)),T=A[E],ga="var"===I?"variance":I,B.attributes[G]=T[ga];f.push({name:G,alias:G,type:"esriFieldTypeDouble"})}if(n)for(var ja in C)d.push(C[ja]);else d.push(B);return{fields:f,features:d}};a.prototype._calculateStatistics=function(a,b,c,d){for(var f=Number.POSITIVE_INFINITY,
h=Number.NEGATIVE_INFINITY,k=null,n=null,p=null,r=null,w=[],u=0,q=0;q<a.length;q++){var m=b.getFieldValue(a[q],c,d);"string"===typeof m?u++:null==m||isNaN(m)||(k+=m,f=Math.min(f,m),h=Math.max(h,m),w.push(m),u++)}if(u){n=k/u;for(b=a=0;b<w.length;b++)m=w[b],a+=Math.pow(m-n,2);r=1<u?a/(u-1):0;p=Math.sqrt(r)}else h=f=null;return{avg:n,count:u,max:h,min:f,stddev:p,sum:k,variance:r}};a.prototype._calculateUniqueValues=function(a,b,c){for(var d={},f=0,k=this.items;f<k.length;f++){var n=k[f],p=a.getFieldValue(n,
b,c);if(null==p||"string"===typeof p&&""===p.trim())p=null;null==d[p]?d[p]={count:1,data:p,items:[n]}:(d[p].count++,d[p].items.push(n))}return d};return a}();a.default=B})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","@dojo/framework/shim/Map","../../../core/maybe","./attributeSupport"],function(B,a,q,p,b){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,c,n){this._fieldDataCache=new q.default;this._returnDistinctMap=new q.default;
this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=n;this.featureAdapter=c;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var d=c=0;d<a.length;d++){var f=a[d],p=b.getExpressionFromFieldName(f),G=this.fieldsIndex.get(p),p=G?null:b.getWhereClause(p,n),G=G?G.name:b.getAliasFromFieldName(f)||"FIELD_EXP_"+c++;this._fieldDataCache.set(f,{alias:G,clause:p})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};
a.prototype.getFieldValue=function(a,c,n){var d=n?n.name:c,f=null;this._fieldDataCache.has(d)?f=this._fieldDataCache.get(d).clause:n||(f=b.getWhereClause(c,this.fieldsIndex),this._fieldDataCache.set(d,{alias:d,clause:f}));return n?this.featureAdapter.getAttribute(a,d):f.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:b.getWhereClause(c,this.fieldsIndex)});return this._fieldDataCache.get(c).clause.testFeature(a,
this.featureAdapter)};a.prototype.validateItems=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:b.getWhereClause(c,this.fieldsIndex)});return this._fieldDataCache.get(c).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},d=0;d<b.length;d++){var p=this._fieldDataCache.get(b[d]),u=p.alias,p=p.clause;c[u]=p?p.calculateValue(a,
this.featureAdapter):this.featureAdapter.getAttribute(a,u)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(p.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var d=0;d<b.length;d++){var q=this._fieldDataCache.get(b[d]).alias;c.push(a[q])}else for(q in a)c.push(a[q]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();a.default=B})},"esri/layers/graphics/data/timeSupport":function(){define(["require",
"exports"],function(B,a){function q(a,c,d,f,n){if(null!=f&&null!=n&&f===n)return function(b){return f>=a.getAttribute(b,c)&&f<=a.getAttribute(b,d)};if(null!=f&&null!=n)return function(b){var p=a.getAttribute(b,c);b=a.getAttribute(b,d);return!(p>n||b<f)};if(null!=f)return function(b){return!(a.getAttribute(b,d)<f)};if(null!=n)return function(b){return!(a.getAttribute(b,c)>n)}}function p(a,c,d,f){if(null!=d&&null!=f&&d===f)return function(b){return a.getAttribute(b,c)===d};if(null!=d&&null!=f)return function(b){return a.getAttribute(b,
c)>=d&&a.getAttribute(b,c)<=f};if(null!=d)return function(b){return a.getAttribute(b,c)>=d};if(null!=f)return function(b){return a.getAttribute(b,c)<=f}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=c.featureAdapter,f=a.startTimeField,n=a.endTimeField,p=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY;if(f&&n)c.forEach(function(a){var c=b.getAttribute(a,f);a=b.getAttribute(a,n);null==c||isNaN(c)||(p=Math.min(p,c));null==a||isNaN(a)||(q=Math.max(q,
a))});else{var u=f||n;c.forEach(function(a){a=b.getAttribute(a,u);null==a||isNaN(a)||(p=Math.min(p,a),q=Math.max(q,a))})}return{start:p,end:q}};a.getTimeOperator=function(a,c,d){if(!c||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var n=c.start;c=c.end;return null==n&&null==c?null:b&&a?q(d,b,a,n,c):p(d,b||a,n,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(B,a,q,p,b,c,d,f,n,w,C,u,G,A,H,F,D){function k(a,b,c){c&&(b=A.quantizeOptimizedGeometry(y,b,a.hasZ,a.hasM,"esriGeometryPoint",c));return A.convertToPoint(b,a.hasZ,a.hasM)}function v(b,d,f){return p(this,void 0,void 0,function(){var h,k,l,p,t,y;return q(this,function(m){switch(m.label){case 0:if(!b)return[2,null];h=b.where;b.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||d&&d===h)b.where=null;return b.geometry?[4,r(b)]:[2,b];case 1:return k=m.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===
b.spatialRel&&(l=b.geometry.spatialReference,k=n.getGeometryExtent(k),k.spatialReference=l),b.geometry=k,[4,F.checkProjectionSupport(k.spatialReference,f)];case 2:return m.sent(),[4,C.normalizeCentralMeridian(w.fromJSON(k))];case 3:p=m.sent()[0];if(c.isNone(p))throw a.QUERY_ENGINE_EMPTY_RESULT;t=p.toJSON();return[4,F.project(t,t.spatialReference,f)];case 4:y=m.sent();if(!y)throw a.QUERY_ENGINE_EMPTY_RESULT;y.spatialReference=f;b.geometry=y;return[2,b]}})})}function r(a){return p(this,void 0,void 0,
function(){var b,c,k,l,n,p,t,r,y,w;return q(this,function(m){switch(m.label){case 0:b=a.geometry;c=a.distance;k=a.units;if(null==c)return[2,d.resolve(b)];l=b.spatialReference;n=k&&h.fromJSON(k)||f.getUnitString(l);p=l&&(u.isGeographic(l)||u.isWebMercator(l));if(!p)return[3,1];r=b;return[3,3];case 1:return[4,F.checkProjectionSupport(l,u.WGS84).then(function(){return F.project(b,u.WGS84)})];case 2:r=m.sent(),m.label=3;case 3:return t=r,[4,D.getGeodesicBufferOperator()];case 4:return y=m.sent(),w=y(t,
c,n),[2,w?w.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var h=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var l=new H.default,y=new H.default,t={esriGeometryPoint:A.convertToPoint,esriGeometryPolyline:A.convertToPolyline,esriGeometryPolygon:A.convertToPolygon,
esriGeometryMultipoint:A.convertToMultipoint};a.transformCentroid=k;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=G.getCentroidOptimizedGeometry(new H.default,b.geometry,a.hasZ,a.hasM));return k(a,b.centroid,c)};a.getGeometry=function(a,b,c,d){b=b?"coords"in b?b:b.geometry:null;return b?c?(c=A.generalizeOptimizedGeometry(l,b,a.hasZ,a.hasM,a.geometryType,c),d&&(c=A.quantizeOptimizedGeometry(y,c,a.hasZ,a.hasM,
a.geometryType,d)),t[a.geometryType](c,a.hasZ,a.hasM)):d?(c=A.quantizeOptimizedGeometry(y,b,a.hasZ,a.hasM,a.geometryType,d),t[a.geometryType](c,a.hasZ,a.hasM)):t[a.geometryType](b,a.hasZ,a.hasM):null};a.normalizeQuery=function(a,b,c){return p(this,void 0,void 0,function(){var d,f,h,k,l;return q(this,function(m){d=a.outFields;f=a.orderByFields;h=a.groupByFieldsForStatistics;k=a.outStatistics;if(d)for(l=0;l<d.length;l++)d[l]=d[l].trim();if(f)for(l=0;l<f.length;l++)f[l]=f[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=
h[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,v(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return p(this,void 0,void 0,function(){return q(this,function(d){return[2,v(a,b,c)]})})};a.normalizeQueryLike=v;a.cleanFromGeometryEngine=function(a){return a&&M in a?JSON.parse(JSON.stringify(a,Q)):a};var M="_geVersion",Q=function(a,b){return a!==M?b:void 0}})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(B,a,q,p,b,c,d,f,n,w,C,u,G,A,H){function F(){return c.create(function(a){return B(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var D={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},k={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},v={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},r={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=F;a.getGeodesicBufferOperator=function(){return F().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,k){if(n.isPolygon(b)&&"esriGeometryPoint"===k.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var h=u.convertFromPolygon(new G.default,b,!1,!1);return c.resolve(function(a){return C.polygonContainsPoint(h,!1,!1,a)})}if(n.isPolygon(b)&&"esriGeometryMultipoint"===k.geometryType){var l=
u.convertFromPolygon(new G.default,b,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return C.polygonContainsMultipoint(l,!1,!1,a,k.hasZ,k.hasM)})}if(n.isExtent(b)&&"esriGeometryPoint"===k.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return d.extentContainsPoint(b,H.getGeometry(k,a))});if(n.isExtent(b)&&"esriGeometryMultipoint"===k.geometryType&&"esriSpatialRelContains"===a)return c.resolve(function(a){return d.extentContainsMultipoint(b,
H.getGeometry(k,a))});if(n.isExtent(b)&&"esriSpatialRelIntersects"===a){var p=f.getExtentIntersector(k.geometryType);return c.resolve(function(a){return p(b,H.getGeometry(k,a))})}return F().then(function(c){var d=c[D[a]].bind(null,b);return function(a){return d(H.getGeometry(k,a))}})};a.checkSpatialQuerySupport=function(a,c,d){return p(this,void 0,void 0,function(){var f,h;return q(this,function(l){f=a.spatialRel;h=a.geometry;if(!h)return[2];if(!0!==k[f])throw new b("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!w.isValid(h.spatialReference)||!w.isValid(d))return[2];if(!0!==v[n.getJsonType(h)])throw new b("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==r[c])throw new b("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,A.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(n.isExtent(a))return!0;if(n.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(B,a){function q(a,b,c,d,f){if(!a)return!1;b=b?c?4:3:c?3:2;c=a.coords;var n=!1,p=0,q=0;for(a=a.lengths;q<a.length;q++){for(var u=a[q],B=p,A=p,H=p+u*b;A<H;A+=b){B=A+b;B===H&&(B=p);var F=c[A],D=c[A+1],k=c[B],B=c[B+1];(D<
f&&B>=f||B<f&&D>=f)&&F+(f-D)/(B-D)*(k-F)<d&&(n=!n)}p+=u*b}return n}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,b,c,d){return q(a,b,c,d.coords[0],d.coords[1])};a.polygonContainsMultipoint=function(a,b,c,d,f,n){f=f?n?4:3:n?3:2;n=d.coords;d=d.lengths;if(!d)return!1;for(var p=0,C=0;p<d.length;p++,C+=f)if(!q(a,b,c,n[C],n[C+1]))return!1;return!0};a.polygonContainsCoords=q})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(B,a,q){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var b=this;return q.create(function(c,f){b._deferreds.push({resolve:c,reject:f});b._values.push(a)})};a.prototype.unshift=function(a){var b=this;return q.create(function(c,f){b._deferreds.unshift({resolve:c,reject:f});b._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,
configurable:!0});a.prototype.process=function(){if(0===this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=q.createAbortError(),c=0,d=this._deferreds;c<d.length;c++)d[c].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=B})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/valuesHelper ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),
function(B,a,q,p,b,c,d,f){function n(a){var b=[];a.forEach(function(a){return b.push(a)});return b}function w(a){var b,c,d,f;return q(this,function(h){switch(h.label){case 0:b=a.type;switch(b){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,a];case 2:return h.sent(),[3,7];case 3:c=0,d=a.features,h.label=4;case 4:return c<d.length?(f=d[c])?[4,f]:[3,6]:[3,7];case 5:h.sent(),h.label=6;case 6:return c++,[3,4];case 7:return[2]}})}function C(a){var c,d,f,k,n,
p,r,u,w,v;return q(this,function(h){switch(h.label){case 0:if(!a)return[2,null];c=a.type;switch(c){case "Point":return[3,1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,a.coordinates];case 2:return h.sent(),[3,17];case 3:return[5,b(a.coordinates)];case 4:return h.sent(),[3,17];case 5:d=0,f=a.coordinates,h.label=6;case 6:if(!(d<f.length))return[3,9];k=f[d];return[5,
b(k)];case 7:h.sent(),h.label=8;case 8:return d++,[3,6];case 9:return[3,17];case 10:n=0,p=a.coordinates,h.label=11;case 11:if(!(n<p.length))return[3,16];r=p[n];u=0;w=r;h.label=12;case 12:if(!(u<w.length))return[3,15];v=w[u];return[5,b(v)];case 13:h.sent(),h.label=14;case 14:return u++,[3,12];case 15:return n++,[3,11];case 16:return[3,17];case 17:return[2]}})}function u(a,b){var c,h,k,n,p,r,u,w,A,m,C;void 0===b&&(b={});return q(this,function(l){switch(l.label){case 0:c=b.geometryType,h=b.ignoreIds,
k=b.nextObjectId,n=void 0===k?1:k,l.label=1;case 1:p=a.next();r=p.value;if(u=p.done)return[2];w=r.geometry;A=r.properties;m=r.id;if(w&&v[w.type]!==c)return[3,1];C=new d.default(w?H(new f.default,w,b):null,A);C.objectId=h||null==m?n++:m;return[4,C];case 2:return l.sent(),[3,1];case 3:return[2]}})}function G(a){for(var b=0,c=0;c<a.length;c++)var d=a[c],f=a[(c+1)%a.length],b=b+(d[0]*f[1]-f[0]*d[1]);return 0>=b}function A(a){var b=a[0],c=a[a.length-1];b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]||a.push(b);
return a}function H(a,b,c){switch(b.type){case "LineString":return F(a,b.coordinates,c),a;case "MultiLineString":var d=0;for(b=b.coordinates;d<b.length;d++)F(a,b[d],c);return a;case "MultiPoint":return F(a,b.coordinates,c),a;case "MultiPolygon":d=0;for(b=b.coordinates;d<b.length;d++){var f=b[d],h=a,l=c,n=A(f[0]);G(n)?F(h,n,l):D(h,n,l);for(h=1;h<f.length;h++){var l=a,n=c,p=A(f[h]);G(p)?D(l,p,n):F(l,p,n)}}return a;case "Point":return k(a,b.coordinates,c),a;case "Polygon":d=b.coordinates;b=A(d[0]);G(b)?
F(a,b,c):D(a,b,c);for(b=1;b<d.length;b++)f=a,h=c,l=A(d[b]),G(l)?D(f,l,h):F(f,l,h);return a}}function F(a,b,c){for(var d=0;d<b.length;d++)k(a,b[d],c);a.lengths.push(b.length)}function D(a,b,c){for(var d=b.length-1;0<=d;d--)k(a,b[d],c);a.lengths.push(b.length)}function k(a,b,c){var d=b[2];a.coords.push(b[0],b[1]);c.hasZ&&a.coords.push(d||0)}Object.defineProperty(a,"__esModule",{value:!0});var v={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",
Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(a){if(!a)throw new c("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new c("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});if(a.crs){a=a.crs;var b=["urn:ogc:def:crs:OGC:1.3:CRS84","EPSG:4326"].map(function(a){return a.toLowerCase()});if("link"===a.type||-1===b.indexOf(a.properties.name.toLowerCase()))throw new c("geojson-layer:unsupported-crs",
"unsupported GeoJSON 'crs' member",{crs:a});}};a.inferLayerProperties=function(a,b){void 0===b&&(b={});a=w(a);var c=[],d=new Set,f=new Set,h=!1,k=Number.NEGATIVE_INFINITY,p=!1,q=void 0;b=b.geometryType;b=void 0===b?null:b;for(var r=!1;;){var u=a.next(),m=u.value;if(u.done)return{fields:c,geometryType:b,hasZ:h,maxObjectId:Math.max(0,k),objectIdFieldType:q,objectIdOnFeature:p,unknownFields:n(f)};var A=m.geometry,u=m.properties,m=m.id;if(A&&(b||(b=v[A.type]),v[A.type]!==b))continue;if(!h)a:for(h=C(A);;){var A=
h.next(),B=A.value;if(A.done){h=!1;break a}if(2<B.length){h=!0;break a}}p||(p=null!=m)&&(q=typeof m);p&&"number"===q&&null!=m&&(k=Math.max(k,m));if(!r&&u){var r=!0,D;for(D in u)if(!d.has(D))if(m=u[D],null==m)r=!1,f.add(D);else{a:switch(typeof m){case "string":m="esriFieldTypeString";break a;case "number":m="esriFieldTypeDouble";break a;default:m="unknown"}"unknown"===m?f.add(D):(f.delete(D),d.add(D),c.push({name:D,alias:D,type:m}))}}}};a.createOptimizedFeatures=function(a,b){a:for(a=u(w(a),b),b=[];;){var c=
a.next(),d=c.value;if(c.done)break a;b.push(d)}return b}})},"esri/core/tsSupport/valuesHelper":function(){define([],function(){return function(B){var a="function"===typeof Symbol&&B[Symbol.iterator],q=0;return a?a.call(B):{next:function(){B&&q>=B.length&&(B=void 0);return{value:B&&B[q++],done:!B}}}}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),
function(B,a,q,p,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(p("csp-restrictions"))return function(){var c;return q((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",d;for(d in a)c+="this."+d+" \x3d "+
JSON.stringify(a[d])+";";var f=new Function(c);return function(){return new f}}catch(u){return function(){var c;return q((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:b.clone(a)}}]}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../request ../../../../core/Error ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(B,
a,q,p,b,c,d,f,n,w,C,u,G,A,H,F,D,k){Object.defineProperty(a,"__esModule",{value:!0});var v={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}},r=function(){return function(){this.description=this.code=null}}(),h=function(){return function(a){this.error=new r;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}(),l=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();B=function(){function a(){this._featuresInfo=this._queryEngine=
null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._featuresInfo=this._requiredFieldNames=this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return b(this,void 0,void 0,function(){var b,f,h,l,t,r,m,y,B,I,X,ia,Y,ha,K,T,W,ga,ba,ja,na,ca,oa,ka,Aa,Qa,Ga;return q(this,function(q){switch(q.label){case 0:return b=[],[4,this._checkProjection(a.spatialReference)];case 1:return q.sent(),f=null,a.url?[4,
c(a.url,{responseType:"json"})]:[3,4];case 2:return h=q.sent(),f=h.data,[4,A.validateGeoJSON(f)];case 3:q.sent(),q.label=4;case 4:l=A.inferLayerProperties(f,{geometryType:a.geometryType});t=a.fields||l.fields||[];r=null!=a.hasZ?a.hasZ:l.hasZ;m=l.geometryType;y=a.objectIdField||"OBJECTID";B=a.spatialReference||n.WGS84;I=a.timeInfo;if(!m)throw new d("geojson-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");"string"===l.objectIdFieldType&&b.push({type:"geojson-layer:unsupported-id-type",
message:"Feature ids are of type string and can't be honored."});t===l.fields&&0<l.unknownFields.length&&b.push({type:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:l.unknownFields}});y&&(X=null,(ia=t.some(function(a){return a.name===y?(X=a,!0):!1}))?(X.type="esriFieldTypeOID",X.editable=!1,X.nullable=!1):t.unshift({alias:y,name:y,type:"esriFieldTypeOID",editable:!1,nullable:!1}));Y=0;for(ha=t;Y<ha.length;Y++){K=
ha[Y];null==K.name&&(K.name=K.alias);null==K.alias&&(K.alias=K.name);if(!K.name)throw new d("geojson-layer:invalid-field-name","field name is missing",{field:K});K.name===y&&(K.type="esriFieldTypeOID");if(-1===D.kebabDict.jsonValues.indexOf(K.type))throw new d("geojson-layer:invalid-field-type",'invalid type for field "'+K.name+'"',{field:K});}T={};this._requiredFieldNames=[];W=0;for(ga=t;W<ga.length;W++)K=ga[W],"esriFieldTypeOID"!==K.type&&"esriFieldTypeGlobalID"!==K.type&&(K.editable=null==K.editable?
!0:!!K.editable,K.nullable=null==K.nullable?!0:!!K.nullable,ba=k.getFieldDefaultValue(K),K.nullable||void 0!==ba?T[K.name]=ba:this._requiredFieldNames.push(K.name));this._fieldsIndex=new F(t);I&&(I.startTimeField&&((ja=this._fieldsIndex.get(I.startTimeField.toLowerCase()))?(I.startTimeField=ja.name,ja.type="esriFieldTypeDate"):I.startTimeField=null),I.endTimeField&&((na=this._fieldsIndex.get(I.endTimeField.toLowerCase()))?(I.endTimeField=na.name,na.type="esriFieldTypeDate"):I.endTimeField=null),I.trackIdField&&
((ca=this._fieldsIndex.get(I.trackIdField.toLowerCase()))?I.trackIdField=ca.name:(I.trackIdField=null,b.push({type:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:I}}))),I.startTimeField||I.endTimeField||(b.push({type:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:I}}),I=null));oa={warnings:b,featureErrors:[],layerDefinition:p({},v,{drawingInfo:H.createDrawingInfo(m),templates:H.createDefaultTemplate(T),
extent:null,geometryType:m,objectIdField:y,fields:t,hasZ:!!r,timeInfo:I})};this._queryEngine=new G.default({fields:t,geometryType:m,hasM:!1,hasZ:r,objectIdField:y,spatialReference:B,timeInfo:I,featureStore:new C.default({geometryType:m,hasM:!1,hasZ:r})});this._createDefaultAttributes=H.createDefaultAttributesFunction(T,y);this._featuresInfo={nextObjectId:l.maxObjectId+1,geometryType:m,hasZ:r,ignoreIds:"string"===l.objectIdFieldType};ka=A.createOptimizedFeatures(f,this._featuresInfo);if(!n.equals(B,
n.WGS84))for(Aa=0,Qa=ka;Aa<Qa.length;Aa++)Ga=Qa[Aa],Ga.geometry&&(Ga.geometry=w.convertFromGeometry(u.project(w.convertToGeometry(Ga.geometry,m,r,!1),n.WGS84,B)));this._loadInitialFeatures(oa,ka);return[2,oa]}})})};a.prototype.applyEdits=function(a){return b(this,void 0,void 0,function(){var b,c=this;return q(this,function(d){b=this._queryEngine.spatialReference;return[2,u.checkProjectionSupport(a.adds,b).then(function(){return u.checkProjectionSupport(a.updates,b)}).then(function(){return c._applyEdits(a)})]})})};
a.prototype.queryFeatures=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return q(this,function(b){return[2,this._queryEngine.executeQuery(a,c.signal)]})})};a.prototype.queryFeatureCount=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return q(this,function(b){return[2,this._queryEngine.executeQueryForCount(a,c.signal)]})})};a.prototype.queryObjectIds=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,
void 0,void 0,function(){return q(this,function(b){return[2,this._queryEngine.executeQueryForIds(a,c.signal)]})})};a.prototype.queryExtent=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return q(this,function(b){return[2,this._queryEngine.executeQueryForExtent(a,c.signal)]})})};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine.featureStore,d=[],f=0;f<b.length;f++){var h=b[f],k=this._createDefaultAttributes(),l=this._mixAttributes(k,
h.attributes,!0);l?a.featureErrors.push(l):(this._assignObjectId(k,h.attributes,!0),h.attributes=k,d.push(h))}c.addMany(d);a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(d,b);c&&c.length&&this._applyUpdateEdits(d,
c);if(a&&a.length){for(b=0;b<a.length;b++)d.deleteResults.push(new l(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:d}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,d=this._queryEngine,k=d.geometryType,n=d.hasM,p=d.hasZ,m=d.objectIdField,t=d.spatialReference,d=d.featureStore,q=[],r=0;r<b.length;r++){var v=b[r];if(v.geometry&&k!==f.getJsonType(v.geometry))c.push(new h("Incorrect geometry type."));
else{var y=this._createDefaultAttributes(),A=this._mixAttributes(y,v.attributes);A?c.push(A):(this._assignObjectId(y,v.attributes),v.attributes=y,null!=v.uid&&(a.uidToObjectId[v.uid]=v.attributes[m]),v.geometry&&(v.geometry=u.project(v.geometry,v.geometry.spatialReference,t)),q.push(v),c.push(new l(v.attributes[m])))}}d.addMany(w.convertFromFeatures([],q,k,p,n,m))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,d=c.geometryType,k=c.hasM,n=c.hasZ,p=c.objectIdField,
m=c.spatialReference,c=c.featureStore,t=0;t<b.length;t++){var q=b[t],r=q.attributes,v=q.geometry,q=r&&r[p];if(null==q)a.push(new h("Identifier field "+p+" missing"));else if(c.has(q)){var y=w.convertToFeature(c.getFeature(q),d,n,k);if(v){if(d!==f.getJsonType(v)){a.push(new h("Incorrect geometry type."));continue}y.geometry=u.project(v,v.spatialReference,m)}if(r&&(r=this._mixAttributes(y.attributes,r))){a.push(r);continue}c.add(w.convertFromFeature(y,d,n,k,p));a.push(new l(q))}else a.push(new h("Feature with object id "+
q+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var d=this._queryEngine.objectIdField;c?b&&isFinite(b[d])?a[d]=b[d]:a[d]=this._featuresInfo.nextObjectId++:a[d]=this._featuresInfo.nextObjectId++};a.prototype._mixAttributes=function(a,b,c){void 0===c&&(c=!1);for(var d in b){var f=k.sanitizeNullFieldValue(b[d]),l=this._fieldsIndex.get(d)||this._fieldsIndex.get(d.toLowerCase());if(l&&(c||l.editable)){var n=k.validateFieldValue(l,f);if(n)return new h(k.validationErrorToString(n,
l,f));a[l.name]=f}}b=0;for(c=this._requiredFieldNames;b<c.length;b++)if(d=c[b],void 0===a[d])return new h('missing required field "'+d+'"');return null};a.prototype._checkProjection=function(a){return b(this,void 0,void 0,function(){return q(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,u.checkProjectionSupport(n.WGS84,a)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new d("geojson-layer","Projection not supported");case 3:return[2]}})})};return a}();a.default=B});