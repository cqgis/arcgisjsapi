// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(C,a,q,l,e,d,b,c){function k(a,m){return a?m?4:3:m?3:2}function r(a,m){return Math.round((m-a.translate[0])/a.scale[0])}function A(a,m){return Math.round((a.translate[1]-m)/a.scale[1])}function w(a,m){return m*a.scale[0]+a.translate[0]}function E(a,m){return a.translate[1]-
m*a.scale[1]}function y(a){a=a.coords;return{x:a[0],y:a[1]}}function H(a,m){a.coords[0]=m.x;a.coords[1]=m.y;return a}function G(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function D(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.z;return a}function h(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function n(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.m;return a}function u(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function p(a,m){a.coords[0]=m.x;a.coords[1]=m.y;a.coords[2]=m.z;a.coords[3]=
m.m;return a}function t(a,m){return a&&m?p:a?D:m?n:H}function F(a,m,c){if(!a)return null;for(var e=k(m,c),d=[],b=0;b<a.coords.length;b+=e){for(var h=[],p=0;p<e;p++)h.push(a.coords[b+p]);d.push(h)}return m?c?{points:d,hasZ:m,hasM:c}:{points:d,hasZ:m}:c?{points:d,hasM:c}:{points:d}}function z(a,m,c){void 0===c&&(c=k(m.hasZ,m.hasM));a.lengths[0]=m.points.length;var e=a.coords,d=0,b=0;for(m=m.points;b<m.length;b++)for(var h=m[b],p=0;p<c;p++)e[d++]=h[p];return a}function Q(a,m,c){if(!a)return null;var e=
k(m,c),d=a.coords,b=[],h=0,p=0;for(a=a.lengths;p<a.length;p++){for(var t=a[p],n=[],u=0;u<t;u++){for(var S=[],B=0;B<e;B++)S.push(d[h++]);n.push(S)}b.push(n)}return m?c?{paths:b,hasZ:m,hasM:c}:{paths:b,hasZ:m}:c?{paths:b,hasM:c}:{paths:b}}function T(a,m,c){void 0===c&&(c=k(m.hasZ,m.hasM));var e=a.lengths,b=a.coords,d=0,h=0;for(m=m.paths;h<m.length;h++){for(var p=m[h],t=0,n=p;t<n.length;t++)for(var u=n[t],B=0;B<c;B++)b[d++]=u[B];e.push(p.length)}return a}function K(a,m,c){if(!a)return null;var e=k(m,
c),b=a.coords,d=[],h=0,p=0;for(a=a.lengths;p<a.length;p++){for(var t=a[p],n=[],u=0;u<t;u++){for(var B=[],S=0;S<e;S++)B.push(b[h++]);n.push(B)}d.push(n)}return m?c?{rings:d,hasZ:m,hasM:c}:{rings:d,hasZ:m}:c?{rings:d,hasM:c}:{rings:d}}function R(a,m,c,d){void 0===c&&(c=m.hasZ);void 0===d&&(d=m.hasM);c=k(c,d);d=a.lengths;var e=a.coords,b=0,h=d.length=e.length=0;for(m=m.rings;h<m.length;h++){for(var p=m[h],t=0,n=p;t<n.length;t++)for(var u=n[t],B=0;B<c;B++)e[b++]=u[B];d.push(p.length)}return a}function I(a,
m,e,b,h,p){a.length=0;if(!e){for(b=0;b<m.length;b++)h=m[b],a.push(new d.default(null,h.attributes,null,h.attributes[p]));return a}switch(e){case "esriGeometryPoint":b=t(b,h);for(h=0;h<m.length;h++){var n=m[h];e=n.geometry;var n=n.attributes,u=void 0;e&&(u=b(new c.default,e));a.push(new d.default(u,n,null,n[p]))}break;case "esriGeometryMultipoint":b=k(b,h);for(h=0;h<m.length;h++)n=m[h],e=n.geometry,n=n.attributes,u=void 0,e&&(u=z(new c.default,e,b)),a.push(new d.default(u,n,null,n[p]));break;case "esriGeometryPolyline":b=
k(b,h);for(h=0;h<m.length;h++)n=m[h],e=n.geometry,n=n.attributes,u=void 0,e&&(u=T(new c.default,e,b)),a.push(new d.default(u,n,null,n[p]));break;case "esriGeometryPolygon":for(e=0;e<m.length;e++){var B=m[e],n=B.geometry,u=B.centroid,B=B.attributes,y=void 0;n&&(y=R(new c.default,n,b,h));u?a.push(new d.default(y,B,H(new c.default,u),B[p])):a.push(new d.default(y,B,null,B[p]))}break;default:X.error("convertToFeatureSet:unknown-geometry",new q("Unable to parse unknown geometry type '"+e+"'")),a.length=
0}return a}function M(a,m,c,e,b){a.length=0;switch(c){case "esriGeometryPoint":c=y;e&&b?c=u:e?c=G:b&&(c=h);for(e=0;e<m.length;e++){var d=m[e];b=d.geometry;d=d.attributes;b=b?c(b):null;a.push({attributes:d,geometry:b})}break;case "esriGeometryMultipoint":for(c=0;c<m.length;c++){var p=m[c],d=p.geometry,p=p.attributes,t=void 0;d&&(t=F(d,e,b));a.push({attributes:p,geometry:t})}break;case "esriGeometryPolyline":for(c=0;c<m.length;c++)p=m[c],d=p.geometry,p=p.attributes,t=void 0,d&&(t=Q(d,e,b)),a.push({attributes:p,
geometry:t});break;case "esriGeometryPolygon":for(c=0;c<m.length;c++){var t=m[c],p=t.geometry,d=t.attributes,n=t.centroid,t=void 0;p&&(t=K(p,e,b));n?(p=y(n),a.push({attributes:d,centroid:p,geometry:t})):a.push({attributes:d,geometry:t})}break;default:X.error("convertToFeatureSet:unknown-geometry",new q("Unable to parse unknown geometry type '"+c+"'"))}return a}function m(a,m,c,e,b,d){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;b=
sa[b];var h=m.coords;m=m.lengths;var p=k(c,e);c=c?e?Fa:Y:e?Y:ha;if(!m.length)return c(a.coords,h,0,0,r(d,h[0]),A(d,h[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=p,a;for(var t,n,u,B=0,y,F=0,D=0;D<m.length;D++){var S=m[D];if(!(S<b)){var z=0;y=F;n=e=r(d,h[B]);u=t=A(d,h[B+1]);c(a.coords,h,y,B,n,u);z++;B+=p;y+=p;for(var l=1;l<S;l++,B+=p)if(n=r(d,h[B]),u=A(d,h[B+1]),n!==e||u!==t)c(a.coords,h,y,B,n-e,u-t),y+=p,z++,e=n,t=u;z>=b&&(a.lengths.push(z),F=y)}}a.coords.length=F;return a.coords.length?
a:null}function B(a,m,c,e,b,d,h){for(var p=h-c,t=0,n=0,k,u=d+c;u<h-c;u+=c){k=m[u];var y=m[u+1],F=m[d],D=m[d+1],r=m[p],z=m[p+1];F===r?k=Math.abs(k-F):(r=(z-D)/(r-F),k=Math.abs(r*k-y+(D-r*F))/Math.sqrt(r*r+1));k>t&&(n=u,t=k)}t>e?(B(a,m,c,e,b,d,n+c),B(a,m,c,e,b,n,h)):(b(a,m,a.length,d,m[d],m[d+1]),b(a,m,a.length,p,m[p],m[p+1]))}function ia(a,m,c,e,d){var b=m.coords,h=m.lengths,p=c?e?Fa:Y:e?Y:ha;c=k(c,e);if(!b.length)return a!==m&&(a.lengths.length=0,a.coords.length=0),a;if(!h.length)return p(a.coords,
b,0,0,w(d,b[0]),E(d,b[1])),a!==m&&(a.lengths.length=0,a.coords.length=c),a;var t=d.scale;e=t[0];for(var t=t[1],n=0,u=0;u<h.length;u++){var B=h[u];a.lengths[u]=B;var y=w(d,b[n]),F=E(d,b[n+1]);p(a.coords,b,n,n,y,F);for(var n=n+c,D=1;D<B;D++,n+=c)y+=b[n]*e,F-=b[n+1]*t,p(a.coords,b,n,n,y,F)}a!==m&&(a.lengths.length=h.length,a.coords.length=b.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var X=l.getLogger("esri.tasks.support.optimizedFeatureSet"),sa={esriGeometryPoint:0,esriGeometryPolyline:2,
esriGeometryPolygon:3,esriGeometryMultipoint:0},ha=function(a,m,c,e,b,d){a[c]=b;a[c+1]=d},Y=function(a,m,c,b,e,d){a[c]=e;a[c+1]=d;a[c+2]=m[b+2]},Fa=function(a,m,c,b,e,d){a[c]=e;a[c+1]=d;a[c+2]=m[b+2];a[c+3]=m[b+3]};a.quantizeX=r;a.quantizeY=A;a.hydrateX=w;a.hydrateY=E;a.convertToPoint=function(a,m,c){return a?m?c?u(a):G(a):c?h(a):y(a):null};a.convertFromPoint=function(a,m,c){void 0===c&&(c=t(null!=m.z,null!=m.m));return c(a,m)};a.convertToMultipoint=F;a.convertFromMultipoint=z;a.convertToPolyline=
Q;a.convertToPolygon=K;a.convertFromPolygon=R;var aa=[],Z=[];a.convertFromFeature=function(a,m,c,b,e){aa[0]=a;a=I(Z,aa,m,c,b,e)[0];aa.length=Z.length=0;return a};a.convertFromFeatures=I;a.convertToFeature=function(a,m,c,b){Z[0]=a;M(aa,Z,m,c,b);a=aa[0];aa.length=Z.length=0;return a};a.convertFromGeometry=function(a,m,b){if(!a)return null;var d=new c.default;"hasZ"in a&&null==m&&(m=a.hasZ);"hasM"in a&&null==b&&(b=a.hasM);if(e.isPoint(a))return t(null!=m?m:null!=a.z,null!=b?b:null!=a.m)(d,a);if(e.isPolygon(a))return R(d,
a,m,b);if(e.isPolyline(a))return T(d,a,k(m,b));if(e.isMultipoint(a))return z(d,a,k(m,b));X.error("convertFromGeometry:unknown-geometry",new q("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=function(a,m,c,b){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(m){case "esriGeometryPoint":return m=y,c&&b?m=u:c?m=G:b&&(m=h),m(a);case "esriGeometryMultipoint":return F(a,c,b);case "esriGeometryPolyline":return Q(a,c,b);case "esriGeometryPolygon":return K(a,c,b);default:X.error("convertToGeometry:unknown-geometry",
new q("Unable to parse unknown geometry type '"+m+"'"))}};a.convertToFeatures=M;a.convertToFeatureSet=function(a){var m=a.objectIdFieldName,c=a.spatialReference,b=a.transform,e=a.fields,d=a.hasM,h=a.hasZ,p=a.geometryType,t=a.exceededTransferLimit;a={features:M([],a.features,p,h,d),fields:e,geometryType:p,objectIdFieldName:m,spatialReference:c};b&&(a.transform=b);t&&(a.exceededTransferLimit=t);d&&(a.hasM=d);h&&(a.hasZ=h);return a};a.convertFromFeatureSet=function(a,m){var c=new b.default,d=a.hasM,
e=a.hasZ,h=a.features,p=a.objectIdFieldName,t=a.spatialReference,n=a.geometryType,k=a.exceededTransferLimit,u=a.transform;c.fields=a.fields;c.geometryType=n;c.objectIdFieldName=p||m;c.spatialReference=t;if(!c.objectIdFieldName)return X.error(new q("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),c;h&&I(c.features,h,n,e,d,c.objectIdFieldName);k&&(c.exceededTransferLimit=k);d&&(c.hasM=d);e&&(c.hasZ=e);u&&(c.transform=u);return c};a.hydrateOptimizedFeatureSet=function(a){var m=
a.transform,c=a.hasM,b=a.hasZ;if(!m)return a;for(var d=0,e=a.features;d<e.length;d++){var h=e[d];h.geometry&&ia(h.geometry,h.geometry,c,b,m);h.centroid&&ia(h.centroid,h.centroid,c,b,m)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var e=b.geometryType,h=b.features,p=b.hasM,t=b.hasZ;if(!a)return b;for(var n=0;n<h.length;n++){var k=h[n],u=new d.default(new c.default,k.attributes);m(u.geometry,k.geometry,p,t,e,a);k.centroid&&(u.centroid=new c.default,m(u.centroid,k.centroid,
p,t,"esriGeometryPoint",a));h[n]=u}b.transform=a;return b};a.quantizeOptimizedGeometry=m;a.quantizeOptimizedGeometryRemoveCollinear=function(a,m,c,b,e,d){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;e=sa[e];var h=m.coords;m=m.lengths;var p=k(c,b);c=c?b?Fa:Y:b?Y:ha;if(!m.length)return c(a.coords,h,0,0,r(d,h[0]),A(d,h[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=p,a;for(var t,n,u,B=0,y,F=0,D=0;D<m.length;D++){var z=m[D];
if(!(z<e)){var l=0;y=F;b=t=r(d,h[B]);u=n=A(d,h[B+1]);c(a.coords,h,y,B,b,u);l++;for(var B=B+p,M=!1,H=0,w=0,K=1;K<z;K++,B+=p)if(b=r(d,h[B]),u=A(d,h[B+1]),b!==t||u!==n)t=b-t,n=u-n,M&&(0===H&&0===t||0===w&&0===n)?(H+=t,w+=n):(M=!0,H=t,w=n,y+=p,l++),c(a.coords,h,y,B,H,w),t=b,n=u;M&&(y+=p,c(a.coords,h,y,B,H,w));l>=e&&(a.lengths.push(l),F=y)}}a.coords.length!==F&&(a.coords.length=F);return a.coords.length?a:null};a.generalizeOptimizedGeometry=function(a,m,c,b,d,e){a.lengths.length&&(a.lengths.length=0);
a.coords.length&&(a.coords.length=0);if(!m||!m.coords.length)return null;d=sa[d];var h=m.coords;m=m.lengths;var p=k(c,b);c=c?b?Fa:Y:b?Y:ha;if(!m.length)return c(a.coords,h,0,0,h[0],h[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=p,a;for(var t=b=0;t<m.length;t++){var n=m[t];if(!(n<d)){var u=a.coords.length/p;B(a.coords,h,p,e,c,b,b+n*p);var y=a.coords.length/p-u;y>=d?a.lengths.push(y):a.coords.length=u*p}b+=n*p}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,m,c,
b){c=k(c,b);var d=b=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY;if(m&&m.coords){m=m.coords;for(var p=0;p<m.length;p+=c){var t=m[p],n=m[p+1];b=Math.min(b,t);e=Math.max(e,t);d=Math.min(d,n);h=Math.max(h,n)}}a[0]=b;a[1]=d;a[2]=e;a[3]=h;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,m,c,b){c=k(c,b);b=m.coords;var d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,p=Number.NEGATIVE_INFINITY,t=0,n=0;for(m=m.lengths;n<m.length;n++)for(var u=
m[n],B=b[t],y=b[t+1],d=Math.min(B,d),e=Math.min(y,e),h=Math.max(B,h),p=Math.max(y,p),t=t+c,F=1;F<u;F++,t+=c){var D=b[t],r=b[t+1],B=B+D,y=y+r;0>D&&(d=Math.min(d,B));0<D&&(h=Math.max(h,B));0>r?e=Math.min(e,y):0<r&&(p=Math.max(p,y))}a[0]=d;a[1]=e;a[2]=h;a[3]=p;return a};a.hydrateOptimizedGeometry=ia})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/extendsHelper @dojo/framework/shim/Map ../../../core/Error ../../../core/Evented ../../../core/has ../../../core/Logger ../../../core/maybe ../../../core/libs/rbush/rbush ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(C,a,q,l,e,d,b,c,k,r,A,w,E,y,H,G){Object.defineProperty(a,"__esModule",{value:!0});var D=[],h=r.getLogger("esri.layers.graphics.data.FeatureStore"),n={minX:0,minY:0,maxX:0,maxY:0};C=function(){function a(a,b,e){this._geometryInfo=a;this._onFeatureAdd=b;this._onFeatureRemove=e;this._featuresById=new d.default;this._boundsByFeature=new d.default;this._featuresByBounds=new d.default;this._index=w(9,k("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]",
"[2]","[3]"]);this.events=new c;this.featureAdapter=G.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var a=y.create(y.NEGATIVE_INFINITY);this._boundsByFeature.forEach(function(c){c&&(a[0]=Math.min(c[0],a[0]),a[1]=Math.min(c[1],a[1]),a[2]=Math.max(c[2],a[2]),a[3]=Math.max(c[3],a[3]))});return a},enumerable:!0,configurable:!0});a.prototype.add=function(a){this._add(a,D);this._index.load(D);this._emitChanged();D.length=
0};a.prototype.addMany=function(a){for(var c=0;c<a.length;c++)this._add(a[c],D);this._index.load(D);this._emitChanged();D.length=0};a.prototype.clear=function(){this._featuresById.clear();this._boundsByFeature.clear();this._featuresByBounds.clear();this._index.clear();this._emitChanged()};a.prototype.removeById=function(a){var c=this._featuresById.get(a);if(!c)return null;var b=this._boundsByFeature.get(c);b&&(this._index.remove(b),this._featuresByBounds.delete(b));this._boundsByFeature.delete(c);
this._featuresById.delete(a);this._emitChanged();return c};a.prototype.removeIf=function(a,c){var b=this;this._featuresById.forEach(function(d,e){c(d)&&(b._remove(d),a.push(d))});this._emitChanged()};a.prototype.removeManyById=function(a){for(var c=0;c<a.length;c++){var b=a[c],d=this._featuresById.get(b);if(d){var e=this._boundsByFeature.get(d);e&&(this._index.remove(e),this._featuresByBounds.delete(e));this._boundsByFeature.delete(d)}this._featuresById.delete(b)}this._emitChanged()};a.prototype.forEachBounds=
function(a,c,b){for(var d=0;d<a.length;d++){var e=this._boundsByFeature.get(a[d]);e&&c(E.fromRect(b,e))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(c){return a(c)})};a.prototype.forEachInBounds=function(a,c){var b=0,d=this._index;n.minX=a[0];n.minY=a[1];n.maxX=a[2];n.maxY=a[3];for(a=d.search(n);b<a.length;b++)c(this._featuresByBounds.get(a[b]))};
a.prototype.transferById=function(a,c){if(c=this._featuresById.get(c))this._remove(c),a.add(c),this._emitChanged()};a.prototype.transferByIds=function(a,c){for(var b=[],d=0;d<c.length;d++){var e=this._featuresById.get(c[d]);e&&(this._remove(e),b.push(e))}a.addMany(b);this._emitChanged()};a.prototype.transferIdRange=function(a,c,b){for(var d=[];c<b;c++){var e=this._featuresById.get(c);e&&(this._remove(e),d.push(e))}a.addMany(d);this._emitChanged()};a.prototype.transferIf=function(a,c){var b=this,d=
[];this._featuresById.forEach(function(a,e){c(a)&&(b._remove(a),d.push(a))});a.addMany(d);this._emitChanged()};a.prototype.transferAll=function(a){var c=this,b=[];this._featuresById.forEach(function(a,d){c._remove(a);b.push(a)});a.addMany(b);this._emitChanged()};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a,c){if(a){var d=a.objectId;if(null==d)h.error(new b("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var e=this._featuresById.get(d),
n;e?(n=this._boundsByFeature.get(e),a.localId=e.localId,n&&(this._index.remove(n),this._boundsByFeature.delete(e),this._featuresByBounds.delete(n))):A.isSome(this._onFeatureAdd)&&this._onFeatureAdd(a);a.geometry?(n=H.getBoundsOptimizedGeometry(n||y.create(),a.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(a,n),this._featuresByBounds.set(n,a),this._featuresById.set(d,a),c.push(n)):(this._boundsByFeature.set(a,null),this._featuresById.set(d,a))}}};a.prototype._remove=
function(a){var c;if(a){A.isSome(this._onFeatureRemove)&&this._onFeatureRemove(a);if(c=this._boundsByFeature.get(a))this._index.remove(c),this._boundsByFeature.delete(a),this._featuresByBounds.delete(c);this._featuresById.delete(a.objectId)}};return a}();a.default=C})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(C){function a(c,b){if(!(this instanceof a))return new a(c,b);this._maxEntries=Math.max(4,c||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));
b&&("function"===typeof b?this.toBBox=b:this._initFormat(b));this.clear()}function q(a,c){l(a,0,a.children.length,c,a)}function l(a,c,b,d,h){h||(h=w(null));h.minX=Infinity;h.minY=Infinity;h.maxX=-Infinity;h.maxY=-Infinity;for(var n;c<b;c++)n=a.children[c],e(h,a.leaf?d(n):n);return h}function e(a,c){a.minX=Math.min(a.minX,c.minX);a.minY=Math.min(a.minY,c.minY);a.maxX=Math.max(a.maxX,c.maxX);a.maxY=Math.max(a.maxY,c.maxY);return a}function d(a,c){return a.minX-c.minX}function b(a,c){return a.minY-c.minY}
function c(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function k(a){return a.maxX-a.minX+(a.maxY-a.minY)}function r(a,c){return a.minX<=c.minX&&a.minY<=c.minY&&c.maxX<=a.maxX&&c.maxY<=a.maxY}function A(a,c){return c.minX<=a.maxX&&c.minY<=a.maxY&&c.maxX>=a.minX&&c.maxY>=a.minY}function w(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function E(a,c,b,d,e){for(var h=[c,b],k;h.length;)b=h.pop(),c=h.pop(),b-c<=d||(k=c+Math.ceil((b-c)/d/2)*d,C(a,k,c,b,e),
h.push(c,k,k,b))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var c=this.data,b=[],d=this.toBBox;if(!A(a,c))return b;for(var e=[],n,k,p,t;c;){n=0;for(k=c.children.length;n<k;n++)p=c.children[n],t=c.leaf?d(p):p,A(a,t)&&(c.leaf?b.push(p):r(a,t)?this._all(p,b):e.push(p));c=e.pop()}return b},collides:function(a){var c=this.data,b=this.toBBox;if(!A(a,c))return!1;for(var d=[],e,n,k,p;c;){e=0;for(n=c.children.length;e<n;e++)if(k=c.children[e],p=c.leaf?b(k):k,A(a,p)){if(c.leaf||
r(a,p))return!0;d.push(k)}c=d.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var c=0,b=a.length;c<b;c++)this.insert(a[c]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(c=this.data,this.data=a,a=c),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},
clear:function(){this.data=w([]);return this},remove:function(a,c){if(!a)return this;for(var b=this.data,d=this.toBBox(a),e=[],n=[],k,p,t,F;b||e.length;){b||(b=e.pop(),p=e[e.length-1],k=n.pop(),F=!0);if(b.leaf){a:{t=a;var l=b.children,y=c;if(y){for(var w=0;w<l.length;w++)if(y(t,l[w])){t=w;break a}t=-1}else t=l.indexOf(t)}if(-1!==t){b.children.splice(t,1);e.push(b);this._condense(e);break}}F||b.leaf||!r(b,d)?p?(k++,b=p.children[k],F=!1):b=null:(e.push(b),n.push(k),k=0,p=b,b=b.children[0])}return this},
toBBox:function(a){return a},compareMinX:d,compareMinY:b,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,c){for(var b=[];a;)a.leaf?c.push.apply(c,a.children):b.push.apply(b,a.children),a=b.pop();return c},_build:function(a,c,b,d){var e=b-c+1,n=this._maxEntries,k;if(e<=n)return k=w(a.slice(c,b+1)),q(k,this.toBBox),k;d||(d=Math.ceil(Math.log(e)/Math.log(n)),n=Math.ceil(e/Math.pow(n,d-1)));k=w([]);k.leaf=!1;k.height=d;var e=Math.ceil(e/n),n=e*Math.ceil(Math.sqrt(n)),
p,t,r;for(E(a,c,b,n,this.compareMinX);c<=b;c+=n)for(t=Math.min(c+n-1,b),E(a,c,t,e,this.compareMinY),p=c;p<=t;p+=e)r=Math.min(p+e-1,t),k.children.push(this._build(a,p,r,d-1));q(k,this.toBBox);return k},_chooseSubtree:function(a,b,d,e){for(var h,n,k,p,t,r,D,l;;){e.push(b);if(b.leaf||e.length-1===d)break;D=l=Infinity;h=0;for(n=b.children.length;h<n;h++)k=b.children[h],t=c(k),r=(Math.max(k.maxX,a.maxX)-Math.min(k.minX,a.minX))*(Math.max(k.maxY,a.maxY)-Math.min(k.minY,a.minY))-t,r<l?(l=r,D=t<D?t:D,p=k):
r===l&&t<D&&(D=t,p=k);b=p||b.children[0]}return b},_insert:function(a,c,b){var d=this.toBBox;b=b?a:d(a);var d=[],h=this._chooseSubtree(b,this.data,c,d);h.children.push(a);for(e(h,b);0<=c;)if(d[c].children.length>this._maxEntries)this._split(d,c),c--;else break;this._adjustParentBBoxes(b,d,c)},_split:function(a,c){var b=a[c],d=b.children.length,e=this._minEntries;this._chooseSplitAxis(b,e,d);d=this._chooseSplitIndex(b,e,d);d=w(b.children.splice(d,b.children.length-d));d.height=b.height;d.leaf=b.leaf;
q(b,this.toBBox);q(d,this.toBBox);c?a[c-1].children.push(d):this._splitRoot(b,d)},_splitRoot:function(a,c){this.data=w([a,c]);this.data.height=a.height+1;this.data.leaf=!1;q(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,d){var e,h,n,k,p,t,r;p=t=Infinity;for(e=b;e<=d-b;e++)h=l(a,0,e,this.toBBox),n=l(a,e,d,this.toBBox),k=Math.max(0,Math.min(h.maxX,n.maxX)-Math.max(h.minX,n.minX))*Math.max(0,Math.min(h.maxY,n.maxY)-Math.max(h.minY,n.minY)),h=c(h)+c(n),k<p?(p=k,r=e,t=h<t?h:t):k===p&&h<t&&(t=
h,r=e);return r},_chooseSplitAxis:function(a,c,e){var k=a.leaf?this.compareMinX:d,h=a.leaf?this.compareMinY:b,n=this._allDistMargin(a,c,e,k);c=this._allDistMargin(a,c,e,h);n<c&&a.children.sort(k)},_allDistMargin:function(a,c,b,d){a.children.sort(d);d=this.toBBox;var h=l(a,0,c,d),n=l(a,b-c,b,d),u=k(h)+k(n),p,t;for(p=c;p<b-c;p++)t=a.children[p],e(h,a.leaf?d(t):t),u+=k(h);for(p=b-c-1;p>=c;p--)t=a.children[p],e(n,a.leaf?d(t):t),u+=k(n);return u},_adjustParentBBoxes:function(a,c,b){for(;0<=b;b--)e(c[b],
a)},_condense:function(a){for(var c=a.length-1,b;0<=c;c--)0===a[c].children.length?0<c?(b=a[c-1].children,b.splice(b.indexOf(a[c]),1)):this.clear():q(a[c],this.toBBox)},_initFormat:function(a){var c=["return a"," - b",";"];this.compareMinX=new Function("a","b",c.join(a[0]));this.compareMinY=new Function("a","b",c.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],
function(){function C(l,e,d,b,c){for(;b>d;){if(600<b-d){var k=b-d+1,r=e-d+1,A=Math.log(k),w=.5*Math.exp(2*A/3),A=.5*Math.sqrt(A*w*(k-w)/k)*(0>r-k/2?-1:1);C(l,e,Math.max(d,Math.floor(e-r*w/k+A)),Math.min(b,Math.floor(e+(k-r)*w/k+A)),c)}k=l[e];r=d;w=b;a(l,d,e);for(0<c(l[b],k)&&a(l,d,b);r<w;){a(l,r,w);r++;for(w--;0>c(l[r],k);)r++;for(;0<c(l[w],k);)w--}0===c(l[d],k)?a(l,d,w):(w++,a(l,w,b));w<=e&&(d=w+1);e<=w&&(b=w-1)}}function a(a,e,d){var b=a[e];a[e]=a[d];a[d]=b}function q(a,e){return a<e?-1:a>e?1:0}
return function(a,e,d,b,c){C(a,e,d||0,b||a.length-1,c||q)}})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(C,a,q,l,e){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,
b){return new l.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,b){a.centroid||(a.centroid=q.getCentroidOptimizedGeometry(new e.default,a.geometry,b.hasZ,b.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(C,a){function q(a,d,b,c,k,r){r=k?r?4:3:r?3:2;var e=b,l=b+r,E=0,y=0,q=b=0,G=0,D=0;for(--c;D<c;D++,e+=r,l+=r){var h=d[e],n=d[e+1],
u=d[e+2],p=d[l],t=d[l+1],F=d[l+2],z=h*t-p*n,q=q+z,E=E+(h+p)*z,y=y+(n+t)*z;k&&(z=h*F-p*u,b+=(u+F)*z,G+=z);h<a[0]&&(a[0]=h);h>a[1]&&(a[1]=h);n<a[2]&&(a[2]=n);n>a[3]&&(a[3]=n);k&&(u<a[4]&&(a[4]=u),u>a[5]&&(a[5]=u))}0<q&&(q*=-1);0<G&&(G*=-1);if(!q)return null;a=[E,y,.5*q];k&&(a[3]=b,a[4]=.5*G);return a}function l(a,d,b,c,k){k=c?k?4:3:k?3:2;for(var e=d,l=d+k,w=0,E=0,y=0,q=0,G=0,D=b-1;G<D;G++,e+=k,l+=k){var h=a[e],n=a[e+1],u=a[e+2],p=a[l],t=a[l+1],F=a[l+2],z;if(c){z=p-h;var Q=t-n,T=F-u;z=Math.sqrt(z*z+
Q*Q+T*T)}else z=p-h,Q=t-n,z=Math.sqrt(z*z+Q*Q);z&&(w+=z,c?(h=[h+.5*(p-h),n+.5*(t-n),u+.5*(F-u)],E+=z*h[0],y+=z*h[1],q+=z*h[2]):(h=[h+.5*(p-h),n+.5*(t-n)],E+=z*h[0],y+=z*h[1]))}return 0<w?c?[E/w,y/w,q/w]:[E/w,y/w]:0<b?c?[a[d],a[d+1],a[d+2]]:[a[d],a[d+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,d,b,c){if(!d||!d.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var e=a.coords,r=[],A=b?[Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],w=d.lengths,E=d.coords,y=b?c?4:3:c?3:2,H=0,G=0;G<w.length;G++){var D=w[G],h=q(A,E,H,D,b,c);h&&r.push(h);H+=D*y}r.sort(function(a,c){var d=a[2]-c[2];0===d&&b&&(d=a[4]-c[4]);return d});r.length&&(y=6*r[0][2],e[0]=r[0][0]/y,e[1]=r[0][1]/y,b&&(y=6*r[0][4],e[2]=0!==y?r[0][3]/y:
0),e[0]<A[0]||e[0]>A[1]||e[1]<A[2]||e[1]>A[3]||b&&(e[2]<A[4]||e[2]>A[5]))&&(e.length=0);if(!e.length)if(d=d.lengths[0]?l(E,0,w[0],b,c):null)e[0]=d[0],e[1]=d[1],b&&2<d.length&&(e[2]=d[2]);else return null;return a};a.lineCentroid=l})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(C,a,q,l,e,d,b,c,k){function r(a,c){var b;if(!c)return null;if("x"in c){var d={x:0,y:0};a=a(c.x,c.y,y);d.x=a[0];d.y=a[1];null!=c.z&&(d.z=c.z);null!=c.m&&(d.m=c.m);return d}if("xmin"in c)return d={xmin:0,ymin:0,xmax:0,ymax:0},b=a(c.xmin,c.ymin,y),d.xmin=b[0],d.ymin=b[1],a=a(c.xmax,c.ymax,y),d.xmax=a[0],d.ymax=a[1],c.hasZ&&(d.zmin=c.zmin,d.zmax=c.zmax,d.hasZ=!0),c.hasM&&(d.mmin=c.mmin,d.mmax=c.mmax,d.hasM=!0),d;if("rings"in c)return{rings:A(c.rings,a),hasM:c.hasM,hasZ:c.hasZ};if("paths"in c)return{paths:A(c.paths,
a),hasM:c.hasM,hasZ:c.hasZ};if("points"in c)return{points:w(c.points,a),hasM:c.hasM,hasZ:c.hasZ}}function A(a,c){for(var b=[],d=0;d<a.length;d++)b.push(w(a[d],c));return b}function w(a,c){for(var b=[],d=0;d<a.length;d++){var e=a[d],h=c(e[0],e[1],[0,0]);b.push(h);2<e.length&&h.push(e[2]);3<e.length&&h.push(e[3])}return b}function E(a,b){return!c.isValid(a)||!c.isValid(b)||c.equals(a,b)||k.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var y=[0,0];a.checkProjectionSupport=function(a,
c){return l(this,void 0,void 0,function(){var d,h,k;return q(this,function(n){if(!c)return[2];if(Array.isArray(a)){d=0;for(h=a;d<h.length;d++)if(k=h[d],E(k.geometry&&k.geometry.spatialReference,c)){if(b.isSupported())return[2,b.load()];throw new e("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});}return[2]}if(!E(a,c))return[2];if(b.isSupported())return[2,b.load()];throw new e("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,
outSpatialReference:c});})})};var H=r.bind(null,k.lngLatToXY),G=r.bind(null,k.xyToLngLat);a.project=function(a,d,e){e||(e=d,d=a.spatialReference);return c.isValid(d)&&c.isValid(e)&&!c.equals(d,e)?k.canProject(d,e)?c.isWebMercator(e)?H(a):G(a):b.projectMany([a],d,e,null,!0)[0]:a};var D=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,e){return l(this,void 0,void 0,function(){var h,k=this;return q(this,function(n){a&&a.length&&
b&&e&&!c.equals(b,e)||d.resolve(a);h={geometries:a,inSpatialReference:b,outSpatialReference:e,resolve:null};this._jobs.push(h);return[2,d.create(function(a){h.resolve=a;null===k._timer&&(k._timer=setTimeout(k._process,10))},function(){var a=k._jobs.indexOf(h);-1<a&&k._jobs.splice(a,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var d=a.geometries,e=a.inSpatialReference,h=a.outSpatialReference,a=a.resolve;k.canProject(e,h)?c.isWebMercator(h)?a(d.map(H)):
a(d.map(G)):a(b.projectMany(d,e,h,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,c,b){return l(this,void 0,void 0,function(){return q(this,function(d){return[2,D.push(a,c,b)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(C,a,q,l,e,d){function b(a,b,r,l,q){void 0===l&&(l=null);void 0===q&&(q=!1);if(null===l){var D=
d.cacheKey(b,r);void 0!==A[D]?l=A[D]:(l=c(b,r,null),null===l&&(l=new d),A[D]=l)}return k._project(a,b,r instanceof e||!1===q?r:new e(r),l,q)}function c(a,c,b){void 0===b&&(b=null);a=k._getTransformation(a,c,b);return null!==a?d.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var k=null;a.isLoaded=function(){return!!k&&l.isLoaded()};a.isSupported=function(){return l.isSupported()};var r=null;a.load=function(){return r?r:r=q.create(function(a,c){var b=l.load();C(["./geometryEngine"],
function(d){k=d;b.then(function(){k._enableProjection(l);a()},function(a){c(a)})})})};a.project=function(a,c,d){void 0===d&&(d=null);return a instanceof Array?0===a.length?[]:b(a,a[0].spatialReference,c,d):b([a],a.spatialReference,c,d)[0]};var A={};a.projectMany=b;a.getTransformation=c;a.getTransformations=function(a,c,b){void 0===b&&(b=null);a=k._getTransformationBySuitability(a,c,b);if(null!==a){c=[];for(b=0;b<a.length;b++)c.push(d.fromGE(a[b]));return c}return[]}})},"esri/geometry/pe":function(){define(["require",
"exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(C,a,q,l,e){function d(c){function b(a,c,b){a[c]=b(a[c])}a._pe=c;w.init();E.init();y.init();H.init();G.init();a.PeGCSExtent=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}q(b,c);b.prototype.destroy=function(){a._pe.destroy(this)};return b}(a._pe.PeGCSExtent);for(var d=0,e=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,
a._pe.PeUnit];d<e.length;d++)c=e[d],b(c.prototype,"getName",function(a){return function(){return a.call(this,Array(w.PE_NAME_MAX))}});d=0;for(e=[a._pe.PeGeogtran,a._pe.PeProjcs];d<e.length;d++)c=e[d],b(c.prototype,"getParameters",function(c){return function(){for(var b=Array(w.PE_PARM_MAX),d=c.call(this),e=0;e<b.length;e++){var k=a._pe.getValue(d,"*");b[e]=k?a._pe.wrapPointer(k,a._pe.PeParameter):null;d+=Int32Array.BYTES_PER_ELEMENT}return b}});b(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var c=
this.getSize();if(!c)return null;var b=[],d=a.call(this);r(b,c,d);return b}});b(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(c){var b=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var d=null,e=c.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],k=this.getSteps();if(1<k)for(var e=a._pe.getPointer(e),h=1;h<k;h++)d.push(a._pe.wrapPointer(e+b*h,a._pe.PeGTlistExtendedGTs))}return d}});var k=a._pe._pe_getPeHorizonSize();c=function(c){return function(){var b=this._cache;b||
(this._cache=b=new Map);if(b.has(c))return b.get(c);var d=null,e=c.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],h=e.getNump();if(1<h)for(var e=a._pe.getPointer(e),n=1;n<h;n++)d.push(a._pe.wrapPointer(e+k*n,a._pe.PeHorizon))}b.set(c,d);return d}};b(a._pe.PeProjcs.prototype,"horizonGcsGenerate",c);b(a._pe.PeProjcs.prototype,"horizonPcsGenerate",c);a._pe.PeObject.prototype.toString=function(c){void 0===c&&(c=w.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var b=a._pe.getPointer(this),d=a._pe.ensureInt8(Array(w.PE_BUFFER_MAX));
return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(b,c,d))}}function b(c){if(c){var b=a._pe.getClass(c);b&&(b=a._pe.getCache(b))&&(c=a._pe.getPointer(c))&&delete b[c]}}function c(c,b){var d=[];b=Array(b);for(var e=0;e<c;e++)d.push(a._pe.ensureInt8(b));return d}function k(a){var c;Array.isArray(a[0])?(c=[],a.forEach(function(a){c.push(a[0],a[1])})):c=a;return c}function r(c,b,d,e){void 0===e&&(e=!1);if(e)for(e=0;e<2*b;e++)c[e]=a._pe.getValue(d+e*Float64Array.BYTES_PER_ELEMENT,"double");else{var k=
0===c.length;for(e=0;e<b;e++)k&&(c[e]=Array(2)),c[e][0]=a._pe.getValue(d,"double"),c[e][1]=a._pe.getValue(d+Float64Array.BYTES_PER_ELEMENT,"double"),d+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var A;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!l("esri-wasm")};a.load=function(){return A?A:A=e.create(function(a,c){C(["./support/pe-wasm"],function(b){b({locateFile:function(a){return C.toUrl("./support/"+a)},onAbort:function(a){c(Error(a))}}).then(function(c){d(c);
a()})})})};(function(c){function b(c,b,d){a._pe.ensureCache.prepare();var e=k(d),h=d===e,e=a._pe.ensureFloat64(e);(c=a._pe._pe_geog_to_proj(a._pe.getPointer(c),b,e))&&r(d,b,e,h);return c}function d(a,c,b){return e(a,c,b,0)}function e(c,b,d,e){a._pe.ensureCache.prepare();var h=k(d),n=d===h,h=a._pe.ensureFloat64(h);(c=a._pe._pe_proj_to_geog_center(a._pe.getPointer(c),b,h,e))&&r(d,b,h,n);return c}c.geogToProj=b;c.projGeog=function(a,c,e,k){switch(k){case w.PE_TRANSFORM_P_TO_G:return d(a,c,e);case w.PE_TRANSFORM_G_TO_P:return b(a,
c,e)}return 0};c.projToGeog=d;c.projToGeogCenter=e})(a.PeCSTransformations||(a.PeCSTransformations={}));var w;(function(c){c.init=function(){c.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;c.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;c.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;c.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;c.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;c.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;c.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;c.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;
c.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;c.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;c.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;c.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;c.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;c.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;c.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;c.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;c.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;c.PE_STR_AUTH_TOP=
a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;c.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;c.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;c.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;c.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;c.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;c.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;c.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;c.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;
c.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;c.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;c.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(w=a.PeDefs||(a.PeDefs={}));(function(c){function b(c,b){var k=null,h=e[c];h||(h={},e[c]=h);h.hasOwnProperty(String(b))?k=h[b]:(c=a._pe.PeFactory.prototype.factoryByType(c,b),a._pe.compare(c,a._pe.NULL)||(k=c,h[b]=k));return k=d(k)}function d(c){if(c){var b=c.getType();switch(b){case w.PE_TYPE_GEOGCS:c=a._pe.castObject(c,a._pe.PeGeogcs);
break;case w.PE_TYPE_PROJCS:c=a._pe.castObject(c,a._pe.PeProjcs);break;case w.PE_TYPE_GEOGTRAN:c=a._pe.castObject(c,a._pe.PeGeogtran);break;default:b&w.PE_TYPE_UNIT&&(c=a._pe.castObject(c,a._pe.PeUnit))}}return c}var e={},k={};c.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};c.coordsys=function(a){return b(w.PE_TYPE_COORDSYS,a)};c.factoryByType=b;c.fromString=function(c,b){var e=null,h=k[c];h||(h={},k[c]=h);h.hasOwnProperty(b)?e=h[b]:(c=a._pe.PeFactory.prototype.fromString(c,b),
a._pe.compare(c,a._pe.NULL)||(e=c,h[b]=e));return e=d(e)};c.geogcs=function(a){return b(w.PE_TYPE_GEOGCS,a)};c.geogtran=function(a){return b(w.PE_TYPE_GEOGTRAN,a)};c.getCode=function(c){return a._pe.PeFactory.prototype.getCode(c)};c.projcs=function(a){return b(w.PE_TYPE_PROJCS,a)};c.unit=function(a){return b(w.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var E;(function(c){var b;c.init=function(){c.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
b=a._pe._pe_getPeGTlistExtendedEntrySize()};c.getGTlist=function(c,d,e,k,h,r){var n=null,p=new a._pe.PeInteger(r);try{var l=a._pe.PeGTlistExtended.prototype.getGTlist(c,d,e,k,h,p);if(r=p.val)if(n=[l],1<r){var t=a._pe.getPointer(l);for(c=1;c<r;c++)n.push(a._pe.wrapPointer(t+b*c,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(p)}return n}})(E=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(c){c.destroy=function(c){if(c&&c.length){for(var d=0;d<c.length;d++){var e=c[d];b(e);e.getEntries().forEach(function(a){b(a);
a=a.getGeogtran();b(a);a.getParameters().forEach(b);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){b(a);var c=a.getDatum();b(c);b(c.getSpheroid());b(a.getPrimem());b(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(c[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(c,b,d,e,l){a._pe.ensureCache.prepare();var h=k(d),n=d===h,h=a._pe.ensureFloat64(h),p=0;e&&(p=a._pe.ensureFloat64(e));(c=a._pe._pe_geog_to_geog(a._pe.getPointer(c),b,h,p,
l))&&r(d,b,h,n);return c}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function d(b,d,e,h,n,r){a._pe.ensureCache.prepare();var p,l;switch(b){case "dd":p=a._pe._pe_geog_to_dd;l=w.PE_DD_MAX;break;case "ddm":p=a._pe._pe_geog_to_ddm;l=w.PE_DDM_MAX;break;case "dms":p=a._pe._pe_geog_to_dms,l=w.PE_DMS_MAX}b=0;d&&(b=a._pe.getPointer(d));d=k(h);d=a._pe.ensureFloat64(d);l=c(e,l);h=a._pe.ensureInt32(l);if(n=p(b,e,d,n,h))for(p=0;p<e;p++)r[p]=a._pe.UTF8ToString(l[p]);return n}function e(c,
b,d,e,k){a._pe.ensureCache.prepare();var h;switch(c){case "dd":h=a._pe._pe_dd_to_geog;break;case "ddm":h=a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}c=0;b&&(c=a._pe.getPointer(b));b=e.map(function(c){return a._pe.ensureString(c)});e=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(h=h(c,d,e,b))&&r(k,d,b);return h}b.geog_to_dms=function(a,c,b,e,k){return d("dms",a,c,b,e,k)};b.dms_to_geog=function(a,c,b,d){return e("dms",a,c,b,d)};b.geog_to_ddm=function(a,c,b,e,k){return d("ddm",
a,c,b,e,k)};b.ddm_to_geog=function(a,c,b,d){return e("ddm",a,c,b,d)};b.geog_to_dd=function(a,c,b,e,k){return d("dd",a,c,b,e,k)};b.dd_to_geog=function(a,c,b,d){return e("dd",a,c,b,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var y;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,d,e,r,l,A,z){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=k(e);e=a._pe.ensureFloat64(b);b=c(d,w.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(r=a._pe._pe_geog_to_mgrs_extended(h,d,e,r,l,A,n))for(l=0;l<d;l++)z[l]=a._pe.UTF8ToString(b[l]);return r};b.mgrs_to_geog_extended=function(c,b,d,e,k){a._pe.ensureCache.prepare();var h=0;c&&(h=a._pe.getPointer(c));c=d.map(function(c){return a._pe.ensureString(c)});
d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*b));(e=a._pe._pe_mgrs_to_geog_extended(h,b,d,e,c))&&r(k,b,c);return e}})(y=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,d,e,r,l,A,z){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=k(e);e=a._pe.ensureFloat64(b);b=c(d,w.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(r=a._pe._pe_geog_to_usng(h,d,e,r,l,A,n))for(l=0;l<d;l++)z[l]=a._pe.UTF8ToString(b[l]);return r};b.usng_to_geog=function(c,b,d,e){a._pe.ensureCache.prepare();
var k=0;c&&(k=a._pe.getPointer(c));c=d.map(function(c){return a._pe.ensureString(c)});d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*b));(k=a._pe._pe_usng_to_geog(k,b,d,c))&&r(e,b,c);return k}})(a.PeNotationUsng||(a.PeNotationUsng={}));var H;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
d,e,r,l){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=k(e);e=a._pe.ensureFloat64(b);b=c(d,w.PE_UTM_MAX);var n=a._pe.ensureInt32(b);if(r=a._pe._pe_geog_to_utm(h,d,e,r,n))for(h=0;h<d;h++)l[h]=a._pe.UTF8ToString(b[h]);return r};b.utm_to_geog=function(c,b,d,e,k){a._pe.ensureCache.prepare();var h=0;c&&(h=a._pe.getPointer(c));c=d.map(function(c){return a._pe.ensureString(c)});d=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*b));(e=a._pe._pe_utm_to_geog(h,b,d,e,c))&&r(k,b,c);return e}})(H=
a.PeNotationUtm||(a.PeNotationUtm={}));var G;(function(c){var b=new Map;c.init=function(){c.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;c.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;c.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;c.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};c.generate=function(d,e){void 0===e&&(e=c.PE_PCSINFO_OPTION_DOMAIN);var k,h;b.has(d)&&(h=b.get(d),h[e]&&(k=h[e]));k||(k=a._pe.PePCSInfo.prototype.generate(d,
e),h||(h=[],b.set(d,h)),h[e]=k);return k}})(G=a.PePCSInfo||(a.PePCSInfo={}));(function(c){c.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=d})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(C,a,q){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var d=0;for(a=a.steps;d<
a.length;d++){var b=a[d];b instanceof q?this.steps.push(b):this.steps.push(new q({wkid:b.wkid,wkt:b.wkt,isInverse:b.isInverse}))}}}a.cacheKey=function(a,d){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==d.wkid&&null!==d.wkid?d.wkid.toString():"-1",void 0!==d.wkt&&null!==d.wkt?d.wkt.toString():""].join()};a.fromGE=function(e){var d=new a,b="",c=0;for(e=e.steps;c<e.length;c++){var k=q.fromGE(e[c]);d.steps.push(k);b+=k.uid.toString()+
","}d._cached_projection={};d._gtlistentry=null;d._chain=b;return d};a.prototype.getInverse=function(){var e=new a;e.steps=[];for(var d=this.steps.length-1;0<=d;d--)e.steps.push(this.steps[d].getInverse());return e};a.prototype.getGTListEntry=function(){for(var a="",d=0,b=this.steps;d<b.length;d++)a+=b[d].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(e,d,b){this._cached_projection[a.cacheKey(e,
d)]=b};a.prototype.getCachedGeTransformation=function(e,d){for(var b="",c=0,k=this.steps;c<k.length;c++)b+=k[c].uid.toString()+",";b!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=b);e=this._cached_projection[a.cacheKey(e,d)];return void 0===e?null:e};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(C,a){var q=0;return function(){function a(a){void 0===a&&(a=null);this.uid=q++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(e){var d=new a;d._wkt=e.wkt;d._wkid=e.wkid;d._isInverse=e.isInverse;return d};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=q++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var e=new a;e._wkt=this.wkt;e._wkid=this._wkid;e._isInverse=!this.isInverse;return e};return a}()})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array @dojo/framework/shim/Map @dojo/framework/shim/Set ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(C,a,q,l,e,d,b,c,k,r,A,w,E,y,H,G,D,h,n,u,p,t,F,z,Q,T,K,R){Object.defineProperty(a,"__esModule",{value:!0});var I=A.getLogger("esri.layers.graphics.data.QueryEngine");C=function(){return function(a,c,b,d,e){this.attributes=a;this.localId=c;this.geometry=b;this.centroid=d;this.filterFlags=e}}();a.Feature=C;var M=new c.default,m=new w.MemCacheStorage(2E6),B=0;C=function(){function a(a){var c=this;this.capabilities={query:t.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;
this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.gdbVersion=a.gdbVersion;this.historicMoment=a.historicMoment;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return c.clearCache()});this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new w.MemCache(B++ +"$$",m));this.fieldsIndex=
new K(a.fields);a.scheduler&&a.priority&&(this._frameQueue=new R.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.priority,function(a){return c._update(a)},function(){return 0<c._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=
null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:T.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?
this._timeExtent?this._timeExtent:this._timeExtent=Q.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,c){void 0===a&&(a={});return e(this,void 0,void 0,function(){var c,b,d;return l(this,function(e){switch(e.label){case 0:c=r.clone(a),e.label=1;case 1:return e.trys.push([1,13,,14]),[4,T.normalizeQuery(c,
this.definitionExpression,this.spatialReference)];case 2:return c=e.sent(),[4,this._reschedule()];case 3:return e.sent(),[4,this._checkQuerySupport(c)];case 4:return c=e.sent(),[4,this._reschedule()];case 5:return e.sent(),[4,this._executeGeometryQuery(c)];case 6:return b=e.sent(),[4,this._reschedule()];case 7:return e.sent(),[4,b.executeObjectIdsQuery(c)];case 8:return b=e.sent(),[4,this._reschedule()];case 9:return e.sent(),[4,b.executeTimeQuery(c)];case 10:return b=e.sent(),[4,this._reschedule()];
case 11:return e.sent(),[4,b.executeAttributesQuery(c)];case 12:return b=e.sent(),[3,14];case 13:d=e.sent();if(d!==T.QUERY_ENGINE_EMPTY_RESULT)throw d;b=new F.default([],null,this);return[3,14];case 14:return[2,b.createQueryResponse(c)]}})})};a.prototype.executeQueryForCount=function(a,c){void 0===a&&(a={});return e(this,void 0,void 0,function(){var c,b,d;return l(this,function(e){switch(e.label){case 0:c=r.clone(a),c.returnGeometry=!1,c.returnCentroid=!1,c.outSR=null,e.label=1;case 1:return e.trys.push([1,
13,,14]),[4,T.normalizeQuery(c,this.definitionExpression,this.spatialReference)];case 2:return c=e.sent(),[4,this._reschedule()];case 3:return e.sent(),[4,this._checkQuerySupport(c)];case 4:return c=e.sent(),[4,this._reschedule()];case 5:return e.sent(),[4,this._executeGeometryQuery(c)];case 6:return b=e.sent(),[4,this._reschedule()];case 7:return e.sent(),[4,b.executeObjectIdsQuery(c)];case 8:return b=e.sent(),[4,this._reschedule()];case 9:return e.sent(),[4,b.executeTimeQuery(c)];case 10:return b=
e.sent(),[4,this._reschedule()];case 11:return e.sent(),[4,b.executeAttributesQuery(c)];case 12:return b=e.sent(),[2,b.size];case 13:d=e.sent();if(d!==T.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 14:return[2]}})})};a.prototype.executeQueryForExtent=function(a,c){void 0===a&&(a={});return e(this,void 0,void 0,function(){var c,b,d,e,m,k,h,B;return l(this,function(n){switch(n.label){case 0:c=r.clone(a),d=c.outSR,n.label=1;case 1:return n.trys.push([1,13,,14]),[4,T.normalizeQuery(c,this.definitionExpression,
this.spatialReference)];case 2:return c=n.sent(),[4,this._reschedule()];case 3:return n.sent(),[4,this._checkQuerySupport(c)];case 4:return c=n.sent(),c.returnGeometry=!0,c.returnCentroid=!1,c.outSR=null,[4,this._reschedule()];case 5:return n.sent(),[4,this._executeGeometryQuery(c)];case 6:return b=n.sent(),[4,this._reschedule()];case 7:return n.sent(),[4,b.executeObjectIdsQuery(c)];case 8:return b=n.sent(),[4,this._reschedule()];case 9:return n.sent(),[4,b.executeTimeQuery(c)];case 10:return b=n.sent(),
[4,this._reschedule()];case 11:return n.sent(),[4,b.executeAttributesQuery(c)];case 12:b=n.sent();e=b.size;if(!e)return[2,{count:e,extent:null}];H.set(X,H.NEGATIVE_INFINITY);this.featureStore.forEachBounds(b.items,function(a){return H.expand(X,a)},ia);m={xmin:X[0],ymin:X[1],xmax:X[3],ymax:X[4],spatialReference:T.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(X[2])&&isFinite(X[5])&&(m.zmin=X[2],m.zmax=X[5]);k=p.project(m,b.spatialReference,d);k.spatialReference=T.cleanFromGeometryEngine(d||
this.spatialReference);0===k.xmax-k.xmin&&(h=y.getMetersPerUnitForSR(k.spatialReference),k.xmin-=h,k.xmax+=h);0===k.ymax-k.ymin&&(h=y.getMetersPerUnitForSR(k.spatialReference),k.ymin-=h,k.ymax+=h);this.hasZ&&null!=k.zmin&&null!=k.zmax&&0===k.zmax-k.zmin&&(h=y.getMetersPerUnitForSR(k.spatialReference),k.zmin-=h,k.zmax+=h);return[2,{count:e,extent:k}];case 13:B=n.sent();if(B===T.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw B;case 14:return[2]}})})};a.prototype.executeQueryForIds=
function(a,c){void 0===a&&(a={});return e(this,void 0,void 0,function(){return l(this,function(b){return[2,this.executeQueryForIdSet(a,c).then(function(a){return d.from(a)})]})})};a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return e(this,void 0,void 0,function(){var b,d,e,m,k,h,B,n;return l(this,function(l){switch(l.label){case 0:b=r.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,l.label=1;case 1:return l.trys.push([1,12,,13]),[4,T.normalizeQuery(b,this.definitionExpression,
this.spatialReference)];case 2:return b=l.sent(),[4,this._reschedule()];case 3:return l.sent(),[4,this._executeGeometryQuery(b)];case 4:return d=l.sent(),[4,this._reschedule()];case 5:return l.sent(),[4,d.executeObjectIdsQuery(b)];case 6:return d=l.sent(),[4,this._reschedule()];case 7:return l.sent(),[4,d.executeTimeQuery(b)];case 8:return d=l.sent(),[4,this._reschedule()];case 9:return l.sent(),[4,d.executeAttributesQuery(b)];case 10:return d=l.sent(),[4,this._reschedule()];case 11:l.sent();e=d.items;
m=new c.default;k=0;for(h=e;k<h.length;k++)B=h[k],m.add(d.featureAdapter.getObjectId(B));return[2,m];case 12:n=l.sent();if(n===T.QUERY_ENGINE_EMPTY_RESULT)return[2,new c.default];throw n;case 13:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,c){var b=this;if(this.timeInfo)return this.executeQuery(a,c).then(function(a){return b._filterLatest(a,b.timeInfo)});I.error(new k("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};a.prototype._reschedule=
function(a){return e(this,void 0,void 0,function(){return l(this,function(c){return this._frameQueue?[2,this._frameQueue.push(a).then(function(a){return a})]:[2,a]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._filterLatest=function(a,c){var d=c.trackIdField,e=c.startTimeField;c=c.endTimeField||e;for(var e=new b.default,m=[],k=0,h=a.features;k<h.length;k++){var B=h[k],r=B.attributes[d],
n=B.attributes[c];(!e.has(r)||e.get(r).attributes[c]<n)&&e.set(r,B)}e.forEach(function(a){return m.push(a)});return q({},a,{features:m})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(c){return a.push(c)});this._allItems=new F.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return e(this,void 0,void 0,function(){var b,d,m,k,h,B,r,p,M,t,w,K,ia,A,u,y,X,q,ha,R,I,E,D,sa,G=this;return l(this,function(Y){switch(Y.label){case 0:b=
a.geometry;d=a.outSR;m=a.spatialRel;k=n.isValid(d)&&!n.equals(this.spatialReference,d);if(h=this.cacheSpatialQueries?k?JSON.stringify({geometry:b,spatialRelationship:m,outSpatialReference:d}):JSON.stringify({geometry:b,spatialRelationship:m}):null)if(B=this._geometryQueryCache.get(h),void 0!==B)return[2,B];r=function(c){return e(G,void 0,void 0,function(){var b;return l(this,function(e){switch(e.label){case 0:return k&&(a.returnGeometry||a.returnCentroid)?[4,c.project(d)]:[3,2];case 1:return b=e.sent(),
h&&this._geometryQueryCache.put(h,b,b.size||1),[2,b];case 2:return h&&this._geometryQueryCache.put(h,c,c.size||1),[2,c]}})})};if(!b)return[2,r(this._getAll())];p=this.featureAdapter;if("esriSpatialRelDisjoint"!==m)return[3,5];M=this._searchFeatures(this._getQueryBBoxes(b));if(!M.length)return[2,r(this._getAll())];K=new c.default;ia=0;for(A=M;ia<A.length;ia++)u=A[ia],K.add(p.getObjectId(u));return[4,this._reschedule(K)];case 1:return K=Y.sent(),y=0,t=Array(K.size),this.featureStore.forEach(function(a){return t[y++]=
a}),w=K,[4,this._reschedule()];case 2:return Y.sent(),[4,z.getSpatialQueryOperator(m,b,this)];case 3:return X=Y.sent(),q=function(a){return!w.has(p.getObjectId(a))||X(p.getGeometry(a))},R=F.default.bind,[4,this._runSpatialFilter(t,q)];case 4:return ha=new (R.apply(F.default,[void 0,Y.sent(),b,this])),[2,r(ha)];case 5:return I=this._searchFeatures(this._getQueryBBoxes(b)),I.length?(E=this._canExecuteSoloPass(b,a))?[2,r(new F.default(I,b,this))]:[4,z.getSpatialQueryOperator(m,b,this)]:(ha=new F.default([],
b,this),h&&this._geometryQueryCache.put(h,ha,ha.size||1),[2,ha]);case 6:return D=Y.sent(),[4,this._runSpatialFilter(I,function(a){return D(p.getGeometry(a))})];case 7:return sa=Y.sent(),[2,r(new F.default(sa,b,this))]}})})};a.prototype._runSpatialFilter=function(a,c){return e(this,void 0,void 0,function(){var b,d,m,k=this;return l(this,function(h){if(!c)return[2,a];if(!this._budget)return[2,a.filter(function(a){return c(a)})];b=0;d=[];m=function(){return e(k,void 0,void 0,function(){var e;return l(this,
function(k){switch(k.label){case 0:if(!(b<a.length))return[3,3];e=a[b];c(e)&&d.push(e);return this._budget.done?[4,this._reschedule()]:[3,2];case 1:return k.sent(),[2,m()];case 2:return++b,[3,0];case 3:return[2]}})})};return[2,this._reschedule().then(function(){return m()}).then(function(){return d})]})})};a.prototype._canExecuteSoloPass=function(a,c){var b=this.geometryType;c=c.spatialRel;return z.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===c||"esriGeometryPoint"===b&&("esriSpatialRelIntersects"===
c||"esriSpatialRelContains"===c||"esriSpatialRelWithin"===c))};a.prototype._getQueryBBoxes=function(a){if(z.canQueryWithRBush(a)){if(h.isExtent(a))return[G.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(h.isPolygon(a))return a.rings.map(function(a){return G.fromValues(a[0][0],a[0][1],a[2][0],a[2][1])})}return[D.getBoundsXY(G.create(),a)]};a.prototype._searchFeatures=function(a){for(var c=0;c<a.length;c++)this.featureStore.forEachInBounds(a[c],function(a){M.add(a)});var b=Array(M.size),d=0;M.forEach(function(a){return b[d++]=
a});M.clear();return b};a.prototype._checkQuerySupport=function(a){return e(this,void 0,void 0,function(){return l(this,function(c){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new k("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,E.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),z.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),p.checkProjectionSupport(this.spatialReference,
a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var c=a.outFields,b=a.orderByFields,d=a.returnDistinctValues;b&&0<b.length&&(b=b.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),u.validateFields(this.fieldsIndex,b,"orderByFields contains missing fields"));if(c&&0<c.length)u.validateFields(this.fieldsIndex,c,"outFields contains missing fields");else if(d)throw new k("feature-store:unsupported-query",
"outFields should be specified for returnDistinctValues",{query:a});u.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return e(this,void 0,void 0,function(){var c,b,d,e,m,h,B,r,n,p,M,t;return l(this,function(l){c=a.outStatistics;b=a.groupByFieldsForStatistics;d=a.having;e=b&&b.length;m=c&&c.length;if(d){if(!e||!m)throw new k("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});u.validateHaving(this.fieldsIndex,
d,c)}if(m){if(h=c.some(function(a){return"exceedslimit"===a.statisticType}))return[2];B=c.map(function(a){return a.onStatisticField});u.validateFields(this.fieldsIndex,B,"onStatisticFields contains missing fields");e&&u.validateFields(this.fieldsIndex,b,"groupByFieldsForStatistics contains missing fields");r=0;for(n=c;r<n.length;r++){p=n[r];M=p.onStatisticField;t=p.statisticType;if("exceedslimit"===t)throw new k("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:p,
query:a});if((!e||"count"!==t)&&M&&u.hasInvalidFieldType(M,this.fieldsIndex))throw new k("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:p,query:a});}}return[2]})})};return a}();a.default=C;var ia=H.create(),X=H.create()})},"esri/core/MemCache":function(){define(["require","exports","./iteratorUtils","./PooledArray","./string"],function(C,a,q,l,e){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(a,c,d){this._namespace=a;this._storage=
c;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";d&&(this._storage.registerRemoveFunc(this._namespace,d),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,c,d,e){void 0===e&&(e=1);this._storage.put(this._namespace+a,c,d,e)};a.prototype.get=function(a){a=
this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=C;C=function(){function a(a){void 0===
a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new l}a.prototype.register=function(a){this._users.push(a)};a.prototype.deregister=function(a){this._users.removeUnordered(a)};a.prototype.registerRemoveFunc=function(a,c){this._removeFuncs.push([a,c])};a.prototype.deregisterRemoveFunc=function(a){this._removeFuncs=this._removeFuncs.filter(function(c){return c[0]!==a})};Object.defineProperty(a.prototype,"size",{get:function(){return this._size},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._size>this._maxSize&&this._removeEntries()},enumerable:!0,configurable:!0});a.prototype.put=function(a,c,d,e){if(this._db.has(a)){var b=this._db.get(a);this._size-=b.size;this._db.delete(a);this._notifyRemoved(a,b.entry)}d>this._maxSize?this._notifyRemoved(a,c):void 0===c?console.warn("Refusing to cache undefined entry "):!d||0>d?console.warn("Refusing to cache entry with invalid size "+
d):(this._db.set(a,{entry:c,size:d,lifetime:e,lives:e}),this._size+=d,this._size>this._maxSize&&this._removeEntries())};a.prototype.pop=function(a){if(this._db.has(a)){var c=this._db.get(a);this._size-=c.size;this._db.delete(a);++this._hit;return c.entry}++this._miss};a.prototype.get=function(a){var c=this._db.get(a);if(void 0===c)++this._miss;else return this._db.delete(a),c.lives=c.lifetime,this._db.set(a,c),++this._hit,c.entry};a.prototype.getStats=function(){var a=this,c={Size:Math.round(this._size/
1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},d={},r=[];this._db.forEach(function(c,b){var k=c.lifetime;r[k]=(r[k]||0)+1;a._users.forEach(function(a){a=a.namespace;if(e.startsWith(b,a))return d[a]=(d[a]||0)+c.size,!1})});var l={};this._users.forEach(function(a){var c=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(d[c]=d[c]||0,l[c]=Math.round(100*a.hitRate)+"%"):l[c]="0%"});var w=Object.keys(d);w.forEach(function(c){return d[c]=
d[c]/a._size*100});w.sort(function(a,c){return d[c]-d[a]});w.forEach(function(a){return c[a]=Math.round(d[a])+"% / "+l[a]});for(w=0;w<r.length;++w){var q=r[w];q&&(c["Lifetime "+w]=Math.round(q/this._db.size*100)+"%")}return c};a.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};a.prototype.clear=function(a){var c=this;this._db.forEach(function(b,d){e.startsWith(d,a)&&(c._size-=b.size,c._db.delete(d),c._notifyRemoved(d,b.entry))})};a.prototype.clearAll=
function(){var a=this;this._db.forEach(function(c,b){a._notifyRemoved(b,c.entry)});this._size=0;this._db.clear()};a.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};a.prototype._notifyRemoved=function(a,c){this._removeFuncs.forEach(function(b){if(e.startsWith(a,b[0]))b[1](c)})};a.prototype._removeEntries=function(){var a=this;q.everyMap(this._db,function(c,b){a._db.delete(b);1>=c.lives?(a._size-=c.size,a._notifyRemoved(b,c.entry)):(--c.lives,a._db.set(b,c));return a._size>
.9*a.maxSize})};return a}();a.MemCacheStorage=C})},"esri/core/iteratorUtils":function(){define(["require","exports"],function(C,a){Object.defineProperty(a,"__esModule",{value:!0});a.everyMap=Map.prototype.entries?function(a,l){a=a.entries();for(var e=a.next();!e.done;e=a.next())if(!1===l(e.value[1],e.value[0]))return!1;return!0}:function(a,l){var e=!0;a.forEach(function(a,b){e&&(e=!1!==l(a,b))});return e}})},"esri/core/PooledArray":function(){define(["require","exports","./tsSupport/generatorHelper",
"./arrayUtils","./HeapSort"],function(C,a,q,l,e){return function(){function a(a){var c=this;this.data=[];this._length=0;this._allocator=null;this._deallocator=function(){};this._shrink=function(){};this._hint=new l.RemoveHint;a&&(a.initialSize&&(this.data=Array(a.initialSize)),a.allocator?(this._allocator=a.allocator,this._deallocator=a.deallocator):"deallocator"in a&&(this._deallocator=a.deallocator),a.shrink&&(this._shrink=function(){c.data.length>1.5*c.length&&(c.data.length=Math.floor(1.1*c.length))}))}
a.prototype.toArray=function(){return this.data.slice(0,this.length)};Object.defineProperty(a.prototype,"length",{get:function(){return this._length},set:function(a){if(a>this._length)if(this._allocator)for(;this._length<a;)this.data[this._length++]=this._allocator(this.data[this._length]);else this._length=a;else{if(this._deallocator)for(var c=a;c<this._length;++c)this.data[c]=this._deallocator(this.data[c]);this._length=a;this._shrink()}},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.length=
0};a.prototype.prune=function(){this.clear();this.data=[]};a.prototype.equal=function(a){return l.equals(this.data,a.data)};a.prototype.push=function(a){return this.data[this._length++]=a};a.prototype.pushArray=function(a,c){void 0===c&&(c=a.length);for(var b=0;b<c;b++)this.data[this._length++]=a[b];return this.back()};a.prototype.pushNew=function(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));++this._length;return this.back()};a.prototype.pop=function(){if(0!==
this.length){var a=this.data[this.length-1];--this.length;this._shrink();return a}};a.prototype.removeMany=function(a){var c=this,b=[];this.data=this.data.filter(function(d,e){if(e>=c.length)return!1;if(0>a.indexOf(d))return!0;b.push(d);return!1});this._length=this.data.length;return b};a.prototype.iterableRemoveMany=function(a,c){var b,d;return q(this,function(e){switch(e.label){case 0:b=[],d=0,e.label=1;case 1:if(!(d<this.length)||d>=this.length)return[3,4];0>a.indexOf(this.data[d])&&b.push(this.data[d]);
return c()?[4]:[3,3];case 2:e.sent(),e.label=3;case 3:return++d,[3,1];case 4:return this.data=b,this._length=this.data.length,[2]}})};a.prototype.removeUnordered=function(a){a=l.removeUnordered(this.data,a,this.length,this._hint);void 0!==a&&--this.length;return a};a.prototype.removeUnorderedIndex=function(a){if(!(a>=this.length||0>a))return this.swapElements(a,this.length-1),this.pop()};a.prototype.removeUnorderedMany=function(a,c,d){void 0===c&&(c=a.length);this.length=l.removeUnorderedMany(this.data,
a,this.length,c,this._hint,d)};a.prototype.front=function(){if(0!==this.length)return this.data[0]};a.prototype.back=function(){if(0!==this.length)return this.data[this.length-1]};a.prototype.swapElements=function(a,c){var b;a>=this.length||c>=this.length||a===c||(b=[this.data[c],this.data[a]],this.data[a]=b[0],this.data[c]=b[1])};a.prototype.sort=function(a){e.sort(this.data,0,this.length,a)};a.prototype.iterableSort=function(a,c){return e.iterableSort(this.data,0,this.length,a,c)};a.prototype.some=
function(a,c){for(var b=0;b<this.length;++b)if(a.call(c,this.data[b],b,this.data))return!0;return!1};a.prototype.find=function(a,c){for(var b=0;b<this.length;++b){var d=this.data[b];if(a.call(c,d,b,this.data))return d}};a.prototype.filterInPlace=function(a,c){for(var b=0,d=0;d<this._length;++d){var e=this.data[d];a.call(c,e,d,this.data)&&(this.data[d]=this.data[b],this.data[b]=e,b++)}if(this._deallocator)for(d=b;d<this._length;d++)this.data[d]=this._deallocator(this.data[d]);this._length=b;return this};
a.prototype.forEach=function(a,c){for(var b=this.length,d=0;d<Math.min(this.length,b);++d)a.call(c,this.data[d],d,this.data)};a.prototype.iterableForEach=function(){var a;return q(this,function(c){switch(c.label){case 0:a=0,c.label=1;case 1:return a<this.length?[4,this.data[a]]:[3,4];case 2:c.sent(),c.label=3;case 3:return++a,[3,1];case 4:return[2]}})};a.prototype.map=function(a,c){for(var b=Array(this.length),d=0;d<this.length;++d)b[d]=a.call(c,this.data[d],d,this.data);return b};return a}()})},
"esri/core/HeapSort":function(){define(["require","exports","./tsSupport/generatorHelper"],function(C,a,q){var l;(function(a){function d(a,b,d,e){for(var c=b,k=d>>>1,l=a[c-1];b<=k;){b=c<<1;b<d&&0>e(a[b-1],a[b])&&++b;var r=a[b-1];if(0>=e(r,l))break;a[c-1]=r;c=b}a[c-1]=l}function b(a,b){return a<b?-1:a>b?1:0}a.sort=function(a,e,l,q){void 0===e&&(e=0);void 0===l&&(l=a.length);void 0===q&&(q=b);for(var c=l>>>1;c>e;c--)d(a,c,l,q);for(var k=e+1,c=l-1;c>e;c--)l=a[e],a[e]=a[c],a[c]=l,d(a,k,c,q)};a.iterableSort=
function(a,e,l,A,w){var c,k,r;return q(this,function(q){switch(q.label){case 0:void 0===e&&(e=0),void 0===l&&(l=a.length),void 0===A&&(A=b),c=l>>>1,q.label=1;case 1:if(!(c>e))return[3,4];d(a,c,l,A);return w&&w()?[4]:[3,3];case 2:q.sent(),q.label=3;case 3:return c--,[3,1];case 4:k=e+1,c=l-1,q.label=5;case 5:if(!(c>e))return[3,8];r=a[e];a[e]=a[c];a[c]=r;d(a,k,c,A);return w&&w()?[4]:[3,7];case 6:q.sent(),q.label=7;case 7:return c--,[3,5];case 8:return[2]}})}})(l||(l={}));return l})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/Set ../../../core/Error ../../../core/sql/WhereClauseCache".split(" "),
function(C,a,q,l,e,d){function b(a,c){return a?r.get(a,c):null}function c(a,d,l,r){void 0===r&&(r=!0);for(var w=[],q=0;q<d.length;q++){var h=d[q];if("*"!==h&&!a.has(h))if(r){var n=k(h);try{var u=b(n,a);if(!u)throw new e("feature-store:unsupported-query","invalid SQL expression",{where:n});if(!u.isStandardized)throw new e("feature-store:unsupported-query","expression is not standard",{clause:u});c(a,u.fieldNames,"expression contains missing fields")}catch(p){if((n=p&&p.details)&&(n.clause||n.where))throw p;
n&&n.missingFields?w.push.apply(w,n.missingFields):w.push(h)}}else w.push(h)}if(w.length)throw new e("feature-store:unsupported-query",l,{missingFields:w});}function k(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var r=new d.WhereClauseCache(50,500),A=new l.default("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var d=
r.get(b,a);if(!d)throw new e("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!d.isStandardized)throw new e("feature-store:unsupported-query","where clause is not standard",{where:b});c(a,d.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,d){if(!b)return!0;var k=r.get(b,a);if(!k)throw new e("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!k.isAggregate)throw new e("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});c(a,k.fieldNames,"having contains missing fields");if(!k.getExpressions().every(function(c){var b=c.aggregateType;c=c.field;var e=a.has(c)&&a.get(c).name;return d.some(function(c){var d=c.onStatisticField;c=c.statisticType;return(a.has(d)&&a.get(d).name)===e&&c.toLowerCase().trim()===b})}))throw new e("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=b;a.validateFields=c;a.getExpressionFromFieldName=k;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,c){return(a=c.get(a))?!A.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(C,a,q,l){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(a,b){this._cache=new q(a);this._invalidCache=new q(b)}a.prototype.get=function(a,b){var c=b.uid+":"+a,d=this._cache.get(c);if(d)return d;if(void 0!==this._invalidCache.get(c))return null;try{var e=
l.WhereClause.create(a,b);this._cache.put(c,e);return e}catch(A){return this._invalidCache.put(c,null),null}};return a}();a.WhereClauseCache=C})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(C,a,q){return function(){function a(a,d){this._storage=new q.MemCacheStorage;this._storage.maxSize=a;d&&this._storage.registerRemoveFunc("",d)}a.prototype.put=function(a,d){this._storage.put(a,d,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(C,a,q,l,e,d,b,c){function k(a,c){a+="";return a.length>=c?a:Array(c-a.length+1).join("0")+a}function r(a,c,b,d,e,h,l,n,r){void 0===
b&&(b="0");void 0===d&&(d="0");void 0===e&&(e="0");void 0===h&&(h="0");void 0===l&&(l="");void 0===n&&(n="0");void 0===r&&(r="0");return"+"===l||"-"===l?(a=k(parseInt(a,10),4)+"-"+k(parseInt(c,10),2)+"-"+k(parseInt(b,10),2),c="",10>parseFloat(h)&&(c="0"),d=k(parseInt(d,10),2)+":"+k(parseInt(e,10),2)+":"+(c+parseFloat(h).toString()),l=""+l+k(parseInt(n,10),2)+":"+k(parseInt(r,10),2),new Date(a+"T"+d+l)):new Date(parseInt(a,10),parseInt(c,10),parseInt(b,10),parseInt(d,10),parseInt(e,10),parseFloat(h))}
function A(a){var c=Q.exec(a);if(null!==c){a=c[1];var b=c[2],d=c[3],e=c[4],h=c[5],k=c[6];return r(a,b,d,e,h,k)}c=T.exec(a);if(null!==c){a=c[1];var b=c[2],d=c[3],e=c[4],h=c[5],k=c[6],l=c[7],n=c[8],c=c[9];return r(a,b,d,e,h,k,l,n,c)}c=K.exec(a);if(null!==c)return a=c[1],b=c[2],d=c[3],e=c[4],h=c[5],l=c[6],n=c[7],c=c[8],r(a,b,d,e,h,"0",l,n,c);c=R.exec(a);if(null!==c)return a=c[1],b=c[2],d=c[3],e=c[4],h=c[5],r(a,b,d,e,h);c=z.exec(a);if(null!==c)return a=c[1],b=c[2],d=c[3],r(a,b,d);throw Error("SQL Invalid Timestamp");
}function w(a){a=z.exec(a);if(null===a)throw Error("SQL Invalid Date");var c=a[2],b=a[3];return new Date(parseInt(a[1],10),parseInt(c,10)-1,parseInt(b,10))}function E(a){return Array.isArray(a)?a:[a]}function y(a){return null!==a?!0!==a:null}function H(a,c){return null!=a&&null!=c?!0===a&&!0===c:!1===a||!1===c?!1:null}function G(a,c){return null!=a&&null!=c?!0===a||!0===c:!0===a||!0===c?!0:null}function D(a,c){if(null==a)return null;for(var b=!1,d=0;d<c.length;d++){var e=c[d];if(null==e)b=null;else if(a===
e){b=!0;break}}return b}function h(a,c,b){if(null==a)return null;for(var d="",e=0,m=0;m<c.length;m++){var h=c.charAt(m);switch(e){case 0:h===b?e=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(h)?d+("\\"+h):"%"===h?d+".*":"_"===h?d+".":d+h;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(h)?d+("\\"+h):d+h,e=0}}return(new RegExp("^"+d+"$")).test(a)}function n(a){return a instanceof Date?a.valueOf():a}function u(a,c,b){if(null==c||null==b)return null;c=n(c);b=n(b);switch(a){case "\x3c\x3e":return c!==b;case "\x3d":return c===
b;case "\x3e":return c>b;case "\x3c":return c<b;case "\x3e\x3d":return c>=b;case "\x3c\x3d":return c<=b}}function p(a){for(var c=[],b={},d=0;d<a.length;d++){var e=a[d],h=e.toLowerCase();void 0===b[h]&&(c.push(e),b[h]=1)}return c}function t(a,c,d){if(c instanceof b.SqlInterval)if(d instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+d.getTime());case "-":return c.valueInMilliseconds()-d.getTime();case "*":return c.valueInMilliseconds()*d.getTime();case "/":return c.valueInMilliseconds()/
d.getTime()}else if(d instanceof b.SqlInterval)switch(a){case "+":return b.SqlInterval.createFromMilliseconds(c.valueInMilliseconds()+d.valueInMilliseconds());case "-":return b.SqlInterval.createFromMilliseconds(c.valueInMilliseconds()-d.valueInMilliseconds());case "*":return c.valueInMilliseconds()*d.valueInMilliseconds();case "/":return c.valueInMilliseconds()/d.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(d instanceof b.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(d.valueInMilliseconds()+
c.getTime());case "-":return new Date(c.getTime()-d.valueInMilliseconds());case "*":return c.getTime()*d.valueInMilliseconds();case "/":return c.getTime()/d.valueInMilliseconds()}else d=d.valueInMilliseconds();else if(c instanceof Date&&"number"===typeof d)switch(d*=864E5,c=c.getTime(),a){case "+":return new Date(c+d);case "-":return new Date(c-d);case "*":return new Date(c*d);case "/":return new Date(c/d)}else if(d instanceof Date&&"number"===typeof c)switch(c*=864E5,d=d.getTime(),a){case "+":return new Date(c+
d);case "-":return new Date(c-d);case "*":return new Date(c*d);case "/":return new Date(c/d)}switch(a){case "+":return c+d;case "-":return c-d;case "*":return c*d;case "/":return c/d}}function F(a,c,b,d){a=d.getAttribute(a,c);return null!=a&&1===b[c]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var z=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,Q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,T=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
K=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,R=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,I=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,c,b,d){return F(a,c,b,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,c,b){return h(a,c,b)};a.ensureArray=function(a){return E(a)};a.applyIn=function(a,c){return D(a,c)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,c,d){return b.SqlInterval.createFromValueAndQualifer(a,c,d)};a.convertInterval=function(a){return a instanceof b.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,c,b){return u(a,c,b)};a.calculate=function(a,c,b){return t(a,c,b)};a.makeComparable=function(a){return n(a)};a.evaluateFunction=function(a,c){return b.evaluateFunction(a,c)};a.lookup=function(a,c){a=c[a];return void 0===a?null:a};a.between=function(a,c){return null==a||
null==c[0]||null==c[1]?null:a>=c[0]&&a<=c[1]};a.notbetween=function(a,c){return null==a||null==c[0]||null==c[1]?null:a<c[0]||a>c[1]};a.ternaryNot=function(a){return y(a)};a.ternaryAnd=function(a,c){return H(a,c)};a.ternaryOr=function(a,c){return G(a,c)};return a}();C=function(){function k(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=c.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var d=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=d}k.create=function(a,c){return new k(a,c)};Object.defineProperty(k.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});k.prototype.testSet=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);for(var d={},e=function(a){d[a]=c.map(function(c){return b.getAttribute(c,a)})},m=0,h=this.fieldNames;m<h.length;m++)e(h[m]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};k.prototype.calculateValue=
function(c,d){void 0===d&&(d=a.defaultAttributeAdapter);c=this.evaluateNode(this.parseTree,c,d);return c instanceof b.SqlInterval?c.valueInMilliseconds()/864E5:c};k.prototype.calculateValueCompiled=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(c,this.parameters,b,this.datefields);if(e("csp-restrictions"))return this.calculateValue(c,b);this.compileMe();return this.parseTree._compiledVersion(c,this.parameters,
b,this.datefields)};k.prototype.testFeature=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,c,b)};k.prototype.testFeatureCompiled=function(c,b){void 0===b&&(b=a.defaultAttributeAdapter);if(void 0===this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(c,this.parameters,b,this.datefields);if(e("csp-restrictions"))return this.testFeature(c,b);this.compileMe();return!!this.parseTree._compiledVersion(c,this.parameters,b,this.datefields)};
k.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(c){"function"===c.type&&a.push(c.name.toLowerCase())});return p(a)};k.prototype.getExpressions=function(){var a=new l.default;this.visitAll(this.parseTree,function(c){if("function"===c.type){var b=c.name.toLowerCase();c=c.args.value[0];if("column_ref"===c.type){c=c.column;var d=b+"-"+c;a.has(d)||a.set(d,{aggregateType:b,field:c})}}});return q.from(a.values())};k.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(c){"param"===c.type&&a.push(c.value.toLowerCase())});return p(a)};k.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(I)};k.prototype.extractExpressionInfo=function(a){var c=this,e=[],m=!0,h=!0;this.visitAll(this.parseTree,function(k){switch(k.type){case "column_ref":var l=k.column.toUpperCase();if("CURRENT_DATE"!==
l&&"CURRENT_TIMESTAMP"!==l){var n=(l=a.get(k.column))&&l.name;!l||"date"!==l.type&&"esriFieldTypeDate"!==l.type||(c.datefields[l.name]=1);void 0!==n?(e.push(n),k.column=n):e.push(k.column)}break;case "function":l=k.name,k=k.args.value.length,m&&(m=b.isStandardized(l,k)),h&&(h=d.isAggregate(l,k))}});return{referencedFieldNames:p(e),isStandardized:m,isAggregate:h}};k.prototype.visitAll=function(a,c){if(null!=a)switch(c(a),a.type){case "when_clause":this.visitAll(a.operand,c);this.visitAll(a.value,c);
break;case "case_expression":for(var b=0,d=a.clauses;b<d.length;b++){var e=d[b];this.visitAll(e,c)}"simple"===a.format&&this.visitAll(a.operand,c);null!==a.else&&this.visitAll(a.else,c);break;case "expr_list":b=0;for(a=a.value;b<a.length;b++)e=a[b],this.visitAll(e,c);break;case "unary_expr":this.visitAll(a.expr,c);break;case "binary_expr":this.visitAll(a.left,c);this.visitAll(a.right,c);break;case "function":this.visitAll(a.args,c)}};k.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var c="";if("simple"===a.format)for(var b="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",c="( ",d=0;d<a.clauses.length;d++)c+=" ("+b+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";else for(c="( ",d=0;d<a.clauses.length;d++)c+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+
")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";c=null!==a.else?c+this.evaluateNodeToJavaScript(a.else):c+"null";return c+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":c="[";b=0;for(a=a.value;b<a.length;b++)d=a[b],"["!==c&&(c+=","),c+=this.evaluateNodeToJavaScript(d);return c+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+w(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+A(a.value).getTime().toString()+"))";case "column_ref":return"CURRENT_DATE"===
a.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===a.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};k.prototype.evaluateNode=function(a,c,e){switch(a.type){case "interval":return c=this.evaluateNode(a.value,c,e),b.SqlInterval.createFromValueAndQualifer(c,
a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var k=n(this.evaluateNode(a.operand,c,e)),l=0;l<a.clauses.length;l++){if(k===n(this.evaluateNode(a.clauses[l].operand,c,e)))return this.evaluateNode(a.clauses[l].value,c,e)}else for(l=0;l<a.clauses.length;l++)if(!0===this.evaluateNode(a.clauses[l].operand,c,e))return this.evaluateNode(a.clauses[l].value,c,e);return null!==a.else?this.evaluateNode(a.else,c,e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":k=
[];l=0;for(a=a.value;l<a.length;l++){var m=a[l];k.push(this.evaluateNode(m,c,e))}return k;case "unary_expr":return y(this.evaluateNode(a.expr,c,e));case "binary_expr":switch(a.operator){case "AND":return H(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "OR":return G(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,c,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,c,e);case "IN":return k=E(this.evaluateNode(a.right,c,e)),D(this.evaluateNode(a.left,c,e),k);case "NOT IN":return k=E(this.evaluateNode(a.right,c,e)),y(D(this.evaluateNode(a.left,c,e),k));case "BETWEEN":return k=this.evaluateNode(a.left,c,e),a=this.evaluateNode(a.right,c,e),null==k||null==a[0]||null==a[1]?null:k>=n(a[0])&&k<=n(a[1]);case "NOTBETWEEN":return k=this.evaluateNode(a.left,c,e),a=this.evaluateNode(a.right,c,e),null==k||null==a[0]||null==a[1]?null:
k<n(a[0])||k>n(a[1]);case "LIKE":return h(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e),a.escape);case "NOT LIKE":return y(h(this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return u(a.operator,this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e));case "-":case "+":case "*":case "/":return t(a.operator,this.evaluateNode(a.left,c,e),this.evaluateNode(a.right,c,e))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return w(a.value);case "timestamp":return A(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(m=new Date,m.setHours(0,0,0,0),m):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:F(c,a.column,this.datefields,e);case "function":return c=this.evaluateNode(a.args,c,e),this.isAggregate?d.aggregateFunction(a.name,c):b.evaluateFunction(a.name,c)}throw Error("Unsupported sql syntax "+a.type);
};return k}();a.WhereClause=C;a.defaultAttributeAdapter={getAttribute:function(a,c){return(a&&"object"===typeof a.attributes?a.attributes:a)[c]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(C,a){function q(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function l(a){for(var b=q(a),c=a.length,d=0,e=0;e<a.length;e++)d+=Math.pow(a[e]-b,2);return 1<c?d/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,b){var c=
e[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(b.length<c.minParams||b.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(b)};a.isAggregate=function(a,b){a=e[a.toLowerCase()];return null!=a&&b>=a.minParams&&b<=a.maxParams};var e={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,
a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:q(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(l(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:l(a[0])}}}})},
"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(C,a,q){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(d){var b=new a;b.second=d/1E3;return b};a.createFromValueAndQualifer=
function(d,b,c){var e=null,l=new a;l.op="-"===c?"-":"+";if("interval-period"===b.type){a.fixDefaults(b);if("year"===b.period||"month"===b.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(d))l[b.period]=parseFloat(d);else throw Error("Illegal Interval");}else{a.fixDefaults(b.start);a.fixDefaults(b.end);if("year"===b.start.period||"month"===b.start.period)throw Error("Year-Month Intervals not supported");if("year"===b.end.period||"month"===b.end.period)throw Error("Year-Month Intervals not supported");
switch(b.start.period){case "day":switch(b.end.period){case "hour":e=/^[0-9]{1,} [0-9]{1,}$/;if(e.test(d))l[b.start.period]=parseFloat(d.split(" ")[0]),l[b.end.period]=parseFloat(d.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":e=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(e.test(d))l[b.start.period]=parseFloat(d.split(" ")[0]),d=d.split(" ")[1].split(":"),l.hour=parseFloat(d[0]),l.minute=parseFloat(d[1]);else throw Error("Illegal Interval");break;case "second":e=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(e.test(d))l[b.start.period]=parseFloat(d.split(" ")[0]),d=d.split(" ")[1].split(":"),l.hour=parseFloat(d[0]),l.minute=parseFloat(d[1]),l.second=parseFloat(d[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(b.end.period){case "minute":e=/^[0-9]{1,}:[0-9]{1,}$/;if(e.test(d))l.hour=parseFloat(d.split(":")[0]),l.minute=parseFloat(d.split(":")[1]);else throw Error("Illegal Interval");break;case "second":e=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(e.test(d))d=d.split(":"),l.hour=parseFloat(d[0]),l.minute=parseFloat(d[1]),l.second=parseFloat(d[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(b.end.period){case "second":e=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(e.test(d))d=d.split(":"),l.minute=parseFloat(d[0]),l.second=parseFloat(d[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return l};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=C;a.evaluateFunction=function(a,d){var b=l[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(d.length<b.minParams||d.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(d)};a.isStandardized=function(a,d){a=l[a.toLowerCase()];return null!=a&&d>=a.minParams&&
d<=a.maxParams};var l={extract:{minParams:2,maxParams:2,evaluate:function(a){var d=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(d.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var d=
a[0],b=a[1];return null==d||null==b?null:d.toString().substring(b-1)}if(3===a.length)return d=a[0],b=a[1],a=a[2],null==d||null==b||null==a?null:0>=a?"":d.toString().substring(b-1,b+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var d=a[0];a=a[1];return null==d||null==a?null:a.indexOf(d)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var d=3===a.length,b=d?a[1]:" ",d=d?a[2]:a[1];if(null==b||null==d)return null;b="("+q.escapeString(b)+")";switch(a[0]){case "BOTH":return d.replace(new RegExp("^"+
b+"*|"+b+"*$","g"),"");case "LEADING":return d.replace(new RegExp("^"+b+"*","g"),"");case "TRAILING":return d.replace(new RegExp(b+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var d=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==d?null:Math.round(d*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var d="",b=0;b<
a.length;b++){if(null==a[b])return null;d+=a[b].toString()}return d}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(C,a){var q={};a.setObject("dojo.regexp",q);q.escapeString=function(a,e){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return e&&
-1!=e.indexOf(a)?a:"\\"+a})};q.buildGroupRE=function(a,e,d){if(!(a instanceof Array))return e(a);for(var b=[],c=0;c<a.length;c++)b.push(e(a[c]));return q.group(b.join("|"),d)};q.group=function(a,e){return"("+(e?"?:":"")+a+")"};return q})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(C,a,q){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(){}a.parse=function(a){return q.parse(a)};return a}();a.WhereGrammar=C})},"esri/core/sql/sql92grammar":function(){define([],
function(){function C(a,q,l,e){this.message=a;this.expected=q;this.found=l;this.location=e;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,C)}(function(a,q){function l(){this.constructor=a}l.prototype=q.prototype;a.prototype=new l})(C,Error);C.buildMessage=function(a,q){function l(a){return a.charCodeAt(0).toString(16).toUpperCase()}function e(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,
"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+l(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+l(a)})}function d(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+l(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+l(a)})}var b={literal:function(a){return'"'+e(a.text)+
'"'},"class":function(a){var c="",b;for(b=0;b<a.parts.length;b++)c+=a.parts[b]instanceof Array?d(a.parts[b][0])+"-"+d(a.parts[b][1]):d(a.parts[b]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var c=Array(a.length),d;for(d=0;d<a.length;d++){var e=d,l;l=a[d];l=b[l.type](l);c[e]=l}c.sort();if(0<c.length){for(a=d=1;d<c.length;d++)c[d-1]!==c[d]&&(c[a]=c[d],a++);c.length=
a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(a)+" but "+(q?'"'+e(q)+'"':"end of input")+" found."};return{SyntaxError:C,parse:function(a,q){function l(a,c){return{type:"literal",text:a,ignoreCase:c}}function e(a,c,f){return{type:"class",parts:a,inverted:c,ignoreCase:f}}function d(c){var f=Ha[c],b;if(!f){for(b=c-1;!Ha[b];)b--;f=Ha[b];for(f={line:f.line,column:f.column};b<c;)10===a.charCodeAt(b)?(f.line++,f.column=
1):f.column++,b++;Ha[c]=f}return f}function b(a,c){var f=d(a),b=d(c);return{start:{offset:a,line:f.line,column:f.column},end:{offset:c,line:b.line,column:b.column}}}function c(a){g<ma||(g>ma&&(ma=g,Sa=[]),Sa.push(a))}function k(){var a,c,b;a=g;c=x();c!==f?(c=A(),c!==f?(b=x(),b!==f?a=c:(g=a,a=f)):(g=a,a=f)):(g=a,a=f);return a}function r(){var a,c,b,d,e,h,k,l;a=g;c=A();if(c!==f){b=[];d=g;e=x();e!==f?(h=za(),h!==f?(k=x(),k!==f?(l=A(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);for(;d!==
f;)b.push(d),d=g,e=x(),e!==f?(h=za(),h!==f?(k=x(),k!==f?(l=A(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);if(b!==f){a={type:"expr_list"};c=[c];for(d=0;d<b.length;d++)c.push(b[d][3]);a.value=c}else g=a,a=f}else g=a,a=f;return a}function A(){var a,c,b,d,e,h,k,l;a=g;c=w();if(c!==f){b=[];d=g;e=x();e!==f?(h=ka(),h!==f?(k=x(),k!==f?(l=w(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);for(;d!==f;)b.push(d),d=g,e=x(),e!==f?(h=ka(),h!==f?(k=x(),k!==f?(l=w(),l!==f?d=e=[e,
h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);b!==f?a=c=Aa(c,b):(g=a,a=f)}else g=a,a=f;return a}function w(){var a,c,b,d,e,h,k,l;a=g;c=E();if(c!==f){b=[];d=g;e=x();e!==f?(h=ga(),h!==f?(k=x(),k!==f?(l=E(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);for(;d!==f;)b.push(d),d=g,e=x(),e!==f?(h=ga(),h!==f?(k=x(),k!==f?(l=E(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);b!==f?a=c=Aa(c,b):(g=a,a=f)}else g=a,a=f;return a}function E(){var b,d,e,h,k;b=g;d=L();d===f&&(d=
g,33===a.charCodeAt(g)?(e=$c,g++):(e=f,0===v&&c(ad)),e!==f?(h=g,v++,61===a.charCodeAt(g)?(k=fb,g++):(k=f,0===v&&c(gb)),v--,k===f?h=void 0:(g=h,h=f),h!==f?d=e=[e,h]:(g=d,d=f)):(g=d,d=f));d!==f?(e=x(),e!==f?(h=E(),h!==f?b=d={type:"unary_expr",operator:"NOT",expr:h}:(g=b,b=f)):(g=b,b=f)):(g=b,b=f);if(b===f)if(b=g,d=D(),d!==f)if(e=x(),e!==f){var l,m,n;e=[];h=g;k=x();k!==f?(l=y(),l!==f?(m=x(),m!==f?(n=D(),n!==f?h=k=[k,l,m,n]:(g=h,h=f)):(g=h,h=f)):(g=h,h=f)):(g=h,h=f);if(h!==f)for(;h!==f;)e.push(h),h=g,
k=x(),k!==f?(l=y(),l!==f?(m=x(),m!==f?(n=D(),n!==f?h=k=[k,l,m,n]:(g=h,h=f)):(g=h,h=f)):(g=h,h=f)):(g=h,h=f);else e=f;e!==f&&(e={type:"arithmetic",tail:e});e===f&&(e=g,h=G(),h!==f?(k=x(),k!==f?(k=da(),k!==f?(k=x(),k!==f?(k=r(),k!==f?(l=x(),l!==f?(l=ea(),l!==f?e=h={op:h,right:k}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,h=G(),h!==f?(k=x(),k!==f?(k=da(),k!==f?(k=x(),k!==f?(k=ea(),k!==f?e=h={op:h,right:{type:"expr_list",value:[]}}:(g=e,e=f)):(g=e,e=f)):(g=
e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,h=G(),h!==f?(k=x(),k!==f?(k=T(),k!==f?e=h={op:h,right:k}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f))),e===f&&(e=g,k=L(),k!==f?(h=x(),h!==f?(h=la(),h!==f?(l=x(),l!==f?(l=D(),l!==f?(m=x(),m!==f?(m=ga(),m!==f?(k=x(),k!==f?(k=D(),k!==f?e=k={op:"NOT"+h,right:{type:"expr_list",value:[l,k]}}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,k=la(),k!==f?(h=x(),h!==f?(h=D(),h!==f?(l=x(),l!==f?(l=ga(),l!==f?(m=x(),m!==
f?(m=D(),m!==f?e=k={op:k,right:{type:"expr_list",value:[h,m]}}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)),e===f&&(e=g,h=ja(),h!==f?(k=x(),k!==f?(k=L(),k!==f?(k=x(),k!==f?(k=D(),k!==f?e=h={op:h+"NOT",right:k}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,h=ja(),h!==f?(k=x(),k!==f?(k=D(),k!==f?e=h={op:h,right:k}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)),e===f&&(e=g,h=H(),h!==f?(k=x(),k!==f?(k=B(),k!==f?(l=x(),l!==f?(l=g,a.substr(g,6).toLowerCase()===bd?(m=
a.substr(g,6),g+=6):(m=f,0===v&&c(cd)),m!==f?(m=g,v++,n=z(),v--,n===f?m=void 0:(g=m,m=f),m!==f?l="ESCAPE":(g=l,l=f)):(g=l,l=f),l!==f?(l=x(),l!==f?(l=ia(),l!==f?e=h={op:h,right:k,escape:l.value}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,h=H(),h!==f?(k=x(),k!==f?(k=B(),k!==f?e=h={op:h,right:k,escape:""}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f))))));e===f&&(e=null);e!==f?(b=d,d=e,""==d||void 0==d||null==d?d=b:(e=null,d=e="arithmetic"==d.type?Aa(b,d.tail):hb(d.op,
b,d.right,d.escape)),b=d):(g=b,b=f)}else g=b,b=f;else g=b,b=f;return b}function y(){var b;a.substr(g,2)===ib?(b=ib,g+=2):(b=f,0===v&&c(dd));b===f&&(62===a.charCodeAt(g)?(b=ed,g++):(b=f,0===v&&c(fd)),b===f&&(a.substr(g,2)===jb?(b=jb,g+=2):(b=f,0===v&&c(gd)),b===f&&(a.substr(g,2)===kb?(b=kb,g+=2):(b=f,0===v&&c(hd)),b===f&&(60===a.charCodeAt(g)?(b=id,g++):(b=f,0===v&&c(jd)),b===f&&(61===a.charCodeAt(g)?(b=fb,g++):(b=f,0===v&&c(gb)),b===f&&(a.substr(g,2)===lb?(b=lb,g+=2):(b=f,0===v&&c(kd))))))));return b}
function H(){var a,c,b,d;a=a=g;c=L();c!==f?(b=x(),b!==f?(d=ca(),d!==f?a=c=[c,b,d]:(g=a,a=f)):(g=a,a=f)):(g=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=ca());return a}function G(){var a,c,b,d;a=a=g;c=L();c!==f?(b=x(),b!==f?(d=ta(),d!==f?a=c=[c,b,d]:(g=a,a=f)):(g=a,a=f)):(g=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=ta());return a}function D(){var a,c,b,d,e,k,l,m;a=g;c=n();if(c!==f){b=[];d=g;e=x();e!==f?(k=h(),k!==f?(l=x(),l!==f?(m=n(),m!==f?d=e=[e,k,l,m]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);for(;d!==
f;)b.push(d),d=g,e=x(),e!==f?(k=h(),k!==f?(l=x(),l!==f?(m=n(),m!==f?d=e=[e,k,l,m]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);b!==f?a=c=Aa(c,b):(g=a,a=f)}else g=a,a=f;return a}function h(){var b;43===a.charCodeAt(g)?(b=fc,g++):(b=f,0===v&&c(gc));b===f&&(45===a.charCodeAt(g)?(b=hc,g++):(b=f,0===v&&c(ic)));return b}function n(){var a,c,b,d,e,h,k,l;a=g;c=p();if(c!==f){b=[];d=g;e=x();e!==f?(h=u(),h!==f?(k=x(),k!==f?(l=p(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);for(;d!==f;)b.push(d),
d=g,e=x(),e!==f?(h=u(),h!==f?(k=x(),k!==f?(l=p(),l!==f?d=e=[e,h,k,l]:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);b!==f?a=c=Aa(c,b):(g=a,a=f)}else g=a,a=f;return a}function u(){var b;42===a.charCodeAt(g)?(b=ld,g++):(b=f,0===v&&c(md));b===f&&(47===a.charCodeAt(g)?(b=nd,g++):(b=f,0===v&&c(od)));return b}function p(){var b,d,e,h,k,l,m;m=ia();if(m===f){var n,p,q,w;n=g;var u,I,M,y;u=g;I=Y();I!==f?(M=Fa(),M!==f?(y=aa(),y!==f?u=I=parseFloat(I+M+y):(g=u,u=f)):(g=u,u=f)):(g=u,u=f);u===f&&(u=g,I=Y(),I!==f?(M=
Fa(),M!==f?u=I=parseFloat(I+M):(g=u,u=f)):(g=u,u=f),u===f&&(u=g,I=Y(),I!==f?(M=aa(),M!==f?u=I=parseFloat(I+M):(g=u,u=f)):(g=u,u=f),u===f&&(u=g,I=Y(),I!==f&&(I=parseFloat(I)),u=I)));p=u;p!==f?(q=g,v++,w=F(),v--,w===f?q=void 0:(g=q,q=f),q!==f?n=p={type:"number",value:p}:(g=n,n=f)):(g=n,n=f);m=n;if(m===f){var D,E;D=g;var C,G,H,Z;C=g;a.substr(g,4).toLowerCase()===pd?(G=a.substr(g,4),g+=4):(G=f,0===v&&c(qd));G!==f?(H=g,v++,Z=z(),v--,Z===f?H=void 0:(g=H,H=f),H!==f?C=G=[G,H]:(g=C,C=f)):(g=C,C=f);E=C;E!==
f&&(E={type:"bool",value:!0});D=E;if(D===f){D=g;var L,S,ja,ma;L=g;a.substr(g,5).toLowerCase()===rd?(S=a.substr(g,5),g+=5):(S=f,0===v&&c(sd));S!==f?(ja=g,v++,ma=z(),v--,ma===f?ja=void 0:(g=ja,ja=f),ja!==f?L=S=[S,ja]:(g=L,L=f)):(g=L,L=f);E=L;E!==f&&(E={type:"bool",value:!1});D=E}m=D;if(m===f){var ga,ca,ka,la,Aa;ca=g;a.substr(g,4).toLowerCase()===td?(ka=a.substr(g,4),g+=4):(ka=f,0===v&&c(ud));ka!==f?(la=g,v++,Aa=z(),v--,Aa===f?la=void 0:(g=la,la=f),la!==f?ca=ka=[ka,la]:(g=ca,ca=f)):(g=ca,ca=f);ga=ca;
ga!==f&&(ga={type:"null",value:null});m=ga;if(m===f){var wa,za,Ha,Da;wa=g;var Ia,ya,mb,Sa;Ia=g;a.substr(g,4).toLowerCase()===vd?(ya=a.substr(g,4),g+=4):(ya=f,0===v&&c(wd));ya!==f?(mb=g,v++,Sa=z(),v--,Sa===f?mb=void 0:(g=mb,mb=f),mb!==f?Ia=ya="DATE":(g=Ia,Ia=f)):(g=Ia,Ia=f);za=Ia;za!==f?(Ha=x(),Ha!==f?(Da=B(),Da!==f?wa=za={type:"date",value:Da.value}:(g=wa,wa=f)):(g=wa,wa=f)):(g=wa,wa=f);m=wa;if(m===f){var xa,jc,db,kc;xa=g;var Ja,Kb,nb,eb;Ja=g;a.substr(g,9).toLowerCase()===xd?(Kb=a.substr(g,9),g+=
9):(Kb=f,0===v&&c(yd));Kb!==f?(nb=g,v++,eb=z(),v--,eb===f?nb=void 0:(g=nb,nb=f),nb!==f?Ja=Kb="TIMESTAMP":(g=Ja,Ja=f)):(g=Ja,Ja=f);jc=Ja;jc!==f?(db=x(),db!==f?(kc=B(),kc!==f?xa=jc={type:"timestamp",value:kc.value}:(g=xa,xa=f)):(g=xa,xa=f)):(g=xa,xa=f);m=xa;if(m===f){var O,Ta,Lb,ua,Mb,Ua,fb,lc;O=g;Ta=Qa();Ta!==f?(Lb=x(),Lb!==f?(45===a.charCodeAt(g)?(ua=hc,g++):(ua=f,0===v&&c(ic)),ua===f&&(43===a.charCodeAt(g)?(ua=fc,g++):(ua=f,0===v&&c(gc))),ua!==f?(Mb=x(),Mb!==f?(Ua=B(),Ua!==f?(fb=x(),fb!==f?(lc=R(),
lc!==f?O=Ta={type:"interval",value:Ua,qualifier:lc,op:ua}:(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f);O===f&&(O=g,Ta=Qa(),Ta!==f?(Lb=x(),Lb!==f?(ua=B(),ua!==f?(Mb=x(),Mb!==f?(Ua=R(),Ua!==f?O=Ta={type:"interval",value:ua,qualifier:Ua,op:""}:(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f));m=O}}}}}}b=m;if(b===f){var V,mc,gb,hb,ib,nc,jb,kb,lb,oc,xb,yb;V=g;var Ka,Nb,ob,zb;Ka=g;a.substr(g,7).toLowerCase()===zd?(Nb=a.substr(g,7),g+=7):(Nb=f,0===v&&c(Ad));Nb!==f?(ob=
g,v++,zb=z(),v--,zb===f?ob=void 0:(g=ob,ob=f),ob!==f?Ka=Nb="EXTRACT":(g=Ka,Ka=f)):(g=Ka,Ka=f);mc=Ka;if(mc!==f)if(gb=x(),gb!==f)if(hb=da(),hb!==f)if(ib=x(),ib!==f){var na;na=bb();na===f&&(na=Ra(),na===f&&(na=cb(),na===f&&(na=yc(),na===f&&(na=zc(),na===f&&(na=Ga())))));nc=na;nc!==f?(jb=x(),jb!==f?(kb=Ea(),kb!==f?(lb=x(),lb!==f?(oc=A(),oc!==f?(xb=x(),xb!==f?(yb=ea(),yb!==f?V=mc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:nc},oc]}}:(g=V,V=f)):(g=V,V=f)):(g=V,V=f)):
(g=V,V=f)):(g=V,V=f)):(g=V,V=f)):(g=V,V=f)}else g=V,V=f;else g=V,V=f;else g=V,V=f;else g=V,V=f;b=V;if(b===f){var U,pc,Ab,Bb,Cb,Ob,Db,Eb,Fb,Pb,Gb,fa,Va,qc,rc,sc;U=g;var La,Qb,pb,Hb;La=g;a.substr(g,9).toLowerCase()===Bd?(Qb=a.substr(g,9),g+=9):(Qb=f,0===v&&c(Cd));Qb!==f?(pb=g,v++,Hb=z(),v--,Hb===f?pb=void 0:(g=pb,pb=f),pb!==f?La=Qb="SUBSTRING":(g=La,La=f)):(g=La,La=f);pc=La;if(pc!==f)if(Ab=x(),Ab!==f)if(Bb=da(),Bb!==f)if(Cb=x(),Cb!==f)if(Ob=A(),Ob!==f)if(Db=x(),Db!==f)if(Eb=Ea(),Eb!==f)if(Fb=x(),Fb!==
f)if(Pb=A(),Pb!==f)if(Gb=x(),Gb!==f){fa=g;var Ma,Rb,qb,Ac;Ma=g;a.substr(g,3).toLowerCase()===Dd?(Rb=a.substr(g,3),g+=3):(Rb=f,0===v&&c(Ed));Rb!==f?(qb=g,v++,Ac=z(),v--,Ac===f?qb=void 0:(g=qb,qb=f),qb!==f?Ma=Rb="FOR":(g=Ma,Ma=f)):(g=Ma,Ma=f);Va=Ma;Va!==f?(qc=x(),qc!==f?(rc=A(),rc!==f?(sc=x(),sc!==f?fa=Va=[Va,qc,rc,sc]:(g=fa,fa=f)):(g=fa,fa=f)):(g=fa,fa=f)):(g=fa,fa=f);fa===f&&(fa=null);fa!==f?(Va=ea(),Va!==f?U=pc={type:"function",name:"substring",args:{type:"expr_list",value:fa?[Ob,Pb,fa[2]]:[Ob,Pb]}}:
(g=U,U=f)):(g=U,U=f)}else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;else g=U,U=f;b=U;if(b===f){var J,Wa,Sb,Tb,Ub,oa,Vb,Xa,Wb,Xb,Bc,tc,Cc,Dc;J=g;Wa=Pa();Wa!==f?(Sb=x(),Sb!==f?(Tb=da(),Tb!==f?(Ub=x(),Ub!==f?(oa=K(),oa===f&&(oa=null),oa!==f?(Vb=x(),Vb!==f?(Xa=A(),Xa!==f?(Wb=x(),Wb!==f?(Xb=Ea(),Xb!==f?(Bc=x(),Bc!==f?(tc=A(),tc!==f?(Cc=x(),Cc!==f?(Dc=ea(),Dc!==f?J=Wa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==oa?"BOTH":oa},Xa,tc]}}:(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f);J===f&&(J=g,Wa=Pa(),Wa!==f?(Sb=x(),Sb!==f?(Tb=da(),Tb!==f?(Ub=x(),Ub!==f?(oa=K(),oa===f&&(oa=null),oa!==f?(Vb=x(),Vb!==f?(Xa=A(),Xa!==f?(Wb=x(),Wb!==f?(Xb=ea(),Xb!==f?J=Wa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==oa?"BOTH":oa},Xa]}}:(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=
J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f)):(g=J,J=f));b=J;if(b===f){var W,uc,Ec,Fc,Gc,vc,Hc,Ic,Jc,wc,Kc,Lc;W=g;var Na,Yb,rb,Mc;Na=g;a.substr(g,8).toLowerCase()===Fd?(Yb=a.substr(g,8),g+=8):(Yb=f,0===v&&c(Gd));Yb!==f?(rb=g,v++,Mc=z(),v--,Mc===f?rb=void 0:(g=rb,rb=f),rb!==f?Na=Yb="POSITION":(g=Na,Na=f)):(g=Na,Na=f);uc=Na;uc!==f?(Ec=x(),Ec!==f?(Fc=da(),Fc!==f?(Gc=x(),Gc!==f?(vc=A(),vc!==f?(Hc=x(),Hc!==f?(Ic=ta(),Ic!==f?(Jc=x(),Jc!==f?(wc=A(),wc!==f?(Kc=x(),Kc!==f?(Lc=ea(),Lc!==f?W=uc={type:"function",
name:"position",args:{type:"expr_list",value:[vc,wc]}}:(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f)):(g=W,W=f);b=W;if(b===f){var ba,Zb,Nc,Oc,Pc,Ya,Qc,Rc;ba=g;var pa,sb,tb,va;pa=g;pa=sb=t();if(pa===f)if(pa=g,96===a.charCodeAt(g)?(sb=Sc,g++):(sb=f,0===v&&c(Tc)),sb!==f){tb=[];Uc.test(a.charAt(g))?(va=a.charAt(g),g++):(va=f,0===v&&c(Vc));if(va!==f)for(;va!==f;)tb.push(va),Uc.test(a.charAt(g))?(va=a.charAt(g),g++):(va=f,0===v&&c(Vc));else tb=
f;tb!==f?(96===a.charCodeAt(g)?(va=Sc,g++):(va=f,0===v&&c(Tc)),va!==f?pa=sb=tb.join(""):(g=pa,pa=f)):(g=pa,pa=f)}else g=pa,pa=f;Zb=pa;Zb!==f?(Nc=x(),Nc!==f?(Oc=da(),Oc!==f?(Pc=x(),Pc!==f?(Ya=r(),Ya===f&&(Ya=null),Ya!==f?(Qc=x(),Qc!==f?(Rc=ea(),Rc!==f?ba=Zb={type:"function",name:Zb,args:Ya?Ya:{type:"expr_list",value:[]}}:(g=ba,ba=f)):(g=ba,ba=f)):(g=ba,ba=f)):(g=ba,ba=f)):(g=ba,ba=f)):(g=ba,ba=f)):(g=ba,ba=f);b=ba;if(b===f){var $b,N,Za,ac,$a,bc,Ba,qa,ub,Wc,Xc;N=g;Za=Ib();if(Za!==f)if(ac=x(),ac!==f)if($a=
A(),$a!==f)if(bc=x(),bc!==f){Ba=[];for(qa=sa();qa!==f;)Ba.push(qa),qa=sa();Ba!==f?(qa=x(),qa!==f?(ub=Jb(),ub!==f?N=Za={type:"case_expression",format:"simple",operand:$a,clauses:Ba,else:null}:(g=N,N=f)):(g=N,N=f)):(g=N,N=f)}else g=N,N=f;else g=N,N=f;else g=N,N=f;else g=N,N=f;if(N===f)if(N=g,Za=Ib(),Za!==f)if(ac=x(),ac!==f)if($a=A(),$a!==f)if(bc=x(),bc!==f){Ba=[];for(qa=sa();qa!==f;)Ba.push(qa),qa=sa();Ba!==f?(qa=x(),qa!==f?(ub=ha(),ub!==f?(Wc=x(),Wc!==f?(Xc=Jb(),Xc!==f?N=Za={type:"case_expression",
format:"simple",operand:$a,clauses:Ba,else:ub.value}:(g=N,N=f)):(g=N,N=f)):(g=N,N=f)):(g=N,N=f)):(g=N,N=f)}else g=N,N=f;else g=N,N=f;else g=N,N=f;else g=N,N=f;$b=N;if($b===f){var P,ab,cc,Ca,ra,vb,Yc,Zc;P=g;ab=Ib();if(ab!==f)if(cc=x(),cc!==f){Ca=[];for(ra=X();ra!==f;)Ca.push(ra),ra=X();Ca!==f?(ra=x(),ra!==f?(vb=Jb(),vb!==f?P=ab={type:"case_expression",format:"searched",clauses:Ca,else:null}:(g=P,P=f)):(g=P,P=f)):(g=P,P=f)}else g=P,P=f;else g=P,P=f;if(P===f)if(P=g,ab=Ib(),ab!==f)if(cc=x(),cc!==f){Ca=
[];for(ra=X();ra!==f;)Ca.push(ra),ra=X();Ca!==f?(ra=x(),ra!==f?(vb=ha(),vb!==f?(Yc=x(),Yc!==f?(Zc=Jb(),Zc!==f?P=ab={type:"case_expression",format:"searched",clauses:Ca,else:vb.value}:(g=P,P=f)):(g=P,P=f)):(g=P,P=f)):(g=P,P=f)):(g=P,P=f)}else g=P,P=f;else g=P,P=f;$b=P}b=$b;if(b===f){var wb,Oa,xc,dc,ec;Oa=g;xc=F();if(xc!==f){dc=[];for(ec=Q();ec!==f;)dc.push(ec),ec=Q();dc!==f?Oa=xc+=dc.join(""):(g=Oa,Oa=f)}else g=Oa,Oa=f;wb=Oa;wb!==f&&(wb={type:"column_ref",table:"",column:wb});b=wb;b===f&&(b=T(),b===
f&&(b=g,d=da(),d!==f?(e=x(),e!==f?(h=A(),h!==f?(k=x(),k!==f?(l=ea(),l!==f?(h.paren=!0,b=d=h):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)))}}}}}}}return b}function t(){var a,c,b,d;a=g;c=F();if(c!==f){b=[];for(d=z();d!==f;)b.push(d),d=z();b!==f?a=c+=b.join(""):(g=a,a=f)}else g=a,a=f;return a}function F(){var b;Hd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===v&&c(Id));return b}function z(){var b;Jd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===v&&c(Kd));return b}function Q(){var b;Ld.test(a.charAt(g))?
(b=a.charAt(g),g++):(b=f,0===v&&c(Md));return b}function T(){var b,d,e;b=g;64===a.charCodeAt(g)?(d=Nd,g++):(d=f,0===v&&c(Od));d!==f?(e=t(),e!==f?b=d=[d,e]:(g=b,b=f)):(g=b,b=f);b!==f&&(b={type:"param",value:b[1]});return b}function K(){var b,d,e;b=g;a.substr(g,7).toLowerCase()===Pd?(d=a.substr(g,7),g+=7):(d=f,0===v&&c(Qd));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="LEADING":(g=b,b=f)):(g=b,b=f);b===f&&(b=g,a.substr(g,8).toLowerCase()===Rd?(d=a.substr(g,8),g+=8):(d=f,0===v&&c(Sd)),d!==
f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="TRAILING":(g=b,b=f)):(g=b,b=f),b===f&&(b=g,a.substr(g,4).toLowerCase()===Td?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(Ud)),d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="BOTH":(g=b,b=f)):(g=b,b=f)));return b}function R(){var b,d,e;b=g;var h,k;d=g;e=I();e!==f?(h=x(),h!==f?(h=da(),h!==f?(h=x(),h!==f?(h=m(),h!==f?(k=x(),k!==f?(k=ea(),k!==f?d=e={type:"interval-period",period:e.value,precision:h,secondary:null}:(g=d,d=f)):(g=d,d=f)):(g=d,d=
f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f);d===f&&(d=g,e=I(),e!==f&&(e=xb(e)),d=e);if(d!==f)if(e=x(),e!==f)if(e=g,a.substr(g,2).toLowerCase()===Vd?(h=a.substr(g,2),g+=2):(h=f,0===v&&c(Wd)),h!==f?(h=g,v++,k=z(),v--,k===f?h=void 0:(g=h,h=f),h!==f?e="TO":(g=e,e=f)):(g=e,e=f),e!==f)if(e=x(),e!==f){var l;e=g;h=I();h!==f&&(h={type:"interval-period",period:h.value,precision:null,secondary:null});e=h;e===f&&(e=g,h=Ga(),h!==f?(h=x(),h!==f?(h=da(),h!==f?(h=x(),h!==f?(h=m(),h!==f?(k=x(),k!==f?(k=za(),k!==
f?(k=x(),k!==f?(k=M(),k!==f?(l=x(),l!==f?(l=ea(),l!==f?e=h=yb(h,k):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,h=Ga(),h!==f?(h=x(),h!==f?(h=da(),h!==f?(h=x(),h!==f?(h=m(),h!==f?(k=x(),k!==f?(k=ea(),k!==f?e=h={type:"interval-period",period:"second",precision:h,secondary:null}:(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f)):(g=e,e=f),e===f&&(e=g,h=Ga(),h!==f&&(h={type:"interval-period",period:"second",
precision:null,secondary:null}),e=h)));e!==f?b=d={type:"interval-qualifier",start:d,end:e}:(g=b,b=f)}else g=b,b=f;else g=b,b=f;else g=b,b=f;else g=b,b=f;b===f&&(b=g,e=I(),e!==f?(d=x(),d!==f?(d=da(),d!==f?(d=x(),d!==f?(d=M(),d!==f?(h=x(),h!==f?(h=ea(),h!==f?b=e={type:"interval-period",period:e.value,precision:d,secondary:null}:(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f),b===f&&(b=g,e=I(),e!==f&&(e=xb(e)),b=e,b===f&&(b=g,e=Ga(),e!==f?(d=x(),d!==f?(d=da(),d!==f?(d=x(),
d!==f?(d=m(),d!==f?(h=x(),h!==f?(h=za(),h!==f?(e=x(),e!==f?(e=M(),e!==f?(h=x(),h!==f?(h=ea(),h!==f?b=e=yb(d,e):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f),b===f&&(b=g,e=Ga(),e!==f?(d=x(),d!==f?(d=da(),d!==f?(d=x(),d!==f?(d=M(),d!==f?(h=x(),h!==f?(h=ea(),h!==f?b=e={type:"interval-period",period:"second",precision:d,secondary:null}:(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f),b===f&&(b=g,e=Ga(),
e!==f&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),b=e)))));return b}function I(){var a;a=g;a=cb();a!==f&&(a={type:"string",value:"day"});a===f&&(a=g,a=yc(),a!==f&&(a={type:"string",value:"hour"}),a===f&&(a=g,a=zc(),a!==f&&(a={type:"string",value:"minute"}),a===f&&(a=g,a=Ra(),a!==f&&(a={type:"string",value:"month"}),a===f&&(a=g,a=bb(),a!==f&&(a={type:"string",value:"year"})))));return a}function M(){var a;a=Z();a!==f&&(a=parseFloat(a));return a}function m(){var a;a=
Z();a!==f&&(a=parseFloat(a));return a}function B(){var a;a=ia();a===f&&(a=T());return a}function ia(){var b,d,e;b=g;39===a.charCodeAt(g)?(d=zb,g++):(d=f,0===v&&c(Ab));d===f&&(a.substr(g,2)===Bb?(d=Bb,g+=2):(d=f,0===v&&c(Xd)));if(d!==f){d=[];e=g;a.substr(g,2)===Da?(e=Da,g+=2):(e=f,0===v&&c(Cb));e!==f&&(e="'");e===f&&(Db.test(a.charAt(g))?(e=a.charAt(g),g++):(e=f,0===v&&c(Eb)));for(;e!==f;)d.push(e),e=g,a.substr(g,2)===Da?(e=Da,g+=2):(e=f,0===v&&c(Cb)),e!==f&&(e="'"),e===f&&(Db.test(a.charAt(g))?(e=
a.charAt(g),g++):(e=f,0===v&&c(Eb)));d!==f?(39===a.charCodeAt(g)?(e=zb,g++):(e=f,0===v&&c(Ab)),e!==f?b=d={type:"string",value:d.join("")}:(g=b,b=f)):(g=b,b=f)}else g=b,b=f;return b}function X(){var a,c,b;a=g;c=db();c!==f?(c=x(),c!==f?(c=A(),c!==f?(b=x(),b!==f?(b=eb(),b!==f?(b=x(),b!==f?(b=A(),b!==f?a=c={type:"when_clause",operand:c,value:b}:(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f);return a}function sa(){var a,c,b;a=g;c=db();c!==f?(c=x(),c!==f?(c=A(),c!==f?(b=x(),
b!==f?(b=eb(),b!==f?(b=x(),b!==f?(b=A(),b!==f?a=c={type:"when_clause",operand:c,value:b}:(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f);return a}function ha(){var b,d;b=g;var e,h;d=g;a.substr(g,4).toLowerCase()===Yd?(e=a.substr(g,4),g+=4):(e=f,0===v&&c(Zd));e!==f?(e=g,v++,h=z(),v--,h===f?e=void 0:(g=e,e=f),e!==f?d="ELSE":(g=d,d=f)):(g=d,d=f);d!==f?(d=x(),d!==f?(d=A(),d!==f?b={type:"else_clause",value:d}:(g=b,b=f)):(g=b,b=f)):(g=b,b=f);return b}function Y(){var b,d,e;b=
Z();b===f&&(b=g,45===a.charCodeAt(g)?(d=hc,g++):(d=f,0===v&&c(ic)),d===f&&(43===a.charCodeAt(g)?(d=fc,g++):(d=f,0===v&&c(gc))),d!==f?(e=Z(),e!==f?b=d=d[0]+e:(g=b,b=f)):(g=b,b=f));return b}function Fa(){var b,d;b=g;46===a.charCodeAt(g)?(d=$d,g++):(d=f,0===v&&c(ae));d!==f?(d=Z(),d===f&&(d=null),d!==f?b="."+(null!=d?d:""):(g=b,b=f)):(g=b,b=f);return b}function aa(){var b,d,e;d=b=g;be.test(a.charAt(g))?(e=a.charAt(g),g++):(e=f,0===v&&c(ce));e!==f?(de.test(a.charAt(g))?(e=a.charAt(g),g++):(e=f,0===v&&
c(ee)),e===f&&(e=null),e!==f?d="e"+(null===e?"":e):(g=d,d=f)):(g=d,d=f);d!==f?(e=Z(),e!==f?b=d+e:(g=b,b=f)):(g=b,b=f);return b}function Z(){var a,c;a=[];c=S();if(c!==f)for(;c!==f;)a.push(c),c=S();else a=f;a!==f&&(a=a.join(""));return a}function S(){var b;fe.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===v&&c(ge));return b}function ta(){var b,d,e;b=g;a.substr(g,2).toLowerCase()===he?(d=a.substr(g,2),g+=2):(d=f,0===v&&c(ie));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="IN":(g=b,b=f)):
(g=b,b=f);return b}function ja(){var b,d,e;b=g;a.substr(g,2).toLowerCase()===je?(d=a.substr(g,2),g+=2):(d=f,0===v&&c(ke));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="IS":(g=b,b=f)):(g=b,b=f);return b}function ca(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===le?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(me));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="LIKE":(g=b,b=f)):(g=b,b=f);return b}function L(){var b,d,e;b=g;a.substr(g,3).toLowerCase()===ne?(d=a.substr(g,3),g+=3):(d=f,
0===v&&c(oe));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="NOT":(g=b,b=f)):(g=b,b=f);return b}function ga(){var b,d,e;b=g;a.substr(g,3).toLowerCase()===pe?(d=a.substr(g,3),g+=3):(d=f,0===v&&c(qe));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="AND":(g=b,b=f)):(g=b,b=f);return b}function ka(){var b,d,e;b=g;a.substr(g,2).toLowerCase()===re?(d=a.substr(g,2),g+=2):(d=f,0===v&&c(se));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="OR":(g=b,b=f)):(g=b,b=f);return b}
function la(){var b,d,e;b=g;a.substr(g,7).toLowerCase()===te?(d=a.substr(g,7),g+=7):(d=f,0===v&&c(ue));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="BETWEEN":(g=b,b=f)):(g=b,b=f);return b}function Ea(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===ve?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(we));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="FROM":(g=b,b=f)):(g=b,b=f);return b}function Pa(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===xe?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(ye));
d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="TRIM":(g=b,b=f)):(g=b,b=f);return b}function Qa(){var b,d,e;b=g;a.substr(g,8).toLowerCase()===ze?(d=a.substr(g,8),g+=8):(d=f,0===v&&c(Ae));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="INTERVAL":(g=b,b=f)):(g=b,b=f);return b}function bb(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===Be?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(Ce));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="YEAR":(g=b,b=f)):(g=b,b=f);return b}function Ra(){var b,
d,e;b=g;a.substr(g,5).toLowerCase()===De?(d=a.substr(g,5),g+=5):(d=f,0===v&&c(Ee));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="MONTH":(g=b,b=f)):(g=b,b=f);return b}function cb(){var b,d,e;b=g;a.substr(g,3).toLowerCase()===Fe?(d=a.substr(g,3),g+=3):(d=f,0===v&&c(Ge));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="DAY":(g=b,b=f)):(g=b,b=f);return b}function yc(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===He?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(Ie));d!==f?(d=g,v++,e=z(),v--,
e===f?d=void 0:(g=d,d=f),d!==f?b="HOUR":(g=b,b=f)):(g=b,b=f);return b}function zc(){var b,d,e;b=g;a.substr(g,6).toLowerCase()===Je?(d=a.substr(g,6),g+=6):(d=f,0===v&&c(Ke));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="MINUTE":(g=b,b=f)):(g=b,b=f);return b}function Ga(){var b,d,e;b=g;a.substr(g,6).toLowerCase()===Le?(d=a.substr(g,6),g+=6):(d=f,0===v&&c(Me));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="SECOND":(g=b,b=f)):(g=b,b=f);return b}function Ib(){var b,d,e;b=g;a.substr(g,
4).toLowerCase()===Ne?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(Oe));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="CASE":(g=b,b=f)):(g=b,b=f);return b}function Jb(){var b,d,e;b=g;a.substr(g,3).toLowerCase()===Pe?(d=a.substr(g,3),g+=3):(d=f,0===v&&c(Qe));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="END":(g=b,b=f)):(g=b,b=f);return b}function db(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===Re?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(Se));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=
d,d=f),d!==f?b="WHEN":(g=b,b=f)):(g=b,b=f);return b}function eb(){var b,d,e;b=g;a.substr(g,4).toLowerCase()===Te?(d=a.substr(g,4),g+=4):(d=f,0===v&&c(Ue));d!==f?(d=g,v++,e=z(),v--,e===f?d=void 0:(g=d,d=f),d!==f?b="THEN":(g=b,b=f)):(g=b,b=f);return b}function za(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=f,0===v&&c(We));return b}function da(){var b;40===a.charCodeAt(g)?(b=Xe,g++):(b=f,0===v&&c(Ye));return b}function ea(){var b;41===a.charCodeAt(g)?(b=Ze,g++):(b=f,0===v&&c($e));return b}function x(){var a,
b;a=[];for(b=Fb();b!==f;)a.push(b),b=Fb();return a}function Fb(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===v&&c(bf));return b}function hb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function Aa(a,b){for(var c=0;c<b.length;c++)a=hb(b[c][1],a,b[c][3]);return a}q=void 0!==q?q:{};var f={},Gb={start:k},Hb=k,$c="!",ad=l("!",!1),fb="\x3d",gb=l("\x3d",!1),ib="\x3e\x3d",dd=l("\x3e\x3d",!1),ed="\x3e",fd=l("\x3e",!1),jb="\x3c\x3d",gd=l("\x3c\x3d",
!1),kb="\x3c\x3e",hd=l("\x3c\x3e",!1),id="\x3c",jd=l("\x3c",!1),lb="!\x3d",kd=l("!\x3d",!1),fc="+",gc=l("+",!1),hc="-",ic=l("-",!1),ld="*",md=l("*",!1),nd="/",od=l("/",!1),Hd=/^[A-Za-z_\x80-\uFFFF]/,Id=e([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Jd=/^[A-Za-z0-9_]/,Kd=e([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ld=/^[A-Za-z0-9_.\x80-\uFFFF]/,Md=e([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Nd="@",Od=l("@",!1),xb=function(a){return{type:"interval-period",period:a.value,
precision:null,secondary:null}},yb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},zb="'",Ab=l("'",!1),Bb="N'",Xd=l("N'",!1),Da="''",Cb=l("''",!1),Db=/^[^']/,Eb=e(["'"],!0,!1),$d=".",ae=l(".",!1),fe=/^[0-9]/,ge=e([["0","9"]],!1,!1),be=/^[eE]/,ce=e(["e","E"],!1,!1),de=/^[+\-]/,ee=e(["+","-"],!1,!1),td="null",ud=l("NULL",!0),pd="true",qd=l("TRUE",!0),rd="false",sd=l("FALSE",!0),he="in",ie=l("IN",!0),je="is",ke=l("IS",!0),le="like",me=l("LIKE",!0),bd="escape",cd=
l("ESCAPE",!0),ne="not",oe=l("NOT",!0),pe="and",qe=l("AND",!0),re="or",se=l("OR",!0),te="between",ue=l("BETWEEN",!0),ve="from",we=l("FROM",!0),Dd="for",Ed=l("FOR",!0),Bd="substring",Cd=l("SUBSTRING",!0),zd="extract",Ad=l("EXTRACT",!0),xe="trim",ye=l("TRIM",!0),Fd="position",Gd=l("POSITION",!0),xd="timestamp",yd=l("TIMESTAMP",!0),vd="date",wd=l("DATE",!0),Pd="leading",Qd=l("LEADING",!0),Rd="trailing",Sd=l("TRAILING",!0),Td="both",Ud=l("BOTH",!0),Vd="to",Wd=l("TO",!0),ze="interval",Ae=l("INTERVAL",
!0),Be="year",Ce=l("YEAR",!0),De="month",Ee=l("MONTH",!0),Fe="day",Ge=l("DAY",!0),He="hour",Ie=l("HOUR",!0),Je="minute",Ke=l("MINUTE",!0),Le="second",Me=l("SECOND",!0),Ne="case",Oe=l("CASE",!0),Pe="end",Qe=l("END",!0),Re="when",Se=l("WHEN",!0),Te="then",Ue=l("THEN",!0),Yd="else",Zd=l("ELSE",!0),Ve=",",We=l(",",!1),Xe="(",Ye=l("(",!1),Ze=")",$e=l(")",!1),af=/^[ \t\n\r]/,bf=e([" ","\t","\n","\r"],!1,!1),Sc="`",Tc=l("`",!1),Uc=/^[^`]/,Vc=e(["`"],!0,!1),g=0,Ha=[{line:1,column:1}],ma=0,Sa=[],v=0,ya;if("startRule"in
q){if(!(q.startRule in Gb))throw Error("Can't start parsing from rule \""+q.startRule+'".');Hb=Gb[q.startRule]}ya=Hb();if(ya!==f&&g===a.length)return ya;ya!==f&&g<a.length&&c({type:"end"});throw function(a,b,c){return new C(C.buildMessage(a,b),a,b,c)}(Sa,ma<a.length?a.charAt(ma):null,ma<a.length?b(ma,ma+1):b(ma,ma));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(C,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,
supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}})},
"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/Set ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),function(C,a,q,l,e,d,b,
c,k,r,A,w,E,y,H,G){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(r.isValid(a.outSR)&&!r.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=G.cleanFromGeometryEngine(q({spatialReference:a.outSR},y.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=G.cleanFromGeometryEngine(q({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var d=E.getWhereClause(b.where,this.fieldsIndex);if(!d)return c.resolve(this);if(d.isStandardized){for(var e=0,h=[],k=0,l=this.items;k<l.length;k++){var r=l[k];d.testFeature(r,this.featureAdapter)&&(h[e++]=r)}d=new a(h,this.queryGeometry,this);d.definitionExpression=b.where;return c.resolve(d)}return c.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return c.resolve(this);var e=new d.default(b.objectIds),h=this.featureAdapter.getObjectId;return c.resolve(new a(this.items.filter(function(a){return e.has(h(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(d){d=H.getTimeOperator(this.timeInfo,d.timeExtent,this.featureAdapter);if(!b.isSome(d))return c.resolve(this);d=this.items.filter(d);return c.resolve(new a(d,this.queryGeometry,this))};a.prototype.project=
function(b){return e(this,void 0,void 0,function(){var c,d,e,h=this;return l(this,function(k){switch(k.label){case 0:if(!b||r.equals(this.spatialReference,b))return[2,this];c=this.featureAdapter;return[4,y.projectMany(this.items.map(function(a){return G.getGeometry(h,c.getGeometry(a))}),this.spatialReference,b)];case 1:return d=k.sent(),e=d.map(function(a,b){return c.cloneWithGeometry(h.items[b],A.convertFromGeometry(a,h.hasZ,h.hasM))}),[2,new a(e,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,e=this.hasM,h=this.hasZ,l=this.objectIdField,r=this.spatialReference,q=a.outFields,K=a.outSR,w=a.quantizationParameters,I=a.resultRecordCount,M=a.resultOffset,m=!1;null!=I&&null!=M&&(I=M+I,m=c.length>
I,c=c.slice(M,Math.min(c.length,I)));return{exceededTransferLimit:m,features:this._createFeatures(a,c),fields:q&&q.map(function(a){return b.fieldsIndex.get(a)}),geometryType:d,hasM:e,hasZ:h,objectIdFieldName:l,spatialReference:G.cleanFromGeometryEngine(K?K:r),transform:w&&k.toQuantizationTransform(w)||null}};a.prototype._createFeatures=function(a,b){var c=new w.default(a,this.featureAdapter,this.fieldsIndex),d=a.quantizationParameters,e=a.returnGeometry,h=a.returnCentroid,l=a.maxAllowableOffset,n=
a.orderByFields;a=[];var r=0;if(b.length&&n&&n.length){var n=n[0].split(" "),K=n[0],q=this.fieldsIndex.get(K),I="DESC"===n[1];b.sort(function(a,b){a=c.getFieldValue(a,K,q);b=c.getFieldValue(b,K,q);if("number"===typeof a&&"number"===typeof b)return I?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(I?a>b:a<b)?-1:(I?a<b:a>b)?1:0})}if(e||h)if(d=k.toQuantizationTransform(d),e&&!h)for(h=0;h<b.length;h++)e=b[h],a[r++]={attributes:c.getAttributes(e),geometry:G.getGeometry(this,
this.featureAdapter.getGeometry(e),l,d)};else if(!e&&h)for(l=0;l<b.length;l++)e=b[l],a[r++]={attributes:c.getAttributes(e),centroid:G.transformCentroid(this,this.featureAdapter.getCentroid(e,this),d)};else for(h=0;h<b.length;h++)e=b[h],a[r++]={attributes:c.getAttributes(e),centroid:G.transformCentroid(this,this.featureAdapter.getCentroid(e,this),d),geometry:G.getGeometry(this,this.featureAdapter.getGeometry(e),l,d)};else for(l=0;l<b.length;l++)e=b[l],(e=c.getAttributes(e))&&(a[r++]={attributes:e});
return a};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var h=a[e];if("exceedslimit"===h.statisticType){c=null!=h.maxPointCount?h.maxPointCount:Number.POSITIVE_INFINITY;d=null!=h.maxRecordCount?h.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=h.maxVertexCount?h.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>
c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,k=this.featureAdapter,b=this.items.reduce(function(a,b){b=k.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new w.default(a,this.featureAdapter,this.fieldsIndex),
c=a.outStatistics,d=[],e=[],h=a.groupByFieldsForStatistics;a=a.having;for(var k=h&&h.length,h=k&&h[0],l=this.fieldsIndex.get(h),r=!l,K={},q={},I={},A={attributes:{}},m=0;m<c.length;m++){var B=c[m],y=B.outStatisticFieldName,E=B.statisticType,B="exceedslimit"!==E?B.onStatisticField:void 0,D=this.fieldsIndex.get(B),C=k&&(B===h||r)&&"count"===E;if(k){K[B]||(K[B]=this._calculateUniqueValues(b,h,l));var G=K[B],H;for(H in G){var aa=G[H],Z=aa.count,S=aa.data,ta=aa.items;if(!a||b.validateItems(ta,a)){var aa=
q[S]||{attributes:{}},ja=null;C?ja=Z:(Z=this._calculateStatistics(ta,b,B,D),ta="var"===E?"variance":E,ja=Z[ta]);aa.attributes[y]=ja;aa.attributes[r?"EXPR_1":h]=S;q[S]=aa}}}else I[B]||(I[B]=this._calculateStatistics(this.items,b,B,D)),Z=I[B],ta="var"===E?"variance":E,A.attributes[y]=Z[ta];e.push({name:y,alias:y,type:"esriFieldTypeDouble"})}if(k)for(var ca in q)d.push(q[ca]);else d.push(A);return{fields:e,features:d}};a.prototype._calculateStatistics=function(a,b,c,d){for(var e=Number.POSITIVE_INFINITY,
h=Number.NEGATIVE_INFINITY,k=null,l=null,n=null,r=null,p=[],q=0,w=0;w<a.length;w++){var m=b.getFieldValue(a[w],c,d);"string"===typeof m?q++:null==m||isNaN(m)||(k+=m,e=Math.min(e,m),h=Math.max(h,m),p.push(m),q++)}if(q){l=k/q;for(b=a=0;b<p.length;b++)m=p[b],a+=Math.pow(m-l,2);r=1<q?a/(q-1):0;n=Math.sqrt(r)}else h=e=null;return{avg:l,count:q,max:h,min:e,stddev:n,sum:k,variance:r}};a.prototype._calculateUniqueValues=function(a,b,c){for(var d={},e=0,h=this.items;e<h.length;e++){var k=h[e],l=a.getFieldValue(k,
b,c);if(null==l||"string"===typeof l&&""===l.trim())l=null;null==d[l]?d[l]={count:1,data:l,items:[k]}:(d[l].count++,d[l].items.push(k))}return d};return a}();a.default=C})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","@dojo/framework/shim/Map","../../../core/maybe","./attributeSupport"],function(C,a,q,l,e){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(a,c,d){this._fieldDataCache=new q.default;this._returnDistinctMap=new q.default;
this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=d;this.featureAdapter=c;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var b=c=0;b<a.length;b++){var k=a[b],l=e.getExpressionFromFieldName(k),E=this.fieldsIndex.get(l),l=E?null:e.getWhereClause(l,d),E=E?E.name:e.getAliasFromFieldName(k)||"FIELD_EXP_"+c++;this._fieldDataCache.set(k,{alias:E,clause:l})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};
a.prototype.getFieldValue=function(a,c,d){var b=d?d.name:c,k=null;this._fieldDataCache.has(b)?k=this._fieldDataCache.get(b).clause:d||(k=e.getWhereClause(c,this.fieldsIndex),this._fieldDataCache.set(b,{alias:b,clause:k}));return d?this.featureAdapter.getAttribute(a,b):k.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:e.getWhereClause(c,this.fieldsIndex)});return this._fieldDataCache.get(c).clause.testFeature(a,
this.featureAdapter)};a.prototype.validateItems=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:e.getWhereClause(c,this.fieldsIndex)});return this._fieldDataCache.get(c).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var d={},e=0;e<b.length;e++){var l=this._fieldDataCache.get(b[e]),q=l.alias,l=l.clause;d[q]=l?l.calculateValue(a,
this.featureAdapter):this.featureAdapter.getAttribute(a,q)}return d};a.prototype._processAttributesForDistinctValues=function(a){if(l.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,d=[];if(b)for(var e=0;e<b.length;e++){var q=this._fieldDataCache.get(b[e]).alias;d.push(a[q])}else for(q in a)d.push(a[q]);b=(b||["*"]).join(",")+"\x3d"+d.join(",");d=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++d);return 1<d?null:a};return a}();a.default=C})},"esri/layers/graphics/data/timeSupport":function(){define(["require",
"exports"],function(C,a){function q(a,d,b,c,k){if(null!=c&&null!=k&&c===k)return function(e){return c>=a.getAttribute(e,d)&&c<=a.getAttribute(e,b)};if(null!=c&&null!=k)return function(e){var l=a.getAttribute(e,d);e=a.getAttribute(e,b);return!(l>k||e<c)};if(null!=c)return function(d){return!(a.getAttribute(d,b)<c)};if(null!=k)return function(b){return!(a.getAttribute(b,d)>k)}}function l(a,d,b,c){if(null!=b&&null!=c&&b===c)return function(c){return a.getAttribute(c,d)===b};if(null!=b&&null!=c)return function(e){return a.getAttribute(e,
d)>=b&&a.getAttribute(e,d)<=c};if(null!=b)return function(c){return a.getAttribute(c,d)>=b};if(null!=c)return function(b){return a.getAttribute(b,d)<=c}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,d){if(!a)return null;var b=d.featureAdapter,c=a.startTimeField,e=a.endTimeField,l=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY;if(c&&e)d.forEach(function(a){var d=b.getAttribute(a,c);a=b.getAttribute(a,e);null==d||isNaN(d)||(l=Math.min(l,d));null==a||isNaN(a)||(q=Math.max(q,
a))});else{var w=c||e;d.forEach(function(a){a=b.getAttribute(a,w);null==a||isNaN(a)||(l=Math.min(l,a),q=Math.max(q,a))})}return{start:l,end:q}};a.getTimeOperator=function(a,d,b){if(!d||!a)return null;var c=a.startTimeField;a=a.endTimeField;if(!c&&!a)return null;var e=d.start;d=d.end;return null==e&&null==d?null:c&&a?q(b,c,a,e,d):l(b,c||a,e,d)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(C,a,q,l,e,d,b,c,k,r,A,w,E,y,H,G,D){function h(a,b,c){c&&(b=y.quantizeOptimizedGeometry(F,b,a.hasZ,a.hasM,"esriGeometryPoint",c));return y.convertToPoint(b,a.hasZ,a.hasM)}function n(b,c,e){return l(this,void 0,void 0,function(){var h,l,n,p,t,K;return q(this,function(m){switch(m.label){case 0:if(!b)return[2,null];h=b.where;b.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||c&&c===h)b.where=null;return b.geometry?[4,u(b)]:[2,b];case 1:return l=m.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===
b.spatialRel&&(n=b.geometry.spatialReference,l=k.getGeometryExtent(l),l.spatialReference=n),b.geometry=l,[4,G.checkProjectionSupport(l.spatialReference,e)];case 2:return m.sent(),[4,A.normalizeCentralMeridian(r.fromJSON(l))];case 3:p=m.sent()[0];if(d.isNone(p))throw a.QUERY_ENGINE_EMPTY_RESULT;t=p.toJSON();return[4,G.project(t,t.spatialReference,e)];case 4:K=m.sent();if(!K)throw a.QUERY_ENGINE_EMPTY_RESULT;K.spatialReference=e;b.geometry=K;return[2,b]}})})}function u(a){return l(this,void 0,void 0,
function(){var d,e,h,k,l,n,r,t,K,u;return q(this,function(m){switch(m.label){case 0:d=a.geometry;e=a.distance;h=a.units;if(null==e)return[2,b.resolve(d)];k=d.spatialReference;l=h&&p.fromJSON(h)||c.getUnitString(k);n=k&&(w.isGeographic(k)||w.isWebMercator(k));if(!n)return[3,1];t=d;return[3,3];case 1:return[4,G.checkProjectionSupport(k,w.WGS84).then(function(){return G.project(d,w.WGS84)})];case 2:t=m.sent(),m.label=3;case 3:return r=t,[4,D.getGeodesicBufferOperator()];case 4:return K=m.sent(),u=K(r,
e,l),[2,u?u.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var p=new e.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var t=new H.default,F=new H.default,z={esriGeometryPoint:y.convertToPoint,esriGeometryPolyline:y.convertToPolyline,esriGeometryPolygon:y.convertToPolygon,
esriGeometryMultipoint:y.convertToMultipoint};a.transformCentroid=h;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=E.getCentroidOptimizedGeometry(new H.default,b.geometry,a.hasZ,a.hasM));return h(a,b.centroid,c)};a.getGeometry=function(a,b,c,d){b=b?"coords"in b?b:b.geometry:null;return b?c?(c=y.generalizeOptimizedGeometry(t,b,a.hasZ,a.hasM,a.geometryType,c),d&&(c=y.quantizeOptimizedGeometry(F,c,a.hasZ,a.hasM,
a.geometryType,d)),z[a.geometryType](c,a.hasZ,a.hasM)):d?(c=y.quantizeOptimizedGeometry(F,b,a.hasZ,a.hasM,a.geometryType,d),z[a.geometryType](c,a.hasZ,a.hasM)):z[a.geometryType](b,a.hasZ,a.hasM):null};a.normalizeQuery=function(a,b,c){return l(this,void 0,void 0,function(){var d,e,h,k,l;return q(this,function(m){d=a.outFields;e=a.orderByFields;h=a.groupByFieldsForStatistics;k=a.outStatistics;if(d)for(l=0;l<d.length;l++)d[l]=d[l].trim();if(e)for(l=0;l<e.length;l++)e[l]=e[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=
h[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,n(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return l(this,void 0,void 0,function(){return q(this,function(d){return[2,n(a,b,c)]})})};a.normalizeQueryLike=n;a.cleanFromGeometryEngine=function(a){return a&&Q in a?JSON.parse(JSON.stringify(a,T)):a};var Q="_geVersion",T=function(a,b){return a!==Q?b:void 0}})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(C,a,q,l,e,d,b,c,k,r,A,w,E,y,H){function G(){return d.create(function(a){return C(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var D={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},h={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},n={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},u={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=G;a.getGeodesicBufferOperator=function(){return G().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,e,h){if(k.isPolygon(e)&&"esriGeometryPoint"===h.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var l=w.convertFromPolygon(new E.default,e,!1,!1);return d.resolve(function(a){return A.polygonContainsPoint(l,!1,!1,a)})}if(k.isPolygon(e)&&"esriGeometryMultipoint"===h.geometryType){var n=
w.convertFromPolygon(new E.default,e,!1,!1);if("esriSpatialRelContains"===a)return d.resolve(function(a){return A.polygonContainsMultipoint(n,!1,!1,a,h.hasZ,h.hasM)})}if(k.isExtent(e)&&"esriGeometryPoint"===h.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return d.resolve(function(a){return b.extentContainsPoint(e,H.getGeometry(h,a))});if(k.isExtent(e)&&"esriGeometryMultipoint"===h.geometryType&&"esriSpatialRelContains"===a)return d.resolve(function(a){return b.extentContainsMultipoint(e,
H.getGeometry(h,a))});if(k.isExtent(e)&&"esriSpatialRelIntersects"===a){var p=c.getExtentIntersector(h.geometryType);return d.resolve(function(a){return p(e,H.getGeometry(h,a))})}return G().then(function(b){var c=b[D[a]].bind(null,e);return function(a){return c(H.getGeometry(h,a))}})};a.checkSpatialQuerySupport=function(a,b,c){return l(this,void 0,void 0,function(){var d,l;return q(this,function(p){d=a.spatialRel;l=a.geometry;if(!l)return[2];if(!0!==h[d])throw new e("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!r.isValid(l.spatialReference)||!r.isValid(c))return[2];if(!0!==n[k.getJsonType(l)])throw new e("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==u[b])throw new e("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,y.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(k.isExtent(a))return!0;if(k.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(C,a){function q(a,e,d,b,c){if(!a)return!1;e=e?d?4:3:d?3:2;d=a.coords;var k=!1,l=0,q=0;for(a=a.lengths;q<a.length;q++){for(var w=a[q],E=l,y=l,C=l+w*e;y<C;y+=e){E=y+e;E===C&&(E=l);var G=d[y],D=d[y+1],h=d[E],E=d[E+1];(D<
c&&E>=c||E<c&&D>=c)&&G+(c-D)/(E-D)*(h-G)<b&&(k=!k)}l+=w*e}return k}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,e,d,b){return q(a,e,d,b.coords[0],b.coords[1])};a.polygonContainsMultipoint=function(a,e,d,b,c,k){c=c?k?4:3:k?3:2;k=b.coords;b=b.lengths;if(!b)return!1;for(var l=0,A=0;l<b.length;l++,A+=c)if(!q(a,e,d,k[A],k[A+1]))return!1;return!0};a.polygonContainsCoords=q})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(C,a,q){Object.defineProperty(a,"__esModule",{value:!0});C=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var d=this;return q.create(function(b,c){d._deferreds.push({resolve:b,reject:c});d._values.push(a)})};a.prototype.unshift=function(a){var d=this;return q.create(function(b,c){d._deferreds.unshift({resolve:b,reject:c});d._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,
configurable:!0});a.prototype.process=function(){if(0===this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=q.createAbortError(),d=0,b=this._deferreds;d<b.length;d++)b[d].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=C})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),
function(C,a,q,l,e,d){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?d.defaultPointSymbolJSON:"esriGeometryPolyline"===a?d.defaultPolylineSymbolJSON:d.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,c){if(l("csp-restrictions"))return function(){var b;return q((b={},b[c]=null,b),a)};try{var b="this."+c+" \x3d null;",d;for(d in a)b+="this."+d+" \x3d "+
JSON.stringify(a[d])+";";var e=new Function(b);return function(){return new e}}catch(w){return function(){var b;return q((b={},b[c]=null,b),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:e.clone(a)}}]}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(C,
a,q,l,e,d,b,c,k,r,A,w,E,y,H,G,D){function h(a){return c.isPoint(a)?null!=a.z:!!a.hasZ}function n(a){return c.isPoint(a)?null!=a.m:!!a.hasM}Object.defineProperty(a,"__esModule",{value:!0});var u=k.WGS84,p={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:k.WGS84},t={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,
supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}},F=function(){return function(){this.description=this.code=null}}(),z=function(){return function(a){this.error=new F;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=
a}}(),Q=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();C=function(){function a(){this._nextObjectId=this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFieldNames=this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){var b,c,h,k,l,n,r,z,K,C,R,F,S,T,Q,ca,L,ga,ka,
la,Ea,Pa,Qa,bb,Ra,cb;return q(this,function(m){switch(m.label){case 0:b=[];c=a.features;h=this._inferLayerProperties(c,a.fields);k=a.fields||[];l=null!=a.hasM?a.hasM:h.hasM;n=null!=a.hasZ?a.hasZ:h.hasZ;z=(r=!a.spatialReference&&!h.spatialReference)?u:a.spatialReference||h.spatialReference;K=r?p:null;C=a.geometryType||h.geometryType;R=a.objectIdField||h.objectIdField;F=a.timeInfo;r&&b.push({type:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"});
if(!C)throw new d("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!R)throw new d("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");h.objectIdField&&R!==h.objectIdField&&(b.push({type:"feature-layer:duplicated-oid-field",message:'Provided objectIdField "'+R+'" doesn\'t match the field name "'+h.objectIdField+'", found in the provided fields'}),R=h.objectIdField);R&&!h.objectIdField&&
(S=null,(T=k.some(function(a){return a.name===R?(S=a,!0):!1}))?(S.type="esriFieldTypeOID",S.editable=!1,S.nullable=!1):k.unshift({alias:R,name:R,type:"esriFieldTypeOID",editable:!1,nullable:!1}));Q=0;for(ca=k;Q<ca.length;Q++){L=ca[Q];null==L.name&&(L.name=L.alias);null==L.alias&&(L.alias=L.name);if(!L.name)throw new d("feature-layer:invalid-field-name","field name is missing",{field:L});L.name===R&&(L.type="esriFieldTypeOID");if(-1===G.kebabDict.jsonValues.indexOf(L.type))throw new d("feature-layer:invalid-field-type",
'invalid type for field "'+L.name+'"',{field:L});}ga={};this._requiredFieldNames=[];ka=0;for(la=k;ka<la.length;ka++)L=la[ka],"esriFieldTypeOID"!==L.type&&"esriFieldTypeGlobalID"!==L.type&&(L.editable=null==L.editable?!0:!!L.editable,L.nullable=null==L.nullable?!0:!!L.nullable,Ea=D.getFieldDefaultValue(L),L.nullable||void 0!==Ea?ga[L.name]=Ea:this._requiredFieldNames.push(L.name));this._fieldsIndex=new H(k);this._createDefaultAttributes=y.createDefaultAttributesFunction(ga,R);F&&(F.startTimeField&&
((Pa=this._fieldsIndex.get(F.startTimeField.toLowerCase()))?(F.startTimeField=Pa.name,Pa.type="esriFieldTypeDate"):F.startTimeField=null),F.endTimeField&&((Qa=this._fieldsIndex.get(F.endTimeField.toLowerCase()))?(F.endTimeField=Qa.name,Qa.type="esriFieldTypeDate"):F.endTimeField=null),F.trackIdField&&((bb=this._fieldsIndex.get(F.trackIdField.toLowerCase()))?F.trackIdField=bb.name:(F.trackIdField=null,b.push({type:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:F}}))),
F.startTimeField||F.endTimeField||(b.push({type:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:F}}),F=null));Ra={warnings:b,featureErrors:[],layerDefinition:e({},t,{drawingInfo:y.createDrawingInfo(C),templates:y.createDefaultTemplate(ga),extent:K,geometryType:C,objectIdField:R,fields:k,hasZ:!!n,hasM:!!l,timeInfo:F}),assignedObjectIds:{}};this._queryEngine=new E.default({fields:k,geometryType:C,hasM:l,hasZ:n,objectIdField:R,spatialReference:z,
featureStore:new A.default({geometryType:C,hasM:l,hasZ:n}),timeInfo:F});if(!c||!c.length)return this._nextObjectId=1,[2,Ra];cb=c.reduce(function(a,b){b=b.attributes&&b.attributes[R];return null==b||isNaN(b)||!isFinite(b)?a:Math.max(a,b)},0);this._nextObjectId=1+cb;return[4,w.checkProjectionSupport(c,z)];case 1:return m.sent(),[2,this._loadInitialFeatures(Ra,c)]}})})};a.prototype.applyEdits=function(a){return l(this,void 0,void 0,function(){var c;return q(this,function(d){switch(d.label){case 0:return c=
this._queryEngine.spatialReference,[4,b.all([w.checkProjectionSupport(a.adds,c),w.checkProjectionSupport(a.updates,c)])];case 1:return d.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQuery(a,b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,
b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._inferLayerProperties=function(a,b){for(var d=void 0,e=void 0,k=null,l=null,p=null,q=0;q<a.length;q++){var r=
a[q].geometry;if(r&&(k||(k=c.getJsonType(r)),l||(l=r.spatialReference),null==d&&(d=h(r)),null==e&&(e=n(r)),k&&l&&null!=d&&null!=e))break}if(b&&b.length){var t=null;b.some(function(a){var b="esriFieldTypeOID"===a.type,c=!a.type&&a.name&&"objectid"===a.name.toLowerCase();t=a;return b||c})&&(p=t.name)}return{geometryType:k,spatialReference:l,objectIdField:p,hasM:e,hasZ:d}};a.prototype._loadInitialFeatures=function(a,b){for(var d=this._queryEngine,e=d.geometryType,h=d.hasM,k=d.hasZ,l=d.objectIdField,
n=d.spatialReference,d=d.featureStore,p=[],q=0;q<b.length;q++){var t=b[q];null!=t.uid&&(a.assignedObjectIds[t.uid]=-1);if(t.geometry&&e!==c.getJsonType(t.geometry))a.featureErrors.push(new z("Incorrect geometry type."));else{var u=this._createDefaultAttributes(),y=this._mixAttributes(u,t.attributes,!0);y?a.featureErrors.push(y):(this._assignObjectId(u,t.attributes,!0),t.attributes=u,null!=t.uid&&(a.assignedObjectIds[t.uid]=t.attributes[l]),t.geometry&&(t.geometry=w.project(t.geometry,t.geometry.spatialReference,
n)),p.push(t))}}d.addMany(r.convertFromFeatures([],p,e,k,h,l));a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(d,b);c&&c.length&&this._applyUpdateEdits(d,c);if(a&&a.length){for(b=0;b<a.length;b++)d.deleteResults.push(new Q(a[b]));
this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:d}};a.prototype._applyAddEdits=function(a,b){for(var d=a.addResults,e=this._queryEngine,h=e.geometryType,k=e.hasM,l=e.hasZ,n=e.objectIdField,p=e.spatialReference,e=e.featureStore,q=[],t=0;t<b.length;t++){var u=b[t];if(u.geometry&&h!==c.getJsonType(u.geometry))d.push(new z("Incorrect geometry type."));else{var y=this._createDefaultAttributes(),A=this._mixAttributes(y,u.attributes);A?d.push(A):
(this._assignObjectId(y,u.attributes),u.attributes=y,null!=u.uid&&(a.uidToObjectId[u.uid]=u.attributes[n]),u.geometry&&(u.geometry=w.project(u.geometry,u.geometry.spatialReference,p)),q.push(u),d.push(new Q(u.attributes[n])))}}e.addMany(r.convertFromFeatures([],q,h,l,k,n))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var d=this._queryEngine,e=d.geometryType,h=d.hasM,k=d.hasZ,l=d.objectIdField,n=d.spatialReference,d=d.featureStore,p=0;p<b.length;p++){var q=b[p],t=q.attributes,
u=q.geometry,q=t&&t[l];if(null==q)a.push(new z("Identifier field "+l+" missing"));else if(d.has(q)){var y=r.convertToFeature(d.getFeature(q),e,k,h);if(u){if(e!==c.getJsonType(u)){a.push(new z("Incorrect geometry type."));continue}y.geometry=w.project(u,u.spatialReference,n)}if(t&&(t=this._mixAttributes(y.attributes,t))){a.push(t);continue}d.add(r.convertFromFeature(y,e,k,h,l));a.push(new Q(q))}else a.push(new z("Feature with object id "+q+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===
c&&(c=!1);var d=this._queryEngine.objectIdField;c?b&&isFinite(b[d])?a[d]=b[d]:a[d]=this._nextObjectId++:a[d]=this._nextObjectId++};a.prototype._mixAttributes=function(a,b,c){void 0===c&&(c=!1);for(var d in b){var e=D.sanitizeNullFieldValue(b[d]),h=this._fieldsIndex.get(d)||this._fieldsIndex.get(d.toLowerCase());if(h&&(c||h.editable)){var k=D.validateFieldValue(h,e);if(k)return new z(D.validationErrorToString(k,h,e));a[h.name]=e}}b=0;for(c=this._requiredFieldNames;b<c.length;b++)if(d=c[b],void 0===
a[d])return new z('missing required field "'+d+'"');return null};return a}();a.default=C});