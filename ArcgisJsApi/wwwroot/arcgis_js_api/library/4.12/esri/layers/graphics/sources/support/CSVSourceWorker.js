// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
require({cache:{"dojo/number":function(){define(["./_base/lang","./i18n","./i18n!./cldr/nls/number","./string","./regexp"],function(y,a,q,k,c){var d={};y.setObject("dojo.number",d);d.format=function(e,b){b=y.mixin({},b||{});var c=a.normalizeLocale(b.locale),c=a.getLocalization("dojo.cldr","number",c);b.customs=c;c=b.pattern||c[(b.type||"decimal")+"Format"];return isNaN(e)||Infinity==Math.abs(e)?null:d._applyPattern(e,c,b)};d._numberPatternRE=/[#0,]*[#0](?:\.0*#*)?/;d._applyPattern=function(a,b,c){c=
c||{};var e=c.customs.group,h=c.customs.decimal;b=b.split(";");var l=b[0];b=b[0>a?1:0]||"-"+l;if(-1!=b.indexOf("%"))a*=100;else if(-1!=b.indexOf("\u2030"))a*=1E3;else if(-1!=b.indexOf("\u00a4"))e=c.customs.currencyGroup||e,h=c.customs.currencyDecimal||h,b=b.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/,function(a,e,b,d){return(a=c[["symbol","currency","displayName"][b.length-1]]||c.currency||"")?e+a+d:""});else if(-1!=b.indexOf("E"))throw Error("exponential notation not supported");var r=d._numberPatternRE,
l=l.match(r);if(!l)throw Error("unable to find a number expression in pattern: "+b);!1===c.fractional&&(c.places=0);return b.replace(r,d._formatAbsolute(a,l[0],{decimal:h,group:e,places:c.places,round:c.round}))};d.round=function(a,b,d){d=10/(d||10);return(d*+a).toFixed(b)/d};if(0==(.9).toFixed()){var b=d.round;d.round=function(a,d,c){var e=Math.pow(10,-d||0),h=Math.abs(a);if(!a||h>=e)e=0;else if(h/=e,.5>h||.95<=h)e=0;return b(a,d,c)+(0<a?e:-e)}}d._formatAbsolute=function(a,b,c){c=c||{};!0===c.places&&
(c.places=0);Infinity===c.places&&(c.places=6);b=b.split(".");var e="string"==typeof c.places&&c.places.indexOf(","),h=c.places;e?h=c.places.substring(e+1):0<=h||(h=(b[1]||[]).length);0>c.round||(a=d.round(a,h,c.round));a=String(Math.abs(a)).split(".");var l=a[1]||"";b[1]||c.places?(e&&(c.places=c.places.substring(0,e)),e=void 0!==c.places?c.places:b[1]&&b[1].lastIndexOf("0")+1,e>l.length&&(a[1]=k.pad(l,e,"0",!0)),h<l.length&&(a[1]=l.substr(0,h))):a[1]&&a.pop();h=b[0].replace(",","");e=h.indexOf("0");
-1!=e&&(e=h.length-e,e>a[0].length&&(a[0]=k.pad(a[0],e)),-1==h.indexOf("#")&&(a[0]=a[0].substr(a[0].length-e)));var h=b[0].lastIndexOf(","),r,A;-1!=h&&(r=b[0].length-h-1,b=b[0].substr(0,h),h=b.lastIndexOf(","),-1!=h&&(A=b.length-h-1));b=[];for(h=a[0];h;)e=h.length-r,b.push(0<e?h.substr(e):h),h=0<e?h.slice(0,e):"",A&&(r=A,A=void 0);a[0]=b.reverse().join(c.group||",");return a.join(c.decimal||".")};d.regexp=function(a){return d._parseInfo(a).regexp};d._parseInfo=function(e){e=e||{};var b=a.normalizeLocale(e.locale),
b=a.getLocalization("dojo.cldr","number",b),l=e.pattern||b[(e.type||"decimal")+"Format"],k=b.group,p=b.decimal,z=1;if(-1!=l.indexOf("%"))z/=100;else if(-1!=l.indexOf("\u2030"))z/=1E3;else{var r=-1!=l.indexOf("\u00a4");r&&(k=b.currencyGroup||k,p=b.currencyDecimal||p)}b=l.split(";");1==b.length&&b.push("-"+b[0]);b=c.buildGroupRE(b,function(a){a="(?:"+c.escapeString(a,".")+")";return a.replace(d._numberPatternRE,function(a){var b={signed:!1,separator:e.strict?k:[k,""],fractional:e.fractional,decimal:p,
exponent:!1};a=a.split(".");var c=e.places;1==a.length&&1!=z&&(a[1]="###");1==a.length||0===c?b.fractional=!1:(void 0===c&&(c=e.pattern?a[1].lastIndexOf("0")+1:Infinity),c&&void 0==e.fractional&&(b.fractional=!0),!e.places&&c<a[1].length&&(c+=","+a[1].length),b.places=c);a=a[0].split(",");1<a.length&&(b.groupSize=a.pop().length,1<a.length&&(b.groupSize2=a.pop().length));return"("+d._realNumberRegexp(b)+")"})},!0);r&&(b=b.replace(/([\s\xa0]*)(\u00a4{1,3})([\s\xa0]*)/g,function(a,b,d,h){a=c.escapeString(e[["symbol",
"currency","displayName"][d.length-1]]||e.currency||"");if(!a)return"";b=b?"[\\s\\xa0]":"";h=h?"[\\s\\xa0]":"";return e.strict?b+a+h:(b&&(b+="*"),h&&(h+="*"),"(?:"+b+a+h+")?")}));return{regexp:b.replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:k,decimal:p,factor:z}};d.parse=function(a,b){b=d._parseInfo(b);a=(new RegExp("^"+b.regexp+"$")).exec(a);if(!a)return NaN;var e=a[1];if(!a[1]){if(!a[2])return NaN;e=a[2];b.factor*=-1}e=e.replace(new RegExp("["+b.group+"\\s\\xa0]","g"),"").replace(b.decimal,".");return e*
b.factor};d._realNumberRegexp=function(a){a=a||{};"places"in a||(a.places=Infinity);"string"!=typeof a.decimal&&(a.decimal=".");"fractional"in a&&!/^0/.test(a.places)||(a.fractional=[!0,!1]);"exponent"in a||(a.exponent=[!0,!1]);"eSigned"in a||(a.eSigned=[!0,!1]);var b=d._integerRegexp(a),e=c.buildGroupRE(a.fractional,function(b){var e="";b&&0!==a.places&&(e="\\"+a.decimal,e=Infinity==a.places?"(?:"+e+"\\d+)?":e+("\\d{"+a.places+"}"));return e},!0),k=c.buildGroupRE(a.exponent,function(b){return b?
"([eE]"+d._integerRegexp({signed:a.eSigned})+")":""}),b=b+e;e&&(b="(?:(?:"+b+")|(?:"+e+"))");return b+k};d._integerRegexp=function(a){a=a||{};"signed"in a||(a.signed=[!0,!1]);"separator"in a?"groupSize"in a||(a.groupSize=3):a.separator="";var b=c.buildGroupRE(a.signed,function(a){return a?"[-+]":""},!0),e=c.buildGroupRE(a.separator,function(b){if(!b)return"(?:\\d+)";b=c.escapeString(b);" "==b?b="\\s":"\u00a0"==b&&(b="\\s\\xa0");var e=a.groupSize,d=a.groupSize2;return d?(b="(?:0|[1-9]\\d{0,"+(d-1)+
"}(?:["+b+"]\\d{"+d+"})*["+b+"]\\d{"+e+"})",0<e-d?"(?:"+b+"|(?:0|[1-9]\\d{0,"+(e-1)+"}))":b):"(?:0|[1-9]\\d{0,"+(e-1)+"}(?:["+b+"]\\d{"+e+"})*)"},!0);return b+e};return d})},"dojo/string":function(){define(["./_base/kernel","./_base/lang"],function(y,a){var q=/[&<>'"\/]/g,k={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;","/":"\x26#x2F;"},c={};a.setObject("dojo.string",c);c.escape=function(a){return a?a.replace(q,function(a){return k[a]}):""};c.rep=function(a,b){if(0>=
b||!a)return"";for(var e=[];;){b&1&&e.push(a);if(!(b>>=1))break;a+=a}return e.join("")};c.pad=function(a,b,e,h){e||(e="0");a=String(a);b=c.rep(e,Math.ceil((b-a.length)/e.length));return h?a+b:b+a};c.substitute=function(c,b,e,h){h=h||y.global;e=e?a.hitch(h,e):function(a){return a};return c.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,function(c,d,k){if(""==d)return"$";c=a.getObject(d,!1,b);k&&(c=a.getObject(k,!1,h).call(h,c,d));k=e(c,d);if("undefined"===typeof k)throw Error('string.substitute could not find key "'+
d+'" in template');return k.toString()})};c.trim=String.prototype.trim?a.trim:function(a){a=a.replace(/^\s+/,"");for(var b=a.length-1;0<=b;b--)if(/\S/.test(a.charAt(b))){a=a.substring(0,b+1);break}return a};return c})},"dojo/regexp":function(){define(["./_base/kernel","./_base/lang"],function(y,a){var q={};a.setObject("dojo.regexp",q);q.escapeString=function(a,c){return a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,function(a){return c&&-1!=c.indexOf(a)?a:"\\"+a})};q.buildGroupRE=function(a,c,d){if(!(a instanceof
Array))return c(a);for(var b=[],e=0;e<a.length;e++)b.push(c(a[e]));return q.group(b.join("|"),d)};q.group=function(a,c){return"("+(c?"?:":"")+a+")"};return q})},"dstore/Csv":function(){define(["dojo/_base/lang","dojo/_base/declare"],function(y,a){function q(a,e){var b={},c=a.length,d;for(d=0;d<c;d++)b[a[d]]=e[d];return b}var k=/^\s*"([\S\s]*)"\s*$/,c=/""/g,d=/"/g;return a(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(a){var b=[];a=a.split(this.newline);var d=this.fieldNames,
l=0,t=[],p="",z="",r,A,C,H,m,B,I;m=0;C=a.length;a:for(;m<C;m++)if(y.trim(a[m])){r=a[m].split(this.delimiter);B=0;for(H=r.length;B<H;B++){A=r[B];I=-1;p+=z+A;for(z="";0<=(I=A.indexOf('"',I+1));)l++;if(0===l%2){if(0<l)if(l=k.exec(p))t.push(l[1].replace(c,'"'));else{console.warn("Csv: discarding row with invalid value: "+p);t=[];p="";l=0;continue a}else t.push(this.trim||!d?y.trim(p):p);p="";l=0}else z=this.delimiter}0===l?(d?b.push(q(d,t)):d=this.fieldNames=t,t=[]):z=this.newline}return b},toCsv:function(a){return this.stringify(this.data,
a)},stringify:function(a,e){e=e||{};var b=e.alwaysQuote,c=this.fieldNames,k=this.delimiter,p=this.newline,z="",r,A,C,H;for(r=-1;r<a.length;r++)for(-1<r&&(z+=p),A=0;A<c.length;A++){C=0>r?c[A]:a[r][c[A]];if(null===C||void 0===C)C="";"string"!==typeof C&&(C=C.toString());H=b||0<=C.indexOf('"')||0<=C.indexOf(k);z+=(0<A?k:"")+(H?'"'+C.replace(d,'""')+'"':C)}e.trailingNewline&&(z+=p);return z}})})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(y,a,q,k,c,d){function b(a,b,r,l,k){void 0===l&&(l=null);void 0===k&&(k=!1);if(null===l){var H=d.cacheKey(b,r);void 0!==t[H]?l=t[H]:(l=e(b,r,null),null===l&&(l=new d),t[H]=l)}return h._project(a,b,r instanceof c||!1===k?r:new c(r),l,k)}function e(a,b,e){void 0===e&&(e=null);a=h._getTransformation(a,b,e);return null!==a?d.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var h=null;a.isLoaded=function(){return!!h&&k.isLoaded()};a.isSupported=function(){return k.isSupported()};
var l=null;a.load=function(){return l?l:l=q.create(function(a,b){var e=k.load();y(["./geometryEngine"],function(c){h=c;e.then(function(){h._enableProjection(k);a()},function(a){b(a)})})})};a.project=function(a,e,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:b(a,a[0].spatialReference,e,c):b([a],a.spatialReference,e,c)[0]};var t={};a.projectMany=b;a.getTransformation=e;a.getTransformations=function(a,b,e){void 0===e&&(e=null);a=h._getTransformationBySuitability(a,b,e);if(null!==
a){b=[];for(e=0;e<a.length;e++)b.push(d.fromGE(a[e]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(y,a,q,k,c){function d(b){function e(a,b,e){a[b]=e(a[b])}a._pe=b;p.init();z.init();r.init();A.init();C.init();a.PeGCSExtent=function(b){function e(){return null!==b&&b.apply(this,arguments)||this}q(e,b);e.prototype.destroy=function(){a._pe.destroy(this)};return e}(a._pe.PeGCSExtent);for(var c=
0,d=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];c<d.length;c++)b=d[c],e(b.prototype,"getName",function(a){return function(){return a.call(this,Array(p.PE_NAME_MAX))}});c=0;for(d=[a._pe.PeGeogtran,a._pe.PeProjcs];c<d.length;c++)b=d[c],e(b.prototype,"getParameters",function(b){return function(){for(var e=Array(p.PE_PARM_MAX),c=b.call(this),d=0;d<e.length;d++){var h=a._pe.getValue(c,"*");e[d]=h?a._pe.wrapPointer(h,
a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return e}});e(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var e=[],c=a.call(this);l(e,b,c);return e}});e(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var e=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var c=null,d=b.call(this);if(!a._pe.compare(d,a._pe.NULL)){var c=[d],h=this.getSteps();if(1<h)for(var d=a._pe.getPointer(d),m=1;m<h;m++)c.push(a._pe.wrapPointer(d+
e*m,a._pe.PeGTlistExtendedGTs))}return c}});var h=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var e=this._cache;e||(this._cache=e=new Map);if(e.has(b))return e.get(b);var c=null,d=b.call(this);if(!a._pe.compare(d,a._pe.NULL)){var c=[d],m=d.getNump();if(1<m)for(var d=a._pe.getPointer(d),x=1;x<m;x++)c.push(a._pe.wrapPointer(d+h*x,a._pe.PeHorizon))}e.set(b,c);return c}};e(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);e(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=
function(b){void 0===b&&(b=p.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var e=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(p.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(e,b,c))}}function b(b){if(b){var e=a._pe.getClass(b);e&&(e=a._pe.getCache(e))&&(b=a._pe.getPointer(b))&&delete e[b]}}function e(b,e){var c=[];e=Array(e);for(var d=0;d<b;d++)c.push(a._pe.ensureInt8(e));return c}function h(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):
b=a;return b}function l(b,e,c,d){void 0===d&&(d=!1);if(d)for(d=0;d<2*e;d++)b[d]=a._pe.getValue(c+d*Float64Array.BYTES_PER_ELEMENT,"double");else{var h=0===b.length;for(d=0;d<e;d++)h&&(b[d]=Array(2)),b[d][0]=a._pe.getValue(c,"double"),b[d][1]=a._pe.getValue(c+Float64Array.BYTES_PER_ELEMENT,"double"),c+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var t;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!k("esri-wasm")};a.load=function(){return t?
t:t=c.create(function(a,b){y(["./support/pe-wasm"],function(e){e({locateFile:function(a){return y.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){d(b);a()})})})};(function(b){function e(b,e,c){a._pe.ensureCache.prepare();var d=h(c),x=c===d,d=a._pe.ensureFloat64(d);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),e,d))&&l(c,e,d,x);return b}function c(a,b,e){return d(a,b,e,0)}function d(b,e,c,d){a._pe.ensureCache.prepare();var m=h(c),x=c===m,m=a._pe.ensureFloat64(m);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),
e,m,d))&&l(c,e,m,x);return b}b.geogToProj=e;b.projGeog=function(a,b,d,h){switch(h){case p.PE_TRANSFORM_P_TO_G:return c(a,b,d);case p.PE_TRANSFORM_G_TO_P:return e(a,b,d)}return 0};b.projToGeog=c;b.projToGeogCenter=d})(a.PeCSTransformations||(a.PeCSTransformations={}));var p;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;
b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(p=a.PeDefs||(a.PeDefs={}));(function(b){function e(b,e){var h=null,m=d[b];m||(m={},d[b]=m);m.hasOwnProperty(String(e))?h=m[e]:(b=a._pe.PeFactory.prototype.factoryByType(b,
e),a._pe.compare(b,a._pe.NULL)||(h=b,m[e]=h));return h=c(h)}function c(b){if(b){var e=b.getType();switch(e){case p.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case p.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case p.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:e&p.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var d={},h={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return e(p.PE_TYPE_COORDSYS,
a)};b.factoryByType=e;b.fromString=function(b,e){var d=null,m=h[b];m||(m={},h[b]=m);m.hasOwnProperty(e)?d=m[e]:(b=a._pe.PeFactory.prototype.fromString(b,e),a._pe.compare(b,a._pe.NULL)||(d=b,m[e]=d));return d=c(d)};b.geogcs=function(a){return e(p.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return e(p.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return e(p.PE_TYPE_PROJCS,a)};b.unit=function(a){return e(p.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory=
{}));a.PeGCSExtent=null;var z;(function(b){var e;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;e=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,c,d,h,m,l){var x=null,B=new a._pe.PeInteger(l);try{var r=a._pe.PeGTlistExtended.prototype.getGTlist(b,c,d,h,m,B);if(l=B.val)if(x=[r],1<l){var I=a._pe.getPointer(r);for(b=1;b<l;b++)x.push(a._pe.wrapPointer(I+e*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(B)}return x}})(z=a.PeGTlistExtended||
(a.PeGTlistExtended={}));(function(e){e.destroy=function(e){if(e&&e.length){for(var c=0;c<e.length;c++){var d=e[c];b(d);d.getEntries().forEach(function(a){b(a);a=a.getGeogtran();b(a);a.getParameters().forEach(b);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){b(a);var e=a.getDatum();b(e);b(e.getSpheroid());b(a.getPrimem());b(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,e,c,d,
r){a._pe.ensureCache.prepare();var m=h(c),x=c===m,m=a._pe.ensureFloat64(m),B=0;d&&(B=a._pe.ensureFloat64(d));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),e,m,B,r))&&l(c,e,m,x);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function c(b,c,d,m,l,r){a._pe.ensureCache.prepare();var x,B;switch(b){case "dd":x=a._pe._pe_geog_to_dd;B=p.PE_DD_MAX;break;case "ddm":x=a._pe._pe_geog_to_ddm;B=p.PE_DDM_MAX;break;case "dms":x=a._pe._pe_geog_to_dms,B=p.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));
c=h(m);c=a._pe.ensureFloat64(c);B=e(d,B);m=a._pe.ensureInt32(B);if(l=x(b,d,c,l,m))for(x=0;x<d;x++)r[x]=a._pe.UTF8ToString(B[x]);return l}function d(b,e,c,d,h){a._pe.ensureCache.prepare();var m;switch(b){case "dd":m=a._pe._pe_dd_to_geog;break;case "ddm":m=a._pe._pe_ddm_to_geog;break;case "dms":m=a._pe._pe_dms_to_geog}b=0;e&&(b=a._pe.getPointer(e));e=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(e);e=a._pe.ensureFloat64(Array(2*c));(m=m(b,c,d,e))&&l(h,c,e);return m}b.geog_to_dms=
function(a,b,e,d,h){return c("dms",a,b,e,d,h)};b.dms_to_geog=function(a,b,e,c){return d("dms",a,b,e,c)};b.geog_to_ddm=function(a,b,e,d,h){return c("ddm",a,b,e,d,h)};b.ddm_to_geog=function(a,b,e,c){return d("ddm",a,b,e,c)};b.geog_to_dd=function(a,b,e,d,h){return c("dd",a,b,e,d,h)};b.dd_to_geog=function(a,b,e,c){return d("dd",a,b,e,c)}})(a.PeNotationDms||(a.PeNotationDms={}));var r;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=
a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,d,l,r,k,A){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=h(d);d=a._pe.ensureFloat64(b);b=e(c,p.PE_MGRS_MAX);var x=a._pe.ensureInt32(b);if(l=a._pe._pe_geog_to_mgrs_extended(m,
c,d,l,r,k,x))for(r=0;r<c;r++)A[r]=a._pe.UTF8ToString(b[r]);return l};b.mgrs_to_geog_extended=function(b,e,c,d,h){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*e));(d=a._pe._pe_mgrs_to_geog_extended(m,e,c,d,b))&&l(h,e,b);return d}})(r=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,d,l,r,k,A){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));
b=h(d);d=a._pe.ensureFloat64(b);b=e(c,p.PE_MGRS_MAX);var x=a._pe.ensureInt32(b);if(l=a._pe._pe_geog_to_usng(m,c,d,l,r,k,x))for(r=0;r<c;r++)A[r]=a._pe.UTF8ToString(b[r]);return l};b.usng_to_geog=function(b,e,c,d){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*e));(h=a._pe._pe_usng_to_geog(h,e,c,b))&&l(d,e,b);return h}})(a.PeNotationUsng||(a.PeNotationUsng={}));var A;(function(b){b.init=
function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,c,d,l,r){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=h(d);d=a._pe.ensureFloat64(b);b=e(c,p.PE_UTM_MAX);var x=a._pe.ensureInt32(b);if(l=a._pe._pe_geog_to_utm(m,c,d,l,x))for(m=0;m<c;m++)r[m]=a._pe.UTF8ToString(b[m]);return l};b.utm_to_geog=
function(b,e,c,d,h){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*e));(d=a._pe._pe_utm_to_geog(m,e,c,d,b))&&l(h,e,b);return d}})(A=a.PeNotationUtm||(a.PeNotationUtm={}));var C;(function(b){var e=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=
a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(c,d){void 0===d&&(d=b.PE_PCSINFO_OPTION_DOMAIN);var h,l;e.has(c)&&(l=e.get(c),l[d]&&(h=l[d]));h||(h=a._pe.PePCSInfo.prototype.generate(c,d),l||(l=[],e.set(c,l)),l[d]=h);return h}})(C=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=d})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(y,a,q){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var c=0;for(a=a.steps;c<a.length;c++){var b=a[c];b instanceof q?this.steps.push(b):this.steps.push(new q({wkid:b.wkid,wkt:b.wkt,isInverse:b.isInverse}))}}}a.cacheKey=function(a,d){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==d.wkid&&null!==d.wkid?
d.wkid.toString():"-1",void 0!==d.wkt&&null!==d.wkt?d.wkt.toString():""].join()};a.fromGE=function(c){var d=new a,b="",e=0;for(c=c.steps;e<c.length;e++){var h=q.fromGE(c[e]);d.steps.push(h);b+=h.uid.toString()+","}d._cached_projection={};d._gtlistentry=null;d._chain=b;return d};a.prototype.getInverse=function(){var c=new a;c.steps=[];for(var d=this.steps.length-1;0<=d;d--)c.steps.push(this.steps[d].getInverse());return c};a.prototype.getGTListEntry=function(){for(var a="",d=0,b=this.steps;d<b.length;d++)a+=
b[d].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(c,d,b){this._cached_projection[a.cacheKey(c,d)]=b};a.prototype.getCachedGeTransformation=function(c,d){for(var b="",e=0,h=this.steps;e<h.length;e++)b+=h[e].uid.toString()+",";b!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=b);c=this._cached_projection[a.cacheKey(c,d)];return void 0===c?null:c};return a}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(y,a){var q=0;return function(){function a(a){void 0===a&&(a=null);this.uid=q++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(c){var d=new a;d._wkt=c.wkt;d._wkid=c.wkid;d._isInverse=c.isInverse;return d};Object.defineProperty(a.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=q++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var c=new a;c._wkt=this.wkt;c._wkid=this._wkid;
c._isInverse=!this.isInverse;return c};return a}()})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/extendsHelper @dojo/framework/shim/Map ../../../core/Error ../../../core/Evented ../../../core/has ../../../core/Logger ../../../core/maybe ../../../core/libs/rbush/rbush ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../featureConversionUtils ./optimizedFeatureQueryEngineAdapter".split(" "),
function(y,a,q,k,c,d,b,e,h,l,t,p,z,r,A,C){Object.defineProperty(a,"__esModule",{value:!0});var H=[],m=l.getLogger("esri.layers.graphics.data.FeatureStore"),B={minX:0,minY:0,maxX:0,maxY:0};y=function(){function a(a,b,c){this._geometryInfo=a;this._onFeatureAdd=b;this._onFeatureRemove=c;this._featuresById=new d.default;this._boundsByFeature=new d.default;this._featuresByBounds=new d.default;this._index=p(9,h("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]",
"[2]","[3]"]);this.events=new e;this.featureAdapter=C.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var a=r.create(r.NEGATIVE_INFINITY);this._boundsByFeature.forEach(function(b){b&&(a[0]=Math.min(b[0],a[0]),a[1]=Math.min(b[1],a[1]),a[2]=Math.max(b[2],a[2]),a[3]=Math.max(b[3],a[3]))});return a},enumerable:!0,configurable:!0});a.prototype.add=function(a){this._add(a,H);this._index.load(H);this._emitChanged();H.length=
0};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b],H);this._index.load(H);this._emitChanged();H.length=0};a.prototype.clear=function(){this._featuresById.clear();this._boundsByFeature.clear();this._featuresByBounds.clear();this._index.clear();this._emitChanged()};a.prototype.removeById=function(a){var b=this._featuresById.get(a);if(!b)return null;var e=this._boundsByFeature.get(b);e&&(this._index.remove(e),this._featuresByBounds.delete(e));this._boundsByFeature.delete(b);
this._featuresById.delete(a);this._emitChanged();return b};a.prototype.removeIf=function(a,b){var e=this;this._featuresById.forEach(function(c,d){b(c)&&(e._remove(c),a.push(c))});this._emitChanged()};a.prototype.removeManyById=function(a){for(var b=0;b<a.length;b++){var e=a[b],c=this._featuresById.get(e);if(c){var d=this._boundsByFeature.get(c);d&&(this._index.remove(d),this._featuresByBounds.delete(d));this._boundsByFeature.delete(c)}this._featuresById.delete(e)}this._emitChanged()};a.prototype.forEachBounds=
function(a,b,e){for(var c=0;c<a.length;c++){var d=this._boundsByFeature.get(a[c]);d&&b(z.fromRect(e,d))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var e=0,c=this._index;B.minX=a[0];B.minY=a[1];B.maxX=a[2];B.maxY=a[3];for(a=c.search(B);e<a.length;e++)b(this._featuresByBounds.get(a[e]))};
a.prototype.transferById=function(a,b){if(b=this._featuresById.get(b))this._remove(b),a.add(b),this._emitChanged()};a.prototype.transferByIds=function(a,b){for(var e=[],c=0;c<b.length;c++){var d=this._featuresById.get(b[c]);d&&(this._remove(d),e.push(d))}a.addMany(e);this._emitChanged()};a.prototype.transferIdRange=function(a,b,e){for(var c=[];b<e;b++){var d=this._featuresById.get(b);d&&(this._remove(d),c.push(d))}a.addMany(c);this._emitChanged()};a.prototype.transferIf=function(a,b){var e=this,c=
[];this._featuresById.forEach(function(a,d){b(a)&&(e._remove(a),c.push(a))});a.addMany(c);this._emitChanged()};a.prototype.transferAll=function(a){var b=this,e=[];this._featuresById.forEach(function(a,c){b._remove(a);e.push(a)});a.addMany(e);this._emitChanged()};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a,e){if(a){var c=a.objectId;if(null==c)m.error(new b("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var d=this._featuresById.get(c),
h;d?(h=this._boundsByFeature.get(d),a.localId=d.localId,h&&(this._index.remove(h),this._boundsByFeature.delete(d),this._featuresByBounds.delete(h))):t.isSome(this._onFeatureAdd)&&this._onFeatureAdd(a);a.geometry?(h=A.getBoundsOptimizedGeometry(h||r.create(),a.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(a,h),this._featuresByBounds.set(h,a),this._featuresById.set(c,a),e.push(h)):(this._boundsByFeature.set(a,null),this._featuresById.set(c,a))}}};a.prototype._remove=
function(a){var b;if(a){t.isSome(this._onFeatureRemove)&&this._onFeatureRemove(a);if(b=this._boundsByFeature.get(a))this._index.remove(b),this._boundsByFeature.delete(a),this._featuresByBounds.delete(b);this._featuresById.delete(a.objectId)}};return a}();a.default=y})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(y){function a(b,e){if(!(this instanceof a))return new a(b,e);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));
e&&("function"===typeof e?this.toBBox=e:this._initFormat(e));this.clear()}function q(a,b){k(a,0,a.children.length,b,a)}function k(a,b,e,d,h){h||(h=p(null));h.minX=Infinity;h.minY=Infinity;h.maxX=-Infinity;h.maxY=-Infinity;for(var l;b<e;b++)l=a.children[b],c(h,a.leaf?d(l):l);return h}function c(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function d(a,b){return a.minX-b.minX}function b(a,b){return a.minY-b.minY}
function e(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function h(a){return a.maxX-a.minX+(a.maxY-a.minY)}function l(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function t(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function p(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function z(a,b,e,c,d){for(var h=[b,e],l;h.length;)e=h.pop(),b=h.pop(),e-b<=c||(l=b+Math.ceil((e-b)/c/2)*c,y(a,l,b,e,d),
h.push(b,l,l,e))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,e=[],c=this.toBBox;if(!t(a,b))return e;for(var d=[],h,r,k,p;b;){h=0;for(r=b.children.length;h<r;h++)k=b.children[h],p=b.leaf?c(k):k,t(a,p)&&(b.leaf?e.push(k):l(a,p)?this._all(k,e):d.push(k));b=d.pop()}return e},collides:function(a){var b=this.data,e=this.toBBox;if(!t(a,b))return!1;for(var c=[],d,h,k,r;b;){d=0;for(h=b.children.length;d<h;d++)if(k=b.children[d],r=b.leaf?e(k):k,t(a,r)){if(b.leaf||
l(a,r))return!0;c.push(k)}b=c.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,e=a.length;b<e;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},
clear:function(){this.data=p([]);return this},remove:function(a,b){if(!a)return this;for(var e=this.data,c=this.toBBox(a),d=[],h=[],k,r,p,t;e||d.length;){e||(e=d.pop(),r=d[d.length-1],k=h.pop(),t=!0);if(e.leaf){a:{p=a;var A=e.children,z=b;if(z){for(var q=0;q<A.length;q++)if(z(p,A[q])){p=q;break a}p=-1}else p=A.indexOf(p)}if(-1!==p){e.children.splice(p,1);d.push(e);this._condense(d);break}}t||e.leaf||!l(e,c)?r?(k++,e=r.children[k],t=!1):e=null:(d.push(e),h.push(k),k=0,r=e,e=e.children[0])}return this},
toBBox:function(a){return a},compareMinX:d,compareMinY:b,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var e=[];a;)a.leaf?b.push.apply(b,a.children):e.push.apply(e,a.children),a=e.pop();return b},_build:function(a,b,e,c){var d=e-b+1,h=this._maxEntries,l;if(d<=h)return l=p(a.slice(b,e+1)),q(l,this.toBBox),l;c||(c=Math.ceil(Math.log(d)/Math.log(h)),h=Math.ceil(d/Math.pow(h,c-1)));l=p([]);l.leaf=!1;l.height=c;var d=Math.ceil(d/h),h=d*Math.ceil(Math.sqrt(h)),
k,r,t;for(z(a,b,e,h,this.compareMinX);b<=e;b+=h)for(r=Math.min(b+h-1,e),z(a,b,r,d,this.compareMinY),k=b;k<=r;k+=d)t=Math.min(k+d-1,r),l.children.push(this._build(a,k,t,c-1));q(l,this.toBBox);return l},_chooseSubtree:function(a,b,c,d){for(var h,l,k,r,p,t,A,q;;){d.push(b);if(b.leaf||d.length-1===c)break;A=q=Infinity;h=0;for(l=b.children.length;h<l;h++)k=b.children[h],p=e(k),t=(Math.max(k.maxX,a.maxX)-Math.min(k.minX,a.minX))*(Math.max(k.maxY,a.maxY)-Math.min(k.minY,a.minY))-p,t<q?(q=t,A=p<A?p:A,r=k):
t===q&&p<A&&(A=p,r=k);b=r||b.children[0]}return b},_insert:function(a,b,e){var d=this.toBBox;e=e?a:d(a);var d=[],h=this._chooseSubtree(e,this.data,b,d);h.children.push(a);for(c(h,e);0<=b;)if(d[b].children.length>this._maxEntries)this._split(d,b),b--;else break;this._adjustParentBBoxes(e,d,b)},_split:function(a,b){var e=a[b],d=e.children.length,c=this._minEntries;this._chooseSplitAxis(e,c,d);d=this._chooseSplitIndex(e,c,d);d=p(e.children.splice(d,e.children.length-d));d.height=e.height;d.leaf=e.leaf;
q(e,this.toBBox);q(d,this.toBBox);b?a[b-1].children.push(d):this._splitRoot(e,d)},_splitRoot:function(a,b){this.data=p([a,b]);this.data.height=a.height+1;this.data.leaf=!1;q(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,d){var c,h,l,p,r,t,q;r=t=Infinity;for(c=b;c<=d-b;c++)h=k(a,0,c,this.toBBox),l=k(a,c,d,this.toBBox),p=Math.max(0,Math.min(h.maxX,l.maxX)-Math.max(h.minX,l.minX))*Math.max(0,Math.min(h.maxY,l.maxY)-Math.max(h.minY,l.minY)),h=e(h)+e(l),p<r?(r=p,q=c,t=h<t?h:t):p===r&&h<t&&(t=
h,q=c);return q},_chooseSplitAxis:function(a,e,c){var h=a.leaf?this.compareMinX:d,l=a.leaf?this.compareMinY:b,k=this._allDistMargin(a,e,c,h);e=this._allDistMargin(a,e,c,l);k<e&&a.children.sort(h)},_allDistMargin:function(a,b,e,d){a.children.sort(d);d=this.toBBox;var l=k(a,0,b,d),p=k(a,e-b,e,d),r=h(l)+h(p),t,q;for(t=b;t<e-b;t++)q=a.children[t],c(l,a.leaf?d(q):q),r+=h(l);for(t=e-b-1;t>=b;t--)q=a.children[t],c(p,a.leaf?d(q):q),r+=h(p);return r},_adjustParentBBoxes:function(a,b,e){for(;0<=e;e--)c(b[e],
a)},_condense:function(a){for(var b=a.length-1,e;0<=b;b--)0===a[b].children.length?0<b?(e=a[b-1].children,e.splice(e.indexOf(a[b]),1)):this.clear():q(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],
function(){function y(k,c,d,b,e){for(;b>d;){if(600<b-d){var h=b-d+1,l=c-d+1,t=Math.log(h),p=.5*Math.exp(2*t/3),t=.5*Math.sqrt(t*p*(h-p)/h)*(0>l-h/2?-1:1);y(k,c,Math.max(d,Math.floor(c-l*p/h+t)),Math.min(b,Math.floor(c+(h-l)*p/h+t)),e)}h=k[c];l=d;p=b;a(k,d,c);for(0<e(k[b],h)&&a(k,d,b);l<p;){a(k,l,p);l++;for(p--;0>e(k[l],h);)l++;for(;0<e(k[p],h);)p--}0===e(k[d],h)?a(k,d,p):(p++,a(k,p,b));p<=c&&(d=p+1);c<=p&&(b=p-1)}}function a(a,c,d){var b=a[c];a[c]=a[d];a[d]=b}function q(a,c){return a<c?-1:a>c?1:0}
return function(a,c,d,b,e){y(a,c,d||0,b||a.length-1,e||q)}})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(y,a,q,k,c,d,b,e){function h(a,b){return a?b?4:3:b?3:2}function l(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function t(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function p(a,b){return b*
a.scale[0]+a.translate[0]}function z(a,b){return a.translate[1]-b*a.scale[1]}function r(a){a=a.coords;return{x:a[0],y:a[1]}}function A(a,b){a.coords[0]=b.x;a.coords[1]=b.y;return a}function C(a){a=a.coords;return{x:a[0],y:a[1],z:a[2]}}function H(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;return a}function m(a){a=a.coords;return{x:a[0],y:a[1],m:a[2]}}function B(a,b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.m;return a}function I(a){a=a.coords;return{x:a[0],y:a[1],z:a[2],m:a[3]}}function x(a,
b){a.coords[0]=b.x;a.coords[1]=b.y;a.coords[2]=b.z;a.coords[3]=b.m;return a}function S(a,b){return a&&b?x:a?H:b?B:A}function N(a,b,e){if(!a)return null;for(var d=h(b,e),c=[],n=0;n<a.coords.length;n+=d){for(var l=[],F=0;F<d;F++)l.push(a.coords[n+F]);c.push(l)}return b?e?{points:c,hasZ:b,hasM:e}:{points:c,hasZ:b}:e?{points:c,hasM:e}:{points:c}}function D(a,b,e){void 0===e&&(e=h(b.hasZ,b.hasM));a.lengths[0]=b.points.length;var d=a.coords,c=0,n=0;for(b=b.points;n<b.length;n++)for(var l=b[n],F=0;F<e;F++)d[c++]=
l[F];return a}function ba(a,b,e){if(!a)return null;var d=h(b,e),c=a.coords,n=[],l=0,F=0;for(a=a.lengths;F<a.length;F++){for(var w=a[F],k=[],m=0;m<w;m++){for(var J=[],G=0;G<d;G++)J.push(c[l++]);k.push(J)}n.push(k)}return b?e?{paths:n,hasZ:b,hasM:e}:{paths:n,hasZ:b}:e?{paths:n,hasM:e}:{paths:n}}function Q(a,b,e){void 0===e&&(e=h(b.hasZ,b.hasM));var d=a.lengths,c=a.coords,n=0,l=0;for(b=b.paths;l<b.length;l++){for(var F=b[l],w=0,k=F;w<k.length;w++)for(var m=k[w],J=0;J<e;J++)c[n++]=m[J];d.push(F.length)}return a}
function ca(a,b,e){if(!a)return null;var d=h(b,e),c=a.coords,n=[],l=0,F=0;for(a=a.lengths;F<a.length;F++){for(var w=a[F],k=[],m=0;m<w;m++){for(var J=[],G=0;G<d;G++)J.push(c[l++]);k.push(J)}n.push(k)}return b?e?{rings:n,hasZ:b,hasM:e}:{rings:n,hasZ:b}:e?{rings:n,hasM:e}:{rings:n}}function ga(a,b,e,d){void 0===e&&(e=b.hasZ);void 0===d&&(d=b.hasM);e=h(e,d);d=a.lengths;var c=a.coords,n=0,l=d.length=c.length=0;for(b=b.rings;l<b.length;l++){for(var w=b[l],F=0,k=w;F<k.length;F++)for(var m=k[F],J=0;J<e;J++)c[n++]=
m[J];d.push(w.length)}return a}function X(a,b,c,n,l,w){a.length=0;if(!c){for(n=0;n<b.length;n++)l=b[n],a.push(new d.default(null,l.attributes,null,l.attributes[w]));return a}switch(c){case "esriGeometryPoint":n=S(n,l);for(l=0;l<b.length;l++){var F=b[l];c=F.geometry;var F=F.attributes,k=void 0;c&&(k=n(new e.default,c));a.push(new d.default(k,F,null,F[w]))}break;case "esriGeometryMultipoint":n=h(n,l);for(l=0;l<b.length;l++)F=b[l],c=F.geometry,F=F.attributes,k=void 0,c&&(k=D(new e.default,c,n)),a.push(new d.default(k,
F,null,F[w]));break;case "esriGeometryPolyline":n=h(n,l);for(l=0;l<b.length;l++)F=b[l],c=F.geometry,F=F.attributes,k=void 0,c&&(k=Q(new e.default,c,n)),a.push(new d.default(k,F,null,F[w]));break;case "esriGeometryPolygon":for(c=0;c<b.length;c++){var J=b[c],F=J.geometry,k=J.centroid,J=J.attributes,m=void 0;F&&(m=ga(new e.default,F,n,l));k?a.push(new d.default(m,J,A(new e.default,k),J[w])):a.push(new d.default(m,J,null,J[w]))}break;default:E.error("convertToFeatureSet:unknown-geometry",new q("Unable to parse unknown geometry type '"+
c+"'")),a.length=0}return a}function L(a,b,e,c,d){a.length=0;switch(e){case "esriGeometryPoint":e=r;c&&d?e=I:c?e=C:d&&(e=m);for(c=0;c<b.length;c++){var h=b[c];d=h.geometry;h=h.attributes;d=d?e(d):null;a.push({attributes:h,geometry:d})}break;case "esriGeometryMultipoint":for(e=0;e<b.length;e++){var n=b[e],h=n.geometry,n=n.attributes,l=void 0;h&&(l=N(h,c,d));a.push({attributes:n,geometry:l})}break;case "esriGeometryPolyline":for(e=0;e<b.length;e++)n=b[e],h=n.geometry,n=n.attributes,l=void 0,h&&(l=ba(h,
c,d)),a.push({attributes:n,geometry:l});break;case "esriGeometryPolygon":for(e=0;e<b.length;e++){var l=b[e],n=l.geometry,h=l.attributes,w=l.centroid,l=void 0;n&&(l=ca(n,c,d));w?(n=r(w),a.push({attributes:h,centroid:n,geometry:l})):a.push({attributes:h,geometry:l})}break;default:E.error("convertToFeatureSet:unknown-geometry",new q("Unable to parse unknown geometry type '"+e+"'"))}return a}function n(a,b,e,c,d,n){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;
d=oa[d];var w=b.coords;b=b.lengths;var F=h(e,c);e=e?c?Da:V:c?V:J;if(!b.length)return e(a.coords,w,0,0,l(n,w[0]),t(n,w[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=F,a;for(var k,m,G,E=0,p,B=0,L=0;L<b.length;L++){var r=b[L];if(!(r<d)){var Y=0;p=B;m=c=l(n,w[E]);G=k=t(n,w[E+1]);e(a.coords,w,p,E,m,G);Y++;E+=F;p+=F;for(var x=1;x<r;x++,E+=F)if(m=l(n,w[E]),G=t(n,w[E+1]),m!==c||G!==k)e(a.coords,w,p,E,m-c,G-k),p+=F,Y++,c=m,k=G;Y>=d&&(a.lengths.push(Y),B=p)}}a.coords.length=B;return a.coords.length?
a:null}function w(a,b,e,c,d,h,n){for(var l=n-e,k=0,F=0,m,J=h+e;J<n-e;J+=e){m=b[J];var G=b[J+1],E=b[h],p=b[h+1],B=b[l],t=b[l+1];E===B?m=Math.abs(m-E):(B=(t-p)/(B-E),m=Math.abs(B*m-G+(p-B*E))/Math.sqrt(B*B+1));m>k&&(F=J,k=m)}k>c?(w(a,b,e,c,d,h,F+e),w(a,b,e,c,d,F,n)):(d(a,b,a.length,h,b[h],b[h+1]),d(a,b,a.length,l,b[l],b[l+1]))}function G(a,b,e,c,d){var n=b.coords,l=b.lengths,w=e?c?Da:V:c?V:J;e=h(e,c);if(!n.length)return a!==b&&(a.lengths.length=0,a.coords.length=0),a;if(!l.length)return w(a.coords,
n,0,0,p(d,n[0]),z(d,n[1])),a!==b&&(a.lengths.length=0,a.coords.length=e),a;var k=d.scale;c=k[0];for(var k=k[1],F=0,m=0;m<l.length;m++){var G=l[m];a.lengths[m]=G;var E=p(d,n[F]),B=z(d,n[F+1]);w(a.coords,n,F,F,E,B);for(var F=F+e,t=1;t<G;t++,F+=e)E+=n[F]*c,B-=n[F+1]*k,w(a.coords,n,F,F,E,B)}a!==b&&(a.lengths.length=l.length,a.coords.length=n.length);return a}Object.defineProperty(a,"__esModule",{value:!0});var E=k.getLogger("esri.tasks.support.optimizedFeatureSet"),oa={esriGeometryPoint:0,esriGeometryPolyline:2,
esriGeometryPolygon:3,esriGeometryMultipoint:0},J=function(a,b,e,c,d,h){a[e]=d;a[e+1]=h},V=function(a,b,e,c,d,h){a[e]=d;a[e+1]=h;a[e+2]=b[c+2]},Da=function(a,b,e,c,d,h){a[e]=d;a[e+1]=h;a[e+2]=b[c+2];a[e+3]=b[c+3]};a.quantizeX=l;a.quantizeY=t;a.hydrateX=p;a.hydrateY=z;a.convertToPoint=function(a,b,e){return a?b?e?I(a):C(a):e?m(a):r(a):null};a.convertFromPoint=function(a,b,e){void 0===e&&(e=S(null!=b.z,null!=b.m));return e(a,b)};a.convertToMultipoint=N;a.convertFromMultipoint=D;a.convertToPolyline=
ba;a.convertToPolygon=ca;a.convertFromPolygon=ga;var ua=[],W=[];a.convertFromFeature=function(a,b,e,c,d){ua[0]=a;a=X(W,ua,b,e,c,d)[0];ua.length=W.length=0;return a};a.convertFromFeatures=X;a.convertToFeature=function(a,b,e,c){W[0]=a;L(ua,W,b,e,c);a=ua[0];ua.length=W.length=0;return a};a.convertFromGeometry=function(a,b,d){if(!a)return null;var n=new e.default;"hasZ"in a&&null==b&&(b=a.hasZ);"hasM"in a&&null==d&&(d=a.hasM);if(c.isPoint(a))return S(null!=b?b:null!=a.z,null!=d?d:null!=a.m)(n,a);if(c.isPolygon(a))return ga(n,
a,b,d);if(c.isPolyline(a))return Q(n,a,h(b,d));if(c.isMultipoint(a))return D(n,a,h(b,d));E.error("convertFromGeometry:unknown-geometry",new q("Unable to parse unknown geometry type '"+a+"'"))};a.convertToGeometry=function(a,b,e,d){a=a&&("coords"in a?a:a.geometry);if(!a)return null;switch(b){case "esriGeometryPoint":return b=r,e&&d?b=I:e?b=C:d&&(b=m),b(a);case "esriGeometryMultipoint":return N(a,e,d);case "esriGeometryPolyline":return ba(a,e,d);case "esriGeometryPolygon":return ca(a,e,d);default:E.error("convertToGeometry:unknown-geometry",
new q("Unable to parse unknown geometry type '"+b+"'"))}};a.convertToFeatures=L;a.convertToFeatureSet=function(a){var b=a.objectIdFieldName,e=a.spatialReference,d=a.transform,c=a.fields,h=a.hasM,n=a.hasZ,l=a.geometryType,w=a.exceededTransferLimit;a={features:L([],a.features,l,n,h),fields:c,geometryType:l,objectIdFieldName:b,spatialReference:e};d&&(a.transform=d);w&&(a.exceededTransferLimit=w);h&&(a.hasM=h);n&&(a.hasZ=n);return a};a.convertFromFeatureSet=function(a,e){var d=new b.default,c=a.hasM,
h=a.hasZ,n=a.features,l=a.objectIdFieldName,w=a.spatialReference,k=a.geometryType,m=a.exceededTransferLimit,J=a.transform;d.fields=a.fields;d.geometryType=k;d.objectIdFieldName=l||e;d.spatialReference=w;if(!d.objectIdFieldName)return E.error(new q("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),d;n&&X(d.features,n,k,h,c,d.objectIdFieldName);m&&(d.exceededTransferLimit=m);c&&(d.hasM=c);h&&(d.hasZ=h);J&&(d.transform=J);return d};a.hydrateOptimizedFeatureSet=function(a){var b=
a.transform,e=a.hasM,d=a.hasZ;if(!b)return a;for(var c=0,h=a.features;c<h.length;c++){var n=h[c];n.geometry&&G(n.geometry,n.geometry,e,d,b);n.centroid&&G(n.centroid,n.centroid,e,d,b)}a.transform=null;return a};a.quantizeOptimizedFeatureSet=function(a,b){var c=b.geometryType,h=b.features,l=b.hasM,w=b.hasZ;if(!a)return b;for(var k=0;k<h.length;k++){var m=h[k],J=new d.default(new e.default,m.attributes);n(J.geometry,m.geometry,l,w,c,a);m.centroid&&(J.centroid=new e.default,n(J.centroid,m.centroid,l,
w,"esriGeometryPoint",a));h[k]=J}b.transform=a;return b};a.quantizeOptimizedGeometry=n;a.quantizeOptimizedGeometryRemoveCollinear=function(a,b,e,d,c,n){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;c=oa[c];var w=b.coords;b=b.lengths;var k=h(e,d);e=e?d?Da:V:d?V:J;if(!b.length)return e(a.coords,w,0,0,l(n,w[0]),t(n,w[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=k,a;for(var m,G,E,p=0,B,L=0,r=0;r<b.length;r++){var F=b[r];
if(!(F<c)){var x=0;B=L;d=m=l(n,w[p]);E=G=t(n,w[p+1]);e(a.coords,w,B,p,d,E);x++;for(var p=p+k,q=!1,z=0,I=0,D=1;D<F;D++,p+=k)if(d=l(n,w[p]),E=t(n,w[p+1]),d!==m||E!==G)m=d-m,G=E-G,q&&(0===z&&0===m||0===I&&0===G)?(z+=m,I+=G):(q=!0,z=m,I=G,B+=k,x++),e(a.coords,w,B,p,z,I),m=d,G=E;q&&(B+=k,e(a.coords,w,B,p,z,I));x>=c&&(a.lengths.push(x),L=B)}}a.coords.length!==L&&(a.coords.length=L);return a.coords.length?a:null};a.generalizeOptimizedGeometry=function(a,b,e,d,c,n){a.lengths.length&&(a.lengths.length=0);
a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;c=oa[c];var l=b.coords;b=b.lengths;var k=h(e,d);e=e?d?Da:V:d?V:J;if(!b.length)return e(a.coords,l,0,0,l[0],l[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=k,a;for(var m=d=0;m<b.length;m++){var G=b[m];if(!(G<c)){var E=a.coords.length/k;w(a.coords,l,k,n,e,d,d+G*k);var p=a.coords.length/k-E;p>=c?a.lengths.push(p):a.coords.length=E*k}d+=G*k}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(a,b,e,d){e=
h(e,d);var c=d=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY;if(b&&b.coords){b=b.coords;for(var w=0;w<b.length;w+=e){var k=b[w],m=b[w+1];d=Math.min(d,k);n=Math.max(n,k);c=Math.min(c,m);l=Math.max(l,m)}}a[0]=d;a[1]=c;a[2]=n;a[3]=l;return a};a.getQuantizedBoundsOptimizedGeometry=function(a,b,e,d){e=h(e,d);d=b.coords;var c=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,w=Number.NEGATIVE_INFINITY,k=0,m=0;for(b=b.lengths;m<b.length;m++)for(var J=
b[m],G=d[k],E=d[k+1],c=Math.min(G,c),n=Math.min(E,n),l=Math.max(G,l),w=Math.max(E,w),k=k+e,p=1;p<J;p++,k+=e){var B=d[k],t=d[k+1],G=G+B,E=E+t;0>B&&(c=Math.min(c,G));0<B&&(l=Math.max(l,G));0>t?n=Math.min(n,E):0<t&&(w=Math.max(w,E))}a[0]=c;a[1]=n;a[2]=l;a[3]=w;return a};a.hydrateOptimizedGeometry=G})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(y,a,q,k,c){Object.defineProperty(a,
"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new k.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,b){a.centroid||(a.centroid=q.getCentroidOptimizedGeometry(new c.default,a.geometry,b.hasZ,b.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},
"esri/layers/graphics/centroid":function(){define(["require","exports"],function(y,a){function q(a,d,b,e,h,l){l=h?l?4:3:l?3:2;var c=b,k=b+l,q=0,r=0,A=b=0,C=0,H=0;for(--e;H<e;H++,c+=l,k+=l){var m=d[c],B=d[c+1],I=d[c+2],x=d[k],S=d[k+1],N=d[k+2],D=m*S-x*B,A=A+D,q=q+(m+x)*D,r=r+(B+S)*D;h&&(D=m*N-x*I,b+=(I+N)*D,C+=D);m<a[0]&&(a[0]=m);m>a[1]&&(a[1]=m);B<a[2]&&(a[2]=B);B>a[3]&&(a[3]=B);h&&(I<a[4]&&(a[4]=I),I>a[5]&&(a[5]=I))}0<A&&(A*=-1);0<C&&(C*=-1);if(!A)return null;a=[q,r,.5*A];h&&(a[3]=b,a[4]=.5*C);return a}
function k(a,d,b,e,h){h=e?h?4:3:h?3:2;for(var c=d,k=d+h,p=0,q=0,r=0,A=0,C=0,H=b-1;C<H;C++,c+=h,k+=h){var m=a[c],B=a[c+1],I=a[c+2],x=a[k],S=a[k+1],N=a[k+2],D;if(e){D=x-m;var y=S-B,Q=N-I;D=Math.sqrt(D*D+y*y+Q*Q)}else D=x-m,y=S-B,D=Math.sqrt(D*D+y*y);D&&(p+=D,e?(m=[m+.5*(x-m),B+.5*(S-B),I+.5*(N-I)],q+=D*m[0],r+=D*m[1],A+=D*m[2]):(m=[m+.5*(x-m),B+.5*(S-B)],q+=D*m[0],r+=D*m[1]))}return 0<p?e?[q/p,r/p,A/p]:[q/p,r/p]:0<b?e?[a[d],a[d+1],a[d+2]]:[a[d],a[d+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});
a.getCentroidOptimizedGeometry=function(a,d,b,e){if(!d||!d.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var c=a.coords,l=[],t=b?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],p=d.lengths,z=d.coords,r=b?e?4:3:e?3:2,A=0,C=0;C<p.length;C++){var y=
p[C],m=q(t,z,A,y,b,e);m&&l.push(m);A+=y*r}l.sort(function(a,e){var d=a[2]-e[2];0===d&&b&&(d=a[4]-e[4]);return d});l.length&&(r=6*l[0][2],c[0]=l[0][0]/r,c[1]=l[0][1]/r,b&&(r=6*l[0][4],c[2]=0!==r?l[0][3]/r:0),c[0]<t[0]||c[0]>t[1]||c[1]<t[2]||c[1]>t[3]||b&&(c[2]<t[4]||c[2]>t[5]))&&(c.length=0);if(!c.length)if(d=d.lengths[0]?k(z,0,p[0],b,e):null)c[0]=d[0],c[1]=d[1],b&&2<d.length&&(c[2]=d[2]);else return null;return a};a.lineCentroid=k})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(y,a,q,k,c,d,b,e,h){function l(a,b){var e;if(!b)return null;if("x"in b){var d={x:0,y:0};a=a(b.x,b.y,r);d.x=a[0];d.y=a[1];null!=b.z&&(d.z=b.z);null!=b.m&&(d.m=b.m);return d}if("xmin"in b)return d={xmin:0,ymin:0,xmax:0,ymax:0},e=a(b.xmin,b.ymin,r),d.xmin=e[0],d.ymin=e[1],a=a(b.xmax,b.ymax,r),d.xmax=a[0],d.ymax=a[1],b.hasZ&&(d.zmin=b.zmin,d.zmax=b.zmax,d.hasZ=!0),b.hasM&&(d.mmin=b.mmin,d.mmax=b.mmax,d.hasM=!0),d;if("rings"in b)return{rings:t(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:t(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:p(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function t(a,b){for(var e=[],d=0;d<a.length;d++)e.push(p(a[d],b));return e}function p(a,b){for(var e=[],d=0;d<a.length;d++){var c=a[d],h=b(c[0],c[1],[0,0]);e.push(h);2<c.length&&h.push(c[2]);3<c.length&&h.push(c[3])}return e}function z(a,b){return!e.isValid(a)||!e.isValid(b)||e.equals(a,b)||h.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var r=[0,0];a.checkProjectionSupport=function(a,
e){return k(this,void 0,void 0,function(){var d,h,l;return q(this,function(k){if(!e)return[2];if(Array.isArray(a)){d=0;for(h=a;d<h.length;d++)if(l=h[d],z(l.geometry&&l.geometry.spatialReference,e)){if(b.isSupported())return[2,b.load()];throw new c("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:e});}return[2]}if(!z(a,e))return[2];if(b.isSupported())return[2,b.load()];throw new c("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,
outSpatialReference:e});})})};var A=l.bind(null,h.lngLatToXY),C=l.bind(null,h.xyToLngLat);a.project=function(a,d,c){c||(c=d,d=a.spatialReference);return e.isValid(d)&&e.isValid(c)&&!e.equals(d,c)?h.canProject(d,c)?e.isWebMercator(c)?A(a):C(a):b.projectMany([a],d,c,null,!0)[0]:a};var H=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,c){return k(this,void 0,void 0,function(){var h,l=this;return q(this,function(k){a&&a.length&&
b&&c&&!e.equals(b,c)||d.resolve(a);h={geometries:a,inSpatialReference:b,outSpatialReference:c,resolve:null};this._jobs.push(h);return[2,d.create(function(a){h.resolve=a;null===l._timer&&(l._timer=setTimeout(l._process,10))},function(){var a=l._jobs.indexOf(h);-1<a&&l._jobs.splice(a,1)})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var d=a.geometries,c=a.inSpatialReference,l=a.outSpatialReference,a=a.resolve;h.canProject(c,l)?e.isWebMercator(l)?a(d.map(A)):
a(d.map(C)):a(b.projectMany(d,c,l,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,e){return k(this,void 0,void 0,function(){return q(this,function(d){return[2,H.push(a,b,e)]})})}})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array @dojo/framework/shim/Map @dojo/framework/shim/Set ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(y,a,q,k,c,d,b,e,h,l,t,p,z,r,A,C,H,m,B,I,x,S,N,D,ba,Q,ca,ga){Object.defineProperty(a,"__esModule",{value:!0});var X=t.getLogger("esri.layers.graphics.data.QueryEngine");y=function(){return function(a,b,e,d,c){this.attributes=a;this.localId=b;this.geometry=e;this.centroid=d;this.filterFlags=c}}();a.Feature=y;var L=new e.default,n=new p.MemCacheStorage(2E6),w=0;y=function(){function a(a){var b=this;this.capabilities={query:S.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;
this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.gdbVersion=a.gdbVersion;this.historicMoment=a.historicMoment;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new p.MemCache(w++ +"$$",n));this.fieldsIndex=
new ca(a.fields);a.scheduler&&a.priority&&(this._frameQueue=new ga.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.priority,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=
null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:Q.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?
this._timeExtent?this._timeExtent:this._timeExtent=ba.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return c(this,void 0,void 0,function(){var b,e,d;return k(this,function(c){switch(c.label){case 0:b=l.clone(a),c.label=1;case 1:return c.trys.push([1,13,,14]),[4,Q.normalizeQuery(b,
this.definitionExpression,this.spatialReference)];case 2:return b=c.sent(),[4,this._reschedule()];case 3:return c.sent(),[4,this._checkQuerySupport(b)];case 4:return b=c.sent(),[4,this._reschedule()];case 5:return c.sent(),[4,this._executeGeometryQuery(b)];case 6:return e=c.sent(),[4,this._reschedule()];case 7:return c.sent(),[4,e.executeObjectIdsQuery(b)];case 8:return e=c.sent(),[4,this._reschedule()];case 9:return c.sent(),[4,e.executeTimeQuery(b)];case 10:return e=c.sent(),[4,this._reschedule()];
case 11:return c.sent(),[4,e.executeAttributesQuery(b)];case 12:return e=c.sent(),[3,14];case 13:d=c.sent();if(d!==Q.QUERY_ENGINE_EMPTY_RESULT)throw d;e=new N.default([],null,this);return[3,14];case 14:return[2,e.createQueryResponse(b)]}})})};a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return c(this,void 0,void 0,function(){var b,e,d;return k(this,function(c){switch(c.label){case 0:b=l.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,c.label=1;case 1:return c.trys.push([1,
13,,14]),[4,Q.normalizeQuery(b,this.definitionExpression,this.spatialReference)];case 2:return b=c.sent(),[4,this._reschedule()];case 3:return c.sent(),[4,this._checkQuerySupport(b)];case 4:return b=c.sent(),[4,this._reschedule()];case 5:return c.sent(),[4,this._executeGeometryQuery(b)];case 6:return e=c.sent(),[4,this._reschedule()];case 7:return c.sent(),[4,e.executeObjectIdsQuery(b)];case 8:return e=c.sent(),[4,this._reschedule()];case 9:return c.sent(),[4,e.executeTimeQuery(b)];case 10:return e=
c.sent(),[4,this._reschedule()];case 11:return c.sent(),[4,e.executeAttributesQuery(b)];case 12:return e=c.sent(),[2,e.size];case 13:d=c.sent();if(d!==Q.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 14:return[2]}})})};a.prototype.executeQueryForExtent=function(a,b){void 0===a&&(a={});return c(this,void 0,void 0,function(){var b,e,d,c,n,h,w,m;return k(this,function(k){switch(k.label){case 0:b=l.clone(a),d=b.outSR,k.label=1;case 1:return k.trys.push([1,13,,14]),[4,Q.normalizeQuery(b,this.definitionExpression,
this.spatialReference)];case 2:return b=k.sent(),[4,this._reschedule()];case 3:return k.sent(),[4,this._checkQuerySupport(b)];case 4:return b=k.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule()];case 5:return k.sent(),[4,this._executeGeometryQuery(b)];case 6:return e=k.sent(),[4,this._reschedule()];case 7:return k.sent(),[4,e.executeObjectIdsQuery(b)];case 8:return e=k.sent(),[4,this._reschedule()];case 9:return k.sent(),[4,e.executeTimeQuery(b)];case 10:return e=k.sent(),
[4,this._reschedule()];case 11:return k.sent(),[4,e.executeAttributesQuery(b)];case 12:e=k.sent();c=e.size;if(!c)return[2,{count:c,extent:null}];A.set(E,A.NEGATIVE_INFINITY);this.featureStore.forEachBounds(e.items,function(a){return A.expand(E,a)},G);n={xmin:E[0],ymin:E[1],xmax:E[3],ymax:E[4],spatialReference:Q.cleanFromGeometryEngine(this.spatialReference)};this.hasZ&&isFinite(E[2])&&isFinite(E[5])&&(n.zmin=E[2],n.zmax=E[5]);h=x.project(n,e.spatialReference,d);h.spatialReference=Q.cleanFromGeometryEngine(d||
this.spatialReference);0===h.xmax-h.xmin&&(w=r.getMetersPerUnitForSR(h.spatialReference),h.xmin-=w,h.xmax+=w);0===h.ymax-h.ymin&&(w=r.getMetersPerUnitForSR(h.spatialReference),h.ymin-=w,h.ymax+=w);this.hasZ&&null!=h.zmin&&null!=h.zmax&&0===h.zmax-h.zmin&&(w=r.getMetersPerUnitForSR(h.spatialReference),h.zmin-=w,h.zmax+=w);return[2,{count:c,extent:h}];case 13:m=k.sent();if(m===Q.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw m;case 14:return[2]}})})};a.prototype.executeQueryForIds=
function(a,b){void 0===a&&(a={});return c(this,void 0,void 0,function(){return k(this,function(e){return[2,this.executeQueryForIdSet(a,b).then(function(a){return d.from(a)})]})})};a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return c(this,void 0,void 0,function(){var b,d,c,h,n,w,G,m;return k(this,function(k){switch(k.label){case 0:b=l.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,k.label=1;case 1:return k.trys.push([1,12,,13]),[4,Q.normalizeQuery(b,this.definitionExpression,
this.spatialReference)];case 2:return b=k.sent(),[4,this._reschedule()];case 3:return k.sent(),[4,this._executeGeometryQuery(b)];case 4:return d=k.sent(),[4,this._reschedule()];case 5:return k.sent(),[4,d.executeObjectIdsQuery(b)];case 6:return d=k.sent(),[4,this._reschedule()];case 7:return k.sent(),[4,d.executeTimeQuery(b)];case 8:return d=k.sent(),[4,this._reschedule()];case 9:return k.sent(),[4,d.executeAttributesQuery(b)];case 10:return d=k.sent(),[4,this._reschedule()];case 11:k.sent();c=d.items;
h=new e.default;n=0;for(w=c;n<w.length;n++)G=w[n],h.add(d.featureAdapter.getObjectId(G));return[2,h];case 12:m=k.sent();if(m===Q.QUERY_ENGINE_EMPTY_RESULT)return[2,new e.default];throw m;case 13:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,b){var e=this;if(this.timeInfo)return this.executeQuery(a,b).then(function(a){return e._filterLatest(a,e.timeInfo)});X.error(new h("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};a.prototype._reschedule=
function(a){return c(this,void 0,void 0,function(){return k(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a).then(function(a){return a})]:[2,a]})})};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._filterLatest=function(a,e){var d=e.trackIdField,c=e.startTimeField;e=e.endTimeField||c;for(var c=new b.default,h=[],n=0,l=a.features;n<l.length;n++){var k=l[n],w=k.attributes[d],
m=k.attributes[e];(!c.has(w)||c.get(w).attributes[e]<m)&&c.set(w,k)}c.forEach(function(a){return h.push(a)});return q({},a,{features:h})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new N.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return c(this,void 0,void 0,function(){var b,d,h,n,l,w,m,G,E,p,J,L,t,r,q,z,x,oa,A,ca,C,I,y,S,H=this;return k(this,function(V){switch(V.label){case 0:b=
a.geometry;d=a.outSR;h=a.spatialRel;n=B.isValid(d)&&!B.equals(this.spatialReference,d);if(l=this.cacheSpatialQueries?n?JSON.stringify({geometry:b,spatialRelationship:h,outSpatialReference:d}):JSON.stringify({geometry:b,spatialRelationship:h}):null)if(w=this._geometryQueryCache.get(l),void 0!==w)return[2,w];m=function(b){return c(H,void 0,void 0,function(){var e;return k(this,function(c){switch(c.label){case 0:return n&&(a.returnGeometry||a.returnCentroid)?[4,b.project(d)]:[3,2];case 1:return e=c.sent(),
l&&this._geometryQueryCache.put(l,e,e.size||1),[2,e];case 2:return l&&this._geometryQueryCache.put(l,b,b.size||1),[2,b]}})})};if(!b)return[2,m(this._getAll())];G=this.featureAdapter;if("esriSpatialRelDisjoint"!==h)return[3,5];E=this._searchFeatures(this._getQueryBBoxes(b));if(!E.length)return[2,m(this._getAll())];L=new e.default;t=0;for(r=E;t<r.length;t++)q=r[t],L.add(G.getObjectId(q));return[4,this._reschedule(L)];case 1:return L=V.sent(),z=0,p=Array(L.size),this.featureStore.forEach(function(a){return p[z++]=
a}),J=L,[4,this._reschedule()];case 2:return V.sent(),[4,D.getSpatialQueryOperator(h,b,this)];case 3:return x=V.sent(),oa=function(a){return!J.has(G.getObjectId(a))||x(G.getGeometry(a))},ca=N.default.bind,[4,this._runSpatialFilter(p,oa)];case 4:return A=new (ca.apply(N.default,[void 0,V.sent(),b,this])),[2,m(A)];case 5:return C=this._searchFeatures(this._getQueryBBoxes(b)),C.length?(I=this._canExecuteSoloPass(b,a))?[2,m(new N.default(C,b,this))]:[4,D.getSpatialQueryOperator(h,b,this)]:(A=new N.default([],
b,this),l&&this._geometryQueryCache.put(l,A,A.size||1),[2,A]);case 6:return y=V.sent(),[4,this._runSpatialFilter(C,function(a){return y(G.getGeometry(a))})];case 7:return S=V.sent(),[2,m(new N.default(S,b,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return c(this,void 0,void 0,function(){var e,d,h,n=this;return k(this,function(l){if(!b)return[2,a];if(!this._budget)return[2,a.filter(function(a){return b(a)})];e=0;d=[];h=function(){return c(n,void 0,void 0,function(){var c;return k(this,
function(n){switch(n.label){case 0:if(!(e<a.length))return[3,3];c=a[e];b(c)&&d.push(c);return this._budget.done?[4,this._reschedule()]:[3,2];case 1:return n.sent(),[2,h()];case 2:return++e,[3,0];case 3:return[2]}})})};return[2,this._reschedule().then(function(){return h()}).then(function(){return d})]})})};a.prototype._canExecuteSoloPass=function(a,b){var e=this.geometryType;b=b.spatialRel;return D.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===e&&("esriSpatialRelIntersects"===
b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(D.canQueryWithRBush(a)){if(m.isExtent(a))return[C.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(m.isPolygon(a))return a.rings.map(function(a){return C.fromValues(a[0][0],a[0][1],a[2][0],a[2][1])})}return[H.getBoundsXY(C.create(),a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){L.add(a)});var e=Array(L.size),d=0;L.forEach(function(a){return e[d++]=
a});L.clear();return e};a.prototype._checkQuerySupport=function(a){return c(this,void 0,void 0,function(){return k(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new h("feature-store:unsupported-query","Unsupported query options",{query:a});return[2,z.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),D.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),x.checkProjectionSupport(this.spatialReference,
a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,e=a.orderByFields,d=a.returnDistinctValues;e&&0<e.length&&(e=e.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),I.validateFields(this.fieldsIndex,e,"orderByFields contains missing fields"));if(b&&0<b.length)I.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(d)throw new h("feature-store:unsupported-query",
"outFields should be specified for returnDistinctValues",{query:a});I.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return c(this,void 0,void 0,function(){var b,e,d,c,n,l,w,m,G,E,p,L;return k(this,function(k){b=a.outStatistics;e=a.groupByFieldsForStatistics;d=a.having;c=e&&e.length;n=b&&b.length;if(d){if(!c||!n)throw new h("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});I.validateHaving(this.fieldsIndex,
d,b)}if(n){if(l=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];w=b.map(function(a){return a.onStatisticField});I.validateFields(this.fieldsIndex,w,"onStatisticFields contains missing fields");c&&I.validateFields(this.fieldsIndex,e,"groupByFieldsForStatistics contains missing fields");m=0;for(G=b;m<G.length;m++){E=G[m];p=E.onStatisticField;L=E.statisticType;if("exceedslimit"===L)throw new h("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:E,
query:a});if((!c||"count"!==L)&&p&&I.hasInvalidFieldType(p,this.fieldsIndex))throw new h("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:E,query:a});}}return[2]})})};return a}();a.default=y;var G=A.create(),E=A.create()})},"esri/core/MemCache":function(){define(["require","exports","./iteratorUtils","./PooledArray","./string"],function(y,a,q,k,c){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,e,d){this._namespace=a;this._storage=
e;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";d&&(this._storage.registerRemoveFunc(this._namespace,d),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,e,d,c){void 0===c&&(c=1);this._storage.put(this._namespace+a,e,d,c)};a.prototype.get=function(a){a=
this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=y;y=function(){function a(a){void 0===
a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new k}a.prototype.register=function(a){this._users.push(a)};a.prototype.deregister=function(a){this._users.removeUnordered(a)};a.prototype.registerRemoveFunc=function(a,e){this._removeFuncs.push([a,e])};a.prototype.deregisterRemoveFunc=function(a){this._removeFuncs=this._removeFuncs.filter(function(b){return b[0]!==a})};Object.defineProperty(a.prototype,"size",{get:function(){return this._size},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._size>this._maxSize&&this._removeEntries()},enumerable:!0,configurable:!0});a.prototype.put=function(a,e,c,d){if(this._db.has(a)){var b=this._db.get(a);this._size-=b.size;this._db.delete(a);this._notifyRemoved(a,b.entry)}c>this._maxSize?this._notifyRemoved(a,e):void 0===e?console.warn("Refusing to cache undefined entry "):!c||0>c?console.warn("Refusing to cache entry with invalid size "+
c):(this._db.set(a,{entry:e,size:c,lifetime:d,lives:d}),this._size+=c,this._size>this._maxSize&&this._removeEntries())};a.prototype.pop=function(a){if(this._db.has(a)){var b=this._db.get(a);this._size-=b.size;this._db.delete(a);++this._hit;return b.entry}++this._miss};a.prototype.get=function(a){var b=this._db.get(a);if(void 0===b)++this._miss;else return this._db.delete(a),b.lives=b.lifetime,this._db.set(a,b),++this._hit,b.entry};a.prototype.getStats=function(){var a=this,e={Size:Math.round(this._size/
1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},d={},l=[];this._db.forEach(function(b,e){var h=b.lifetime;l[h]=(l[h]||0)+1;a._users.forEach(function(a){a=a.namespace;if(c.startsWith(e,a))return d[a]=(d[a]||0)+b.size,!1})});var k={};this._users.forEach(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(d[b]=d[b]||0,k[b]=Math.round(100*a.hitRate)+"%"):k[b]="0%"});var p=Object.keys(d);p.forEach(function(b){return d[b]=
d[b]/a._size*100});p.sort(function(a,b){return d[b]-d[a]});p.forEach(function(a){return e[a]=Math.round(d[a])+"% / "+k[a]});for(p=0;p<l.length;++p){var q=l[p];q&&(e["Lifetime "+p]=Math.round(q/this._db.size*100)+"%")}return e};a.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};a.prototype.clear=function(a){var b=this;this._db.forEach(function(e,d){c.startsWith(d,a)&&(b._size-=e.size,b._db.delete(d),b._notifyRemoved(d,e.entry))})};a.prototype.clearAll=
function(){var a=this;this._db.forEach(function(b,d){a._notifyRemoved(d,b.entry)});this._size=0;this._db.clear()};a.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};a.prototype._notifyRemoved=function(a,e){this._removeFuncs.forEach(function(b){if(c.startsWith(a,b[0]))b[1](e)})};a.prototype._removeEntries=function(){var a=this;q.everyMap(this._db,function(b,d){a._db.delete(d);1>=b.lives?(a._size-=b.size,a._notifyRemoved(d,b.entry)):(--b.lives,a._db.set(d,b));return a._size>
.9*a.maxSize})};return a}();a.MemCacheStorage=y})},"esri/core/iteratorUtils":function(){define(["require","exports"],function(y,a){Object.defineProperty(a,"__esModule",{value:!0});a.everyMap=Map.prototype.entries?function(a,k){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(!1===k(c.value[1],c.value[0]))return!1;return!0}:function(a,k){var c=!0;a.forEach(function(a,b){c&&(c=!1!==k(a,b))});return c}})},"esri/core/PooledArray":function(){define(["require","exports","./tsSupport/generatorHelper",
"./arrayUtils","./HeapSort"],function(y,a,q,k,c){return function(){function a(a){var b=this;this.data=[];this._length=0;this._allocator=null;this._deallocator=function(){};this._shrink=function(){};this._hint=new k.RemoveHint;a&&(a.initialSize&&(this.data=Array(a.initialSize)),a.allocator?(this._allocator=a.allocator,this._deallocator=a.deallocator):"deallocator"in a&&(this._deallocator=a.deallocator),a.shrink&&(this._shrink=function(){b.data.length>1.5*b.length&&(b.data.length=Math.floor(1.1*b.length))}))}
a.prototype.toArray=function(){return this.data.slice(0,this.length)};Object.defineProperty(a.prototype,"length",{get:function(){return this._length},set:function(a){if(a>this._length)if(this._allocator)for(;this._length<a;)this.data[this._length++]=this._allocator(this.data[this._length]);else this._length=a;else{if(this._deallocator)for(var b=a;b<this._length;++b)this.data[b]=this._deallocator(this.data[b]);this._length=a;this._shrink()}},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.length=
0};a.prototype.prune=function(){this.clear();this.data=[]};a.prototype.equal=function(a){return k.equals(this.data,a.data)};a.prototype.push=function(a){return this.data[this._length++]=a};a.prototype.pushArray=function(a,e){void 0===e&&(e=a.length);for(var b=0;b<e;b++)this.data[this._length++]=a[b];return this.back()};a.prototype.pushNew=function(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));++this._length;return this.back()};a.prototype.pop=function(){if(0!==
this.length){var a=this.data[this.length-1];--this.length;this._shrink();return a}};a.prototype.removeMany=function(a){var b=this,c=[];this.data=this.data.filter(function(e,d){if(d>=b.length)return!1;if(0>a.indexOf(e))return!0;c.push(e);return!1});this._length=this.data.length;return c};a.prototype.iterableRemoveMany=function(a,e){var b,c;return q(this,function(d){switch(d.label){case 0:b=[],c=0,d.label=1;case 1:if(!(c<this.length)||c>=this.length)return[3,4];0>a.indexOf(this.data[c])&&b.push(this.data[c]);
return e()?[4]:[3,3];case 2:d.sent(),d.label=3;case 3:return++c,[3,1];case 4:return this.data=b,this._length=this.data.length,[2]}})};a.prototype.removeUnordered=function(a){a=k.removeUnordered(this.data,a,this.length,this._hint);void 0!==a&&--this.length;return a};a.prototype.removeUnorderedIndex=function(a){if(!(a>=this.length||0>a))return this.swapElements(a,this.length-1),this.pop()};a.prototype.removeUnorderedMany=function(a,e,c){void 0===e&&(e=a.length);this.length=k.removeUnorderedMany(this.data,
a,this.length,e,this._hint,c)};a.prototype.front=function(){if(0!==this.length)return this.data[0]};a.prototype.back=function(){if(0!==this.length)return this.data[this.length-1]};a.prototype.swapElements=function(a,e){var b;a>=this.length||e>=this.length||a===e||(b=[this.data[e],this.data[a]],this.data[a]=b[0],this.data[e]=b[1])};a.prototype.sort=function(a){c.sort(this.data,0,this.length,a)};a.prototype.iterableSort=function(a,e){return c.iterableSort(this.data,0,this.length,a,e)};a.prototype.some=
function(a,e){for(var b=0;b<this.length;++b)if(a.call(e,this.data[b],b,this.data))return!0;return!1};a.prototype.find=function(a,e){for(var b=0;b<this.length;++b){var c=this.data[b];if(a.call(e,c,b,this.data))return c}};a.prototype.filterInPlace=function(a,e){for(var b=0,c=0;c<this._length;++c){var d=this.data[c];a.call(e,d,c,this.data)&&(this.data[c]=this.data[b],this.data[b]=d,b++)}if(this._deallocator)for(c=b;c<this._length;c++)this.data[c]=this._deallocator(this.data[c]);this._length=b;return this};
a.prototype.forEach=function(a,e){for(var b=this.length,c=0;c<Math.min(this.length,b);++c)a.call(e,this.data[c],c,this.data)};a.prototype.iterableForEach=function(){var a;return q(this,function(b){switch(b.label){case 0:a=0,b.label=1;case 1:return a<this.length?[4,this.data[a]]:[3,4];case 2:b.sent(),b.label=3;case 3:return++a,[3,1];case 4:return[2]}})};a.prototype.map=function(a,e){for(var b=Array(this.length),c=0;c<this.length;++c)b[c]=a.call(e,this.data[c],c,this.data);return b};return a}()})},
"esri/core/HeapSort":function(){define(["require","exports","./tsSupport/generatorHelper"],function(y,a,q){var k;(function(a){function c(a,b,c,d){for(var e=b,h=c>>>1,l=a[e-1];b<=h;){b=e<<1;b<c&&0>d(a[b-1],a[b])&&++b;var k=a[b-1];if(0>=d(k,l))break;a[e-1]=k;e=b}a[e-1]=l}function b(a,b){return a<b?-1:a>b?1:0}a.sort=function(a,d,l,k){void 0===d&&(d=0);void 0===l&&(l=a.length);void 0===k&&(k=b);for(var e=l>>>1;e>d;e--)c(a,e,l,k);for(var h=d+1,e=l-1;e>d;e--)l=a[d],a[d]=a[e],a[e]=l,c(a,h,e,k)};a.iterableSort=
function(a,d,l,k,p){var e,h,t;return q(this,function(r){switch(r.label){case 0:void 0===d&&(d=0),void 0===l&&(l=a.length),void 0===k&&(k=b),e=l>>>1,r.label=1;case 1:if(!(e>d))return[3,4];c(a,e,l,k);return p&&p()?[4]:[3,3];case 2:r.sent(),r.label=3;case 3:return e--,[3,1];case 4:h=d+1,e=l-1,r.label=5;case 5:if(!(e>d))return[3,8];t=a[d];a[d]=a[e];a[e]=t;c(a,h,e,k);return p&&p()?[4]:[3,7];case 6:r.sent(),r.label=7;case 7:return e--,[3,5];case 8:return[2]}})}})(k||(k={}));return k})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/Set ../../../core/Error ../../../core/sql/WhereClauseCache".split(" "),
function(y,a,q,k,c,d){function b(a,b){return a?l.get(a,b):null}function e(a,d,l,k){void 0===k&&(k=!0);for(var p=[],r=0;r<d.length;r++){var m=d[r];if("*"!==m&&!a.has(m))if(k){var t=h(m);try{var q=b(t,a);if(!q)throw new c("feature-store:unsupported-query","invalid SQL expression",{where:t});if(!q.isStandardized)throw new c("feature-store:unsupported-query","expression is not standard",{clause:q});e(a,q.fieldNames,"expression contains missing fields")}catch(x){if((t=x&&x.details)&&(t.clause||t.where))throw x;
t&&t.missingFields?p.push.apply(p,t.missingFields):p.push(m)}}else p.push(m)}if(p.length)throw new c("feature-store:unsupported-query",l,{missingFields:p});}function h(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var l=new d.WhereClauseCache(50,500),t=new k.default("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;var d=
l.get(b,a);if(!d)throw new c("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!d.isStandardized)throw new c("feature-store:unsupported-query","where clause is not standard",{where:b});e(a,d.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,d){if(!b)return!0;var h=l.get(b,a);if(!h)throw new c("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!h.isAggregate)throw new c("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});e(a,h.fieldNames,"having contains missing fields");if(!h.getExpressions().every(function(b){var e=b.aggregateType;b=b.field;var c=a.has(b)&&a.get(b).name;return d.some(function(b){var d=b.onStatisticField;b=b.statisticType;return(a.has(d)&&a.get(d).name)===c&&b.toLowerCase().trim()===e})}))throw new c("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=b;a.validateFields=e;a.getExpressionFromFieldName=h;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!t.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(y,a,q,k){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,b){this._cache=new q(a);this._invalidCache=new q(b)}a.prototype.get=function(a,b){var e=b.uid+":"+a,c=this._cache.get(e);if(c)return c;if(void 0!==this._invalidCache.get(e))return null;try{var d=
k.WhereClause.create(a,b);this._cache.put(e,d);return d}catch(t){return this._invalidCache.put(e,null),null}};return a}();a.WhereClauseCache=y})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(y,a,q){return function(){function a(a,d){this._storage=new q.MemCacheStorage;this._storage.maxSize=a;d&&this._storage.registerRemoveFunc("",d)}a.prototype.put=function(a,d){this._storage.put(a,d,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../has ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(y,a,q,k,c,d,b,e){function h(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function l(a,b,e,c,d,l,k,m,p){void 0===
e&&(e="0");void 0===c&&(c="0");void 0===d&&(d="0");void 0===l&&(l="0");void 0===k&&(k="");void 0===m&&(m="0");void 0===p&&(p="0");return"+"===k||"-"===k?(a=h(parseInt(a,10),4)+"-"+h(parseInt(b,10),2)+"-"+h(parseInt(e,10),2),b="",10>parseFloat(l)&&(b="0"),c=h(parseInt(c,10),2)+":"+h(parseInt(d,10),2)+":"+(b+parseFloat(l).toString()),k=""+k+h(parseInt(m,10),2)+":"+h(parseInt(p,10),2),new Date(a+"T"+c+k)):new Date(parseInt(a,10),parseInt(b,10),parseInt(e,10),parseInt(c,10),parseInt(d,10),parseFloat(l))}
function t(a){var b=ba.exec(a);if(null!==b){a=b[1];var e=b[2],c=b[3],d=b[4],h=b[5],k=b[6];return l(a,e,c,d,h,k)}b=Q.exec(a);if(null!==b){a=b[1];var e=b[2],c=b[3],d=b[4],h=b[5],k=b[6],m=b[7],p=b[8],b=b[9];return l(a,e,c,d,h,k,m,p,b)}b=ca.exec(a);if(null!==b)return a=b[1],e=b[2],c=b[3],d=b[4],h=b[5],m=b[6],p=b[7],b=b[8],l(a,e,c,d,h,"0",m,p,b);b=ga.exec(a);if(null!==b)return a=b[1],e=b[2],c=b[3],d=b[4],h=b[5],l(a,e,c,d,h);b=D.exec(a);if(null!==b)return a=b[1],e=b[2],c=b[3],l(a,e,c);throw Error("SQL Invalid Timestamp");
}function p(a){a=D.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],e=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(e,10))}function z(a){return Array.isArray(a)?a:[a]}function r(a){return null!==a?!0!==a:null}function A(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function C(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function H(a,b){if(null==a)return null;for(var e=!1,c=0;c<b.length;c++){var d=b[c];if(null==d)e=null;else if(a===
d){e=!0;break}}return e}function m(a,b,e){if(null==a)return null;for(var c="",d=0,h=0;h<b.length;h++){var n=b.charAt(h);switch(d){case 0:n===e?d=1:c=0<="-[]/{}()*+?.\\^$|".indexOf(n)?c+("\\"+n):"%"===n?c+".*":"_"===n?c+".":c+n;break;case 1:c=0<="-[]/{}()*+?.\\^$|".indexOf(n)?c+("\\"+n):c+n,d=0}}return(new RegExp("^"+c+"$")).test(a)}function B(a){return a instanceof Date?a.valueOf():a}function I(a,b,e){if(null==b||null==e)return null;b=B(b);e=B(e);switch(a){case "\x3c\x3e":return b!==e;case "\x3d":return b===
e;case "\x3e":return b>e;case "\x3c":return b<e;case "\x3e\x3d":return b>=e;case "\x3c\x3d":return b<=e}}function x(a){for(var b=[],e={},c=0;c<a.length;c++){var d=a[c],h=d.toLowerCase();void 0===e[h]&&(b.push(d),e[h]=1)}return b}function S(a,e,c){if(e instanceof b.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(e.valueInMilliseconds()+c.getTime());case "-":return e.valueInMilliseconds()-c.getTime();case "*":return e.valueInMilliseconds()*c.getTime();case "/":return e.valueInMilliseconds()/
c.getTime()}else if(c instanceof b.SqlInterval)switch(a){case "+":return b.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()+c.valueInMilliseconds());case "-":return b.SqlInterval.createFromMilliseconds(e.valueInMilliseconds()-c.valueInMilliseconds());case "*":return e.valueInMilliseconds()*c.valueInMilliseconds();case "/":return e.valueInMilliseconds()/c.valueInMilliseconds()}else e=e.valueInMilliseconds();else if(c instanceof b.SqlInterval)if(e instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+
e.getTime());case "-":return new Date(e.getTime()-c.valueInMilliseconds());case "*":return e.getTime()*c.valueInMilliseconds();case "/":return e.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(e instanceof Date&&"number"===typeof c)switch(c*=864E5,e=e.getTime(),a){case "+":return new Date(e+c);case "-":return new Date(e-c);case "*":return new Date(e*c);case "/":return new Date(e/c)}else if(c instanceof Date&&"number"===typeof e)switch(e*=864E5,c=c.getTime(),a){case "+":return new Date(e+
c);case "-":return new Date(e-c);case "*":return new Date(e*c);case "/":return new Date(e/c)}switch(a){case "+":return e+c;case "-":return e-c;case "*":return e*c;case "/":return e/c}}function N(a,b,e,c){a=c.getAttribute(a,b);return null!=a&&1===e[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var D=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,ba=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,Q=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
ca=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,ga=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,X=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,e,c){return N(a,b,e,c)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,e){return m(a,b,e)};a.ensureArray=function(a){return z(a)};a.applyIn=function(a,b){return H(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,e,c){return b.SqlInterval.createFromValueAndQualifer(a,e,c)};a.convertInterval=function(a){return a instanceof b.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,e){return I(a,b,e)};a.calculate=function(a,b,e){return S(a,b,e)};a.makeComparable=function(a){return B(a)};a.evaluateFunction=function(a,e){return b.evaluateFunction(a,e)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return r(a)};a.ternaryAnd=function(a,b){return A(a,b)};a.ternaryOr=function(a,b){return C(a,b)};return a}();y=function(){function h(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=e.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=c}h.create=function(a,b){return new h(a,b)};Object.defineProperty(h.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});h.prototype.testSet=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);for(var c={},d=function(a){c[a]=b.map(function(b){return e.getAttribute(b,a)})},h=0,l=this.fieldNames;h<l.length;h++)d(l[h]);return!!this.evaluateNode(this.parseTree,{attributes:c},a.defaultAttributeAdapter)};h.prototype.calculateValue=
function(e,c){void 0===c&&(c=a.defaultAttributeAdapter);e=this.evaluateNode(this.parseTree,e,c);return e instanceof b.SqlInterval?e.valueInMilliseconds()/864E5:e};h.prototype.calculateValueCompiled=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,e,this.datefields);if(c("csp-restrictions"))return this.calculateValue(b,e);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
e,this.datefields)};h.prototype.testFeature=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,e)};h.prototype.testFeatureCompiled=function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);if(void 0===this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,e,this.datefields);if(c("csp-restrictions"))return this.testFeature(b,e);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,e,this.datefields)};
h.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return x(a)};h.prototype.getExpressions=function(){var a=new k.default;this.visitAll(this.parseTree,function(b){if("function"===b.type){var e=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var c=e+"-"+b;a.has(c)||a.set(c,{aggregateType:e,field:b})}}});return q.from(a.values())};h.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return x(a)};h.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(X)};h.prototype.extractExpressionInfo=function(a){var e=this,c=[],h=!0,l=!0;this.visitAll(this.parseTree,function(k){switch(k.type){case "column_ref":var n=k.column.toUpperCase();if("CURRENT_DATE"!==
n&&"CURRENT_TIMESTAMP"!==n){var m=(n=a.get(k.column))&&n.name;!n||"date"!==n.type&&"esriFieldTypeDate"!==n.type||(e.datefields[n.name]=1);void 0!==m?(c.push(m),k.column=m):c.push(k.column)}break;case "function":n=k.name,k=k.args.value.length,h&&(h=b.isStandardized(n,k)),l&&(l=d.isAggregate(n,k))}});return{referencedFieldNames:x(c),isStandardized:h,isAggregate:l}};h.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);
break;case "case_expression":for(var e=0,c=a.clauses;e<c.length;e++){var d=c[e];this.visitAll(d,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":e=0;for(a=a.value;e<a.length;e++)d=a[e],this.visitAll(d,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};h.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+
this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var e="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",c=0;c<a.clauses.length;c++)b+=" ("+e+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";else for(b="( ",c=0;c<a.clauses.length;c++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[c].operand)+
")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[c].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";e=0;for(a=a.value;e<a.length;e++)c=a[e],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(c);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+p(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+t(a.value).getTime().toString()+"))";case "column_ref":return"CURRENT_DATE"===
a.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===a.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};h.prototype.evaluateNode=function(a,e,c){switch(a.type){case "interval":return e=this.evaluateNode(a.value,e,c),b.SqlInterval.createFromValueAndQualifer(e,
a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var h=B(this.evaluateNode(a.operand,e,c)),l=0;l<a.clauses.length;l++){if(h===B(this.evaluateNode(a.clauses[l].operand,e,c)))return this.evaluateNode(a.clauses[l].value,e,c)}else for(l=0;l<a.clauses.length;l++)if(!0===this.evaluateNode(a.clauses[l].operand,e,c))return this.evaluateNode(a.clauses[l].value,e,c);return null!==a.else?this.evaluateNode(a.else,e,c):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":h=
[];l=0;for(a=a.value;l<a.length;l++){var k=a[l];h.push(this.evaluateNode(k,e,c))}return h;case "unary_expr":return r(this.evaluateNode(a.expr,e,c));case "binary_expr":switch(a.operator){case "AND":return A(this.evaluateNode(a.left,e,c),this.evaluateNode(a.right,e,c));case "OR":return C(this.evaluateNode(a.left,e,c),this.evaluateNode(a.right,e,c));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,e,c);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,e,c);case "IN":return h=z(this.evaluateNode(a.right,e,c)),H(this.evaluateNode(a.left,e,c),h);case "NOT IN":return h=z(this.evaluateNode(a.right,e,c)),r(H(this.evaluateNode(a.left,e,c),h));case "BETWEEN":return h=this.evaluateNode(a.left,e,c),a=this.evaluateNode(a.right,e,c),null==h||null==a[0]||null==a[1]?null:h>=B(a[0])&&h<=B(a[1]);case "NOTBETWEEN":return h=this.evaluateNode(a.left,e,c),a=this.evaluateNode(a.right,e,c),null==h||null==a[0]||null==a[1]?null:
h<B(a[0])||h>B(a[1]);case "LIKE":return m(this.evaluateNode(a.left,e,c),this.evaluateNode(a.right,e,c),a.escape);case "NOT LIKE":return r(m(this.evaluateNode(a.left,e,c),this.evaluateNode(a.right,e,c),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return I(a.operator,this.evaluateNode(a.left,e,c),this.evaluateNode(a.right,e,c));case "-":case "+":case "*":case "/":return S(a.operator,this.evaluateNode(a.left,e,c),this.evaluateNode(a.right,e,c))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return p(a.value);case "timestamp":return t(a.value);case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(k=new Date,k.setHours(0,0,0,0),k):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:N(e,a.column,this.datefields,c);case "function":return e=this.evaluateNode(a.args,e,c),this.isAggregate?d.aggregateFunction(a.name,e):b.evaluateFunction(a.name,e)}throw Error("Unsupported sql syntax "+a.type);
};return h}();a.WhereClause=y;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(y,a){function q(a){for(var b=0,e=0;e<a.length;e++)b+=a[e];return b/a.length}function k(a){for(var b=q(a),e=a.length,c=0,d=0;d<a.length;d++)c+=Math.pow(a[d]-b,2);return 1<e?c/(e-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,b){var e=
c[a.toLowerCase()];if(null==e)throw Error("Function Not Recognised");if(b.length<e.minParams||b.length>e.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return e.evaluate(b)};a.isAggregate=function(a,b){a=c[a.toLowerCase()];return null!=a&&b>=a.minParams&&b<=a.maxParams};var c={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,
a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:q(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,e=0;e<a.length;e++)b+=a[e];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(k(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:k(a[0])}}}})},
"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(y,a,q){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(c){var b=new a;b.second=c/1E3;return b};a.createFromValueAndQualifer=
function(c,b,e){var d=null,l=new a;l.op="-"===e?"-":"+";if("interval-period"===b.type){a.fixDefaults(b);if("year"===b.period||"month"===b.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(c))l[b.period]=parseFloat(c);else throw Error("Illegal Interval");}else{a.fixDefaults(b.start);a.fixDefaults(b.end);if("year"===b.start.period||"month"===b.start.period)throw Error("Year-Month Intervals not supported");if("year"===b.end.period||"month"===b.end.period)throw Error("Year-Month Intervals not supported");
switch(b.start.period){case "day":switch(b.end.period){case "hour":d=/^[0-9]{1,} [0-9]{1,}$/;if(d.test(c))l[b.start.period]=parseFloat(c.split(" ")[0]),l[b.end.period]=parseFloat(c.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":d=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(d.test(c))l[b.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),l.hour=parseFloat(c[0]),l.minute=parseFloat(c[1]);else throw Error("Illegal Interval");break;case "second":d=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(d.test(c))l[b.start.period]=parseFloat(c.split(" ")[0]),c=c.split(" ")[1].split(":"),l.hour=parseFloat(c[0]),l.minute=parseFloat(c[1]),l.second=parseFloat(c[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(b.end.period){case "minute":d=/^[0-9]{1,}:[0-9]{1,}$/;if(d.test(c))l.hour=parseFloat(c.split(":")[0]),l.minute=parseFloat(c.split(":")[1]);else throw Error("Illegal Interval");break;case "second":d=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;
if(d.test(c))c=c.split(":"),l.hour=parseFloat(c[0]),l.minute=parseFloat(c[1]),l.second=parseFloat(c[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(b.end.period){case "second":d=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(d.test(c))c=c.split(":"),l.minute=parseFloat(c[0]),l.second=parseFloat(c[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return l};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=y;a.evaluateFunction=function(a,d){var b=k[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(d.length<b.minParams||d.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(d)};a.isStandardized=function(a,d){a=k[a.toLowerCase()];return null!=a&&d>=a.minParams&&
d<=a.maxParams};var k={extract:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(c.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var c=
a[0],b=a[1];return null==c||null==b?null:c.toString().substring(b-1)}if(3===a.length)return c=a[0],b=a[1],a=a[2],null==c||null==b||null==a?null:0>=a?"":c.toString().substring(b-1,b+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];return null==c||null==a?null:a.indexOf(c)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var c=3===a.length,b=c?a[1]:" ",c=c?a[2]:a[1];if(null==b||null==c)return null;b="("+q.escapeString(b)+")";switch(a[0]){case "BOTH":return c.replace(new RegExp("^"+
b+"*|"+b+"*$","g"),"");case "LEADING":return c.replace(new RegExp("^"+b+"*","g"),"");case "TRAILING":return c.replace(new RegExp(b+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var c=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==c?null:Math.round(c*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var c="",b=0;b<
a.length;b++){if(null==a[b])return null;c+=a[b].toString()}return c}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(y,a,q){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(){}a.parse=function(a){return q.parse(a)};
return a}();a.WhereGrammar=y})},"esri/core/sql/sql92grammar":function(){define([],function(){function y(a,q,k,c){this.message=a;this.expected=q;this.found=k;this.location=c;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,y)}(function(a,q){function k(){this.constructor=a}k.prototype=q.prototype;a.prototype=new k})(y,Error);y.buildMessage=function(a,q){function k(a){return a.charCodeAt(0).toString(16).toUpperCase()}function c(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+k(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+k(a)})}function d(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+k(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+k(a)})}var b={literal:function(a){return'"'+c(a.text)+'"'},"class":function(a){var b="",e;for(e=0;e<a.parts.length;e++)b+=a.parts[e]instanceof Array?d(a.parts[e][0])+"-"+d(a.parts[e][1]):d(a.parts[e]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var e=Array(a.length),c;for(c=0;c<a.length;c++){var d=c,k;k=a[c];k=b[k.type](k);e[d]=k}e.sort();
if(0<e.length){for(a=c=1;c<e.length;c++)e[c-1]!==e[c]&&(e[a]=e[c],a++);e.length=a}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}(a)+" but "+(q?'"'+c(q)+'"':"end of input")+" found."};return{SyntaxError:y,parse:function(a,q){function k(a,b){return{type:"literal",text:a,ignoreCase:b}}function c(a,b,e){return{type:"class",parts:a,inverted:b,ignoreCase:e}}function d(b){var e=Fa[b],f;if(!e){for(f=b-1;!Fa[f];)f--;e=Fa[f];
for(e={line:e.line,column:e.column};f<b;)10===a.charCodeAt(f)?(e.line++,e.column=1):e.column++,f++;Fa[b]=e}return e}function b(a,b){var e=d(a),f=d(b);return{start:{offset:a,line:e.line,column:e.column},end:{offset:b,line:f.line,column:f.column}}}function e(a){g<aa||(g>aa&&(aa=g,Na=[]),Na.push(a))}function h(){var a,b,e;a=g;b=v();b!==f?(b=t(),b!==f?(e=v(),e!==f?a=b:(g=a,a=f)):(g=a,a=f)):(g=a,a=f);return a}function l(){var a,b,e,c,d,h,k,l;a=g;b=t();if(b!==f){e=[];c=g;d=v();d!==f?(h=ya(),h!==f?(k=v(),
k!==f?(l=t(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);for(;c!==f;)e.push(c),c=g,d=v(),d!==f?(h=ya(),h!==f?(k=v(),k!==f?(l=t(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);if(e!==f){a={type:"expr_list"};b=[b];for(c=0;c<e.length;c++)b.push(e[c][3]);a.value=b}else g=a,a=f}else g=a,a=f;return a}function t(){var a,b,e,c,d,h,k,l;a=g;b=p();if(b!==f){e=[];c=g;d=v();d!==f?(h=Xa(),h!==f?(k=v(),k!==f?(l=p(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);
for(;c!==f;)e.push(c),c=g,d=v(),d!==f?(h=Xa(),h!==f?(k=v(),k!==f?(l=p(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);e!==f?a=b=za(b,e):(g=a,a=f)}else g=a,a=f;return a}function p(){var a,b,e,c,d,h,k,l;a=g;b=z();if(b!==f){e=[];c=g;d=v();d!==f?(h=na(),h!==f?(k=v(),k!==f?(l=z(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);for(;c!==f;)e.push(c),c=g,d=v(),d!==f?(h=na(),h!==f?(k=v(),k!==f?(l=z(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);e!==f?a=b=
za(b,e):(g=a,a=f)}else g=a,a=f;return a}function z(){var b,c,d,h,k;b=g;c=qa();c===f&&(c=g,33===a.charCodeAt(g)?(d=$c,g++):(d=f,0===u&&e(ad)),d!==f?(h=g,u++,61===a.charCodeAt(g)?(k=$a,g++):(k=f,0===u&&e(ab)),u--,k===f?h=void 0:(g=h,h=f),h!==f?c=d=[d,h]:(g=c,c=f)):(g=c,c=f));c!==f?(d=v(),d!==f?(h=z(),h!==f?b=c={type:"unary_expr",operator:"NOT",expr:h}:(g=b,b=f)):(g=b,b=f)):(g=b,b=f);if(b===f)if(b=g,c=H(),c!==f)if(d=v(),d!==f){var m,n,p;d=[];h=g;k=v();k!==f?(m=r(),m!==f?(n=v(),n!==f?(p=H(),p!==f?h=k=
[k,m,n,p]:(g=h,h=f)):(g=h,h=f)):(g=h,h=f)):(g=h,h=f);if(h!==f)for(;h!==f;)d.push(h),h=g,k=v(),k!==f?(m=r(),m!==f?(n=v(),n!==f?(p=H(),p!==f?h=k=[k,m,n,p]:(g=h,h=f)):(g=h,h=f)):(g=h,h=f)):(g=h,h=f);else d=f;d!==f&&(d={type:"arithmetic",tail:d});d===f&&(d=g,h=C(),h!==f?(k=v(),k!==f?(k=da(),k!==f?(k=v(),k!==f?(k=l(),k!==f?(m=v(),m!==f?(m=ea(),m!==f?d=h={op:h,right:k}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f),d===f&&(d=g,h=C(),h!==f?(k=v(),k!==f?(k=da(),k!==f?(k=v(),k!==
f?(k=ea(),k!==f?d=h={op:h,right:{type:"expr_list",value:[]}}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f),d===f&&(d=g,h=C(),h!==f?(k=v(),k!==f?(k=Q(),k!==f?d=h={op:h,right:k}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f))),d===f&&(d=g,k=qa(),k!==f?(h=v(),h!==f?(h=ra(),h!==f?(m=v(),m!==f?(m=H(),m!==f?(n=v(),n!==f?(n=na(),n!==f?(k=v(),k!==f?(k=H(),k!==f?d=k={op:"NOT"+h,right:{type:"expr_list",value:[m,k]}}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f),
d===f&&(d=g,k=ra(),k!==f?(h=v(),h!==f?(h=H(),h!==f?(m=v(),m!==f?(m=na(),m!==f?(n=v(),n!==f?(n=H(),n!==f?d=k={op:k,right:{type:"expr_list",value:[h,n]}}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)),d===f&&(d=g,h=Y(),h!==f?(k=v(),k!==f?(k=qa(),k!==f?(k=v(),k!==f?(k=H(),k!==f?d=h={op:h+"NOT",right:k}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f),d===f&&(d=g,h=Y(),h!==f?(k=v(),k!==f?(k=H(),k!==f?d=h={op:h,right:k}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)),d===f&&(d=g,h=
A(),h!==f?(k=v(),k!==f?(k=w(),k!==f?(m=v(),m!==f?(m=g,a.substr(g,6).toLowerCase()===bd?(n=a.substr(g,6),g+=6):(n=f,0===u&&e(cd)),n!==f?(n=g,u++,p=D(),u--,p===f?n=void 0:(g=n,n=f),n!==f?m="ESCAPE":(g=m,m=f)):(g=m,m=f),m!==f?(m=v(),m!==f?(m=G(),m!==f?d=h={op:h,right:k,escape:m.value}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f),d===f&&(d=g,h=A(),h!==f?(k=v(),k!==f?(k=w(),k!==f?d=h={op:h,right:k,escape:""}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f))))));d===f&&(d=null);d!==f?(b=c,
c=d,""==c||void 0==c||null==c?c=b:(d=null,c=d="arithmetic"==c.type?za(b,c.tail):bb(c.op,b,c.right,c.escape)),b=c):(g=b,b=f)}else g=b,b=f;else g=b,b=f;return b}function r(){var b;a.substr(g,2)===cb?(b=cb,g+=2):(b=f,0===u&&e(dd));b===f&&(62===a.charCodeAt(g)?(b=ed,g++):(b=f,0===u&&e(fd)),b===f&&(a.substr(g,2)===db?(b=db,g+=2):(b=f,0===u&&e(gd)),b===f&&(a.substr(g,2)===eb?(b=eb,g+=2):(b=f,0===u&&e(hd)),b===f&&(60===a.charCodeAt(g)?(b=id,g++):(b=f,0===u&&e(jd)),b===f&&(61===a.charCodeAt(g)?(b=$a,g++):
(b=f,0===u&&e(ab)),b===f&&(a.substr(g,2)===fb?(b=fb,g+=2):(b=f,0===u&&e(kd))))))));return b}function A(){var a,b,e,c;a=a=g;b=qa();b!==f?(e=v(),e!==f?(c=ma(),c!==f?a=b=[b,e,c]:(g=a,a=f)):(g=a,a=f)):(g=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=ma());return a}function C(){var a,b,e,c;a=a=g;b=qa();b!==f?(e=v(),e!==f?(c=pa(),c!==f?a=b=[b,e,c]:(g=a,a=f)):(g=a,a=f)):(g=a,a=f);a!==f&&(a=a[0]+" "+a[2]);a===f&&(a=pa());return a}function H(){var a,b,e,c,d,h,k,l;a=g;b=B();if(b!==f){e=[];c=g;d=v();d!==f?(h=m(),
h!==f?(k=v(),k!==f?(l=B(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);for(;c!==f;)e.push(c),c=g,d=v(),d!==f?(h=m(),h!==f?(k=v(),k!==f?(l=B(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);e!==f?a=b=za(b,e):(g=a,a=f)}else g=a,a=f;return a}function m(){var b;43===a.charCodeAt(g)?(b=ac,g++):(b=f,0===u&&e(bc));b===f&&(45===a.charCodeAt(g)?(b=cc,g++):(b=f,0===u&&e(dc)));return b}function B(){var a,b,e,c,d,h,k,l;a=g;b=x();if(b!==f){e=[];c=g;d=v();d!==f?(h=I(),h!==f?(k=
v(),k!==f?(l=x(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);for(;c!==f;)e.push(c),c=g,d=v(),d!==f?(h=I(),h!==f?(k=v(),k!==f?(l=x(),l!==f?c=d=[d,h,k,l]:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);e!==f?a=b=za(b,e):(g=a,a=f)}else g=a,a=f;return a}function I(){var b;42===a.charCodeAt(g)?(b=ld,g++):(b=f,0===u&&e(md));b===f&&(47===a.charCodeAt(g)?(b=nd,g++):(b=f,0===u&&e(od)));return b}function x(){var b,c,d,h,k,m,n;n=G();if(n===f){var p,r,q,B;p=g;var x,z,y,I;x=g;z=V();z!==f?(y=Da(),
y!==f?(I=ua(),I!==f?x=z=parseFloat(z+y+I):(g=x,x=f)):(g=x,x=f)):(g=x,x=f);x===f&&(x=g,z=V(),z!==f?(y=Da(),y!==f?x=z=parseFloat(z+y):(g=x,x=f)):(g=x,x=f),x===f&&(x=g,z=V(),z!==f?(y=ua(),y!==f?x=z=parseFloat(z+y):(g=x,x=f)):(g=x,x=f),x===f&&(x=g,z=V(),z!==f&&(z=parseFloat(z)),x=z)));r=x;r!==f?(q=g,u++,B=N(),u--,B===f?q=void 0:(g=q,q=f),q!==f?p=r={type:"number",value:r}:(g=p,p=f)):(g=p,p=f);n=p;if(n===f){var F,A;F=g;var L,C,H,X;L=g;a.substr(g,4).toLowerCase()===pd?(C=a.substr(g,4),g+=4):(C=f,0===u&&
e(qd));C!==f?(H=g,u++,X=D(),u--,X===f?H=void 0:(g=H,H=f),H!==f?L=C=[C,H]:(g=L,L=f)):(g=L,L=f);A=L;A!==f&&(A={type:"bool",value:!0});F=A;if(F===f){F=g;var W,Y,na,Xa;W=g;a.substr(g,5).toLowerCase()===rd?(Y=a.substr(g,5),g+=5):(Y=f,0===u&&e(sd));Y!==f?(na=g,u++,Xa=D(),u--,Xa===f?na=void 0:(g=na,na=f),na!==f?W=Y=[Y,na]:(g=W,W=f)):(g=W,W=f);A=W;A!==f&&(A={type:"bool",value:!1});F=A}n=F;if(n===f){var qa,ra,aa,ma,za;ra=g;a.substr(g,4).toLowerCase()===td?(aa=a.substr(g,4),g+=4):(aa=f,0===u&&e(ud));aa!==f?
(ma=g,u++,za=D(),u--,za===f?ma=void 0:(g=ma,ma=f),ma!==f?ra=aa=[aa,ma]:(g=ra,ra=f)):(g=ra,ra=f);qa=ra;qa!==f&&(qa={type:"null",value:null});n=qa;if(n===f){var va,ya,Fa,Ca;va=g;var Ga,xa,gb,Na;Ga=g;a.substr(g,4).toLowerCase()===vd?(xa=a.substr(g,4),g+=4):(xa=f,0===u&&e(wd));xa!==f?(gb=g,u++,Na=D(),u--,Na===f?gb=void 0:(g=gb,gb=f),gb!==f?Ga=xa="DATE":(g=Ga,Ga=f)):(g=Ga,Ga=f);ya=Ga;ya!==f?(Fa=v(),Fa!==f?(Ca=w(),Ca!==f?va=ya={type:"date",value:Ca.value}:(g=va,va=f)):(g=va,va=f)):(g=va,va=f);n=va;if(n===
f){var wa,ec,Ya,fc;wa=g;var Ha,Eb,hb,Za;Ha=g;a.substr(g,9).toLowerCase()===xd?(Eb=a.substr(g,9),g+=9):(Eb=f,0===u&&e(yd));Eb!==f?(hb=g,u++,Za=D(),u--,Za===f?hb=void 0:(g=hb,hb=f),hb!==f?Ha=Eb="TIMESTAMP":(g=Ha,Ha=f)):(g=Ha,Ha=f);ec=Ha;ec!==f?(Ya=v(),Ya!==f?(fc=w(),fc!==f?wa=ec={type:"timestamp",value:fc.value}:(g=wa,wa=f)):(g=wa,wa=f)):(g=wa,wa=f);n=wa;if(n===f){var O,Oa,Fb,sa,Gb,Pa,$a,gc;O=g;Oa=uc();Oa!==f?(Fb=v(),Fb!==f?(45===a.charCodeAt(g)?(sa=cc,g++):(sa=f,0===u&&e(dc)),sa===f&&(43===a.charCodeAt(g)?
(sa=ac,g++):(sa=f,0===u&&e(bc))),sa!==f?(Gb=v(),Gb!==f?(Pa=w(),Pa!==f?($a=v(),$a!==f?(gc=ga(),gc!==f?O=Oa={type:"interval",value:Pa,qualifier:gc,op:sa}:(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f);O===f&&(O=g,Oa=uc(),Oa!==f?(Fb=v(),Fb!==f?(sa=w(),sa!==f?(Gb=v(),Gb!==f?(Pa=ga(),Pa!==f?O=Oa={type:"interval",value:sa,qualifier:Pa,op:""}:(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f)):(g=O,O=f));n=O}}}}}}b=n;if(b===f){var T,hc,ab,bb,cb,ic,db,eb,fb,jc,rb,sb;T=g;var Ia,Hb,ib,
tb;Ia=g;a.substr(g,7).toLowerCase()===zd?(Hb=a.substr(g,7),g+=7):(Hb=f,0===u&&e(Ad));Hb!==f?(ib=g,u++,tb=D(),u--,tb===f?ib=void 0:(g=ib,ib=f),ib!==f?Ia=Hb="EXTRACT":(g=Ia,Ia=f)):(g=Ia,Ia=f);hc=Ia;if(hc!==f)if(ab=v(),ab!==f)if(bb=da(),bb!==f)if(cb=v(),cb!==f){var ha;ha=vc();ha===f&&(ha=wc(),ha===f&&(ha=xc(),ha===f&&(ha=yc(),ha===f&&(ha=zc(),ha===f&&(ha=Ea())))));ic=ha;ic!==f?(db=v(),db!==f?(eb=$b(),eb!==f?(fb=v(),fb!==f?(jc=t(),jc!==f?(rb=v(),rb!==f?(sb=ea(),sb!==f?T=hc={type:"function",name:"extract",
args:{type:"expr_list",value:[{type:"string",value:ic},jc]}}:(g=T,T=f)):(g=T,T=f)):(g=T,T=f)):(g=T,T=f)):(g=T,T=f)):(g=T,T=f)):(g=T,T=f)}else g=T,T=f;else g=T,T=f;else g=T,T=f;else g=T,T=f;b=T;if(b===f){var R,kc,ub,vb,wb,Ib,xb,yb,zb,Jb,Ab,fa,Qa,lc,mc,nc;R=g;var Ja,Kb,jb,Bb;Ja=g;a.substr(g,9).toLowerCase()===Bd?(Kb=a.substr(g,9),g+=9):(Kb=f,0===u&&e(Cd));Kb!==f?(jb=g,u++,Bb=D(),u--,Bb===f?jb=void 0:(g=jb,jb=f),jb!==f?Ja=Kb="SUBSTRING":(g=Ja,Ja=f)):(g=Ja,Ja=f);kc=Ja;if(kc!==f)if(ub=v(),ub!==f)if(vb=
da(),vb!==f)if(wb=v(),wb!==f)if(Ib=t(),Ib!==f)if(xb=v(),xb!==f)if(yb=$b(),yb!==f)if(zb=v(),zb!==f)if(Jb=t(),Jb!==f)if(Ab=v(),Ab!==f){fa=g;var Ka,Lb,kb,Ac;Ka=g;a.substr(g,3).toLowerCase()===Dd?(Lb=a.substr(g,3),g+=3):(Lb=f,0===u&&e(Ed));Lb!==f?(kb=g,u++,Ac=D(),u--,Ac===f?kb=void 0:(g=kb,kb=f),kb!==f?Ka=Lb="FOR":(g=Ka,Ka=f)):(g=Ka,Ka=f);Qa=Ka;Qa!==f?(lc=v(),lc!==f?(mc=t(),mc!==f?(nc=v(),nc!==f?fa=Qa=[Qa,lc,mc,nc]:(g=fa,fa=f)):(g=fa,fa=f)):(g=fa,fa=f)):(g=fa,fa=f);fa===f&&(fa=null);fa!==f?(Qa=ea(),Qa!==
f?R=kc={type:"function",name:"substring",args:{type:"expr_list",value:fa?[Ib,Jb,fa[2]]:[Ib,Jb]}}:(g=R,R=f)):(g=R,R=f)}else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;else g=R,R=f;b=R;if(b===f){var K,Ra,Mb,Nb,Ob,ia,Pb,Sa,Qb,Rb,Bc,oc,Cc,Dc;K=g;Ra=tc();Ra!==f?(Mb=v(),Mb!==f?(Nb=da(),Nb!==f?(Ob=v(),Ob!==f?(ia=ca(),ia===f&&(ia=null),ia!==f?(Pb=v(),Pb!==f?(Sa=t(),Sa!==f?(Qb=v(),Qb!==f?(Rb=$b(),Rb!==f?(Bc=v(),Bc!==f?(oc=t(),oc!==f?(Cc=
v(),Cc!==f?(Dc=ea(),Dc!==f?K=Ra={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==ia?"BOTH":ia},Sa,oc]}}:(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f);K===f&&(K=g,Ra=tc(),Ra!==f?(Mb=v(),Mb!==f?(Nb=da(),Nb!==f?(Ob=v(),Ob!==f?(ia=ca(),ia===f&&(ia=null),ia!==f?(Pb=v(),Pb!==f?(Sa=t(),Sa!==f?(Qb=v(),Qb!==f?(Rb=ea(),Rb!==f?K=Ra={type:"function",name:"trim",args:{type:"expr_list",
value:[{type:"string",value:null==ia?"BOTH":ia},Sa]}}:(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f)):(g=K,K=f));b=K;if(b===f){var U,pc,Ec,Fc,Gc,qc,Hc,Ic,Jc,rc,Kc,Lc;U=g;var La,Sb,lb,Mc;La=g;a.substr(g,8).toLowerCase()===Fd?(Sb=a.substr(g,8),g+=8):(Sb=f,0===u&&e(Gd));Sb!==f?(lb=g,u++,Mc=D(),u--,Mc===f?lb=void 0:(g=lb,lb=f),lb!==f?La=Sb="POSITION":(g=La,La=f)):(g=La,La=f);pc=La;pc!==f?(Ec=v(),Ec!==f?(Fc=da(),Fc!==f?(Gc=v(),Gc!==f?(qc=t(),qc!==f?(Hc=v(),Hc!==
f?(Ic=pa(),Ic!==f?(Jc=v(),Jc!==f?(rc=t(),rc!==f?(Kc=v(),Kc!==f?(Lc=ea(),Lc!==f?U=pc={type:"function",name:"position",args:{type:"expr_list",value:[qc,rc]}}:(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f)):(g=U,U=f);b=U;if(b===f){var Z,Tb,Nc,Oc,Pc,Ta,Qc,Rc;Z=g;var ja,mb,nb,ta;ja=g;ja=mb=S();if(ja===f)if(ja=g,96===a.charCodeAt(g)?(mb=Sc,g++):(mb=f,0===u&&e(Tc)),mb!==f){nb=[];Uc.test(a.charAt(g))?(ta=a.charAt(g),g++):(ta=f,0===u&&e(Vc));if(ta!==
f)for(;ta!==f;)nb.push(ta),Uc.test(a.charAt(g))?(ta=a.charAt(g),g++):(ta=f,0===u&&e(Vc));else nb=f;nb!==f?(96===a.charCodeAt(g)?(ta=Sc,g++):(ta=f,0===u&&e(Tc)),ta!==f?ja=mb=nb.join(""):(g=ja,ja=f)):(g=ja,ja=f)}else g=ja,ja=f;Tb=ja;Tb!==f?(Nc=v(),Nc!==f?(Oc=da(),Oc!==f?(Pc=v(),Pc!==f?(Ta=l(),Ta===f&&(Ta=null),Ta!==f?(Qc=v(),Qc!==f?(Rc=ea(),Rc!==f?Z=Tb={type:"function",name:Tb,args:Ta?Ta:{type:"expr_list",value:[]}}:(g=Z,Z=f)):(g=Z,Z=f)):(g=Z,Z=f)):(g=Z,Z=f)):(g=Z,Z=f)):(g=Z,Z=f)):(g=Z,Z=f);b=Z;if(b===
f){var Ub,M,Ua,Vb,Va,Wb,Aa,ka,ob,Wc,Xc;M=g;Ua=Cb();if(Ua!==f)if(Vb=v(),Vb!==f)if(Va=t(),Va!==f)if(Wb=v(),Wb!==f){Aa=[];for(ka=oa();ka!==f;)Aa.push(ka),ka=oa();Aa!==f?(ka=v(),ka!==f?(ob=Db(),ob!==f?M=Ua={type:"case_expression",format:"simple",operand:Va,clauses:Aa,else:null}:(g=M,M=f)):(g=M,M=f)):(g=M,M=f)}else g=M,M=f;else g=M,M=f;else g=M,M=f;else g=M,M=f;if(M===f)if(M=g,Ua=Cb(),Ua!==f)if(Vb=v(),Vb!==f)if(Va=t(),Va!==f)if(Wb=v(),Wb!==f){Aa=[];for(ka=oa();ka!==f;)Aa.push(ka),ka=oa();Aa!==f?(ka=v(),
ka!==f?(ob=J(),ob!==f?(Wc=v(),Wc!==f?(Xc=Db(),Xc!==f?M=Ua={type:"case_expression",format:"simple",operand:Va,clauses:Aa,else:ob.value}:(g=M,M=f)):(g=M,M=f)):(g=M,M=f)):(g=M,M=f)):(g=M,M=f)}else g=M,M=f;else g=M,M=f;else g=M,M=f;else g=M,M=f;Ub=M;if(Ub===f){var P,Wa,Xb,Ba,la,pb,Yc,Zc;P=g;Wa=Cb();if(Wa!==f)if(Xb=v(),Xb!==f){Ba=[];for(la=E();la!==f;)Ba.push(la),la=E();Ba!==f?(la=v(),la!==f?(pb=Db(),pb!==f?P=Wa={type:"case_expression",format:"searched",clauses:Ba,else:null}:(g=P,P=f)):(g=P,P=f)):(g=P,
P=f)}else g=P,P=f;else g=P,P=f;if(P===f)if(P=g,Wa=Cb(),Wa!==f)if(Xb=v(),Xb!==f){Ba=[];for(la=E();la!==f;)Ba.push(la),la=E();Ba!==f?(la=v(),la!==f?(pb=J(),pb!==f?(Yc=v(),Yc!==f?(Zc=Db(),Zc!==f?P=Wa={type:"case_expression",format:"searched",clauses:Ba,else:pb.value}:(g=P,P=f)):(g=P,P=f)):(g=P,P=f)):(g=P,P=f)):(g=P,P=f)}else g=P,P=f;else g=P,P=f;Ub=P}b=Ub;if(b===f){var qb,Ma,sc,Yb,Zb;Ma=g;sc=N();if(sc!==f){Yb=[];for(Zb=ba();Zb!==f;)Yb.push(Zb),Zb=ba();Yb!==f?Ma=sc+=Yb.join(""):(g=Ma,Ma=f)}else g=Ma,
Ma=f;qb=Ma;qb!==f&&(qb={type:"column_ref",table:"",column:qb});b=qb;b===f&&(b=Q(),b===f&&(b=g,c=da(),c!==f?(d=v(),d!==f?(h=t(),h!==f?(k=v(),k!==f?(m=ea(),m!==f?(h.paren=!0,b=c=h):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)))}}}}}}}return b}function S(){var a,b,e,c;a=g;b=N();if(b!==f){e=[];for(c=D();c!==f;)e.push(c),c=D();e!==f?a=b+=e.join(""):(g=a,a=f)}else g=a,a=f;return a}function N(){var b;Hd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===u&&e(Id));return b}function D(){var b;Jd.test(a.charAt(g))?
(b=a.charAt(g),g++):(b=f,0===u&&e(Kd));return b}function ba(){var b;Ld.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===u&&e(Md));return b}function Q(){var b,c,d;b=g;64===a.charCodeAt(g)?(c=Nd,g++):(c=f,0===u&&e(Od));c!==f?(d=S(),d!==f?b=c=[c,d]:(g=b,b=f)):(g=b,b=f);b!==f&&(b={type:"param",value:b[1]});return b}function ca(){var b,c,d;b=g;a.substr(g,7).toLowerCase()===Pd?(c=a.substr(g,7),g+=7):(c=f,0===u&&e(Qd));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="LEADING":(g=b,b=f)):(g=b,b=f);
b===f&&(b=g,a.substr(g,8).toLowerCase()===Rd?(c=a.substr(g,8),g+=8):(c=f,0===u&&e(Sd)),c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="TRAILING":(g=b,b=f)):(g=b,b=f),b===f&&(b=g,a.substr(g,4).toLowerCase()===Td?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(Ud)),c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="BOTH":(g=b,b=f)):(g=b,b=f)));return b}function ga(){var b,c,d;b=g;var h,k;c=g;d=X();d!==f?(h=v(),h!==f?(h=da(),h!==f?(h=v(),h!==f?(h=n(),h!==f?(k=v(),k!==f?(k=ea(),k!==f?c=d={type:"interval-period",
period:d.value,precision:h,secondary:null}:(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f)):(g=c,c=f);c===f&&(c=g,d=X(),d!==f&&(d=rb(d)),c=d);if(c!==f)if(d=v(),d!==f)if(d=g,a.substr(g,2).toLowerCase()===Vd?(h=a.substr(g,2),g+=2):(h=f,0===u&&e(Wd)),h!==f?(h=g,u++,k=D(),u--,k===f?h=void 0:(g=h,h=f),h!==f?d="TO":(g=d,d=f)):(g=d,d=f),d!==f)if(d=v(),d!==f){var l;d=g;h=X();h!==f&&(h={type:"interval-period",period:h.value,precision:null,secondary:null});d=h;d===f&&(d=g,h=Ea(),h!==f?(h=v(),
h!==f?(h=da(),h!==f?(h=v(),h!==f?(h=n(),h!==f?(k=v(),k!==f?(k=ya(),k!==f?(k=v(),k!==f?(k=L(),k!==f?(l=v(),l!==f?(l=ea(),l!==f?d=h=sb(h,k):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f),d===f&&(d=g,h=Ea(),h!==f?(h=v(),h!==f?(h=da(),h!==f?(h=v(),h!==f?(h=n(),h!==f?(k=v(),k!==f?(k=ea(),k!==f?d=h={type:"interval-period",period:"second",precision:h,secondary:null}:(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):(g=d,d=f)):
(g=d,d=f),d===f&&(d=g,h=Ea(),h!==f&&(h={type:"interval-period",period:"second",precision:null,secondary:null}),d=h)));d!==f?b=c={type:"interval-qualifier",start:c,end:d}:(g=b,b=f)}else g=b,b=f;else g=b,b=f;else g=b,b=f;else g=b,b=f;b===f&&(b=g,d=X(),d!==f?(c=v(),c!==f?(c=da(),c!==f?(c=v(),c!==f?(c=L(),c!==f?(h=v(),h!==f?(h=ea(),h!==f?b=d={type:"interval-period",period:d.value,precision:c,secondary:null}:(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f),b===f&&(b=g,d=X(),
d!==f&&(d=rb(d)),b=d,b===f&&(b=g,d=Ea(),d!==f?(c=v(),c!==f?(c=da(),c!==f?(c=v(),c!==f?(c=n(),c!==f?(h=v(),h!==f?(h=ya(),h!==f?(d=v(),d!==f?(d=L(),d!==f?(h=v(),h!==f?(h=ea(),h!==f?b=d=sb(c,d):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f),b===f&&(b=g,d=Ea(),d!==f?(c=v(),c!==f?(c=da(),c!==f?(c=v(),c!==f?(c=L(),c!==f?(h=v(),h!==f?(h=ea(),h!==f?b=d={type:"interval-period",period:"second",precision:c,secondary:null}:(g=b,b=f)):(g=
b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f)):(g=b,b=f),b===f&&(b=g,d=Ea(),d!==f&&(d={type:"interval-period",period:"second",precision:null,secondary:null}),b=d)))));return b}function X(){var a;a=g;a=xc();a!==f&&(a={type:"string",value:"day"});a===f&&(a=g,a=yc(),a!==f&&(a={type:"string",value:"hour"}),a===f&&(a=g,a=zc(),a!==f&&(a={type:"string",value:"minute"}),a===f&&(a=g,a=wc(),a!==f&&(a={type:"string",value:"month"}),a===f&&(a=g,a=vc(),a!==f&&(a={type:"string",value:"year"})))));return a}
function L(){var a;a=W();a!==f&&(a=parseFloat(a));return a}function n(){var a;a=W();a!==f&&(a=parseFloat(a));return a}function w(){var a;a=G();a===f&&(a=Q());return a}function G(){var b,c,d;b=g;39===a.charCodeAt(g)?(c=tb,g++):(c=f,0===u&&e(ub));c===f&&(a.substr(g,2)===vb?(c=vb,g+=2):(c=f,0===u&&e(Xd)));if(c!==f){c=[];d=g;a.substr(g,2)===Ca?(d=Ca,g+=2):(d=f,0===u&&e(wb));d!==f&&(d="'");d===f&&(xb.test(a.charAt(g))?(d=a.charAt(g),g++):(d=f,0===u&&e(yb)));for(;d!==f;)c.push(d),d=g,a.substr(g,2)===Ca?
(d=Ca,g+=2):(d=f,0===u&&e(wb)),d!==f&&(d="'"),d===f&&(xb.test(a.charAt(g))?(d=a.charAt(g),g++):(d=f,0===u&&e(yb)));c!==f?(39===a.charCodeAt(g)?(d=tb,g++):(d=f,0===u&&e(ub)),d!==f?b=c={type:"string",value:c.join("")}:(g=b,b=f)):(g=b,b=f)}else g=b,b=f;return b}function E(){var a,b,c;a=g;b=Ya();b!==f?(b=v(),b!==f?(b=t(),b!==f?(c=v(),c!==f?(c=Za(),c!==f?(c=v(),c!==f?(c=t(),c!==f?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f);return a}
function oa(){var a,b,c;a=g;b=Ya();b!==f?(b=v(),b!==f?(b=t(),b!==f?(c=v(),c!==f?(c=Za(),c!==f?(c=v(),c!==f?(c=t(),c!==f?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f)):(g=a,a=f);return a}function J(){var b,c;b=g;var d,h;c=g;a.substr(g,4).toLowerCase()===Yd?(d=a.substr(g,4),g+=4):(d=f,0===u&&e(Zd));d!==f?(d=g,u++,h=D(),u--,h===f?d=void 0:(g=d,d=f),d!==f?c="ELSE":(g=c,c=f)):(g=c,c=f);c!==f?(c=v(),c!==f?(c=t(),c!==f?b={type:"else_clause",value:c}:
(g=b,b=f)):(g=b,b=f)):(g=b,b=f);return b}function V(){var b,c,d;b=W();b===f&&(b=g,45===a.charCodeAt(g)?(c=cc,g++):(c=f,0===u&&e(dc)),c===f&&(43===a.charCodeAt(g)?(c=ac,g++):(c=f,0===u&&e(bc))),c!==f?(d=W(),d!==f?b=c=c[0]+d:(g=b,b=f)):(g=b,b=f));return b}function Da(){var b,c;b=g;46===a.charCodeAt(g)?(c=$d,g++):(c=f,0===u&&e(ae));c!==f?(c=W(),c===f&&(c=null),c!==f?b="."+(null!=c?c:""):(g=b,b=f)):(g=b,b=f);return b}function ua(){var b,c,d;c=b=g;be.test(a.charAt(g))?(d=a.charAt(g),g++):(d=f,0===u&&e(ce));
d!==f?(de.test(a.charAt(g))?(d=a.charAt(g),g++):(d=f,0===u&&e(ee)),d===f&&(d=null),d!==f?c="e"+(null===d?"":d):(g=c,c=f)):(g=c,c=f);c!==f?(d=W(),d!==f?b=c+d:(g=b,b=f)):(g=b,b=f);return b}function W(){var a,b;a=[];b=F();if(b!==f)for(;b!==f;)a.push(b),b=F();else a=f;a!==f&&(a=a.join(""));return a}function F(){var b;fe.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===u&&e(ge));return b}function pa(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===he?(c=a.substr(g,2),g+=2):(c=f,0===u&&e(ie));c!==f?(c=g,u++,
d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="IN":(g=b,b=f)):(g=b,b=f);return b}function Y(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===je?(c=a.substr(g,2),g+=2):(c=f,0===u&&e(ke));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="IS":(g=b,b=f)):(g=b,b=f);return b}function ma(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===le?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(me));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="LIKE":(g=b,b=f)):(g=b,b=f);return b}function qa(){var b,c,d;b=g;a.substr(g,
3).toLowerCase()===ne?(c=a.substr(g,3),g+=3):(c=f,0===u&&e(oe));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="NOT":(g=b,b=f)):(g=b,b=f);return b}function na(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===pe?(c=a.substr(g,3),g+=3):(c=f,0===u&&e(qe));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="AND":(g=b,b=f)):(g=b,b=f);return b}function Xa(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===re?(c=a.substr(g,2),g+=2):(c=f,0===u&&e(se));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=
c,c=f),c!==f?b="OR":(g=b,b=f)):(g=b,b=f);return b}function ra(){var b,c,d;b=g;a.substr(g,7).toLowerCase()===te?(c=a.substr(g,7),g+=7):(c=f,0===u&&e(ue));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="BETWEEN":(g=b,b=f)):(g=b,b=f);return b}function $b(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===ve?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(we));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="FROM":(g=b,b=f)):(g=b,b=f);return b}function tc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===
xe?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(ye));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="TRIM":(g=b,b=f)):(g=b,b=f);return b}function uc(){var b,c,d;b=g;a.substr(g,8).toLowerCase()===ze?(c=a.substr(g,8),g+=8):(c=f,0===u&&e(Ae));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="INTERVAL":(g=b,b=f)):(g=b,b=f);return b}function vc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Be?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(Ce));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?
b="YEAR":(g=b,b=f)):(g=b,b=f);return b}function wc(){var b,c,d;b=g;a.substr(g,5).toLowerCase()===De?(c=a.substr(g,5),g+=5):(c=f,0===u&&e(Ee));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="MONTH":(g=b,b=f)):(g=b,b=f);return b}function xc(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Fe?(c=a.substr(g,3),g+=3):(c=f,0===u&&e(Ge));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="DAY":(g=b,b=f)):(g=b,b=f);return b}function yc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===He?(c=a.substr(g,
4),g+=4):(c=f,0===u&&e(Ie));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="HOUR":(g=b,b=f)):(g=b,b=f);return b}function zc(){var b,c,d;b=g;a.substr(g,6).toLowerCase()===Je?(c=a.substr(g,6),g+=6):(c=f,0===u&&e(Ke));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="MINUTE":(g=b,b=f)):(g=b,b=f);return b}function Ea(){var b,c,d;b=g;a.substr(g,6).toLowerCase()===Le?(c=a.substr(g,6),g+=6):(c=f,0===u&&e(Me));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="SECOND":(g=b,b=f)):
(g=b,b=f);return b}function Cb(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Ne?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(Oe));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="CASE":(g=b,b=f)):(g=b,b=f);return b}function Db(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Pe?(c=a.substr(g,3),g+=3):(c=f,0===u&&e(Qe));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="END":(g=b,b=f)):(g=b,b=f);return b}function Ya(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Re?(c=a.substr(g,4),g+=4):(c=
f,0===u&&e(Se));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="WHEN":(g=b,b=f)):(g=b,b=f);return b}function Za(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Te?(c=a.substr(g,4),g+=4):(c=f,0===u&&e(Ue));c!==f?(c=g,u++,d=D(),u--,d===f?c=void 0:(g=c,c=f),c!==f?b="THEN":(g=b,b=f)):(g=b,b=f);return b}function ya(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=f,0===u&&e(We));return b}function da(){var b;40===a.charCodeAt(g)?(b=Xe,g++):(b=f,0===u&&e(Ye));return b}function ea(){var b;41===a.charCodeAt(g)?
(b=Ze,g++):(b=f,0===u&&e($e));return b}function v(){var a,b;a=[];for(b=zb();b!==f;)a.push(b),b=zb();return a}function zb(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=f,0===u&&e(bf));return b}function bb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function za(a,b){for(var c=0;c<b.length;c++)a=bb(b[c][1],a,b[c][3]);return a}q=void 0!==q?q:{};var f={},Ab={start:h},Bb=h,$c="!",ad=k("!",!1),$a="\x3d",ab=k("\x3d",!1),cb="\x3e\x3d",dd=k("\x3e\x3d",!1),
ed="\x3e",fd=k("\x3e",!1),db="\x3c\x3d",gd=k("\x3c\x3d",!1),eb="\x3c\x3e",hd=k("\x3c\x3e",!1),id="\x3c",jd=k("\x3c",!1),fb="!\x3d",kd=k("!\x3d",!1),ac="+",bc=k("+",!1),cc="-",dc=k("-",!1),ld="*",md=k("*",!1),nd="/",od=k("/",!1),Hd=/^[A-Za-z_\x80-\uFFFF]/,Id=c([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Jd=/^[A-Za-z0-9_]/,Kd=c([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Ld=/^[A-Za-z0-9_.\x80-\uFFFF]/,Md=c([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Nd="@",Od=k("@",!1),
rb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},sb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},tb="'",ub=k("'",!1),vb="N'",Xd=k("N'",!1),Ca="''",wb=k("''",!1),xb=/^[^']/,yb=c(["'"],!0,!1),$d=".",ae=k(".",!1),fe=/^[0-9]/,ge=c([["0","9"]],!1,!1),be=/^[eE]/,ce=c(["e","E"],!1,!1),de=/^[+\-]/,ee=c(["+","-"],!1,!1),td="null",ud=k("NULL",!0),pd="true",qd=k("TRUE",!0),rd="false",sd=k("FALSE",!0),he="in",ie=k("IN",!0),je=
"is",ke=k("IS",!0),le="like",me=k("LIKE",!0),bd="escape",cd=k("ESCAPE",!0),ne="not",oe=k("NOT",!0),pe="and",qe=k("AND",!0),re="or",se=k("OR",!0),te="between",ue=k("BETWEEN",!0),ve="from",we=k("FROM",!0),Dd="for",Ed=k("FOR",!0),Bd="substring",Cd=k("SUBSTRING",!0),zd="extract",Ad=k("EXTRACT",!0),xe="trim",ye=k("TRIM",!0),Fd="position",Gd=k("POSITION",!0),xd="timestamp",yd=k("TIMESTAMP",!0),vd="date",wd=k("DATE",!0),Pd="leading",Qd=k("LEADING",!0),Rd="trailing",Sd=k("TRAILING",!0),Td="both",Ud=k("BOTH",
!0),Vd="to",Wd=k("TO",!0),ze="interval",Ae=k("INTERVAL",!0),Be="year",Ce=k("YEAR",!0),De="month",Ee=k("MONTH",!0),Fe="day",Ge=k("DAY",!0),He="hour",Ie=k("HOUR",!0),Je="minute",Ke=k("MINUTE",!0),Le="second",Me=k("SECOND",!0),Ne="case",Oe=k("CASE",!0),Pe="end",Qe=k("END",!0),Re="when",Se=k("WHEN",!0),Te="then",Ue=k("THEN",!0),Yd="else",Zd=k("ELSE",!0),Ve=",",We=k(",",!1),Xe="(",Ye=k("(",!1),Ze=")",$e=k(")",!1),af=/^[ \t\n\r]/,bf=c([" ","\t","\n","\r"],!1,!1),Sc="`",Tc=k("`",!1),Uc=/^[^`]/,Vc=c(["`"],
!0,!1),g=0,Fa=[{line:1,column:1}],aa=0,Na=[],u=0,xa;if("startRule"in q){if(!(q.startRule in Ab))throw Error("Can't start parsing from rule \""+q.startRule+'".');Bb=Ab[q.startRule]}xa=Bb();if(xa!==f&&g===a.length)return xa;xa!==f&&g<a.length&&e({type:"end"});throw function(a,b,c){return new y(y.buildMessage(a,b),a,b,c)}(Na,aa<a.length?a.charAt(aa):null,aa<a.length?b(aa,aa+1):b(aa,aa));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(y,a){Object.defineProperty(a,
"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/Set ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(y,a,q,k,c,d,b,e,h,l,t,p,z,r,A,C){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(l.isValid(a.outSR)&&!l.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=C.cleanFromGeometryEngine(q({spatialReference:a.outSR},r.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=C.cleanFromGeometryEngine(q({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=z.getWhereClause(b.where,this.fieldsIndex);if(!c)return e.resolve(this);if(c.isStandardized){for(var d=0,h=[],k=0,l=this.items;k<l.length;k++){var m=l[k];c.testFeature(m,this.featureAdapter)&&(h[d++]=m)}c=new a(h,this.queryGeometry,this);c.definitionExpression=b.where;return e.resolve(c)}return e.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return e.resolve(this);var c=new d.default(b.objectIds),h=this.featureAdapter.getObjectId;return e.resolve(new a(this.items.filter(function(a){return c.has(h(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(c){c=A.getTimeOperator(this.timeInfo,c.timeExtent,this.featureAdapter);if(!b.isSome(c))return e.resolve(this);c=this.items.filter(c);return e.resolve(new a(c,this.queryGeometry,this))};a.prototype.project=
function(b){return c(this,void 0,void 0,function(){var c,d,e,h=this;return k(this,function(k){switch(k.label){case 0:if(!b||l.equals(this.spatialReference,b))return[2,this];c=this.featureAdapter;return[4,r.projectMany(this.items.map(function(a){return C.getGeometry(h,c.getGeometry(a))}),this.spatialReference,b)];case 1:return d=k.sent(),e=d.map(function(a,b){return c.cloneWithGeometry(h.items[b],t.convertFromGeometry(a,h.hasZ,h.hasM))}),[2,new a(e,this.queryGeometry,{definitionExpression:this.definitionExpression,
geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,e=this.hasM,k=this.hasZ,l=this.objectIdField,m=this.spatialReference,p=a.outFields,r=a.outSR,t=a.quantizationParameters,q=a.resultRecordCount,z=a.resultOffset,n=!1;null!=q&&null!=z&&(q=z+q,n=c.length>
q,c=c.slice(z,Math.min(c.length,q)));return{exceededTransferLimit:n,features:this._createFeatures(a,c),fields:p&&p.map(function(a){return b.fieldsIndex.get(a)}),geometryType:d,hasM:e,hasZ:k,objectIdFieldName:l,spatialReference:C.cleanFromGeometryEngine(r?r:m),transform:t&&h.toQuantizationTransform(t)||null}};a.prototype._createFeatures=function(a,b){var c=new p.default(a,this.featureAdapter,this.fieldsIndex),d=a.quantizationParameters,e=a.returnGeometry,k=a.returnCentroid,l=a.maxAllowableOffset,m=
a.orderByFields;a=[];var r=0;if(b.length&&m&&m.length){var m=m[0].split(" "),t=m[0],q=this.fieldsIndex.get(t),z="DESC"===m[1];b.sort(function(a,b){a=c.getFieldValue(a,t,q);b=c.getFieldValue(b,t,q);if("number"===typeof a&&"number"===typeof b)return z?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(z?a>b:a<b)?-1:(z?a<b:a>b)?1:0})}if(e||k)if(d=h.toQuantizationTransform(d),e&&!k)for(k=0;k<b.length;k++)e=b[k],a[r++]={attributes:c.getAttributes(e),geometry:C.getGeometry(this,
this.featureAdapter.getGeometry(e),l,d)};else if(!e&&k)for(l=0;l<b.length;l++)e=b[l],a[r++]={attributes:c.getAttributes(e),centroid:C.transformCentroid(this,this.featureAdapter.getCentroid(e,this),d)};else for(k=0;k<b.length;k++)e=b[k],a[r++]={attributes:c.getAttributes(e),centroid:C.transformCentroid(this,this.featureAdapter.getCentroid(e,this),d),geometry:C.getGeometry(this,this.featureAdapter.getGeometry(e),l,d)};else for(l=0;l<b.length;l++)e=b[l],(e=c.getAttributes(e))&&(a[r++]={attributes:e});
return a};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var h=a[e];if("exceedslimit"===h.statisticType){c=null!=h.maxPointCount?h.maxPointCount:Number.POSITIVE_INFINITY;d=null!=h.maxRecordCount?h.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=h.maxVertexCount?h.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)b=this.items.length>
c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,k=this.featureAdapter,b=this.items.reduce(function(a,b){b=k.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new p.default(a,this.featureAdapter,this.fieldsIndex),
c=a.outStatistics,d=[],e=[],h=a.groupByFieldsForStatistics;a=a.having;for(var k=h&&h.length,h=k&&h[0],l=this.fieldsIndex.get(h),m=!l,r={},t={},q={},z={attributes:{}},n=0;n<c.length;n++){var w=c[n],G=w.outStatisticFieldName,E=w.statisticType,w="exceedslimit"!==E?w.onStatisticField:void 0,y=this.fieldsIndex.get(w),J=k&&(w===h||m)&&"count"===E;if(k){r[w]||(r[w]=this._calculateUniqueValues(b,h,l));var V=r[w],A;for(A in V){var C=V[A],H=C.count,F=C.data,pa=C.items;if(!a||b.validateItems(pa,a)){var C=t[F]||
{attributes:{}},Y=null;J?Y=H:(H=this._calculateStatistics(pa,b,w,y),pa="var"===E?"variance":E,Y=H[pa]);C.attributes[G]=Y;C.attributes[m?"EXPR_1":h]=F;t[F]=C}}}else q[w]||(q[w]=this._calculateStatistics(this.items,b,w,y)),H=q[w],pa="var"===E?"variance":E,z.attributes[G]=H[pa];e.push({name:G,alias:G,type:"esriFieldTypeDouble"})}if(k)for(var ma in t)d.push(t[ma]);else d.push(z);return{fields:e,features:d}};a.prototype._calculateStatistics=function(a,b,c,d){for(var e=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,
k=null,l=null,m=null,p=null,r=[],t=0,q=0;q<a.length;q++){var n=b.getFieldValue(a[q],c,d);"string"===typeof n?t++:null==n||isNaN(n)||(k+=n,e=Math.min(e,n),h=Math.max(h,n),r.push(n),t++)}if(t){l=k/t;for(b=a=0;b<r.length;b++)n=r[b],a+=Math.pow(n-l,2);p=1<t?a/(t-1):0;m=Math.sqrt(p)}else h=e=null;return{avg:l,count:t,max:h,min:e,stddev:m,sum:k,variance:p}};a.prototype._calculateUniqueValues=function(a,b,c){for(var d={},e=0,h=this.items;e<h.length;e++){var k=h[e],l=a.getFieldValue(k,b,c);if(null==l||"string"===
typeof l&&""===l.trim())l=null;null==d[l]?d[l]={count:1,data:l,items:[k]}:(d[l].count++,d[l].items.push(k))}return d};return a}();a.default=y})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","@dojo/framework/shim/Map","../../../core/maybe","./attributeSupport"],function(y,a,q,k,c){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,d,h){this._fieldDataCache=new q.default;this._returnDistinctMap=new q.default;this.returnDistinctValues=a.returnDistinctValues;
this.fieldsIndex=h;this.featureAdapter=d;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var b=d=0;b<a.length;b++){var e=a[b],k=c.getExpressionFromFieldName(e),z=this.fieldsIndex.get(k),k=z?null:c.getWhereClause(k,h),z=z?z.name:c.getAliasFromFieldName(e)||"FIELD_EXP_"+d++;this._fieldDataCache.set(e,{alias:z,clause:k})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,
d,h){var b=h?h.name:d,e=null;this._fieldDataCache.has(b)?e=this._fieldDataCache.get(b).clause:h||(e=c.getWhereClause(d,this.fieldsIndex),this._fieldDataCache.set(b,{alias:b,clause:e}));return h?this.featureAdapter.getAttribute(a,b):e.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:c.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d).clause.testFeature(a,this.featureAdapter)};
a.prototype.validateItems=function(a,d){this._fieldDataCache.has(d)||this._fieldDataCache.set(d,{alias:d,clause:c.getWhereClause(d,this.fieldsIndex)});return this._fieldDataCache.get(d).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},d=0;d<b.length;d++){var k=this._fieldDataCache.get(b[d]),p=k.alias,k=k.clause;c[p]=k?k.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,
p)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(k.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var d=0;d<b.length;d++){var q=this._fieldDataCache.get(b[d]).alias;c.push(a[q])}else for(q in a)c.push(a[q]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();a.default=y})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],
function(y,a){function q(a,d,b,e,h){if(null!=e&&null!=h&&e===h)return function(c){return e>=a.getAttribute(c,d)&&e<=a.getAttribute(c,b)};if(null!=e&&null!=h)return function(c){var k=a.getAttribute(c,d);c=a.getAttribute(c,b);return!(k>h||c<e)};if(null!=e)return function(c){return!(a.getAttribute(c,b)<e)};if(null!=h)return function(b){return!(a.getAttribute(b,d)>h)}}function k(a,d,b,e){if(null!=b&&null!=e&&b===e)return function(c){return a.getAttribute(c,d)===b};if(null!=b&&null!=e)return function(c){return a.getAttribute(c,
d)>=b&&a.getAttribute(c,d)<=e};if(null!=b)return function(c){return a.getAttribute(c,d)>=b};if(null!=e)return function(b){return a.getAttribute(b,d)<=e}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,d){if(!a)return null;var b=d.featureAdapter,c=a.startTimeField,h=a.endTimeField,k=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY;if(c&&h)d.forEach(function(a){var d=b.getAttribute(a,c);a=b.getAttribute(a,h);null==d||isNaN(d)||(k=Math.min(k,d));null==a||isNaN(a)||(q=Math.max(q,
a))});else{var p=c||h;d.forEach(function(a){a=b.getAttribute(a,p);null==a||isNaN(a)||(k=Math.min(k,a),q=Math.max(q,a))})}return{start:k,end:q}};a.getTimeOperator=function(a,d,b){if(!d||!a)return null;var c=a.startTimeField;a=a.endTimeField;if(!c&&!a)return null;var h=d.start;d=d.end;return null==h&&null==d?null:c&&a?q(b,c,a,h,d):k(b,c||a,h,d)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(y,a,q,k,c,d,b,e,h,l,t,p,z,r,A,C,H){function m(a,b,c){c&&(b=r.quantizeOptimizedGeometry(N,b,a.hasZ,a.hasM,"esriGeometryPoint",c));return r.convertToPoint(b,a.hasZ,a.hasM)}function B(b,c,e){return k(this,void 0,void 0,function(){var k,m,p,r,E,x;return q(this,function(n){switch(n.label){case 0:if(!b)return[2,null];k=b.where;b.where=k=k&&k.trim();if(!k||/^1 *= *1$/.test(k)||c&&c===k)b.where=null;return b.geometry?[4,I(b)]:[2,b];case 1:return m=n.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===
b.spatialRel&&(p=b.geometry.spatialReference,m=h.getGeometryExtent(m),m.spatialReference=p),b.geometry=m,[4,C.checkProjectionSupport(m.spatialReference,e)];case 2:return n.sent(),[4,t.normalizeCentralMeridian(l.fromJSON(m))];case 3:r=n.sent()[0];if(d.isNone(r))throw a.QUERY_ENGINE_EMPTY_RESULT;E=r.toJSON();return[4,C.project(E,E.spatialReference,e)];case 4:x=n.sent();if(!x)throw a.QUERY_ENGINE_EMPTY_RESULT;x.spatialReference=e;b.geometry=x;return[2,b]}})})}function I(a){return k(this,void 0,void 0,
function(){var c,d,h,k,l,m,E,r,t,z;return q(this,function(n){switch(n.label){case 0:c=a.geometry;d=a.distance;h=a.units;if(null==d)return[2,b.resolve(c)];k=c.spatialReference;l=h&&x.fromJSON(h)||e.getUnitString(k);m=k&&(p.isGeographic(k)||p.isWebMercator(k));if(!m)return[3,1];r=c;return[3,3];case 1:return[4,C.checkProjectionSupport(k,p.WGS84).then(function(){return C.project(c,p.WGS84)})];case 2:r=n.sent(),n.label=3;case 3:return E=r,[4,H.getGeodesicBufferOperator()];case 4:return t=n.sent(),z=t(E,
d,l),[2,z?z.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var x=new c.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var S=new A.default,N=new A.default,D={esriGeometryPoint:r.convertToPoint,esriGeometryPolyline:r.convertToPolyline,esriGeometryPolygon:r.convertToPolygon,
esriGeometryMultipoint:r.convertToMultipoint};a.transformCentroid=m;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=z.getCentroidOptimizedGeometry(new A.default,b.geometry,a.hasZ,a.hasM));return m(a,b.centroid,c)};a.getGeometry=function(a,b,c,d){b=b?"coords"in b?b:b.geometry:null;return b?c?(c=r.generalizeOptimizedGeometry(S,b,a.hasZ,a.hasM,a.geometryType,c),d&&(c=r.quantizeOptimizedGeometry(N,c,a.hasZ,a.hasM,
a.geometryType,d)),D[a.geometryType](c,a.hasZ,a.hasM)):d?(c=r.quantizeOptimizedGeometry(N,b,a.hasZ,a.hasM,a.geometryType,d),D[a.geometryType](c,a.hasZ,a.hasM)):D[a.geometryType](b,a.hasZ,a.hasM):null};a.normalizeQuery=function(a,b,c){return k(this,void 0,void 0,function(){var d,e,h,k,l;return q(this,function(m){d=a.outFields;e=a.orderByFields;h=a.groupByFieldsForStatistics;k=a.outStatistics;if(d)for(l=0;l<d.length;l++)d[l]=d[l].trim();if(e)for(l=0;l<e.length;l++)e[l]=e[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=
h[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,B(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return k(this,void 0,void 0,function(){return q(this,function(d){return[2,B(a,b,c)]})})};a.normalizeQueryLike=B;a.cleanFromGeometryEngine=function(a){return a&&ba in a?JSON.parse(JSON.stringify(a,Q)):a};var ba="_geVersion",Q=function(a,b){return a!==ba?b:void 0}})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(y,a,q,k,c,d,b,e,h,l,t,p,z,r,A){function C(){return d.create(function(a){return y(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var H={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},m={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},B={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},I={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=C;a.getGeodesicBufferOperator=function(){return C().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,c,k){if(h.isPolygon(c)&&"esriGeometryPoint"===k.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var l=p.convertFromPolygon(new z.default,c,!1,!1);return d.resolve(function(a){return t.polygonContainsPoint(l,!1,!1,a)})}if(h.isPolygon(c)&&"esriGeometryMultipoint"===k.geometryType){var m=
p.convertFromPolygon(new z.default,c,!1,!1);if("esriSpatialRelContains"===a)return d.resolve(function(a){return t.polygonContainsMultipoint(m,!1,!1,a,k.hasZ,k.hasM)})}if(h.isExtent(c)&&"esriGeometryPoint"===k.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return d.resolve(function(a){return b.extentContainsPoint(c,A.getGeometry(k,a))});if(h.isExtent(c)&&"esriGeometryMultipoint"===k.geometryType&&"esriSpatialRelContains"===a)return d.resolve(function(a){return b.extentContainsMultipoint(c,
A.getGeometry(k,a))});if(h.isExtent(c)&&"esriSpatialRelIntersects"===a){var q=e.getExtentIntersector(k.geometryType);return d.resolve(function(a){return q(c,A.getGeometry(k,a))})}return C().then(function(b){var d=b[H[a]].bind(null,c);return function(a){return d(A.getGeometry(k,a))}})};a.checkSpatialQuerySupport=function(a,b,d){return k(this,void 0,void 0,function(){var e,k;return q(this,function(p){e=a.spatialRel;k=a.geometry;if(!k)return[2];if(!0!==m[e])throw new c("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!l.isValid(k.spatialReference)||!l.isValid(d))return[2];if(!0!==B[h.getJsonType(k)])throw new c("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==I[b])throw new c("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,r.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(h.isExtent(a))return!0;if(h.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(y,a){function q(a,c,d,b,e){if(!a)return!1;c=c?d?4:3:d?3:2;d=a.coords;var h=!1,k=0,q=0;for(a=a.lengths;q<a.length;q++){for(var p=a[q],z=k,r=k,y=k+p*c;r<y;r+=c){z=r+c;z===y&&(z=k);var C=d[r],H=d[r+1],m=d[z],z=d[z+1];(H<
e&&z>=e||z<e&&H>=e)&&C+(e-H)/(z-H)*(m-C)<b&&(h=!h)}k+=p*c}return h}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,c,d,b){return q(a,c,d,b.coords[0],b.coords[1])};a.polygonContainsMultipoint=function(a,c,d,b,e,h){e=e?h?4:3:h?3:2;h=b.coords;b=b.lengths;if(!b)return!1;for(var k=0,t=0;k<b.length;k++,t+=e)if(!q(a,c,d,h[t],h[t+1]))return!1;return!0};a.polygonContainsCoords=q})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(y,a,q){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var c=this;return q.create(function(b,d){c._deferreds.push({resolve:b,reject:d});c._values.push(a)})};a.prototype.unshift=function(a){var c=this;return q.create(function(b,d){c._deferreds.unshift({resolve:b,reject:d});c._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,
configurable:!0});a.prototype.process=function(){if(0===this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=q.createAbortError(),d=0,b=this._deferreds;d<b.length;d++)b[d].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=y})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),
function(y,a,q,k,c,d){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?d.defaultPointSymbolJSON:"esriGeometryPolyline"===a?d.defaultPolylineSymbolJSON:d.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,c){if(k("csp-restrictions"))return function(){var b;return q((b={},b[c]=null,b),a)};try{var b="this."+c+" \x3d null;",d;for(d in a)b+="this."+d+" \x3d "+
JSON.stringify(a[d])+";";var e=new Function(b);return function(){return new e}}catch(p){return function(){var b;return q((b={},b[c]=null,b),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:c.clone(a)}}]}})},"*now":function(y){y(['dojo/i18n!*preload*esri/layers/graphics/sources/support/nls/CSVSourceWorker*["ar","bs","ca","cs","da","de","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper @dojo/framework/shim/Set dojo/number dstore/Csv ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../geometry/projection ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/webMercatorUtils ../../OptimizedFeature ../../OptimizedGeometry ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ../../../support/FieldsIndex".split(" "),function(y,
a,q,k,c,d,b,e,h,l,t,p,z,r,A,C,H,m,B,I,x,S,N,D){Object.defineProperty(a,"__esModule",{value:!0});var ba=N.createDrawingInfo("esriGeometryPoint"),Q=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];a.csvLatitudeFieldNames="lat latitude y ycenter latitude83 latdecdeg point-y".split(" ");a.csvLongitudeFieldNames="lon lng long longitude x xcenter longitude83 longdecdeg point-x".split(" ");a.csvDetectedDelimiters=[","," ",";","|","\t"];
var ca=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,ga=[0,0],X=function(){return function(a,b){this.x=a;this.y=b}}(),L=function(){var a=d._parseInfo(),b=new RegExp("^"+a.regexp+"$"),c=new RegExp("["+a.group+"\\s\\xa0]","g"),e=a.factor;return function(d){d=b.exec(d);a.factor=e;if(!d)return NaN;var h=d[1];if(!d[1]){if(!d[2])return NaN;h=d[2];a.factor*=-1}h=h.replace(c,"").replace(a.decimal,
".");return+h*a.factor}}(),n=function(){return"isInteger"in Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();y=function(){function d(){this._queryEngine=this._fieldsIndex=null}d.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._fieldsIndex=this._queryEngine=null};d.prototype.load=function(a,b){void 0===b&&(b={});return k(this,void 0,void 0,function(){var c,d,e,h,k;return q(this,function(l){switch(l.label){case 0:return[4,
z.all([this._fetch(a.url,b),this._checkProjection(b&&a.parsing&&a.parsing.spatialReference)])];case 1:return c=l.sent()[0],d=this._parse(c,a.parsing),this._queryEngine=this._createQueryEngine(c,d),d.layerDefinition.extent=this._queryEngine.fullExtent,d.layerDefinition.timeInfo&&(e=this._queryEngine.timeExtent,h=e.start,k=e.end,d.layerDefinition.timeInfo.timeExtent=[h,k]),[2,d]}})})};d.prototype.applyEdits=function(a){return k(this,void 0,void 0,function(){return q(this,function(a){throw new l("csv-source:editing-not-supported",
"applyEdits() is not supported on CSVLayer");})})};d.prototype.queryFeatures=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQuery(a,b.signal)]})})};d.prototype.queryFeatureCount=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};d.prototype.queryObjectIds=function(a,
b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};d.prototype.queryExtent=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};d.prototype._fetch=function(a,b){return k(this,void 0,void 0,function(){var c,d;return q(this,function(e){switch(e.label){case 0:if(!a)throw new l("csv-source:invalid-source",
"url not defined");c=r.urlToObject(a);return[4,h(c.path,{query:c.query,responseType:"text",signal:b.signal})];case 1:return d=e.sent(),[2,d.data]}})})};d.prototype._parse=function(a,b){void 0===b&&(b={});for(var c={columnDelimiter:b.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:b.latitudeField,longitudeFieldName:b.longitudeField}};a&&"\n"===a[0];)a=a.slice(1);"\n"!==a[a.length-1]&&(a+="\n");var d=this._readFirstLine(a);if(!d)throw new l("csv","CSV is empty",{csv:a});if(!b.columnDelimiter){var e=
this._inferDelimiter(d);if(!e)throw new l("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");c.columnDelimiter=e}var d=d.split(c.columnDelimiter),h=c.layerDefinition={name:"csv",drawingInfo:ba,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:b.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:b.spatialReference||{wkid:102100}}};if(!b.latitudeField||!b.longitudeField){e=
this._inferLocationInfo(d);if(!b.longitudeField&&!e.longitudeFieldName||!b.latitudeField&&!e.latitudeFieldName)throw new l("csv","Unable to identify latitudeField and/or longitudeField from CSV");c.locationInfo={longitudeFieldName:b.longitudeField||e.longitudeFieldName,latitudeFieldName:b.latitudeField||e.latitudeFieldName}}a=this._inferFields(a,c.columnDelimiter,d,c.locationInfo);if(b.fields&&b.fields.length){for(var d=new Map,e=0,k=b.fields;e<k.length;e++)b=k[e],d.set(b.name.toLowerCase(),b);for(e=
0;e<a.length;e++)if(b=a[e],k=d.get(b.name.toLowerCase())){var m=b.name;p.mixin(b,k);b.name=m}}h.fields=a;h.fields.some(function(a){return"esriFieldTypeOID"===a.type?(h.objectIdField=a.name,!0):!1})||(b={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1},h.objectIdField=b.name,h.fields.unshift(b));this._fieldsIndex=new D(h.fields);h.timeInfo&&(b=h.timeInfo,b.startTimeField&&((a=this._fieldsIndex.get(b.startTimeField.toLowerCase()))?(b.startTimeField=a.name,a.type=
"esriFieldTypeDate"):b.startTimeField=null),b.endTimeField&&((a=this._fieldsIndex.get(b.endTimeField.toLowerCase()))?(b.endTimeField=a.name,a.type="esriFieldTypeDate"):b.endTimeField=null),b.trackIdField&&(a=this._fieldsIndex.get(b.trackIdField.toLowerCase()),b.trackIdField=a?a.name:null),b.startTimeField||b.endTimeField||(h.timeInfo=null));return c};d.prototype._inferLocationInfo=function(b){var c=null,d=null;b.forEach(function(b){var e=b.toLowerCase(),h;h=a.csvLatitudeFieldNames.indexOf(e);-1===
h||d||(d=b);h=a.csvLongitudeFieldNames.indexOf(e);-1===h||c||(c=b)});return{longitudeFieldName:c,latitudeFieldName:d}};d.prototype._inferFields=function(a,b,c,d){var e=[],h=this._sampleLines(a).map(function(a){return a.split(b).map(function(a){return a.trim()})});a=function(a){var b=c[a];if(b===d.longitudeFieldName||b===d.latitudeFieldName)e.push({name:b,type:"esriFieldTypeDouble",alias:b});else{var l=h.map(function(b){return b[a]}),l=k._inferFieldType(l),b={name:b.replace(/[\s\'\u2019\u2018\.\-\/\(\)]+/g,
"_"),type:null,alias:b};switch(l){case "integer":b.type="esriFieldTypeInteger";break;case "double":b.type="esriFieldTypeDouble";break;case "date":b.type="esriFieldTypeDate";b.length=36;break;default:b.type="esriFieldTypeString",b.length=255}e.push(b)}};for(var k=this,l=0;l<c.length;l++)a(l);return e};d.prototype._inferFieldType=function(a){var b=this;if(!a.length)return"string";var c=/[^+-.,0-9]/;return a.map(function(a){var d=!1;if(""===a||c.test(a))d=!0;else{d=L(a);if(!isNaN(d))return/[.,]/.test(a)||
!n(d)||214783647<d||-214783648>d?"double":"integer";if(-1===a.indexOf("E"))d=!0;else if(d=Number(a),isNaN(d))if(-1===a.indexOf(","))d=!0;else if(a=a.replace(",","."),d=Number(a),isNaN(d))d=!0;else return"double";else return"double"}return d&&!/^[-]?\d*[.,]?\d*$/.test(a)&&b._isValidDate(new Date(a),a)?"date":"string"}).reduce(function(a,b){if(a===b)return b;if("string"===a||"string"===b)return"string";if("double"===a||"double"===b)return"double"})};d.prototype._isValidDate=function(a,b){if(!a||"[object Date]"!==
Object.prototype.toString.call(a)||isNaN(a.getTime()))return!1;a=!0;if(t("chrome")&&/\d+\W*$/.test(b)&&(b=b.match(/[a-zA-Z]{2,}/))){a=!1;for(var c=0;!a&&c<=b.length;)a=!ca.test(b[c]),c++;a=!a}return a};d.prototype._readFirstLine=function(a){return a.substring(0,a.indexOf("\n")).trim()};d.prototype._sampleLines=function(a,b){void 0===b&&(b=10);for(var c=!1,d=[],e=a.indexOf("\n")+1;!c&&d.length<b;){var h=a.indexOf("\n",e);if(-1===h)c=!0;else{var k=void 0;(k=-1===h&&e<a.length-1?a.substring(e).trim():
a.substring(e,h).trim())&&d.push(k);e=h+1}}return d};d.prototype._inferDelimiter=function(b){var c=0,d="";a.csvDetectedDelimiters.forEach(function(a){var e=b.split(a).length;e>c&&(c=e,d=a)});return""===d?null:d};d.prototype._createQueryEngine=function(a,d){var h,k=d.locationInfo;h=k.latitudeFieldName;for(var l=k.longitudeFieldName,n=d.layerDefinition,k=n.objectIdField,p=n.fields,q=n.extent,r=n.timeInfo,n=[],t=[],w=new c.Set,z=new c.Set,y=[],x=0;x<p.length;x++){var E=p[x],D=E.name,E=E.type;"esriFieldTypeDate"===
E?w.add(D):-1<Q.indexOf(E)&&z.add(D);D!==k&&y.push(D)}p=new b;p.delimiter=d.columnDelimiter;p.fieldNames=y;p.newline="\n";a=p.parse(a);p=0;a.shift();for(y=0;y<a.length;y++)if(x=a[y],D=this._parseCoordinateValue(x[h]),E=this._parseCoordinateValue(x[l]),null!=E&&null!=D&&!isNaN(D)&&!isNaN(E)){x[h]=D;x[l]=E;for(var G in x)if(G!==h&&G!==l)if(w.has(G)){var N=new Date(x[G]);x[G]=this._isValidDate(N,x[G])?N.getTime():null}else z.has(G)&&(N=L(x[G]),isNaN(N)?x[G]=null:x[G]=N);x[k]=p;p++;n.push(new X(E,D));
t.push(x)}if(!C.equals({wkid:4326},q.spatialReference))if(C.isWebMercator(q.spatialReference))for(G=0,l=n;G<l.length;G++)w=l[G],h=H.lngLatToXY(w.x,w.y,ga),w.x=h[0],w.y=h[1];else n=A.projectMany(n,e.SpatialReference.WGS84,q.spatialReference,null,!0);h=new I.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});d=new S.default({fields:d.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:r,objectIdField:k,spatialReference:q.spatialReference||{wkid:4326},cacheSpatialQueries:!0,
featureStore:h});q=[];for(r=0;r<n.length;r++)l=n[r],G=l.x,l=l.y,w=t[r],w[k]=r+1,q.push(new m.default(new B.default([],[G,l]),w,null,w[k]));h.addMany(q);return d};d.prototype._parseCoordinateValue=function(a){if(null==a||""===a)return null;var b=L(a);if(isNaN(b)||181<Math.abs(b))b=parseFloat(a);return b};d.prototype._checkProjection=function(a){return k(this,void 0,void 0,function(){return q(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,x.checkProjectionSupport(C.WGS84,a)];
case 1:return b.sent(),[3,3];case 2:throw b.sent(),new l("csv-layer","Projection not supported");case 3:return[2]}})})};return d}();a.default=y});