// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../nls/DatePicker ../../../intl ../../../moment ../../../core/events ../../../core/accessorSupport/decorators ../../Widget ./DatePickerViewModel ../../support/widget".split(" "),function(y,z,v,g,h,k,m,n,l,w,p,c){var q={year:"numeric",month:"2-digit",day:"2-digit"},x=" ;ArrowDown;ArrowLeft;ArrowRight;ArrowUp;End;Enter;Home;PageDown;PageUp".split(";");return function(r){function b(a){a=
r.call(this)||this;a._activeDate=null;a._calendarNode=null;a._closedByUserAction=!1;a._isOpen=!1;a._rootNode=null;a.value=null;a.viewModel=new p;return a}v(b,r);b.prototype.render=function(){var a,b=k.formatDate(this.viewModel.value.valueOf(),q),f=this._isOpen,d=(a={},a["esri-icon-down-arrow"]=!f,a["esri-icon-up-arrow"]=f,a);return c.tsx("div",{afterCreate:c.storeNode,bind:this,class:"esri-date-picker esri-widget","data-node-ref":"_rootNode"},c.tsx("div",{afterUpdate:this._focusSelectedOrClosed,"aria-pressed":f.toString(),
bind:this,class:this.classes("esri-widget--button","esri-date-picker__calendar-toggle"),onclick:this._toggle,onkeydown:this._toggle,role:"button",tabIndex:0},c.tsx("span",{class:"esri-date-picker__date"},b),c.tsx("span",{"aria-hidden":"true",class:this.classes(d)})),f?this._renderCalendar():null)};b.prototype._focusSelectedOrClosed=function(a){this._closedByUserAction&&(this._closedByUserAction=!1,a.focus())};b.prototype._handleDatePickerKeydown=function(a){"Escape"===n.eventKey(a)&&(this._closedByUserAction=
!0,this._close(),a.preventDefault(),a.stopPropagation())};b.prototype._renderCalendar=function(){var a=this._activeDate,b=this.get("viewModel.value");return c.tsx("div",{afterCreate:c.storeNode,bind:this,class:"esri-date-picker__calendar","data-node-ref":"_calendarNode",key:"esri-date-picker__calendar",onkeydown:this._handleDatePickerKeydown},this._renderMonthPicker(a),this._renderDayPicker(a,b),this._renderYearPicker(a))};b.prototype._handleDatePickerBlur=function(a){a=a.relatedTarget;this._calendarNode.contains(a)||
this._rootNode.contains(a)||this._close()};b.prototype._renderMonthPicker=function(a){var b=m.months().map(function(b,d){d=a.month()===d;return c.tsx("option",{selected:d},b)});return c.tsx("div",{class:"esri-date-picker__month-picker"},c.tsx("div",{"aria-label":h.goToPreviousMonth,bind:this,class:"esri-widget--button",onblur:this._handleDatePickerBlur,onclick:this._setPreviousMonth,onkeydown:this._setPreviousMonth,role:"button",tabIndex:0,title:h.goToPreviousMonth},c.tsx("span",{"aria-hidden":"true",
class:"esri-icon-left"})),c.tsx("select",{"aria-live":"assertive",bind:this,class:"esri-date-picker__month-dropdown",id:this.id+"__month-picker",onblur:this._handleDatePickerBlur,onchange:this._setMonth,onkeydown:this._setMonth},b),c.tsx("div",{"aria-label":h.goToNextMonth,bind:this,class:"esri-widget--button",onblur:this._handleDatePickerBlur,onclick:this._setNextMonth,onkeydown:this._setNextMonth,role:"button",tabIndex:0,title:h.goToNextMonth},c.tsx("span",{"aria-hidden":"true",class:"esri-icon-right"})))};
b.prototype._renderDayPicker=function(a,b){var f=this,d=a.clone().day(m.localeData().firstDayOfWeek()),d=this._getWeekLabels(d),e=this._getDayId(a);a=this._renderMonth(a,b);return c.tsx("div",{afterCreate:this._handleDayPickerCreate,"aria-activedescendant":e,"aria-labelledby":this.id+"__month-picker "+this.id+"__selected-year",bind:this,class:"esri-date-picker__day-picker",id:this.id+"__day-picker",onblur:this._handleDatePickerBlur,onkeydown:this._handleDayPickerKeydown,role:"grid",tabIndex:0},c.tsx("div",
{class:"esri-date-picker__week-item",role:"row"},d.map(function(a){return c.tsx("div",{"aria-label":a.name,class:f.classes("esri-date-picker__day-item","esri-date-picker__day-item--header"),role:"columnheader",title:a.name},a.abbr)})),a)};b.prototype._getDayId=function(a){return this.id+"__"+k.formatDate(a.valueOf(),q)};b.prototype._handleDayPickerCreate=function(a){a.focus()};b.prototype._getWeekLabels=function(a){for(var b=[],c={weekday:"long"},d={weekday:"narrow"},e=0;7>e;e++)b.push({name:k.formatDate(a.valueOf(),
c),abbr:k.formatDate(a.valueOf(),d)}),a.add(1,"day");return b};b.prototype._handleDayPickerKeydown=function(a){var b=a.ctrlKey,c=a.shiftKey,d=n.eventKey(a),e=this._activeDate;if(-1!==x.indexOf(d)){if("ArrowLeft"===d)e.subtract(1,"day");else if("ArrowRight"===d)e.add(1,"day");else if("ArrowUp"===d)e.subtract(1,"week");else if("ArrowDown"===d)e.add(1,"week");else if("PageUp"===d)e.subtract(1,c?"year":"month");else if("PageDown"===d)e.add(1,c?"year":"month");else if("Home"===d)e.startOf(b?"year":"month");
else if("End"===d)e.endOf(b?"year":"month");else if("Enter"===d||" "===d)this.viewModel.value=e.clone(),this._closedByUserAction=!0,this._close();a.preventDefault();a.stopPropagation()}};b.prototype._renderMonth=function(a,b){for(var f,d=m(),e=m.localeData(),g=a.clone().startOf("month"),h=a.clone().endOf("month"),e=g.clone().subtract(g.weekday()-e.firstDayOfWeek(),"day"),k=[],u=0;6>u;u++){for(var l=[],n=0;7>n;n++){var p=e.date(),q=e.isSame(a,"day"),t=e.isSame(b,"day"),r=this._getDayId(e),t=(f={},
f["esri-date-picker__day-item--nearby-month"]=!e.isBetween(g,h,null,"[]"),f["esri-date-picker__day-item--today"]=e.isSame(d,"day"),f["esri-date-picker__day-item--active"]=q,f["esri-date-picker__day-item--selected"]=t,f);l.push(c.tsx("div",{"aria-label":p.toString(),"aria-selected":q.toString(),bind:this,class:this.classes("esri-date-picker__day-item",t),"data-iso-date":e.toISOString(),id:r,onclick:this._handleSelectedDate,onkeydown:this._handleSelectedDate,role:"gridcell"},p));e.add(1,"day")}k.push(c.tsx("div",
{class:"esri-date-picker__week-item",role:"row"},l))}return k};b.prototype._renderYearPicker=function(a){var b={year:"numeric"},f=a.clone();a=k.formatDate(f.valueOf(),b);var d=k.formatDate(f.add(1,"year").valueOf(),b),b=k.formatDate(f.subtract(2,"year").valueOf(),b);return c.tsx("div",{class:"esri-date-picker__year-picker"},c.tsx("div",{"aria-label":h.goToPreviousYear,bind:this,class:"esri-date-picker__year-picker-item",onblur:this._handleDatePickerBlur,onclick:this._setPreviousYear,onkeydown:this._setPreviousYear,
tabIndex:0,title:h.goToPreviousYear},b),c.tsx("div",{class:this.classes("esri-date-picker__year-picker-item","esri-date-picker__year-picker-item--selected"),id:this.id+"__selected-year"},a),c.tsx("div",{"aria-label":h.goToNextYear,bind:this,class:"esri-date-picker__year-picker-item",onblur:this._handleDatePickerBlur,onclick:this._setNextYear,onkeydown:this._setNextYear,tabIndex:0,title:h.goToNextYear},d))};b.prototype._toggle=function(){this._isOpen?this._close():this._open(this.viewModel.value.clone())};
b.prototype._setMonth=function(a){this._activeDate.month(a.target.value)};b.prototype._close=function(){this._activeDate=null;this._isOpen=!1};b.prototype._open=function(a){this._activeDate=a;this._isOpen=!0};b.prototype._setPreviousMonth=function(){this._activeDate.subtract(1,"month")};b.prototype._setNextMonth=function(){this._activeDate.add(1,"month")};b.prototype._setPreviousYear=function(){this._activeDate.subtract(1,"year")};b.prototype._setNextYear=function(){this._activeDate.add(1,"year")};
b.prototype._handleSelectedDate=function(a){this.viewModel.value=m(a.target.getAttribute("data-iso-date"));this._closedByUserAction=!0;this._close()};g([l.aliasOf("viewModel.value")],b.prototype,"value",void 0);g([l.property({type:p}),c.renderable("viewModel.value")],b.prototype,"viewModel",void 0);g([c.accessibleHandler()],b.prototype,"_toggle",null);g([c.accessibleHandler()],b.prototype,"_setPreviousMonth",null);g([c.accessibleHandler()],b.prototype,"_setNextMonth",null);g([c.accessibleHandler()],
b.prototype,"_setPreviousYear",null);g([c.accessibleHandler()],b.prototype,"_setNextYear",null);g([c.accessibleHandler()],b.prototype,"_handleSelectedDate",null);return b=g([l.subclass("esri.widgets.Directions.support.DatePicker")],b)}(l.declared(w))});