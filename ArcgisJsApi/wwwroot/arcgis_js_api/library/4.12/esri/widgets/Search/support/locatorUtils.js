// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../Graphic ../../../core/maybe ../../../core/promiseUtils ./geometryUtils".split(" "),function(z,m,v,r,p,n){function w(a){var b=a.source,d=a.spatialReference,f=a.location,c=a.sourceIndex,l=a.view;a=b.locator;var h=b.zoomScale,k=l&&l.scale;d&&(a.outSpatialReference=d);return a.locationToAddress({location:f}).then(function(a){return t([a],{sourceIndex:c,scale:k,view:l,zoomScale:h})})}function u(a,b){var d=a.filter,f=a.searchExtent;a=a.withinViewEnabled;var c=b&&b.extent;
return(b=n.createExtentFromGeometry(d&&d.geometry,b,b&&b.scale))||f||(a&&c?c:void 0)}function x(a){var b=a.source,d=a.suggestResult,f=a.spatialReference,c=a.view,l=a.maxResults,h=a.sourceIndex,k=b&&b.zoomScale;a=d.text.trim();if(!a)return p.resolve();a=""+(!d.key&&b.prefix?b.prefix:"")+a+(!d.key&&b.suffix?b.suffix:"");var e={},g=b.locator,m=c&&c.scale,n=u(b,c);if(!g)return p.resolve();b.categories&&(e.categories=b.categories);b.locationType&&(e.locationType=b.locationType);f&&(g.outSpatialReference=
f);if(f=c&&c.get("extent.center"))e.location=f;e.maxLocations=l;n&&(e.searchExtent=r.unwrap(n));b.countryCode&&(e.countryCode=b.countryCode);var q=d.key;q&&(e.magicKey=q);e.address={};e.address[b.singleLineFieldName||"Single Line Input"]=a;b.outFields&&(e.outFields=b.outFields);return g.addressToLocations(e).then(function(a){return t(a,{key:q,scale:m,sourceIndex:h,view:c,zoomScale:k})})}function y(a,b){return a.map(function(a){return{text:a.text,key:a.magicKey,sourceIndex:b}})}function t(a,b){return a.map(function(a){var d=
b.key,c=b.scale,l=b.sourceIndex,h=b.view,k=b.zoomScale,e=a.extent,g=a.location,m=a.address;a=new v({geometry:g,attributes:a.attributes});c=n.createExtentFromGeometry(e||g,h,c);h=k?n.scaleExtent(c,h,k):c;g=g?g.x+","+g.y:"";return{extent:h,feature:a,key:d,name:m||g,sourceIndex:l}})}Object.defineProperty(m,"__esModule",{value:!0});m.getResults=function(a){return a.location?w(a):x(a)};m.getSuggestions=function(a){var b=a.source,d=a.spatialReference,f=a.view,c=a.suggestTerm,l=a.maxSuggestions,h=a.sourceIndex;
a={};var k=b.locator,e=u(b,f);if(!k)return p.resolve();b.categories&&(a.categories=b.categories);k.outSpatialReference=d;if(d=f&&f.get("extent.center"))a.location=d;c=c.trim();if(!c)return p.resolve();d=b.prefix;f=b.suffix;a.text=""+(void 0===d?"":d)+c+(void 0===f?"":f);e&&(a.searchExtent=r.unwrap(e));a.maxSuggestions=l;b.countryCode&&(a.countryCode=b.countryCode);return k.suggestLocations(a).then(function(a){return y(a,h)})};m.isArcGISWorldGeocoder=function(a){return a?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(a)||
/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi.test(a):!1}});