// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),function(z,A,v,r,t,w,q,x,y,m,f){return function(u){function d(a){a=u.call(this)||this;a.activeLayerInfos=null;a.type="classic";return a}v(d,u);d.prototype.render=function(){var a=this,b=this.activeLayerInfos,c=this.classes("esri-legend esri-widget--panel",
"esri-widget"),b=b&&b.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});return f.tsx("div",{class:c},b&&b.length?b:f.tsx("div",{class:"esri-legend__message"},t.noLegend))};d.prototype._renderLegendForLayer=function(a){var b=this,c;if(!a.ready)return null;var e=!!a.children.length,n="esri-legend__"+a.layer.uid+"-version-"+a.version,g=a.title?f.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(e)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),
f.tsx("div",{key:n,class:this.classes("esri-legend__service","esri-legend__group-layer")},g,c);if((e=a.legendElements)&&!e.length)return null;e=e.map(function(c){return b._renderLegendForElement(c,a.layer)}).filter(function(a){return!!a});if(!e.length)return null;var h=(c={},c["esri-legend__group-layer-child"]=!!a.parent,c);return f.tsx("div",{key:n,class:this.classes("esri-legend__service",h)},g,f.tsx("div",{class:"esri-legend__layer"},e))};d.prototype._renderLegendForElement=function(a,b,c){var e=
this,n,g="color-ramp"===a.type,h="opacity-ramp"===a.type,d="size-ramp"===a.type,p=null;if("symbol-table"===a.type||d){var k=a.infos.map(function(c){return e._renderLegendForElementInfo(c,b,d,a.legendType)}).filter(function(a){return!!a});k.length&&(p=f.tsx("div",{class:"esri-legend__layer-body"},k))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?p=this._renderLegendForRamp(a,b.opacity):"relationship-ramp"===a.type&&(p=y.renderRelationshipRamp(a,this.id,b.opacity));if(!p)return null;
var k=a.title,l=null;"string"===typeof k?l=k:k&&(l=m.getTitle(k,g||h),l=m.isRendererTitle(k,g||h)&&k.title?k.title+" ("+l+")":l);g=c?"esri-legend__layer-child-table":"esri-legend__layer-table";h=l?f.tsx("div",{class:"esri-legend__layer-caption"},l):null;c=(n={},n["esri-legend__layer-table--size-ramp"]=d||!c,n);return f.tsx("div",{class:this.classes(g,c)},h,p)};d.prototype._renderLegendForRamp=function(a,b){var c=a.infos,e="opacity-ramp"===a.type,d="heatmap-ramp"===a.type,g=c.length-1;a=document.createElement("div");
a.className="esri-legend__color-ramp "+(e?"esri-legend__opacity-ramp":"");a.style.height="75px";null!=b&&(a.style.opacity=b.toString());b=w.createSurface(a,"100%",75);try{d||c.forEach(function(a,b){a.offset=b/g}),b.createRect({x:0,y:0,width:"100%",height:75}).setFill({type:"linear",x1:0,y1:0,x2:0,y2:75,colors:c}).setStroke(null)}catch(h){b.clear(),b.destroy()}if(!b)return null;c=c.filter(function(a){return!!a.label}).map(function(a){return f.tsx("div",{class:"esri-legend__ramp-label"},d?t[a.label]:
a.label)});return f.tsx("div",{class:"esri-legend__layer-row"},f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},f.tsx("div",{class:"esri-legend__ramps",bind:a,afterCreate:m.attachToNode})),f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},f.tsx("div",{class:"esri-legend__ramp-labels",styles:{height:"75px"}},c)))};d.prototype._renderLegendForElementInfo=function(a,b,c,e){var d,g;if(a.type)return this._renderLegendForElement(a,
b,!0);var h=null;e=m.isImageryStretchedLegend(b,e);a.symbol&&a.preview?h=f.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:m.attachToNode}):a.src&&(h=this._renderImage(a,b,e));if(!h)return null;b=(d={},d["esri-legend__imagery-layer-info--stretched"]=e,d);c=(g={},g["esri-legend__imagery-layer-info--stretched"]=e,g["esri-legend__size-ramp"]=!e&&c,g);return f.tsx("div",{class:"esri-legend__layer-row"},f.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",
c)},h),f.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",b)},m.getTitle(a.label,!1)||""))};d.prototype._renderImage=function(a,b,c){var e,d=a.label,g=a.src,h=a.opacity;c=(e={},e["esri-legend__imagery-layer-image--stretched"]=c,e["esri-legend__symbol"]=!c,e);b={opacity:""+(null!=h?h:b.opacity)};return f.tsx("img",{alt:d,src:g,border:0,width:a.width,height:a.height,class:this.classes(c),styles:b})};r([f.renderable(),q.property()],d.prototype,"activeLayerInfos",
void 0);r([q.property({readOnly:!0})],d.prototype,"type",void 0);return d=r([q.subclass("esri.widgets.Legend.styles.Classic")],d)}(q.declared(x))});