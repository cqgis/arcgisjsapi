// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Collection ./Handles ./accessorSupport/decorators".split(" "),function(n,p,l,f,g,m,e){return function(h){function b(a){a=h.call(this)||this;a._handles=new m;a.root=null;a.refresh=a.refresh.bind(a);a.updateCollections=a.updateCollections.bind(a);return a}l(b,h);b.prototype.initialize=function(){var a=this;this._handles.add(this.rootCollectionNames.map(function(b){return a.watch("root."+b,a.updateCollections,!0)}));
this.updateCollections()};b.prototype.destroy=function(){this.root=null;this.refresh();this._handles.destroy();this._handles=null};b.prototype.updateCollections=function(){var a=this;this._collections=this.rootCollectionNames.map(function(b){return a.get("root."+b)}).filter(function(a){return null!=a});this.refresh()};b.prototype.refresh=function(){var a=this._handles;a.remove("collections");this.removeAll();for(var b=[],c=[],d=0,k=this._collections;d<k.length;d++)this._processCollection(b,c,k[d]);
this.push.apply(this,c);for(c=0;c<b.length;c++)a.add(b[c].on("after-changes",this.refresh),"collections")};b.prototype._createNewInstance=function(a){return new g(a)};b.prototype._processCollection=function(a,b,c){var d=this;c&&(a.push(c),c.forEach(function(c){c&&(b.push(c),d._processCollection(a,b,d.getChildrenFunction(c)))}))};f([e.property()],b.prototype,"rootCollectionNames",void 0);f([e.property()],b.prototype,"root",void 0);f([e.property()],b.prototype,"getChildrenFunction",void 0);return b=
f([e.subclass("esri.core.CollectionFlattener")],b)}(e.declared(g))});