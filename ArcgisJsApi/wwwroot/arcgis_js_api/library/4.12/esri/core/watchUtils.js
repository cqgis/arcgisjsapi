// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define(["require","exports","./events","./has","./promiseUtils"],function(B,e,n,y,m){function l(b,a,d,c,e){e=b.watch(a,function(a,e,f,k){d&&!d(a)||c.call(b,a,e,f,k)},e);if(Array.isArray(a))for(var f=0;f<a.length;f++){var h=b.get(a[f]);d&&d(h)&&c.call(b,h,h,a,b)}else h=b.get(a),d&&d(h)&&c.call(b,h,h,a,b);return e}function g(b,a,d,c,e){function f(){g&&(g.remove(),g=null)}var h="function"===typeof c?c:null,z="object"===typeof c?c:null;"boolean"===typeof c&&(e=c);var p=!1,g,k=m.createDeferred(f);m.onAbort(z,
function(){f();k.reject(m.createAbortError())});c=y("esri-native-promise")?{then:k.promise.then.bind(k.promise),catch:k.promise.catch.bind(k.promise),remove:f}:{cancel:k.cancel,then:k.promise.then.bind(k.promise),catch:k.promise.catch.bind(k.promise),remove:f};Object.freeze(c);g=l(b,a,d,function(a,c,d,e){p=!0;f();h&&h.call(b,a,c,d,e);k.resolve({value:a,oldValue:c,propertyName:d,target:e})},e);p&&f();return c}function q(b){return!!b}function r(b){return!b}function t(b){return!0===b}function u(b){return!1===
b}function v(b){return void 0!==b}function w(b){return void 0===b}function x(b,a,d,c){var e=Array.isArray(a)?a:-1<a.indexOf(",")?a.split(","):[a];a=b.watch(a,d,c);for(c=0;c<e.length;c++){var f=e[c].trim().replace(A,"$1"),h=b.get(f);d.call(b,h,h,f,b)}return a}Object.defineProperty(e,"__esModule",{value:!0});e.whenValidOnce=g;var A=/\?(\.|$)/g;e.init=x;e.watch=function(b,a,d,c){return b.watch(a,d,c)};e.once=function(b,a,d,c){return g(b,a,null,d,c)};e.when=function(b,a,d,c){return l(b,a,q,d,c)};e.whenOnce=
function(b,a,d,c){return g(b,a,q,d,c)};e.whenNot=function(b,a,d,c){return l(b,a,r,d,c)};e.whenNotOnce=function(b,a,d,c){return g(b,a,r,d,c)};e.whenTrue=function(b,a,d,c){return l(b,a,t,d,c)};e.whenTrueOnce=function(b,a,d,c){return g(b,a,t,d,c)};e.whenFalse=function(b,a,d,c){return l(b,a,u,d,c)};e.whenFalseOnce=function(b,a,d,c){return g(b,a,u,d,c)};e.whenDefined=function(b,a,d,c){return l(b,a,v,d,c)};e.whenDefinedOnce=function(b,a,d,c){return g(b,a,v,d,c)};e.whenUndefined=function(b,a,d,c){return l(b,
a,w,d,c)};e.whenUndefinedOnce=function(b,a,d,c){return g(b,a,w,d,c)};e.pausable=function(b,a,d,c){var e=!1,f=b.watch(a,function(a,c,f,g){e||d.call(b,a,c,f,g)},c);return{remove:function(){f.remove()},pause:function(){e=!0},resume:function(){e=!1}}};e.on=function(b,a,d,c,e,f,g){function h(a){var c=l[a];c&&(f&&f(c.target,a,b,d),c.handle.remove(),delete l[a])}var l={},m=x(b,a,function(a,f,g){h(g);n.isEventTarget(a)&&(l[g]={handle:n.on(a,d,c),target:a},e&&e(a,g,b,d))},g);return{remove:function(){m.remove();
for(var a in l)h(a)}}}});