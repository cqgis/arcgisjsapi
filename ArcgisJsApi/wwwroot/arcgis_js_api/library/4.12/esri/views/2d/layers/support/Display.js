// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/vec2f64 ../../engine ../../ViewState".split(" "),function(c,f,h,l,g,n){Object.defineProperty(f,"__esModule",{value:!0});var p=l.vec2f64.create();c=function(c){function d(a){var b=c.call(this)||this;b.layerView=a;b._childrenRenderParameters={context:document.createElement("canvas").getContext("2d"),pixelRatio:1,state:new n,stationary:!0,drawPhase:g.enums.WGLDrawPhase.MAP,globalOpacity:1};b.requestRender=
b.requestRender.bind(b);return b}h(d,c);d.prototype.attach=function(){this._bitmap=new g.Bitmap;this._bitmap.stage=this.stage;this._bitmap.attach();this._bitmap.attached=!0;return c.prototype.attach.call(this)};d.prototype.detach=function(){this._bitmap.detach();this._bitmap=null};d.prototype.doRender=function(a){var b;if(a.drawPhase===g.enums.WGLDrawPhase.MAP&&this.layerView.attached){var c=window.devicePixelRatio,d=this.stage.painter,f=a.globalOpacity;b=a.state;var m=a.state.size,h=m[1],k=this._childrenRenderParameters.context.canvas,
e=this._childrenRenderParameters;k.width=m[0]*c;k.height=h*c;e.globalOpacity=f;e.state.copy(b);e.state.pixelRatio=c;e.stationary=a.stationary;a=this._bitmap;a.resolution=b.resolution;this.layerView.render(e);a.source=k;b=e.state.toMap(p,l.vec2f64.ZEROS);a.x=b[0];a.y=b[1];e.state.viewpoint.rotation=0;e.state.rotation=0;d.startStencilDraw();d.drawBitmap(e,a,1/c);d.endStencilDraw()}};return d}(g.DisplayObject);f.Display=c;f.default=c});