// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../engine ../../graphics/graphicsUtils".split(" "),function(G,u,f,g,y,z,v,A){function B(a){if(!("visualVariables"in a&&a.hasVisualVariables("size")))return 0;a=a.getVisualVariablesForType("size");if(!a[0])return 0;a=a[0];if("stops"===a.transformationType)return a.stops.map(function(a){return a.size}).reduce(m,0);if("clamped-linear"===
a.transformationType)return"number"===typeof a.maxSize?a.maxSize:a.maxSize.stops.map(function(a){return a.size}).reduce(m,0);if("real-world-size"===a.transformationType)return 30}function c(a,b){return null==a?b:a}function w(a,b){return g(this,void 0,void 0,function(){var x,h,k,d,e,l,p,q,g,n,m;return f(this,function(f){switch(f.label){case 0:if("simple-marker"===a.type)return x=Math.max(c(a.size,12),b),[2,r(a)+.707*x];if("picture-marker"===a.type)return h=Math.max(c(a.height,12),b),k=c(a.width,12)*
(h/c(a.height,12)),d=k/2,e=h/2,[2,r(a)+Math.sqrt(d*d+e*e)];if("text"===a.type)return A.getTextSymbolEstimatedSize(t,a,v.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),l=t[2]*(c(a.horizontalAlignment,"top")in C?1:.5),p=t[3]*(c(a.horizontalAlignment,"center")in D?1:.5),q=null==a.font?9:c(a.font.size,9),g=Math.max(q,b)/q,[2,r(a)+Math.sqrt(l*l+p*p)*g];if("simple-line"===a.type)return[2,Math.max(c(a.width,.75),b)/2];if("simple-fill"===a.type||"picture-fill"===a.type)return[2,Math.max(null==a.outline?.75:c(a.outline.width,
.75),b)/2];if("cim"===a.type)return(n=v.CIMSymbolHelper.getEnvelope(a.data))?[2,Math.sqrt(n.width*n.width+n.height*n.height)]:[2,0];if("web-style"!==a.type)return[3,2];m=w;return[4,a.fetchCIMSymbol()];case 1:return[2,m.apply(void 0,[f.sent(),b])];case 2:return[2]}})})}function E(a,b){return g(this,void 0,void 0,function(){var c,h,k,d,e;return f(this,function(l){switch(l.label){case 0:if(!(a.type in F))return[2,0];h=(c=Math).min;d=(k=Math).max;e=[5];return[4,w(a,b)];case 1:return[2,h.apply(c,[d.apply(k,
e.concat([l.sent()])),75])]}})})}function r(a){var b=c(a.xoffset,0);a=c(a.yoffset,0);return Math.sqrt(b*b+a*a)}function m(a,b){return Math.max(a,b)}Object.defineProperty(u,"__esModule",{value:!0});var F={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1};u.computePxBuffer=function(a,b){return g(this,void 0,void 0,function(){var c,h,k,d,e,l,g;return f(this,function(f){switch(f.label){case 0:if("heatmap"===a.type)return[2,Math.round(3*a.blurRadius)];
if("dot-density"===a.type)return[2,0];if("dictionary"===a.type)return"esriGeometryPoint"===b||"esriGeometryMultipoint"===b?[2,100]:[2,50];c=a.getSymbols();h=B(a);k=[];d=0;for(e=c;d<e.length;d++)l=e[d],k.push(E(l,h));return[4,y.all(k)];case 1:return g=f.sent(),[2,z.pt2px(g.reduce(m,0))]}})})};var t=[0,0,0,0],C={left:1,right:1},D={top:1,bottom:1,baseline:1}});