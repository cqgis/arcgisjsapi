// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(k,n,p,q,r,f){function t(e,a){a.outlineColor[0]=a.fillColor[0]=e.color.r/255;a.outlineColor[1]=a.fillColor[1]=e.color.g/255;a.outlineColor[2]=a.fillColor[2]=e.color.b/255;a.outlineColor[3]=a.fillColor[3]=e.color.a;a.fillColor[3]*=e.fillOpacity;a.outlineColor[3]*=e.haloOpacity;a.fillColor[0]*=a.fillColor[3];a.fillColor[1]*=a.fillColor[3];a.fillColor[2]*=a.fillColor[3];a.outlineColor[0]*=
a.outlineColor[3];a.outlineColor[1]*=a.outlineColor[3];a.outlineColor[2]*=a.outlineColor[3];a.outlineWidth=f.HIGHLIGHT_SIZING.outlineWidth;a.outerHaloWidth=f.HIGHLIGHT_SIZING.outerHaloWidth;a.innerHaloWidth=f.HIGHLIGHT_SIZING.innerHaloWidth;a.outlinePosition=f.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(n,"__esModule",{value:!0});var l=p.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),u=[0,0,0,0];k=function(){function e(){this._convertedHighlightOptions={fillColor:[.2*
.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:f.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:f.HIGHLIGHT_SIZING.outlineWidth,innerHaloWidth:f.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:f.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*f.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}e.prototype.setHighlightOptions=function(a){function e(a,b,c){d[0]=(1-c)*a[0]+c*b[0];d[1]=(1-c)*a[1]+c*b[1];d[2]=(1-c)*a[2]+c*b[2];d[3]=(1-c)*a[3]+c*
b[3]}var c;t(a,this._convertedHighlightOptions);a=this._convertedHighlightOptions.outlinePosition-this._convertedHighlightOptions.outlineWidth/2-this._convertedHighlightOptions.outerHaloWidth;var k=this._convertedHighlightOptions.outlinePosition-this._convertedHighlightOptions.outlineWidth/2,m=this._convertedHighlightOptions.outlinePosition+this._convertedHighlightOptions.outlineWidth/2,h=this._convertedHighlightOptions.outlinePosition+this._convertedHighlightOptions.outlineWidth/2+this._convertedHighlightOptions.innerHaloWidth,
b=Math.sqrt(Math.PI/2)*f.SIGMAS[3],g=Math.abs(a)>b?Math.round(10*(Math.abs(a)-b))/10:0,b=Math.abs(h)>b?Math.round(10*(Math.abs(h)-b))/10:0;g&&!b?l.error("The outer rim of the highlight is "+g+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!g&&b?l.error("The inner rim of the highlight is "+b+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
g&&b&&l.error("The highlight is "+Math.max(g,b)+"px away from the edge of the feature; consider reducing some width values.");for(var d=[void 0,void 0,void 0,void 0],g=this.texelData,b=0;b<f.SHADE_TEXTURE_SIZE;++b)c=a+b/(f.SHADE_TEXTURE_SIZE-1)*(h-a),c<a?(d[4*b+0]=0,d[4*b+1]=0,d[4*b+2]=0,d[4*b+3]=0):c<k?e(u,this._convertedHighlightOptions.outlineColor,(c-a)/(k-a)):c<m?(c=this._convertedHighlightOptions.outlineColor,d[0]=c[0],d[1]=c[1],d[2]=c[2],d[3]=c[3]):c<h?e(this._convertedHighlightOptions.outlineColor,
this._convertedHighlightOptions.fillColor,(c-m)/(h-m)):(c=this._convertedHighlightOptions.fillColor,d[4*b+0]=c[0],d[4*b+1]=c[1],d[4*b+2]=c[2],d[4*b+3]=c[3]),g[4*b+0]=255*d[0],g[4*b+1]=255*d[1],g[4*b+2]=255*d[2],g[4*b+3]=255*d[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=h;this.shadeTexChanged=!0};e.prototype.applyHighlightOptions=function(a,e){this.shadeTex||(this.shadeTex=new q.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:f.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));
this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,f.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,r.TEXTURE_BINDING_HIGHLIGHT_1);e.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};e.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return e}();n.default=k});