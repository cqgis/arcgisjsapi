// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../core/PooledArray"],function(g,e,l){function m(a){return a[0]+"/"+a[1]+"/"+a[2]}function h(a,b){b(a);for(var c=0;4>c;c++){var d=a.children[c];d&&h(d,b)}}function k(a,b){for(var c=0;4>c;c++){var d=a.children[c];d&&k(d,b)}b(a)}function n(a,b,c){a=a.screenDepth;b=b.screenDepth;return a<b?-c:a>b?c:0}Object.defineProperty(e,"__esModule",{value:!0});g=function(){function a(){this.q=new l;this._last=null;this.done=!0}a.prototype.resetOne=function(a){this.q.clear();this.q.push(a);
this._last=null;this.done=!1};a.prototype.reset=function(a){this.q.clear();a&&this.q.pushArray(a);this._last=null;this.done=0===this.q.length};a.prototype.skipSubtree=function(){this._last=null;0===this.q.length&&(this.done=!0)};a.prototype.next=function(){if(this.done)return null;if(this._last){var a=this._last.children;if(a[0])for(var c=3;0<=c;c--){var d=a[c];d&&this.q.push(d)}}this._last=this.q.pop();0!==this.q.length||this._last.children[0]||(this.done=!0);return this._last};return a}();e.IteratorPreorder=
g;g=function(){function a(){this.q=new l;this.done=!0}a.prototype.reset=function(a){this.q.clear();if(a)for(this.q.pushArray(a),a=0;a<this.q.length;++a)for(var b=this.q.data[a],d=0;4>d;d++){var f=b.children[d];f&&this.q.push(f)}this.done=0===this.q.length};a.prototype.next=function(){var a=this.q.pop();this.done=0===this.q.length;return a};return a}();e.IteratorPostorder=g;e.lij2str=m;e.tile2str=function(a){return m(a.lij)};e.traverseTilesPreorder=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)h(a[c],
b);else h(a,b)};e.traverseTilesPostorder=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)k(a[c],b);else k(a,b)};e.findParentByLIJ=function(a,b){for(;a;a=a.parent)if(a.hasLij(b))return a;return null};e.fallsWithinLayer=function(a,b,c){if(!b)return!1;var d=b.fullExtent,f=a.extent;if(c){if(f[0]<d.xmin||f[1]<d.ymin||f[2]>d.xmax||f[3]>d.ymax)return!1}else if(d.xmin>f[2]||d.ymin>f[3]||d.xmax<f[0]||d.ymax<f[1])return!1;a=a.surface.tilingScheme.levels[a.lij[0]].scale;return 0<b.minScale&&a>1.00000001*
b.minScale||0<b.maxScale&&a<.99999999*b.maxScale?!1:!0};e.isPosWithinTile=function(a,b){a=a.extent;return b[0]>=a[0]&&b[1]>=a[1]&&b[0]<=a[2]&&b[1]<=a[3]};e.getTileNLevelsUp=function(a,b){for(;b--;)a=a.parent;return a};e.nextTileInAncestry=function(a,b){var c=a.lij[0]-b.lij[0]-1,d=a.lij[2]>>c,f=0;a.lij[1]>>c&1&&(f+=2);d&1&&(f+=1);return b.children[f]};e.sortTiles=function(a,b){b.sort(function(b,d){return n(b,d,a)})};e.compareTiles=n;e.computeUpsampleInfo=function(a,b,c){for(var d=1,f=0,e=0;a!==b;)if(d*=
.5,f*=.5,e*=.5,a.lij[2]&1&&(f+=.5),0===(a.lij[1]&1)&&(e+=.5),a=a.parent,null==a)throw Error("tile was not a descendant of upsampleTile");c.init(b,f,e,d)};e.hasVisibleSiblings=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.parent;if(d)for(var f=0;4>f;f++){var e=d.children[f];if(e&&e!==c&&e.visible)return!0}}return!1}});