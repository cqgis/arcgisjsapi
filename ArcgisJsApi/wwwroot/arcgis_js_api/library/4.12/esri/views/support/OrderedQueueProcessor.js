// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.12/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/promiseUtils ./QueueProcessor".split(" "),function(d,e,f,g,h,k){Object.defineProperty(e,"__esModule",{value:!0});var l=function(){return function(b,a){this.item=b;this.promise=a;this.deferred=h.createDeferred();this.status=0;this.error=this.value=null}}();d=function(){function b(a){this._queue=[];this._queueMap=new Map;this._processor=new k.QueueProcessor(a)}b.prototype.destroy=function(){this.clear();
this._processor.destroy()};Object.defineProperty(b.prototype,"length",{get:function(){return this._queue.length},enumerable:!0,configurable:!0});b.prototype.abort=function(a){var b=this._queueMap.get(a);b&&(0===b.status?this._processor.abort(a):(b.status=1,b.error=h.createAbortError()))};b.prototype.clear=function(){this._queue.length=0;this._queueMap.clear();this._processor.clear()};b.prototype.get=function(a){return g(this,void 0,void 0,function(){var b;return f(this,function(m){b=this._queueMap.get(a);
return[2,b?b.promise:void 0]})})};b.prototype.isOngoing=function(a){return this._processor.isOngoing(a)};b.prototype.has=function(a){return this._queueMap.has(a)};b.prototype.pause=function(){this._processor.pause()};b.prototype.resume=function(){this._processor.resume()};b.prototype.reset=function(){this._processor.reset()};b.prototype.push=function(a){return g(this,void 0,void 0,function(){var b,c,d=this;return f(this,function(m){b=this._processor.push(a);c=new l(a,b);this._queue.push(c);this._queueMap.set(a,
c);b.then(function(a){return d._success(c,a)},function(a){return d._error(c,a)});return[2,c.deferred.promise]})})};b.prototype._success=function(a,b){a.status=2;a.value=b;this._drain()};b.prototype._error=function(a,b){a.status=1;a.error=b;this._drain()};b.prototype._drain=function(){for(;;){var a=this._queue[0];if(!a||0===a.status)break;this._queue.shift();this._queueMap.delete(a.item);2===a.status?a.deferred.resolve(a.value):a.deferred.reject(a.error)}};return b}();e.OrderedQueueProcessor=d});