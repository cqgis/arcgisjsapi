//>>built
(function(h){"object"===typeof module&&"object"===typeof module.exports?(h=h(require,exports),void 0!==h&&(module.exports=h)):"function"===typeof define&&define.amd&&define("require exports tslib ../shim/global ../has/has ../shim/WeakMap ./animations/cssTransitions ./d ./Registry ./WidgetBase".split(" "),h)})(function(h,C){function n(d){return d&&t.isWNode(d.node)}function m(d){return!!d&&t.isVNode(d.node)}function ha(d,f,k,y){for(var h=Object.keys(k),N=h.length,D=0;D<N;D++){var m=h[D],n=k[m];n!==
f[m]&&V(d,m,n,y)}}function ia(d,f,k){var y=f.node;k=y.diffType;var m=y.properties,y=y.attributes;if(!k||"vdom"===k)return{properties:f.node.properties,attributes:f.node.attributes,events:f.node.events};if("none"===k)return{properties:{},attributes:f.node.attributes?{}:void 0,events:f.node.events};var h={properties:{}};if(y)return h.attributes={},h.events=f.node.events,Object.keys(m).forEach(function(f){h.properties[f]=d[f]}),Object.keys(y).forEach(function(f){h.attributes[f]=d.getAttribute(f)}),h;
h.properties=Object.keys(m).reduce(function(f,k){f[k]=d.getAttribute(k)||d[k];return f},{});return h}function Q(d,f){return m(d)&&m(f)?t.isDomVNode(d.node)&&t.isDomVNode(f.node)&&d.node.domNode!==f.node.domNode||d.node.tag!==f.node.tag||d.node.properties.key!==f.node.properties.key?!1:!0:n(d)&&n(f)?void 0===d.instance&&"string"===typeof f.node.widgetConstructor||d.node.widgetConstructor!==f.node.widgetConstructor||d.node.properties.key!==f.node.properties.key?!1:!0:!1}function W(d,f,k){for(;k<d.length;k++)if(Q(d[k],
f))return k;return-1}function X(d){void 0===d&&(d=[]);d=Array.isArray(d)?d:[d];return d.join(" ").trim()}function V(d,f,k,h){"http://www.w3.org/2000/svg"===h&&"href"===f&&k?d.setAttributeNS("http://www.w3.org/1999/xlink",f,k):"role"===f&&""===k||void 0===k?d.removeAttribute(f):d.setAttribute(f,k)}function ja(d,f){var k=d.domNode,h=d.node.properties,m=d.node.properties.exitAnimation,n=function(){k&&k.parentNode&&k.parentNode.removeChild(k);d.domNode=void 0};if("function"===typeof m)return m(k,n,h);
f.exit(k,h,m,n)}function ka(d){return function(f){function k(){var d=null!==f&&f.apply(this,arguments)||this;d.isWNodeWrapper=!0;return d}E.__extends(k,f);k.prototype.render=function(){var f=d();this.isWNodeWrapper=t.isWNode(f);return f};return k}(v.WidgetBase)}function H(d){function f(a,b,c,e){c=b&&!c;"function"===typeof b&&(c=b());!0===c&&F.push(function(){e[a]()})}function k(a,b,c,e,g){g&&(g=R.get(g),a.removeEventListener(b,g));g=c.bind(e);"input"===b&&(g=function(a){c.call(this,a);a.target["oninput-value"]=
a.target.value}.bind(e));a.addEventListener(b,g);R.set(c,g)}function h(a,b,c,e){void 0===e&&(e=!1);Object.keys(b).forEach(function(g){var d="on"===g.substr(0,2)||e,f=e?g:g.substr(2);d&&!c[g]&&(g=R.get(b[g]))&&a.removeEventListener(f,g)})}function M(a,b,c){var e=b.requiresInsertBefore,g=b.hasPreviousSiblings,d=b.namespace,f=b.depth,l=[],k=n(b);c=0<(m(c)&&c.childrenWrappers||[]).length;for(var e=(e||!1!==g)&&k||c&&1<a.length,h,g=0;g<a.length;g++){var p=a[g];c={node:p,depth:f+1,order:g,requiresInsertBefore:e,
hasParentWNode:k,namespace:d};if(t.isVNode(p)&&p.properties.exitAnimation)for(b.hasAnimations=!0,p=q.get(b);p&&!p.hasAnimations;)p.hasAnimations=!0,p=q.get(p);q.set(c,b);h&&B.set(h,c);l.push(c);h=c}return l}function N(a){var b;for(a=q.get(a);!b&&a;)!b&&n(a)&&(b=a),a=q.get(a);return b}function D(a){var b;for(a=q.get(a);!b&&a;)!b&&m(a)&&a.domNode&&(b=a.domNode),a=q.get(a);return b}function C(a){if(a.node.deferredPropertiesCallback){var b=a.node.properties;a.node.properties=E.__assign({},a.node.deferredPropertiesCallback(!0),
a.node.originalProperties);F.push(function(){S(a,{properties:b})})}}function H(a,b,c){var e=a.value,g=a["oninput-value"],d=a["select-value"];if(d&&e!==d)a.value=d,a.value===d&&(a["select-value"]=void 0);else if(g&&e===g||b!==c)a.value=b,a["oninput-value"]=void 0}function Y(a,b,c,e){void 0===b&&(b={});void 0===e&&(e=!0);var g=Object.keys(c.node.properties),d=g.length;-1===g.indexOf("classes")&&b.classes&&a.removeAttribute("class");e&&h(a,b,c.node.properties);for(var m=0;m<d;m++){var l=g[m],r=c.node.properties[l],
w=b[l];if("classes"===l){if(w=X(w),r=X(r),w!==r)if(r){if(c.merged)for(w=(a.getAttribute("class")||"").split(" "),l=0;l<w.length;l++)-1===r.indexOf(w[l])&&(r=w[l]+" "+r);a.setAttribute("class",r)}else a.removeAttribute("class")}else if(-1!==la.indexOf(l))f(l,r,w,a);else if("styles"===l)for(var l=Object.keys(r),p=l.length,n=0;n<p;n++){var q=l[n],u=r[q];u!==(w&&w[q])&&(a.style[q]=u||"")}else r||"string"!==typeof w||(r=""),"value"===l?("SELECT"===a.tagName&&(a["select-value"]=r),H(a,r,w)):"key"!==l&&
r!==w&&(p=typeof r,"function"===p&&0===l.lastIndexOf("on",0)&&e?k(a,l.substr(2),r,c.node.bind,w):"string"===p&&"innerHTML"!==l&&e?V(a,l,r,c.namespace):"scrollLeft"===l||"scrollTop"===l?a[l]!==r&&(a[l]=r):a[l]=r)}}function Z(){var a=u.sync,b=aa;aa=[];if(b.length){var c=function(){for(var a;a=b.shift();)a()};a?c():z.default.requestAnimationFrame(c)}}function ba(){var a=u.sync,b=F;F=[];if(b.length){var c=function(){for(var a;a=b.shift();)a()};a?c():z.default.requestIdleCallback?z.default.requestIdleCallback(c):
setTimeout(c)}}function S(a,b){if(a.node.attributes&&a.node.events){ha(a.domNode,b.attributes||{},a.node.attributes,a.namespace);Y(a.domNode,b.properties,a,!1);var c=a.node.events||{};b.events&&h(a.domNode,b.events||{},a.node.events,!0);b.events=b.events||{};Object.keys(c).forEach(function(e){k(a.domNode,e,c[e],a.node.bind,b.events[e])})}else Y(a.domNode,b.properties,a)}function ma(){u.sync?ca():T||(T=z.default.requestAnimationFrame(function(){ca()}))}function ca(){T=void 0;var a=E.__spread(U),b=
[];U=[];a.sort(function(a,b){var c=b.depth-a.depth;0===c&&(c=b.order-a.order);return c});for(var c;c=a.pop();)if(c=c.instance,-1===b.indexOf(c)&&x.has(c)){b.push(c);var e=x.get(c),g=v.widgetInstanceMap.get(c),d=q.get(e),f=B.get(e),g={node:{type:t.WNODE,widgetConstructor:c.constructor,properties:g.inputProperties,children:c.children,bind:e.node.bind},instance:c,depth:e.depth,order:e.order};d&&q.set(g,d);f&&B.set(g,f);if(e=da({current:e,next:g}).item)G.push(e),c&&x.set(c,g),ea()}fa();ba();Z()}function ea(){for(var a;a=
G.pop();)if(a.type)O.push(a);else{var b=a.current||ga,c=a.next||ga;a=a.meta;void 0===a&&(a={});var e=a.mergeNodes,e=void 0===e?[]:e,g=a.oldIndex,g=void 0===g?0:g;a=a.newIndex;var d=void 0===a?0:a,f=b.length,l=c.length,k=1<f||0<f&&f<l;a=[];if(d<l){var h=g<f?b[g]:void 0,p=c[d];p.hasPreviousSiblings=k;var k=p,n=e;if(u.merge&&n.length)if(m(k))for(var q=k.node.tag,t=0;t<n.length;t++){var v=n[t];if(q.toUpperCase()===(v.tagName||"")){q=A.indexOf(v);-1!==q&&A.splice(q,1);n.splice(t,1);k.domNode=v;break}}else k.mergeNodes=
n;h&&Q(h,p)?(g++,d++,m(h)&&m(p)&&(p.inserted=h.inserted),a.push({current:h,next:p})):h&&-1!==W(b,p,g+1)?-1===W(c,h,d+1)?(I.default("dojo-debug")&&J(b,g),a.push({current:h,next:void 0}),g++):(I.default("dojo-debug")&&J(c,d),I.default("dojo-debug")&&J(b,g),a.push({current:h,next:void 0}),a.push({current:void 0,next:p}),g++,d++):(I.default("dojo-debug")&&b.length&&J(c,d),a.push({current:void 0,next:p}),d++)}d<l&&G.push({current:b,next:c,meta:{mergeNodes:e,oldIndex:g,newIndex:d}});if(f>g&&d>=l)for(c=
g;c<f;c++)I.default("dojo-debug")&&J(b,c),a.push({current:b[c],next:void 0});for(c=0;c<a.length;c++)g=na(a[c]),b=g.item,e=g.dom,(g=g.widget)&&G.push(g),b&&G.push(b),e&&O.push(e)}}function fa(){O.reverse();for(var a;a=O.pop();)if("create"===a.type){var b=a.parentDomNode,c=a.next,e=a.next,g=e.domNode,d=e.merged,f=e.requiresInsertBefore,e=e.node.properties;S(c,{properties:{}});C(c);if(!d){d=void 0;if(f){f=null;for(d=c;!f;){var h=B.get(d);if(h){m(h);if(h.domNode&&h.domNode.parentNode){f=h.domNode;break}d=
h}else if(d=q.get(d),!d||m(d))break}d=f}else K&&(d=K.get(c));b.insertBefore(g,d);if(t.isDomVNode(c.node)&&c.node.onAttach)c.node.onAttach()}"OPTION"===g.tagName&&g.parentElement&&H(g.parentElement);b=u.transition;f=c.domNode;d=c.node.properties;(h=c.node.properties.enterAnimation)&&("function"===typeof h?h(f,d):b.enter(f,d,h));b=v.widgetInstanceMap.get(c.node.bind);null!=e.key&&b&&b.nodeHandler.add(g,""+e.key);a.next.inserted=!0}else"update"===a.type?(e=c=a.next,g=e.domNode,e=e.node,a=a.current,(b=
q.get(c))&&n(b)&&b.instance&&(b=v.widgetInstanceMap.get(b.instance))&&b.nodeHandler.addRoot(),g=ia(g,a,c),b=v.widgetInstanceMap.get(c.node.bind),S(c,g),C(c),b&&null!=e.properties.key&&b.nodeHandler.add(c.domNode,""+e.properties.key)):"delete"===a.type?(a=a.current,a.node.properties.exitAnimation?ja(a,u.transition):(a.domNode.parentNode.removeChild(a.domNode),a.domNode=void 0)):"attach"===a.type?(c=a.attached,b=v.widgetInstanceMap.get(a.instance),b.nodeHandler.addRoot(),c&&b.onAttach()):"detach"===
a.type&&(a.current.instance&&(b=v.widgetInstanceMap.get(a.current.instance))&&b.onDetach(),a.current.domNode=void 0,a.current.node.bind=void 0,a.current.instance=void 0)}function J(a,b){F.push(function(){var c=N(a[b]);var e=a[b];if(!m(e)||e.node.tag){var d=e.node.properties.key,f="unknown";c&&(f=c.node.widgetConstructor.name||"unknown");if(void 0===d||null===d)for(d=0;d<a.length;d++)if(d!==b&&(c=a[d],Q(c,e))){e=void 0;e=n(c)?c.node.widgetConstructor.name||"unknown":c.node.tag;console.warn("A widget ("+
f+") has had a child added or removed, but they were not able to uniquely identified. It is recommended to provide a unique 'key' property when using the same widget or element ("+e+") multiple times as siblings");break}}})}function na(a){var b=a.current;a=a.next;if(b!==a){if(!b&&a){if(m(a)){var b=[],c=D(a);a.domNode?(u.merge&&(b=Array.prototype.slice.call(a.domNode.childNodes),A=E.__spread(A,b)),a.merged=!0):(a.node.domNode?a.domNode=a.node.domNode:("svg"===a.node.tag&&(a.namespace="http://www.w3.org/2000/svg"),
a.node.tag?a.domNode=a.namespace?z.default.document.createElementNS(a.namespace,a.node.tag):z.default.document.createElement(a.node.tag):null!=a.node.text&&(a.domNode=z.default.document.createTextNode(a.node.text))),K&&A.length&&c===A[0].parentNode&&K.set(a,A[0]));a.domNode&&a.node.children&&(a.childrenWrappers=M(a.node.children,a,null));var e=N(a);e&&!e.domNode&&(e.domNode=a.domNode);c={next:a,parentDomNode:c,type:"create"};a=a.childrenWrappers?{item:{current:[],next:a.childrenWrappers,meta:{mergeNodes:b}},
dom:c}:{dom:c};return a}return oa({next:a})}if(b&&a){if(m(b)&&m(a))return c=D(b),a.domNode=b.domNode,a.namespace=b.namespace,a.node.text&&a.node.text!==b.node.text?(e=c.ownerDocument.createTextNode(a.node.text),c.replaceChild(e,a.domNode),a.domNode=e):a.node.children&&(c=M(a.node.children,a,b),a.childrenWrappers=c),{item:{current:b.childrenWrappers,next:a.childrenWrappers,meta:{}},dom:{type:"update",next:a,current:b}};if(n(b)&&n(a))return da({current:b,next:a})}else if(b&&!a){if(m(b))return pa({current:b});
if(n(b))return a=b,a=a.instance?x.get(a.instance):a,B.delete(a),q.delete(a),x.delete(a.instance),{item:{current:a.childrenWrappers,meta:{}},widget:{type:"detach",current:a}}}}return{}}function oa(a){var b=a.next;a=b.node.widgetConstructor;var c=u.registry;if(!qa.isWidgetBaseConstructor(a))return{};var e=new a;c&&(e.registry.base=c);var d=v.widgetInstanceMap.get(e);d.invalidate=function(){d.dirty=!0;!d.rendering&&x.has(e)&&(U.push({instance:e,depth:b.depth,order:b.order}),ma())};d.rendering=!0;e.__setProperties__(b.node.properties,
b.node.bind);e.__setChildren__(b.node.children);b.instance=e;a=e.__render__();d.rendering=!1;a&&(a=Array.isArray(a)?a:[a],b.childrenWrappers=M(a,b,null));b.instance&&(x.set(b.instance,b),P||b.instance.isWNodeWrapper||(P=b.instance.invalidate.bind(b.instance)));return{item:{next:b.childrenWrappers,meta:{mergeNodes:b.mergeNodes}},widget:{type:"attach",instance:e,attached:!0}}}function da(a){var b=a.current;a=a.next;var b=b.instance&&x.get(b.instance)||b,c=b.instance,e=b.domNode,d=b.hasAnimations;if(!c)return[];
var f=v.widgetInstanceMap.get(c);a.instance=c;a.domNode=e;a.hasAnimations=d;f.rendering=!0;c.__setProperties__(a.node.properties,a.node.bind);c.__setChildren__(a.node.children);x.set(a.instance,a);if(f.dirty)return e=c.__render__(),f.rendering=!1,e&&(e=Array.isArray(e)?e:[e],a.childrenWrappers=M(e,a,b)),{item:{current:b.childrenWrappers,next:a.childrenWrappers,meta:{}},widget:{type:"attach",instance:c,attached:!1}};f.rendering=!1;a.childrenWrappers=b.childrenWrappers;return{widget:{type:"attach",
instance:c,attached:!1}}}function pa(a){var b=a.current;B.delete(b);q.delete(b);b.node.bind=void 0;if(b.hasAnimations)return{item:{current:b.childrenWrappers,meta:{}},dom:{type:"delete",current:b}};b.childrenWrappers&&F.push(function(){for(var a=b.childrenWrappers||[],d;d=a.pop();){d.childrenWrappers&&(a.push.apply(a,E.__spread(d.childrenWrappers)),d.childrenWrappers=void 0);if(n(d)){if(d.instance){x.delete(d.instance);var f=v.widgetInstanceMap.get(d.instance);f&&f.onDetach()}d.instance=void 0}B.delete(d);
q.delete(d);d.domNode=void 0;d.node.bind=void 0}});return{dom:{type:"delete",current:b}}}var u={sync:!1,merge:!0,transition:ra.default,domNode:z.default.document.body,registry:null},U=[],G=[],O=[],R=new L.WeakMap,x=new L.WeakMap,q=new L.WeakMap,B=new L.WeakMap,K=new L.WeakMap,T,F=[],aa=[],P,A=[];return{mount:function(a){void 0===a&&(a={});u=E.__assign({},u,a);a=u.domNode;var b={node:t.w(ka(d),{}),order:0,depth:1};q.set(b,{depth:0,order:0,domNode:a,node:t.v("fake")});G.push({current:[],next:[b],meta:{mergeNodes:Array.prototype.slice.call(a.childNodes)}});
for(ea();a=A.pop();)a.parentNode&&a.parentNode.removeChild(a);fa();u.merge=!1;K=void 0;ba();Z()},invalidate:function(){P&&P()}}}Object.defineProperty(C,"__esModule",{value:!0});var E=h("tslib"),z=h("../shim/global"),I=h("../has/has"),L=h("../shim/WeakMap"),ra=h("./animations/cssTransitions"),t=h("./d"),qa=h("./Registry"),v=h("./WidgetBase"),ga=[],la=["focus","blur","scrollIntoView","click"];C.renderer=H;C.default=H});