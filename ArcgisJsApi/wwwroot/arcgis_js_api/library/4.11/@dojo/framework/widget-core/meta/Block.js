//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define("require exports tslib ../../core/Destroyable ../../shim/Map ../../shim/WeakMap".split(" "),a)})(function(a,b){Object.defineProperty(b,"__esModule",{value:!0});var h=a("tslib"),k=a("../../core/Destroyable"),l=a("../../shim/Map"),m=a("../../shim/WeakMap");a=function(a){function b(b){var g=a.call(this)||this;g._moduleMap=new m.default;
g._invalidate=b.invalidate;return g}h.__extends(b,a);b.prototype.run=function(a){var b=this;return function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];var e=b._moduleMap.get(a);e||(e=new l.default,b._moduleMap.set(a,e));var f=JSON.stringify(c),d=e.get(f);if(void 0!==d)return d;e.set(f,null);c=a.apply(void 0,h.__spread(c));if("function"===typeof c.then)return c.then(function(a){e.set(f,a);b._invalidate()}),null;e.set(f,c);return c}};return b}(k.Destroyable);b.Block=a;b.default=a});