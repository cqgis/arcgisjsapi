//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define("require exports tslib ./../Injector ./../decorators/inject ./../decorators/handleDecorator ./../decorators/diffProperty ./../diff".split(" "),a)})(function(a,d){function p(a){return a.reduce(function(a,b){Object.keys(b).forEach(function(c){a[b[c]]=c});return a},{})}function n(a){return function(a){function b(){var c=null!==a&&
a.apply(this,arguments)||this;c._registeredBaseThemeKeys=[];c._recalculateClasses=!0;c._theme={};return c}f.__extends(b,a);b.prototype.theme=function(c){var a=this;this._recalculateClasses&&this._recalculateThemeClasses();return Array.isArray(c)?c.map(function(c){return a._getThemeClass(c)}):this._getThemeClass(c)};b.prototype.onPropertiesChanged=function(){this._recalculateClasses=!0};b.prototype._getThemeClass=function(c){var a=this;if(void 0===c||null===c)return c;var b=this.properties.extraClasses||
{},g=this._baseThemeClassesReverseLookup[c],e=[];if(!g)return console.warn("Class name: '"+c+"' not found in theme"),null;this._classes&&(c=Object.keys(this._classes).reduce(function(c,b){for(var k=Object.keys(a._classes[b]),h=0;h<k.length;h++){var e=a._classes[b][k[h]];if(k[h]===g&&e){e.forEach(function(a){a&&c.push(a)});break}}return c},[]),e.push.apply(e,f.__spread(c)));b[g]&&e.push(b[g]);this._theme[g]?e.push(this._theme[g]):e.push(this._registeredBaseTheme[g]);return e.join(" ")};b.prototype._recalculateThemeClasses=
function(){var a=this,b=this.properties,d=b.theme,g=void 0===d?{}:d,b=b.classes,e=void 0===b?{}:b;this._registeredBaseTheme||(b=this.getDecorator("baseThemeClasses"),0===b.length&&console.warn("A base theme has not been provided to this widget. Please use the @theme decorator to add a theme."),this._registeredBaseTheme=b.reduce(function(b,c){var e=c[" _key"];c=f.__rest(c,[" _key"]);a._registeredBaseThemeKeys.push(e);return f.__assign({},b,c)},{}),this._baseThemeClassesReverseLookup=p(b));this._theme=
this._registeredBaseThemeKeys.reduce(function(a,b){return f.__assign({},a,g[b])},{});this._classes=Object.keys(e).reduce(function(b,c){-1<a._registeredBaseThemeKeys.indexOf(c)&&(b=f.__assign({},b,(d={},d[c]=e[c],d)));return b;var d},{});this._recalculateClasses=!1};f.__decorate([l.diffProperty("theme",m.shallow),l.diffProperty("extraClasses",m.shallow),l.diffProperty("classes",m.shallow)],b.prototype,"onPropertiesChanged",null);return b=f.__decorate([q.inject({name:d.INJECTED_THEME_KEY,getProperties:function(b,
a){return a.theme?{}:{theme:b}}})],b)}(a)}Object.defineProperty(d,"__esModule",{value:!0});var f=a("tslib"),r=a("./../Injector"),q=a("./../decorators/inject"),t=a("./../decorators/handleDecorator"),l=a("./../decorators/diffProperty"),m=a("./../diff");d.INJECTED_THEME_KEY="__theme_injector";d.theme=function(a){return t.handleDecorator(function(d){d.addDecorator("baseThemeClasses",a)})};d.registerThemeInjector=function(a,f){var b=new r.Injector(a);f.defineInjector(d.INJECTED_THEME_KEY,function(a){b.setInvalidator(a);
return function(){return b.get()}});return b};d.ThemedMixin=n;d.default=n});