// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/accessorSupport/decorators ./ArcGISService ../support/TileInfo ../support/TilemapCache".split(" "),function(p,h,n,g,d,a,f,e,k,c){return function(b){function l(){var a=null!==b&&b.apply(this,arguments)||this;a.copyright=null;a.minScale=0;a.maxScale=0;a.spatialReference=null;
a.tileInfo=null;a.tilemapCache=null;return a}g(l,b);l.prototype.readMinScale=function(b,a){return null!=a.minLOD&&null!=a.maxLOD?b:0};l.prototype.readMaxScale=function(b,a){return null!=a.minLOD&&null!=a.maxLOD?b:0};Object.defineProperty(l.prototype,"supportsBlankTile",{get:function(){return 10.2<=this.version},enumerable:!0,configurable:!0});l.prototype.readTileInfo=function(b,a){if(!b)return null;var c=a.minScale,l=a.maxScale,d=a.minLOD,f=a.maxLOD;if(null!=d&&null!=f)b.lods=b.lods.filter(function(b){b=
b.level;return null!=b&&b>=d&&b<=f});else if(0!==c&&0!==l){var m=c?Math.round(1E4*c)/1E4:Infinity,e=l?Math.round(1E4*l)/1E4:-Infinity;b.lods=b.lods.filter(function(b){b=Math.round(1E4*b.scale)/1E4;return b<=m&&b>=e})}return k.fromJSON(b)};l.prototype.readTilemapCache=function(b,a){return a.capabilities&&-1<a.capabilities.indexOf("Tilemap")?new c({layer:this}):null};d([f.property({json:{read:{source:"copyrightText"}}})],l.prototype,"copyright",void 0);d([f.property()],l.prototype,"minScale",void 0);
d([f.reader("service","minScale")],l.prototype,"readMinScale",null);d([f.property()],l.prototype,"maxScale",void 0);d([f.reader("service","maxScale")],l.prototype,"readMaxScale",null);d([f.property({type:a.SpatialReference})],l.prototype,"spatialReference",void 0);d([f.property({readOnly:!0,dependsOn:["version"]})],l.prototype,"supportsBlankTile",null);d([f.property({type:k})],l.prototype,"tileInfo",void 0);d([f.reader("service","tileInfo",["tileInfo","minScale","maxScale"])],l.prototype,"readTileInfo",
null);d([f.property()],l.prototype,"tilemapCache",void 0);d([f.reader("service","tilemapCache",["capabilities"])],l.prototype,"readTilemapCache",null);d([f.property()],l.prototype,"version",void 0);return l=d([f.subclass("esri.layers.mixins.ArcGISCachedService")],l)}(f.declared(e))})},"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/JSONSupport ../../core/kebabDictionary ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(p,h,n,g,d,a,f,e,k,c,b,l,m,r,q){var t=new e.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc"});return function(f){function e(b){b=f.call(this)||this;b.dpi=96;b.format=null;b.origin=null;b.minScale=0;b.maxScale=0;b.size=null;b.spatialReference=null;return b}g(e,f);h=e;e.create=function(b){void 0===b&&(b={size:256,spatialReference:a.SpatialReference.WebMercator});
var c=b.resolutionFactor||1,l=b.scales,e=b.size||256;b=b.spatialReference||a.SpatialReference.WebMercator;if(!m.isValid(b)){for(var c=[],d=5E-4,f=23;0<=f;f--)c.unshift({level:f,scale:d,resolution:d}),d*=2;return new h({dpi:96,lods:c,origin:new a.Point(0,0,b),size:e,spatialReference:b})}var g=(f=m.getInfo(b))?new a.Point(f.origin[0],f.origin[1],b):new a.Point(0,0,b),v=1/(39.37*k.getMetersPerUnitForSR(b)*96),q=[];if(l)for(f=0;f<l.length;f++){var r=l[f],d=r*v;q.push({level:f,scale:r,resolution:d})}else for(d=
m.isGeographic(b)?512/e*5.916575275917094E8:256/e*5.91657527591555E8,l=Math.ceil(24/c),q.push({level:0,scale:d,resolution:d*v}),f=1;f<l;f++)r=d/Math.pow(2,c),d=r*v,q.push({level:f,scale:r,resolution:d}),d=r;return new h({dpi:96,lods:q,origin:g,size:e,spatialReference:b})};Object.defineProperty(e.prototype,"isWrappable",{get:function(){var b=this.spatialReference,a=this.origin;if(b&&a){var c=m.getInfo(b);return b.isWrappable&&Math.abs(c.origin[0]-a.x)<=c.dx}return!1},enumerable:!0,configurable:!0});
e.prototype.readOrigin=function(b,c){return a.Point.fromJSON(n({spatialReference:c.spatialReference},b))};Object.defineProperty(e.prototype,"lods",{set:function(b){var a=this,c=0,l=0,f=[];this._levelToLOD={};b&&(c=-Infinity,l=Infinity,b.forEach(function(b){f.push(b.scale);c=b.scale>c?b.scale:c;l=b.scale<l?b.scale:l;a._levelToLOD[b.level]=b}));this._set("scales",f);this._set("minScale",c);this._set("maxScale",l);this._set("lods",b);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});
e.prototype.readSize=function(b,a){return[a.cols,a.rows]};e.prototype.writeSize=function(b,a){a.cols=b[0];a.rows=b[0]};e.prototype.zoomToScale=function(b){var a=this.scales;if(0>=b)return a[0];if(b>=a.length)return a[a.length-1];var c=Math.round(b);return a[c]+(c-b)*(a[Math.round(b-.5)]-a[c])};e.prototype.scaleToZoom=function(b){for(var a=this.scales,c=a.length-1,l=0;l<c;l++){var f=a[l],d=a[l+1];if(f<=b)break;if(d===b)return l+1;if(f>b&&d<b)return l+1-(b-d)/(f-d)}return l};e.prototype.snapScale=function(b,
a){void 0===a&&(a=.95);b=this.scaleToZoom(b);return b%Math.floor(b)>=a?this.zoomToScale(Math.ceil(b)):this.zoomToScale(Math.floor(b))};e.prototype.tileAt=function(b,a,c,f){var d=this.lodAt(b);if(!d)return null;var e;if("number"===typeof a)e=a,a=c;else{if(m.equals(a.spatialReference,this.spatialReference))e=a.x,a=a.y;else{f=r.project(a,this.spatialReference);if(!f)return null;e=f.x;a=f.y}f=c}c=d.resolution*this.size[0];d=d.resolution*this.size[1];f||(f={id:null,level:0,row:0,col:0,extent:l.create()});
f.level=b;f.row=Math.floor((this.origin.y-a)/d+.001);f.col=Math.floor((e-this.origin.x)/c+.001);this.updateTileInfo(f);return f};e.prototype.updateTileInfo=function(b){var a=this.lodAt(b.level);if(a){var c=a.resolution*this.size[0],a=a.resolution*this.size[1];b.id=b.level+"/"+b.row+"/"+b.col;b.extent||(b.extent=l.create());b.extent[0]=this.origin.x+b.col*c;b.extent[1]=this.origin.y-(b.row+1)*a;b.extent[2]=b.extent[0]+c;b.extent[3]=b.extent[1]+a}};e.prototype.upsampleTile=function(b){var a=this._upsampleLevels[b.level];
if(!a||-1===a.parentLevel)return!1;b.level=a.parentLevel;b.row=Math.floor(b.row/a.factor+.001);b.col=Math.floor(b.col/a.factor+.001);this.updateTileInfo(b);return!0};e.prototype.getTileBounds=function(b,a){var c=this.lodAt(a.level).resolution,l=c*this.size[0],c=c*this.size[1];b[0]=this.origin.x+a.col*l;b[1]=this.origin.y-(a.row+1)*c;b[2]=b[0]+l;b[3]=b[1]+c;return b};e.prototype.lodAt=function(b){return this._levelToLOD&&this._levelToLOD[b]||null};e.prototype.clone=function(){return h.fromJSON(this.write({}))};
e.prototype._initializeUpsampleLevels=function(){var b=this.lods;this._upsampleLevels=[];for(var a=null,c=0;c<b.length;c++){var l=b[c];this._upsampleLevels[l.level]={parentLevel:a?a.level:-1,factor:a?a.resolution/l.resolution:0};a=l}};var h;d([c.property({type:Number,json:{write:!0}})],e.prototype,"compressionQuality",void 0);d([c.property({type:Number,json:{write:!0}})],e.prototype,"dpi",void 0);d([c.property({type:String,json:{read:t.read,write:t.write,origins:{"web-scene":{read:!1,write:!1}}}})],
e.prototype,"format",void 0);d([c.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],e.prototype,"isWrappable",null);d([c.property({type:a.Point,json:{write:!0}})],e.prototype,"origin",void 0);d([c.reader("origin")],e.prototype,"readOrigin",null);d([c.property({type:[q],value:null,json:{write:!0}})],e.prototype,"lods",null);d([c.property({readOnly:!0})],e.prototype,"minScale",void 0);d([c.property({readOnly:!0})],e.prototype,"maxScale",void 0);d([c.property({readOnly:!0})],e.prototype,
"scales",void 0);d([c.property({cast:function(b){return Array.isArray(b)?b:"number"===typeof b?[b,b]:[256,256]}})],e.prototype,"size",void 0);d([c.reader("size",["rows","cols"])],e.prototype,"readSize",null);d([c.writer("size",{cols:{type:b.Integer},rows:{type:b.Integer}})],e.prototype,"writeSize",null);d([c.property({type:a.SpatialReference,json:{write:!0}})],e.prototype,"spatialReference",void 0);return e=h=d([c.subclass("esri.layers.support.TileInfo")],e)}(c.declared(f))})},"esri/geometry/support/aaBoundingRect":function(){define(["require",
"exports","../../core/compilerUtils","../Extent"],function(p,h,n,g){function d(b){void 0===b&&(b=h.ZERO);return[b[0],b[1],b[2],b[3]]}function a(b){return b[0]>=b[2]?0:b[2]-b[0]}function f(b){return b[1]>=b[3]?0:b[3]-b[1]}function e(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b}function k(b){return 4===b.length}function c(b,a,c){return b<a?a:b>c?c:b}Object.defineProperty(h,"__esModule",{value:!0});h.create=d;h.clone=function(b){return[b[0],b[1],b[2],b[3]]};h.fromValues=function(b,a,c,f,e){void 0===
e&&(e=d());e[0]=b;e[1]=a;e[2]=c;e[3]=f;return e};h.fromExtent=function(b,a){void 0===a&&(a=d());a[0]=b.xmin;a[1]=b.ymin;a[2]=b.xmax;a[3]=b.ymax;return a};h.toExtent=function(b,a){return new g({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:a})};h.expandPointInPlace=function(b,a){a[0]<b[0]&&(b[0]=a[0]);a[0]>b[2]&&(b[2]=a[0]);a[1]<b[1]&&(b[1]=a[1]);a[1]>b[3]&&(b[3]=a[1])};h.expand=function(b,a,c){void 0===c&&(c=b);if("length"in a)if(k(a))c[0]=Math.min(b[0],a[0]),c[1]=Math.min(b[1],a[1]),c[2]=
Math.max(b[2],a[2]),c[3]=Math.max(b[3],a[3]);else{if(2===a.length||3===a.length)c[0]=Math.min(b[0],a[0]),c[1]=Math.min(b[1],a[1]),c[2]=Math.max(b[2],a[0]),c[3]=Math.max(b[3],a[1])}else switch(a.type){case "extent":c[0]=Math.min(b[0],a.xmin);c[1]=Math.min(b[1],a.ymin);c[2]=Math.max(b[2],a.xmax);c[3]=Math.max(b[3],a.ymax);break;case "point":c[0]=Math.min(b[0],a.x);c[1]=Math.min(b[1],a.y);c[2]=Math.max(b[2],a.x);c[3]=Math.max(b[3],a.y);break;default:n.neverReached(a)}return c};h.expandWithNestedArray=
function(b,a,c){void 0===c&&(c=b);var f=a.length,d=b[0],e=b[1],l=b[2];b=b[3];for(var k=0;k<f;k++){var m=a[k],d=Math.min(d,m[0]),e=Math.min(e,m[1]),l=Math.max(l,m[0]);b=Math.max(b,m[1])}c[0]=d;c[1]=e;c[2]=l;c[3]=b;return c};h.allFinite=function(b){for(var a=0;4>a;a++)if(!isFinite(b[a]))return!1;return!0};h.width=a;h.height=f;h.diameter=function(b){var c=a(b);b=f(b);return Math.sqrt(c*c+b*b)};h.area=function(b){return a(b)*f(b)};h.center=function(b,c){void 0===c&&(c=[0,0]);c[0]=b[0]+a(b)/2;c[1]=b[1]+
f(b)/2;return c};h.containsPoint=function(b,a){return a[0]>=b[0]&&a[1]>=b[1]&&a[0]<=b[2]&&a[1]<=b[3]};h.containsPointWithMargin=function(b,a,c){return a[0]>=b[0]-c&&a[1]>=b[1]-c&&a[0]<=b[2]+c&&a[1]<=b[3]+c};h.intersects=function(b,a){return Math.max(a[0],b[0])<=Math.min(a[2],b[2])&&Math.max(a[1],b[1])<=Math.min(a[3],b[3])};h.contains=function(b,a){return a[0]>=b[0]&&a[2]<=b[2]&&a[1]>=b[1]&&a[3]<=b[3]};h.intersection=function(b,a,f){void 0===f&&(f=b);var d=a[0],e=a[1],k=a[2];a=a[3];f[0]=c(b[0],d,k);
f[1]=c(b[1],e,a);f[2]=c(b[2],d,k);f[3]=c(b[3],e,a);return f};h.distance=function(b,c){var d=(b[1]+b[3])/2,e=Math.max(Math.abs(c[0]-(b[0]+b[2])/2)-a(b)/2,0);b=Math.max(Math.abs(c[1]-d)-f(b)/2,0);return Math.sqrt(e*e+b*b)};h.offset=function(b,a,c,f){void 0===f&&(f=b);f[0]=b[0]+a;f[1]=b[1]+c;f[2]=b[2]+a;f[3]=b[3]+c;return f};h.pad=function(b,a,c){void 0===c&&(c=b);c[0]=b[0]-a;c[1]=b[1]-a;c[2]=b[2]+a;c[3]=b[3]+a;return c};h.setMin=function(b,a,c){void 0===c&&(c=b);c[0]=a[0];c[1]=a[1];c!==b&&(c[2]=b[2],
c[3]=b[3]);return c};h.setMax=function(b,a,c){void 0===c&&(c=b);c[2]=a[0];c[3]=a[1];c!==b&&(c[0]=b[0],c[1]=b[1]);return b};h.set=e;h.empty=function(b){return b?e(b,h.NEGATIVE_INFINITY):d(h.NEGATIVE_INFINITY)};h.is=k;h.isPoint=function(b){return(0===a(b)||!isFinite(b[0]))&&(0===f(b)||!isFinite(b[1]))};h.equals=function(b,a,c){if(null==b||null==a)return b===a;if(!k(b)||!k(a))return!1;if(c)for(var f=0;f<b.length;f++){if(!c(b[f],a[f]))return!1}else for(f=0;f<b.length;f++)if(b[f]!==a[f])return!1;return!0};
h.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];h.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];h.ZERO=[0,0,0,0]})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),function(p,h,n,g,d,a,f){return function(d){function e(b){b=d.call(this,b)||this;b.level=0;b.levelValue=null;b.resolution=
0;b.scale=0;return b}n(e,d);c=e;e.prototype.clone=function(){return new c({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var c;g([a.property({type:f.Integer,json:{write:!0}})],e.prototype,"level",void 0);g([a.property({type:String,json:{write:!0}})],e.prototype,"levelValue",void 0);g([a.property({type:Number,json:{write:!0}})],e.prototype,"resolution",void 0);g([a.property({type:Number,json:{write:!0}})],e.prototype,"scale",void 0);return e=c=g([a.subclass("esri.layers.support.LOD")],
e)}(a.declared(d))})},"esri/layers/support/TilemapCache":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper dojo/io-query ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ./Tilemap".split(" "),function(p,h,n,g,d,a,f,e,k,c,b,l,m,r,q,t,u){var w=
b.getLogger("esri.layers.support.TilemapCache");return function(b){function e(a){a=b.call(this)||this;a._handles=new c;a._pendingTilemapRequests={};a._availableLevels={};a.levels=5;a.cacheByteSize=2097152;a.request=f;return a}g(e,b);h=e;e.prototype.initialize=function(){var b=this;this._tilemapCache=new l(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],function(){return b._initializeTilemapDefinition()}),q.init(this,"layer.tileInfo.lods",function(a){return b._initializeAvailableLevels(a)},
!0)]);this._initializeTilemapDefinition()};e.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};e.prototype.castLevels=function(b){return 2>=b?(w.error("Minimum levels for Tilemap is 3, but got ",b),3):b};Object.defineProperty(e.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0});e.prototype.getTilemap=function(b,a,c){return this._tilemapFromCache(b,a,c,this._tmpTilemapDefinition)};e.prototype.fetchTilemap=function(b,a,c,f){var e=
this;if(!this._availableLevels[b])return r.reject(new k("tilemap-cache:level-unavailable","Level "+b+" is unavailable in the service"));var d=this._tmpTilemapDefinition;if(b=this._tilemapFromCache(b,a,c,d))return r.resolve(b);var g=u.tilemapDefinitionId(d),l=this._pendingTilemapRequests[g];l||(l=u.Tilemap.fromDefinition(d,f).then(function(b){e._tilemapCache.put(g,b,b.byteSize);delete e._pendingTilemapRequests[g];return b}).catch(function(b){delete e._pendingTilemapRequests[g];return r.reject(b)}),
this._pendingTilemapRequests[g]=l);return r.create(function(b,a){l.then(b,a)})};e.prototype.getAvailability=function(b,a,c){return this._availableLevels[b]?(b=this.getTilemap(b,a,c))?b.getAvailability(a,c):"unknown":"unavailable"};e.prototype.getAvailabilityUpsample=function(b,a,c,e){e.level=b;e.row=a;e.col=c;b=this.layer.tileInfo;for(b.updateTileInfo(e);;)if(a=this.getAvailability(e.level,e.row,e.col),"unavailable"===a){if(!b.upsampleTile(e))return"unavailable"}else return a};e.prototype.fetchAvailability=
function(b,a,c,e){return this._availableLevels[b]?this.fetchTilemap(b,a,c,e).catch(function(b){return b}).then(function(e){return e instanceof u.Tilemap?(e=e.getAvailability(a,c),"unavailable"===e?r.reject(new k("tile-map:tile-unavailable","Tile is not available",{level:b,row:a,col:c})):e):e&&"cancel"===e.dojoType?r.reject(e):"unknown"}):r.reject(new k("tilemap-cache:level-unavailable","Level "+b+" is unavailable in the service"))};e.prototype.fetchAvailabilityUpsample=function(b,a,c,e,f){var d=this;
e.level=b;e.row=a;e.col=c;var k=this.layer.tileInfo;k.updateTileInfo(e);var g=this.fetchAvailability(b,a,c,f).catch(function(b){return b&&"cancel"===b.dojoType?r.reject(b):k.upsampleTile(e)?d.fetchAvailabilityUpsample(e.level,e.row,e.col,e):r.reject(b)});if(g.isFulfilled())return g;var l={id:e.id,level:b,row:a,col:c};b=function(b){var a=m.fetchAvailability(l.level,l.row,l.col,f);h._prefetches.push(a);b=function(){return h._prefetches.removeUnordered(a)};g.then(function(){return a.cancel()},function(){return a.cancel()});
a.then(b,b)};var m=this;for(a=0;h._prefetches.length<h._maxPrefetch&&k.upsampleTile(l);++a)b(a);return g};e.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var b=this.layer.parsedUrl,c=b.query;this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:b.path,query:c?a.objectToQuery(c):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};e.prototype._tilemapFromCache=function(b,
a,c,e){b=this._getTilemapDefinition(b,a,c,e);b=u.tilemapDefinitionId(b);return this._tilemapCache.get(b)};e.prototype._getTilemapDefinition=function(b,a,c,e){e.level=b;e.row=a-a%this.size;e.col=c-c%this.size;return e};e.prototype._initializeAvailableLevels=function(b){var a=this;this._availableLevels={};b&&b.forEach(function(b){return a._availableLevels[b.level]=!0})};var h;e._maxPrefetch=4;e._prefetches=new m({initialSize:h._maxPrefetch});d([t.property({constructOnly:!0,type:Number})],e.prototype,
"levels",void 0);d([t.cast("levels")],e.prototype,"castLevels",null);d([t.property({readOnly:!0,dependsOn:["levels"],type:Number})],e.prototype,"size",null);d([t.property({constructOnly:!0,type:Number})],e.prototype,"cacheByteSize",void 0);d([t.property({constructOnly:!0})],e.prototype,"layer",void 0);d([t.property({constructOnly:!0})],e.prototype,"request",void 0);return e=h=d([t.subclass("esri.layers.support.TilemapCache")],e)}(t.declared(e))})},"esri/core/LRUCache":function(){define(["require",
"exports","./MemCache"],function(p,h,n){return function(){function g(d,a){this._storage=new n.Storage;this._storage.maxSize=d;a&&this._storage.registerRemoveFunc("",a)}g.prototype.put=function(d,a,f){this._storage.put(d,a,f)};g.prototype.pop=function(d){return this._storage.pop(d)};g.prototype.get=function(d){return this._storage.get(d)};g.prototype.clear=function(){this._storage.clearAll()};g.prototype.destroy=function(){this._storage.clearAll()};return g}()})},"esri/layers/support/Tilemap":function(){define("require exports ../../core/tsSupport/assignHelper ../../request ../../core/Error ../../core/lang ../../core/promiseUtils".split(" "),
function(p,h,n,g,d,a,f){function e(a){var c;"vector-tile"===a.service.type?c=a.service.url+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height:(c=a.service.tileServers,c=(c&&c.length?c[a.row%c.length]:a.service.url)+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height);(a=a.service.query)&&(c=c+"?"+a);return c}Object.defineProperty(h,"__esModule",{value:!0});p=function(){function k(){this.location={left:0,top:0,width:0,height:0};this.byteSize=40}k.prototype.getAvailability=
function(a,b){if(this._isAllAvailable)return"available";if(this._isAllUnvailable)return"unavailable";a=(a-this.location.top)*this.location.width+(b-this.location.left);b=a>>3;var c=this._tileAvailabilityBitSet;return 0>b||b>c.length?"unknown":c[b]&1<<a%8?"available":"unavailable"};k.prototype._updateFromData=function(a){for(var b=!0,c=!0,e=new Uint8Array(Math.ceil(this.location.width*this.location.height/8)),f=0,d=0;d<a.length;d++){var k=d%8;a[d]?(c=!1,e[f]|=1<<k):b=!1;7===k&&++f}this._isAllUnvailable=
c;this._isAllAvailable=b;this._isAllAvailable||this._isAllUnvailable||(this._tileAvailabilityBitSet=e,this.byteSize+=e.length)};k.fromDefinition=function(a,b){var c=a.service.request||g,m=a.row,h=a.col,q=a.width,t=a.height,u={query:{f:"json"}};b=b?n({},u,b):u;return c(e(a),b).then(function(b){return b.data}).catch(function(b){if(b&&b.details&&422===b.details.httpStatus){b=[];for(var a=0,c=q*t;a<c;a++)b[a]=0;return{location:{top:m,left:h,width:q,height:t},valid:!0,data:b}}return f.reject(b)}).then(function(b){if(b.location&&
(b.location.top!==m||b.location.left!==h||b.location.width!==q||b.location.height!==t))throw new d("tilemap:location-mismatch","Tilemap response for different location than requested",{response:b,definition:{top:m,left:h,width:q,height:t}});return k.fromJSON(b)})};k.fromJSON=function(c){k.validateJSON(c);var b=new k;b.location=Object.freeze(a.clone(c.location));b._updateFromData(c.data);return Object.freeze(b)};k.validateJSON=function(a){if(!a||!a.location)throw new d("tilemap:missing-location","Location missing from tilemap response");
if(!1===a.valid)throw new d("tilemap:invalid","Tilemap response was marked as invalid");if(!a.data)throw new d("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(a.data))throw new d("tilemap:data-mismatch","Data must be an array of numbers");if(a.data.length!==a.location.width*a.location.height)throw new d("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");};return k}();h.Tilemap=p;h.tilemapDefinitionId=function(a){return a.level+"/"+
a.row+"/"+a.col+"/"+a.width+"/"+a.height};h.tilemapDefinitionUrl=e;h.default=p})},"esri/layers/support/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../request ../../core/promiseUtils".split(" "),function(p,h,n,g,d,a){Object.defineProperty(h,"__esModule",{value:!0});p=function(){function f(a,f){this.baseURL=a;this.devicePixelRatio=f;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus=
"not-loaded"}Object.defineProperty(f.prototype,"spriteNames",{get:function(){var a=[],f;for(f in this._spritesData)a.push(f);a.sort();return a},enumerable:!0,configurable:!0});f.prototype.getSpriteInfo=function(a){return this._spritesData[a]};f.prototype.load=function(){var e=this;this.loadStatus="loading";return this.baseURL?this._loadSprites().then(function(){e.loadStatus="loaded";return e}).catch(function(a){e.loadStatus="failed";return e}):a.resolve(this)};f.prototype._loadSprites=function(){var e=
this;this._isRetina=1.15<this.devicePixelRatio?!0:!1;var f=this.baseURL,c=this._isRetina?"@2x":"",b=""+f+c+".png";return a.all([d(f+c+".json",{responseType:"json"}),d(b,{responseType:"image"})]).then(function(b){var c=b[0];b=b[1];var f=Object.keys(c.data);if(!f||0===f.length||1===f.length&&"_ssl"===f[0]||!b||!b.data)return e._spritesData=e.image=null,e.width=e.height=0,a.resolve(null);e._spritesData=c.data;c=b.data;e.width=c.width;e.height=c.height;b=document.createElement("canvas");f=b.getContext("2d");
b.width=c.width;b.height=c.height;f.drawImage(c,0,0,c.width,c.height);c=f.getImageData(0,0,c.width,c.height);c=new Uint8Array(c.data);for(f=0;f<c.length;f+=4)b=c[f+3]/255,c[f]*=b,c[f+1]*=b,c[f+2]*=b;e.image=c})};return f}();h.default=p})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports ../../core/tsSupport/assignHelper ../../config ../../request ../../core/promiseUtils ../../core/urlUtils ../../views/vectorTiles/style/VectorTileSource".split(" "),function(p,h,n,g,d,
a,f,e){function k(b){b&&(b=f.getOrigin(b),r&&-1===r.indexOf(b)&&r.push(b))}function c(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(var a=void 0,c=0;c<b.length;++c)f.isProtocolRelative(b[c])?a&&(a=a.split("://")[0]+":"+b[c].trim()):a=f.isAbsolute(b[c])?b[c]:f.join(a,b[c]);return a}function b(b,c,e,g){var h,n,q;"string"===typeof e?(e=f.normalize(e),k(e),h=f.urlToObject(e),h=d(h.path,{query:{f:"json"},responseType:"json"}),q=n=e):(h=a.resolve({data:e}),n=e.jsonUrl||null,q=g);return h.then(function(e){var f=
e.data;e.ssl&&(n&&(n=n.replace(/^http:/i,"https:")),q&&(q=q.replace(/^http:/i,"https:")));return f.sources?(b.styleUrl=n||null,l(b,f,q)):f.sources?a.reject("You must specify the URL or the JSON for a service or for a style."):b.sourceUrl?m(b,f,q,!1,c):(b.sourceUrl=n||null,m(b,f,q,!0,c))})}function l(e,d,g){var l=g?f.removeFile(g):f.appBaseUrl;e.styleBase=l;e.style=d;e.styleUrl&&k(e.styleUrl);if(!e.source){var h=[];g=null;if(d.sources.esri){var m=d.sources.esri;m.url?g=b(e,"esri",c(l,m.url)):h.push(b(e,
"esri",m,l))}null===g&&(g=a.resolve());return g.then(function(){for(var f=0,g=Object.keys(d.sources);f<g.length;f++){var k=g[f];"esri"!==k&&"vector"===d.sources[k].type&&(d.sources[k].url?h.push(b(e,k,c(l,d.sources[k].url))):h.push(b(e,k,d.sources[k],l)))}return a.eachAlways(h).then(function(){})})}return a.resolve()}function m(d,g,l,h,m){l=l?f.removeTrailingSlash(l)+"/":f.appBaseUrl;var n;if(g.hasOwnProperty("tileInfo"))n=g;else{n={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,
ymax:2.0037507067161843E7,spatialReference:{wkid:102100}};for(var q=(n.xmax-n.xmin)/512,p=[],r=g.hasOwnProperty("minzoom")?parseFloat(g.minzoom):0,t=g.hasOwnProperty("maxzoom")?parseFloat(g.maxzoom):16;r<t;r++){var u=q/Math.pow(2,r);p.push({level:r,scale:Math.floor(3779.527559055118*u),resolution:u})}q=0;for(t=g.tiles;q<t.length;q++)k(c(l,t[q]));n={capabilities:"TilesOnly",initialExtent:n,fullExtent:n,minScale:p[0].scale,maxScale:p[p.length-1].scale,tiles:g.tiles,tileInfo:{rows:512,cols:512,dpi:96,
format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:p,spatialReference:{wkid:102100}}}}p=new e(m,l,n);if(!h&&d.primarySourceName in d.sourceNameToSource){q=d.sourceNameToSource[d.primarySourceName];if(!q.isCompatibleWith(p))return a.resolve();q.fullExtent.union(p.fullExtent);q.tileInfo.lods.length<p.tileInfo.lods.length&&(q.tileInfo=p.tileInfo)}h?(d.sourceBase=l,d.source=g,d.validatedSource=n,d.primarySourceName=m,d.sourceUrl&&k(d.sourceUrl)):k(l);d.sourceNameToSource[m]=p;return d.style?
a.resolve():null==g.defaultStyles?a.reject():"string"===typeof g.defaultStyles?b(d,"",c(l,g.defaultStyles,"root.json")):b(d,"",g.defaultStyles,c(l,"root.json"))}Object.defineProperty(h,"__esModule",{value:!0});var r=g.defaults&&g.defaults.io.corsEnabledServers;h.loadMetadata=function(a){var e={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:""},d="string"===typeof a?[a,null]:[null,a.jsonUrl],g=d[0],d=d[1],
l=g?f.urlToObject(g):null;return b(e,"esri",a,d).then(function(){var b={layerDefinition:e.validatedSource,url:g,parsedUrl:l,serviceUrl:e.sourceUrl,style:e.style,styleUrl:e.styleUrl,spriteUrl:e.style.sprite&&c(e.styleBase,e.style.sprite),glyphsUrl:e.style.glyphs&&c(e.styleBase,e.style.glyphs),sourceNameToSource:e.sourceNameToSource,primarySourceName:e.primarySourceName};k(b.spriteUrl);k(b.glyphsUrl);return b})}})},"esri/views/vectorTiles/style/VectorTileSource":function(){define("require exports ../../../core/lang ../../../core/promiseUtils ../../../core/urlUtils ../../../geometry/Extent ../../../layers/support/TileInfo ../../../layers/support/TilemapCache ../TileIndex".split(" "),
function(p,h,n,g,d,a,f,e,k){return function(){function c(b,c,f){this.tileMapURL="";this.fullExtent=this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;this.name=b;if(this.sourceUrl=c)this.parsedUrl=d.urlToObject(this.sourceUrl);b=n.clone(f);var g=b.tiles;c&&g.forEach(function(b,a){d.isAbsolute(b)||(g[a]=d.join(c,b))});this.tileServers=g;f.tileMap&&(this.tileMapURL=d.join(c,f.tileMap));var l=f.capabilities&&f.capabilities.split(",").map(function(b){return b.toLowerCase().trim()}),
h=!!f.exportTilesAllowed,l=!!l&&-1!==l.indexOf("tilemap"),m=h&&f.hasOwnProperty("maxExportTilesCount")?f.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:h,supportsTileMap:l},exportTiles:h?{maxExportTilesCount:+m}:null};this.tileInfo=this.readTileInfo(b.tileInfo,b);l&&(this.type="vector-tile",this.tilemapCache=new e({layer:this}),this.tileIndex=new k(this.tilemapCache));this.fullExtent=a.fromJSON(f.fullExtent)}c.prototype.getRefKey=function(b){return this.tileIndex?this.tileIndex.dataKey(b):
g.resolve(b)};c.prototype.getSourceTileUrl=function(b,a,c){var e=this.tileServers[a%this.tileServers.length];return e=e.replace(/\{z\}/gi,b.toString()).replace(/\{y\}/gi,a.toString()).replace(/\{x\}/gi,c.toString())};c.prototype.isCompatibleWith=function(b){var a=this.tileInfo;b=b.tileInfo;if(!a.spatialReference.equals(b.spatialReference)||!a.origin.equals(b.origin)||Math.round(a.dpi)!==Math.round(b.dpi))return!1;a=a.lods;b=b.lods;for(var c=Math.min(a.length,b.length),e=0;e<c;e++){var f=a[e],d=b[e];
if(f.level!==d.level||Math.round(f.scale)!==Math.round(d.scale))return!1}return!0};c.prototype.readTileInfo=function(b,a){var c=a.minScale?Math.round(1E4*a.minScale)/1E4:Infinity,e=a.maxScale?Math.round(1E4*a.maxScale)/1E4:-Infinity;return b?(b.lods=b.lods.filter(function(b){b=Math.round(1E4*b.scale)/1E4;return b<=c&&b>=e}),f.fromJSON(b)):null};return c}()})},"esri/views/vectorTiles/TileIndex":function(){define(["require","exports","../../core/promiseUtils","../../layers/support/TilemapCache","../2d/tiling/TileKey"],
function(p,h,n,g,d){return function(){function a(a){if(a instanceof g)this._tilemapCache=a;else if(a&&"index"in a)this._tilemap=a.index;else throw Error("Invalid tilemap!");}a.prototype.dataKey=function(a){if(this._tilemapCache){var e=a.level,f=a.row,c=a.col,b=new d(a);return this._tilemapCache.fetchAvailabilityUpsample(e,f,c,b).then(function(){return b}).catch(function(a){if(a&&"cancel"===a.dojoType)throw a;b.level=e;b.row=f;b.col=c;return b})}return this._getIndexedDataKey(a)};a.prototype.forEach=
function(a,e,d,c,b){this._callback=b;this._maxLevel=e+a;this._forEach(this._tilemap,e,d,c)};a.prototype._forEach=function(a,e,d,c){0!==a&&(this._callback(e,d,c),e!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],e+1,2*d,2*c),this._forEach(a[1],e+1,2*d,2*c+1),this._forEach(a[2],e+1,2*d+1,2*c),this._forEach(a[3],e+1,2*d+1,2*c+1)))};a.prototype._getIndexedDataKey=function(a){var e=[a];if(0>a.level||0>a.row||0>a.col||0<a.row>>a.level||0<a.col>>a.level)return n.resolve(null);for(;0!==a.level;)a=
new d(a.level-1,a.row>>1,a.col>>1,a.world),e.push(a);a=this._tilemap;var f=e.pop(),c,b;if(1===a)return n.resolve(f);for(;e.length;)if(c=e.pop(),b=(c.col&1)+((c.row&1)<<1),a){if(0===a[b]){f=null;break}if(1===a[b]){f=c;break}f=c;a=a[b]}return n.resolve(f)};return a}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(p,h,n){return function(){function g(d,a,f,e){this.set(d,a,f,e)}g.from=function(d,a,f,e){return g.pool.acquire(d,a,f,e)};g.getId=
function(d,a,f,e){return"object"===typeof d?d.level+"/"+d.row+"/"+d.col+"/"+d.world:d+"/"+a+"/"+f+"/"+e};Object.defineProperty(g.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});g.prototype.equals=function(d){return this.level===d.level&&this.row===d.row&&this.col===d.col&&this.world===d.world};g.prototype.release=function(){this.world=this.col=this.row=this.level=
0};g.prototype.set=function(d,a,f,e){null==d?this.world=this.col=this.row=this.level=0:"object"===typeof d?(this.level=d.level||0,this.row=d.row||0,this.col=d.col||0,this.world=d.world||0):"string"===typeof d?(d=d.split("/"),a=d[1],f=d[2],e=d[3],this.level=parseFloat(d[0]),this.row=parseFloat(a),this.col=parseFloat(f),this.world=parseFloat(e)):(this.level=+d,this.row=+a,this.col=+f,this.world=+e||0);return this};g.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};
g.prototype.getChildKeys=function(){var d=this.level+1,a=this.row<<1,f=this.col<<1,e=this.world;return[g.pool.acquire(d,a,f,e),g.pool.acquire(d,a,f+1,e),g.pool.acquire(d,a+1,f,e),g.pool.acquire(d,a+1,f+1,e)]};g.prototype.compareRowMajor=function(d){return this.row<d.row?-1:this.row>d.row?1:this.col<d.col?-1:this.col>d.col?1:0};g.sort=function(d){return d.map(function(a){return g.from(a)}).sort(function(a,f){return a.compareRowMajor(f)}).map(function(a){return a.id})};g.pool=new n(g,!0,null,25,50);
return g}()})},"esri/portal/support/jsonContext":function(){define(["require","exports","../../core/urlUtils","../Portal"],function(p,h,n,g){Object.defineProperty(h,"__esModule",{value:!0});h.createForItem=function(d){return{origin:"portal-item",url:n.urlToObject(d.itemUrl),portal:d.portal||g.getDefault()}}})},"esri/views/vectorTiles/SchemaHelper":function(){define(["require","exports"],function(p,h){return function(){function h(g,d){this.lockedSchemaPixelSize=g;this.isWGS84=d}h.prototype.getLevelRowColumn=
function(g){return this.isWGS84?[g[0],g[1]>>1,g[2]>>1]:256===this.lockedSchemaPixelSize&&0<g[0]?[g[0]-1,g[1]>>1,g[2]>>1]:g};h.prototype.adjustLevel=function(g){return this.isWGS84?g:256===this.lockedSchemaPixelSize?0<g?g-1:0:g};h.prototype.getShift=function(g,d){var a=0,f=0;if(256===this.lockedSchemaPixelSize||this.isWGS84)g[2]%2&&(a=2*d),g[1]%2&&(f=2*d);return[a,f]};h.prototype.getScale=function(g){if(this.isWGS84){if(512===this.lockedSchemaPixelSize)return 2}else if(256===this.lockedSchemaPixelSize&&
0===g)return.5;return 1};h.create256x256CompatibleTileInfo=function(g){if(!g)return null;if(256===g.rows&&256===g.cols)return g;for(var d=4326===g.spatialReference.wkid,a=[],f=g.lods.length,e=0;e<f;e++){var k=g.lods[e];a.push({level:k.level,scale:k.scale,resolution:d?k.resolution:2*k.resolution})}return{rows:256,cols:256,dpi:g.dpi,format:g.format,compressionQuality:g.compressionQuality,origin:g.origin,spatialReference:g.spatialReference,lods:a}};h.create512x512CompatibleTileInfo=function(g){if(!g||
256===g.rows||256===g.cols)return null;for(var d=[],a=g.lods.length,f=0;f<a;f++){var e=g.lods[f];d.push({level:e.level,scale:e.scale,resolution:.5*e.resolution})}return{rows:512,cols:512,dpi:g.dpi,format:g.format,compressionQuality:g.compressionQuality,origin:g.origin,spatialReference:g.spatialReference,lods:d}};return h}()})},"esri/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","../../../core/has","./StyleLayer"],function(p,h,n,g){return function(){function d(a,f){this._layerByName=
{};this.styleJSON=a;this.version=parseFloat(a.version);this.sprite=f?f.spriteUrl:a.sprite;this.glyphs=f?f.glyphsUrl:a.glyphs;if(this.layers=(a.layers||[]).map(d._create))for(a=void 0,f=0;f<this.layers.length;f++)a=this.layers[f],this._layerByName[a.id.toLowerCase()]=a;this._identifyRefLayers()}d.prototype.getStyleLayerId=function(a){return a>=this.layers.length?null:this.layers[a].id};d.prototype.getLayoutProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.layout:null};d.prototype.getPaintProperties=
function(a){return(a=this._layerByName[a.toLowerCase()])?a.paint:null};d.prototype.setPaintProperties=function(a,f){a=this._layerByName[a.toLowerCase()];if(!a)return"";var e=this.layers.indexOf(a);this.styleJSON.layers[e].paint=f;f=d._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:f},a);this.layers[e]=f;this._layerByName[a.id.toLowerCase()]=f;return a.id};d.prototype.setLayoutProperties=
function(a,f){a=this._layerByName[a.toLowerCase()];if(!a)return"";var e=this.layers.indexOf(a);this.styleJSON.layers[e].layout=f;f=d._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:f,paint:a.paint},a);this.layers[e]=f;this._layerByName[a.id.toLowerCase()]=f;return a.id};d.prototype._identifyRefLayers=function(){for(var a=[],f=[],e=0,d=0,c=this.layers;d<c.length;d++){var b=c[d];if(1===b.type){var g=b,h=
b.sourceLayer,h=h+("|"+JSON.stringify(b.layout&&b.layout.visibility)),h=h+("|"+JSON.stringify(b.minzoom)),h=h+("|"+JSON.stringify(b.maxzoom)),h=h+("|"+JSON.stringify(b.filter));if(g.hasDataDrivenFill||g.hasDataDrivenOutline)h+="|"+JSON.stringify(e);a.push({key:h,layer:b})}2===b.type&&(g=b,h=b.sourceLayer,h+="|"+JSON.stringify(b.layout&&b.layout.visibility),h+="|"+JSON.stringify(b.minzoom),h+="|"+JSON.stringify(b.maxzoom),h+="|"+JSON.stringify(b.filter),h+="|"+JSON.stringify(b.layout&&b.layout["line-cap"]),
h+="|"+JSON.stringify(b.layout&&b.layout["line-join"]),g.hasDataDrivenLine&&(h+="|"+JSON.stringify(e)),f.push({key:h,layer:b}));++e}this._assignRefLayers(a);this._assignRefLayers(f)};d.prototype._assignRefLayers=function(a){a.sort(function(b,a){return b.key<a.key?-1:b.key>a.key?1:0});for(var d,e,g=a.length,c=0;c<g;c++){var b=a[c];if(b.key===d)b.layer.refLayerId=e;else if(d=b.key,e=b.layer.id,1===b.layer.type&&!b.layer.getPaintProperty("fill-outline-color"))for(var h=c+1;h<g;h++){var n=a[h];if(n.key===
d){if(n.layer.getPaintProperty("fill-outline-color")){a[c]=n;a[h]=b;e=n.layer.id;break}}else break}}};d._create=function(a,d,e){d=1-1/(e.length+1)*(1+d);switch(a.type){case "background":return new g.BackgroundStyleLayer(0,a,d);case "fill":return new g.FillStyleLayer(1,a,d);case "line":return new g.LineStyleLayer(2,a,d);case "symbol":return new g.SymbolStyleLayer(3,a,d);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new g.CircleStyleLayer(4,a,d)}throw Error("Unknown vector tile layer");
};d._recreateLayer=function(a,d){switch(a.type){case "background":return new g.BackgroundStyleLayer(0,a,d.z);case "fill":return new g.FillStyleLayer(1,a,d.z);case "line":return new g.LineStyleLayer(2,a,d.z);case "symbol":return new g.SymbolStyleLayer(3,a,d.z);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new g.CircleStyleLayer(4,a,d.z)}};return d}()})},"esri/views/vectorTiles/style/StyleLayer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Filter ./StyleDefinition ./StyleProperty".split(" "),
function(p,h,n,g,d,a,f){Object.defineProperty(h,"__esModule",{value:!0});p=function(){function e(e,c,b){this.type=e;this.typeName=c.type;this.id=c.id;this.source=c.source;this.sourceLayer=c["source-layer"];this.minzoom=c.minzoom;this.maxzoom=c.maxzoom;this.filter=c.filter;this.layout=c.layout;this.paint=c.paint;this.z=b;switch(e){case 0:this._layoutDefinition=a.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=a.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=
a.StyleDefinition.fillLayoutDefinition;this._paintDefinition=a.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=a.StyleDefinition.lineLayoutDefinition;this._paintDefinition=a.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=a.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=a.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=a.StyleDefinition.circleLayoutDefinition,this._paintDefinition=a.StyleDefinition.circlePaintDefinition}this._layoutProperties=
this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}e.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=d.createFilter(this.filter)};e.prototype.getLayoutProperty=function(a){var c=this._layoutProperties;if(c)return c[a]};e.prototype.getPaintProperty=function(a){var c=this._paintProperties;if(c)return c[a]};e.prototype.getLayoutValue=function(a,c,b){var e,d=this._layoutProperties;d&&(d=d[a])&&(e=d.getValue(c,
b));a=this._layoutDefinition[a];void 0===e&&(e=a["default"]);"enum"===a.type&&(e=a.values.indexOf(e));return e};e.prototype.getPaintValue=function(a,c,b){var e,d=this._paintProperties;d&&(d=d[a])&&(e=d.getValue(c,b));a=this._paintDefinition[a];void 0===e&&(e=a["default"]);"enum"===a.type&&(e=a.values.indexOf(e));return e};e.prototype._parseLayout=function(a){var c={},b;for(b in a){var e=this._layoutDefinition[b];e&&(c[b]=new f(b,e,a[b]))}return c};e.prototype._parsePaint=function(a){var c={},b;for(b in a){var e=
this._paintDefinition[b];e&&(c[b]=new f(b,e,a[b]))}return c};return e}();h.StyleLayer=p;g=function(a){function e(c,b,e){return a.call(this,c,b,e)||this}n(e,a);return e}(p);h.BackgroundStyleLayer=g;g=function(a){function e(c,b,e){c=a.call(this,c,b,e)||this;b=c.getPaintProperty("fill-color");c.hasDataDrivenColor=b?b.isDataDriven:!1;b=c.getPaintProperty("fill-opacity");c.hasDataDrivenOpacity=b?b.isDataDriven:!1;c.hasDataDrivenFill=c.hasDataDrivenColor||c.hasDataDrivenOpacity;b=c.getPaintProperty("fill-outline-color");
c.outlineUsesFillColor=!b;c.hasDataDrivenOutlineColor=b?b.isDataDriven:!1;c.hasDataDrivenOutline=(b?c.hasDataDrivenOutlineColor:c.hasDataDrivenColor)||c.hasDataDrivenOpacity;return c}n(e,a);return e}(p);h.FillStyleLayer=g;g=function(a){function e(c,b,e){c=a.call(this,c,b,e)||this;b=c.getPaintProperty("line-color");c.hasDataDrivenColor=b?b.isDataDriven:!1;b=c.getPaintProperty("line-opacity");c.hasDataDrivenOpacity=b?b.isDataDriven:!1;b=c.getPaintProperty("line-width");c.hasDataDrivenWidth=b?b.isDataDriven:
!1;c.hasDataDrivenLine=c.hasDataDrivenColor||c.hasDataDrivenOpacity||c.hasDataDrivenWidth;return c}n(e,a);return e}(p);h.LineStyleLayer=g;g=function(a){function e(c,b,e){c=a.call(this,c,b,e)||this;b=c.getPaintProperty("icon-color");c.hasDataDrivenIconColor=b?b.isDataDriven:!1;b=c.getPaintProperty("icon-opacity");c.hasDataDrivenIconOpacity=b?b.isDataDriven:!1;b=c.getLayoutProperty("icon-size");c.hasDataDrivenIconSize=b?b.isDataDriven:!1;c.hasDataDrivenIcon=c.hasDataDrivenIconColor||c.hasDataDrivenIconOpacity||
c.hasDataDrivenIconSize;b=c.getPaintProperty("text-color");c.hasDataDrivenTextColor=b?b.isDataDriven:!1;b=c.getPaintProperty("text-opacity");c.hasDataDrivenTextOpacity=b?b.isDataDriven:!1;b=c.getLayoutProperty("text-size");c.hasDataDrivenTextSize=b?b.isDataDriven:!1;c.hasDataDrivenText=c.hasDataDrivenTextColor||c.hasDataDrivenTextOpacity||c.hasDataDrivenTextSize;return c}n(e,a);return e}(p);h.SymbolStyleLayer=g;p=function(a){function e(c,b,e){c=a.call(this,c,b,e)||this;b=c.getPaintProperty("circle-radius");
c.hasDataDrivenRadius=b?b.isDataDriven:!1;b=c.getPaintProperty("circle-color");c.hasDataDrivenColor=b?b.isDataDriven:!1;b=c.getPaintProperty("circle-opacity");c.hasDataDrivenOpacity=b?b.isDataDriven:!1;b=c.getPaintProperty("circle-stroke-width");c.hasDataDrivenStrokeWidth=b?b.isDataDriven:!1;b=c.getPaintProperty("circle-stroke-color");c.hasDataDrivenStrokeColor=b?b.isDataDriven:!1;b=c.getPaintProperty("circle-stroke-opacity");c.hasDataDrivenStrokeOpacity=b?b.isDataDriven:!1;b=c.getPaintProperty("circle-blur");
c.hasDataDrivenBlur=b?b.isDataDriven:!1;return c}n(e,a);return e}(p);h.CircleStyleLayer=p;p=function(){return function(a,d,c){this.cap=a.getLayoutValue("line-cap",d,c);this.join=a.getLayoutValue("line-join",d,c);this.miterLimit=a.getLayoutValue("line-miter-limit",d,c);this.roundLimit=a.getLayoutValue("line-round-limit",d,c)}}();h.LineLayout=p;p=function(){return function(a,d,c,b){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",d,b);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",
d,b);this.optional=a.getLayoutValue("icon-optional",d,b);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",d,b);this.size=a.getLayoutValue("icon-size",d,b);this.rotate=a.getLayoutValue("icon-rotate",d,b);this.padding=a.getLayoutValue("icon-padding",d,b);this.keepUpright=a.getLayoutValue("icon-keep-upright",d,b);this.offset=a.getLayoutValue("icon-offset",d,b);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();h.IconLayout=p;p=function(){return function(a,d,c,b){this.allowOverlap=
a.getLayoutValue("text-allow-overlap",d,b);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",d,b);this.optional=a.getLayoutValue("text-optional",d,b);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",d,b);this.fontArray=a.getLayoutValue("text-font",d,b);this.maxWidth=a.getLayoutValue("text-max-width",d,b);this.lineHeight=a.getLayoutValue("text-line-height",d,b);this.letterSpacing=a.getLayoutValue("text-letter-spacing",d,b);this.justify=a.getLayoutValue("text-justify",d,
b);this.anchor=a.getLayoutValue("text-anchor",d,b);this.maxAngle=a.getLayoutValue("text-max-angle",d,b);this.size=a.getLayoutValue("text-size",d,b);this.rotate=a.getLayoutValue("text-rotate",d,b);this.padding=a.getLayoutValue("text-padding",d,b);this.keepUpright=a.getLayoutValue("text-keep-upright",d,b);this.transform=a.getLayoutValue("text-transform",d,b);this.offset=a.getLayoutValue("text-offset",d,b);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();h.TextLayout=p})},"esri/views/vectorTiles/style/Filter":function(){define(["require",
"exports"],function(p,h){return function(){function h(g,d,a){this._op=g;"$type"===d?(this._val=a instanceof Array?a.map(function(a){return h._types.indexOf(a)}):h._types.indexOf(a),this._op+=11):(this._key=d,this._val=a)}h.prototype.filter=function(g){switch(this._op){case 0:return this._val;case 1:return g.values[this._key]===this._val;case 2:return g.values[this._key]!==this._val;case 3:return g.values[this._key]<this._val;case 4:return g.values[this._key]>this._val;case 5:return g.values[this._key]<=
this._val;case 6:return g.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(g.values[this._key]);case 8:return-1===this._val.indexOf(g.values[this._key]);case 9:for(var d=0,a=this._val;d<a.length;d++){var f=a[d];if(f.filter(g))return!0}return!1;case 10:d=0;for(a=this._val;d<a.length;d++)if(f=a[d],!f.filter(g))return!1;return!0;case 11:d=0;for(a=this._val;d<a.length;d++)if(f=a[d],f.filter(g))return!1;return!0;case 12:return g.type===this._val;case 13:return g.type!==this._val;case 14:return g.type<
this._val;case 15:return g.type>this._val;case 16:return g.type>=this._val;case 17:return g.type<=this._val;case 18:return-1!==this._val.indexOf(g.type);case 19:return-1===this._val.indexOf(g.type);case 20:return void 0!==g.values[this._key];case 21:return void 0===g.values[this._key]}};h.createFilter=function(g){if(!g)return new h(0,void 0,!0);var d=g[0];if(1>=g.length)return new h(0,void 0,"any"!==d);switch(d){case "\x3d\x3d":return new h(1,g[1],g[2]);case "!\x3d":return new h(2,g[1],g[2]);case "\x3e":return new h(4,
g[1],g[2]);case "\x3c":return new h(3,g[1],g[2]);case "\x3e\x3d":return new h(6,g[1],g[2]);case "\x3c\x3d":return new h(5,g[1],g[2]);case "in":return new h(7,g[1],g.slice(2));case "!in":return new h(8,g[1],g.slice(2));case "any":return new h(9,void 0,g.slice(1).map(h.createFilter.bind(this)));case "all":return new h(10,void 0,g.slice(1).map(h.createFilter.bind(this)));case "none":return new h(11,void 0,g.slice(1).map(h.createFilter.bind(this)));case "has":return new h(20,g[1],void 0);case "!has":return new h(21,
g[1],void 0);default:throw Error("invalid operator: "+d);}};h._types=["Unknown","Point","LineString","Polygon"];return h}()})},"esri/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(p,h){Object.defineProperty(h,"__esModule",{value:!0});p=function(){function h(){}h.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};h.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};h.lineLayoutDefinition=
{visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};h.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",
minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",minimum:0,default:2},"icon-keep-upright":{type:"boolean",
default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",
values:["left","center","right"],default:"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",default:0},"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",
length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}};h.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};h.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}};h.fillPaintDefinition={"fill-opacity":{type:"number",
minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"fill-pattern":{type:"string"}};h.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",default:[0,0,0,1]},"line-translate":{type:"array",
value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}};h.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-color":{type:"color",
default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",
minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};h.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",
minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};h.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}};return h}();h.StyleDefinition=p})},"esri/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(p,h,n,g){return function(){function d(a,f,e){this.isDataDriven=!1;switch(f.type){case "number":a=!0;break;case "color":a=
!0;e=d._parseColor(e);break;case "array":a="number"===f.value;break;default:a=!1}null==e&&(e=f.default);a&&"interval"===e.type&&(a=!1);var g=e&&e.stops&&0<e.stops.length;if(g)for(var c=0,b=e.stops;c<b.length;c++){var h=b[c];h[1]=this._validate(h[1],f)}if(this.isDataDriven=e?!!e.property:!1)if(void 0!==e.default&&(e.default=this._validate(e.default,f)),g)switch(e.type){case "identity":this.getValue=this._buildIdentity(e,f);break;case "categorical":this.getValue=this._buildCategorical(e,f);break;default:this.getValue=
a?this._buildInterpolate(e,f):this._buildInterval(e,f)}else this.getValue=this._buildIdentity(e,f);else g?this.getValue=a?this._buildZoomInterpolate(e):this._buildZoomInterval(e):(e=this._validate(e,f),this.getValue=this._buildSimple(e))}d.prototype._validate=function(a,d){if("number"===d.type){if(a<d.minimum)return d.minimum;if(a>d.maximum)return d.maximum}return a};d.prototype._buildSimple=function(a){return function(){return a}};d.prototype._buildIdentity=function(a,f){var e=this;return function(g,
c){var b;c&&(b=c.values[a.property],"color"===f.type&&(b=d._parseColor(b)));void 0===b&&(b=a.default);return void 0!==b?e._validate(b,f):f.default}};d.prototype._buildCategorical=function(a,d){var e=this;return function(f,c){var b;c&&(b=c.values[a.property]);b=e._categorical(b,a.stops);return void 0!==b?b:void 0!==a.default?a.default:d.default}};d.prototype._buildInterval=function(a,d){var e=this;return function(f,c){var b;c&&(b=c.values[a.property]);return"number"===typeof b?e._interval(b,a.stops):
void 0!==a.default?a.default:d.default}};d.prototype._buildInterpolate=function(a,d){var e=this;return function(f,c){var b;c&&(b=c.values[a.property]);return"number"===typeof b?e._interpolate(b,a.stops,a.base||1):void 0!==a.default?a.default:d.default}};d.prototype._buildZoomInterpolate=function(a){var d=this;return function(e){return d._interpolate(e,a.stops,a.base||1)}};d.prototype._buildZoomInterval=function(a){var d=this;return function(e){return d._interval(e,a.stops)}};d.prototype._categorical=
function(a,d){for(var e=d.length,f=0;f<e;f++)if(d[f][0]===a)return d[f][1]};d.prototype._interval=function(a,d){for(var e=d.length,f=0,c=0;c<e;c++)if(d[c][0]<=a)f=c;else break;return d[f][1]};d.prototype._interpolate=function(a,d,e){for(var f,c,b=d.length,h=0;h<b;h++){var m=d[h];if(m[0]<=a)f=m;else{c=m;break}}if(f&&c){h=c[0]-f[0];a-=f[0];e=1===e?a/h:(Math.pow(e,a)-1)/(Math.pow(e,h)-1);if(Array.isArray(f[1])){f=f[1];c=c[1];a=[];for(h=0;h<f.length;h++)a.push(g.interpolate(f[h],c[h],e));return a}return g.interpolate(f[1],
c[1],e)}if(f)return f[1];if(c)return c[1]};d._isEmpty=function(a){for(var d in a)if(a.hasOwnProperty(d))return!1;return!0};d._parseColor=function(a){if(Array.isArray(a))return a;if("string"===typeof a){if(a=new n(a),!this._isEmpty(a))return n.toUnitRGBA(a)}else return a&&a.default&&(a.default=d._parseColor(a.default)),a&&a.stops&&(a.stops=a.stops.map(function(a){return[a[0],d._parseColor(a[1])]})),a};return d}()})},"esri/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(p,
h){function n(d,a){d%=a;return 0<=d?d:d+a}Object.defineProperty(h,"__esModule",{value:!0});h.C_INFINITY=Number.POSITIVE_INFINITY;h.C_PI=Math.PI;h.C_2PI=2*h.C_PI;h.C_PI_BY_2=h.C_PI/2;h.C_RAD_TO_256=128/h.C_PI;h.C_256_TO_RAD=h.C_PI/128;h.C_DEG_TO_256=256/360;h.C_DEG_TO_RAD=h.C_PI/180;h.C_SQRT2=1.414213562;h.C_SQRT2_INV=1/h.C_SQRT2;var g=1/Math.LN2;h.positiveMod=n;h.radToByte=function(d){return n(d*h.C_RAD_TO_256,256)};h.degToByte=function(d){return n(d*h.C_DEG_TO_256,256)};h.log2=function(d){return Math.log(d)*
g};h.sqr=function(d){return d*d};h.clamp=function(d,a,f){return Math.min(Math.max(d,a),f)};h.interpolate=function(d,a,f){return d*(1-f)+a*f};h.between=function(d,a,f){return d>=a&&d<=f||d>=f&&d<=a}})},"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../request ../core/Error ../core/global ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/urlUtils ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ArcGISCachedService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/SpriteSource ./support/TileInfo ./support/TilemapCache ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/vectorTiles/SchemaHelper ../views/vectorTiles/style/StyleRepository".split(" "),function(p,
h,n,g,d,a,f,e,k,c,b,l,m,r,q,t,u,w,A,v,z,x,B,C,D,y,E){return function(h){function k(a,b){a=h.call(this)||this;a._spriteSourceMap=new Map;a.currentStyleInfo=null;a.style=null;a.operationalLayerType="VectorTileLayer";a.type="vector-tile";a.url=null;return a}g(k,h);k.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?n({url:a},b):a};k.prototype.load=function(){var b=this,c=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1}).then(function(){if(b.portalItem&&b.portalItem.id){var c=
b.portalItem.itemUrl+"/resources/styles/root.json";return a(c,{query:{f:"json"}}).then(function(a){a.data&&b.read({url:c},D.createForItem(b.portalItem))})}}).then(function(){return b.loadStyle()},function(){return b.loadStyle()});this.addResolvingPromise(c);return this.when()};Object.defineProperty(k.prototype,"attributionDataUrl",{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&l.urlToObject(a.serviceUrl))?this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});
Object.defineProperty(k.prototype,"capabilities",{get:function(){var a=this._getPrimarySource();return a?a.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"fullExtent",{get:function(){var a=this._getPrimarySource();return a?a.fullExtent:null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"parsedUrl",{get:function(){return this.serviceUrl?b.urlToObject(this.serviceUrl):null},
enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,
configurable:!0});k.prototype.writeStyleUrl=function(a,b){a&&l.isProtocolRelative(a)&&(a="https:"+a);b.styleUrl=a};Object.defineProperty(k.prototype,"tileIndexType",{get:function(){var a=this._getPrimarySource();return a?a.type:""},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"tileIndexUrl",{get:function(){var a=this._getPrimarySource();return a?a.tileMapURL:""},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"tileInfo",{get:function(){var a=this._getPrimarySource();
return a?a.tileInfo:null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"tilemapCache",{get:function(){var a=this._getPrimarySource();return a?a.capabilities.operations.supportsTileMap?a.tilemapCache:null:null},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"tileServers",{get:function(){var a=this._getPrimarySource();return a?a.tileServers:[]},enumerable:!0,configurable:!0});k.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};
k.prototype.readCompatibleTileInfo256=function(a,b){return x.fromJSON(y.create256x256CompatibleTileInfo(b.tileInfo))};k.prototype.readCompatibleTileInfo512=function(a,b){return x.fromJSON(y.create512x512CompatibleTileInfo(b.tileInfo))};k.prototype.loadSpriteSource=function(a){void 0===a&&(a=1);if(!this._spriteSourceMap.has(a)){var b=new z.default(this.styleRepository.sprite,a);this._spriteSourceMap.set(a,b.load())}var d=this._spriteSourceMap.get(a);return c.create(function(a,b){d.then(a,b)})};k.prototype.loadStyle=
function(a){var b=this;a=a||this.style||this.url;if(this._loadingPromise&&"string"===typeof a&&this.url===a)return this._loadingPromise;var c=this._loadingPromise;this._loadingPromise=this._getSourceAndStyle(a).then(function(){b.loadSpriteSource(e.devicePixelRatio||1)});c&&!c.isFulfilled()&&c.cancel();return this._loadingPromise};k.prototype.getStyleLayerId=function(a){return this.styleRepository.getStyleLayerId(a)};k.prototype.getPaintProperties=function(a){return this.styleRepository.getPaintProperties(a)};
k.prototype.setPaintProperties=function(a,b){a=this.styleRepository.setPaintProperties(a,b);this.emit("paint-change",{layer:a,paint:b})};k.prototype.getLayoutProperties=function(a){return this.styleRepository.getLayoutProperties(a)};k.prototype.setLayoutProperties=function(a,b){a=this.styleRepository.setLayoutProperties(a,b);this.emit("layout-change",{layer:a,layout:b})};k.prototype.getTileUrl=function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,
b.toString()).replace(/\{x\}/gi,c.toString())};k.prototype.write=function(a,b){return b&&b.origin&&!this.styleUrl?(b.messages&&b.messages.push(new f("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,[a,b])};k.prototype.importLayerViewModule=function(a){switch(a.type){case "2d":return c.create(function(a){return p(["../views/2d/layers/VectorTileLayerView2D"],a)});case "3d":return c.create(function(a){return p(["../views/3d/layers/VectorTileLayerView3D"],
a)})}};k.prototype._getSourceAndStyle=function(a){var b=this;return a?C.loadMetadata(a).then(function(c){b._set("currentStyleInfo",{serviceUrl:c.serviceUrl,styleUrl:c.styleUrl,spriteUrl:c.spriteUrl,glyphsUrl:c.glyphsUrl,style:c.style,layerDefinition:c.layerDefinition});"string"===typeof a?(b.url=a,b.style=null):(b.url=null,b.style=a);b._set("sourceNameToSource",c.sourceNameToSource);b._set("primarySourceName",c.primarySourceName);b._set("styleRepository",new E(c.style,c));b.read(c.layerDefinition,
{origin:"service"})}):c.reject(Error("invalid style!"))};k.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta|basemapsdev)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3]&&b[3].toLowerCase()))for(var b=b[2]||"",c=0,d="OpenStreetMap_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84".split(" ");c<
d.length;c++){var e=d[c];if(-1<e.toLowerCase().indexOf(a))return l.normalize("//static.arcgis.com/attribution/Vector"+b+"/"+e)}};k.prototype._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null};d([m.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],k.prototype,"attributionDataUrl",null);d([m.property({type:["show","hide"]})],k.prototype,"listMode",void 0);d([m.property({json:{read:!1},
readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],k.prototype,"capabilities",null);d([m.property({readOnly:!0})],k.prototype,"currentStyleInfo",void 0);d([m.property({json:{read:!1},readOnly:!0,type:r,dependsOn:["sourceNameToSource","primarySourceName"]})],k.prototype,"fullExtent",null);d([m.property()],k.prototype,"style",void 0);d([m.property({type:["VectorTileLayer"]})],k.prototype,"operationalLayerType",void 0);d([m.property({readOnly:!0,dependsOn:["serviceUrl"]})],k.prototype,
"parsedUrl",null);d([m.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],k.prototype,"serviceUrl",null);d([m.property({type:q,dependsOn:["tileInfo"],readOnly:!0})],k.prototype,"spatialReference",null);d([m.property({readOnly:!0})],k.prototype,"styleRepository",void 0);d([m.property({readOnly:!0})],k.prototype,"sourceNameToSource",void 0);d([m.property({readOnly:!0})],k.prototype,"primarySourceName",void 0);d([m.property({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},
origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],k.prototype,"styleUrl",null);d([m.writer(["portal-item","web-document"],"styleUrl")],k.prototype,"writeStyleUrl",null);d([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],k.prototype,"tileIndexType",null);d([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],k.prototype,"tileIndexUrl",null);d([m.property({json:{read:!1},readOnly:!0,type:x,dependsOn:["sourceNameToSource",
"primarySourceName"]})],k.prototype,"tileInfo",null);d([m.property({json:{read:!1},readOnly:!0,type:B,dependsOn:["sourceNameToSource","primarySourceName"]})],k.prototype,"tilemapCache",null);d([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],k.prototype,"tileServers",null);d([m.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],k.prototype,"type",void 0);d([m.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},
write:!1,read:!1}})],k.prototype,"url",void 0);d([m.property({readOnly:!0})],k.prototype,"version",void 0);d([m.reader("version",["version","currentVersion"])],k.prototype,"readVersion",null);d([m.property({readOnly:!0})],k.prototype,"compatibleTileInfo256",void 0);d([m.reader("compatibleTileInfo256",["tileInfo"])],k.prototype,"readCompatibleTileInfo256",null);d([m.property({readOnly:!0})],k.prototype,"compatibleTileInfo512",void 0);d([m.reader("compatibleTileInfo512",["tileInfo"])],k.prototype,"readCompatibleTileInfo512",
null);return k=d([m.subclass("esri.layers.VectorTileLayer")],k)}(m.declared(t,w,A,v,k,u))});