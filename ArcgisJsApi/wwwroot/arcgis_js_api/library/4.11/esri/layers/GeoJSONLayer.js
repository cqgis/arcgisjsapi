// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/paramHelper ../geometry ../PopupTemplate ../renderers ../core/asyncUtils ../core/kebabDictionary ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ./Layer ./graphics/editingSupport ./graphics/sources/GeoJSONSource ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/TemporalLayer ./support/FeatureReduction ./support/FeatureReductionSelection ./support/FeatureTemplate ./support/FeatureType ./support/Field ./support/fieldUtils ./support/LabelClass ../support/popupUtils ../symbols/support/ElevationInfo ../tasks/support/Query".split(" "),
function(m,N,r,d,O,g,k,t,n,u,v,w,p,x,c,y,z,A,B,C,D,E,F,G,H,I,h,J,K,L,e){var M=new v.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"});return function(q){function a(b){b=q.call(this)||this;b.copyright=null;b.definitionExpression=null;b.displayField=null;b.editingEnabled=!0;b.elevationInfo=null;b.featureReduction=null;b.fields=null;b.fullExtent=null;b.geometryType=null;b.hasZ=void 0;b.labelsVisible=!0;b.labelingInfo=
null;b.legendEnabled=!0;b.objectIdField=null;b.popupEnabled=!0;b.popupTemplate=null;b.screenSizePerspectiveEnabled=!0;b.source=null;b.spatialReference=k.SpatialReference.WGS84;b.templates=null;b.title="GeoJSON";b.type="geojson";b.typeIdField=null;b.types=null;b.url=null;return b}r(a,q);a.prototype.load=function(){var b=this,a=new A.default({layer:this});this._set("source",a);this.addResolvingPromise(a.load().then(function(){b.read(a.layerDefinition,{origin:"service",url:b.parsedUrl});b.revert(["objectIdField",
"fields","timeInfo"],"service");h.fixRendererFields(b.renderer,b.fields);h.fixTimeInfoFields(b.timeInfo,b.fields)}));return this.when()};Object.defineProperty(a.prototype,"capabilities",{get:function(){return this.source?this.source.capabilities:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fieldsMap",{get:function(){var b=this.fields,
a=new Map;if(!b)return a;for(var c=0;c<b.length;c++){var d=b[c],l=d&&d.name&&d.name.trim();l&&(a.set(l,d),a.set(l.toLowerCase(),d))}return a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isTable",{get:function(){return this.loaded&&null==this.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"parsedUrl",{get:function(){return this.url?x.urlToObject(this.url):null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"renderer",{set:function(b){h.fixRendererFields(b,
this.fields);this._set("renderer",b)},enumerable:!0,configurable:!0});a.prototype.applyEdits=function(b){return u.safeCast(z.applyEdits(this,b))};a.prototype.createPopupTemplate=function(b){return K.createPopupTemplate(this,b)};a.prototype.createQuery=function(){var b=new e,a=this.get("capabilities.data");b.returnGeometry=!0;a&&a.supportsZ&&(b.returnZ=!0);b.outFields=["*"];b.where=this.definitionExpression||"1\x3d1";return b};a.prototype.getFieldDomain=function(b,a){var d=this,c,f=!1;a=(a=a&&a.feature)&&
a.attributes;var e=this.typeIdField&&a&&a[this.typeIdField];null!=e&&this.types&&(f=this.types.some(function(a){return a.id==e?((c=a.domains&&a.domains[b])&&"inherited"===c.type&&(c=d._getLayerDomain(b)),!0):!1}));f||c||(c=this._getLayerDomain(b));return c};a.prototype.getField=function(a,c){return c?h.getField(c,a):this.fieldsMap.get(a)||this.fieldsMap.get(a.toLowerCase())};a.prototype.queryFeatures=function(a,c){var b=this;return this.load().then(function(){return b.source.queryFeatures(a||b.createQuery(),
c)}).then(function(a){if(a&&a.features)for(var c=0,d=a.features;c<d.length;c++){var f=d[c];f.layer=f.sourceLayer=b}return a})};a.prototype.queryObjectIds=function(a,c){var b=this;return this.load().then(function(){return b.source.queryObjectIds(a||b.createQuery(),c)})};a.prototype.queryFeatureCount=function(a,c){var b=this;return this.load().then(function(){return b.source.queryFeatureCount(a||b.createQuery(),c)})};a.prototype.queryExtent=function(a,c){var b=this;return this.load().then(function(){return b.source.queryExtent(a||
b.createQuery(),c)})};a.prototype.importLayerViewModule=function(a){switch(a.type){case "2d":return p.create(function(a){return m(["../views/2d/layers/FeatureLayerView2D"],a)});case "3d":return p.create(function(a){return m(["../views/3d/layers/FeatureLayerView3D"],a)})}};a.prototype._getLayerDomain=function(a){if(!this.fields)return null;var b=null;this.fields.some(function(c){c.name===a&&(b=c.domain);return!!b});return b};d([c.property({readOnly:!0,dependsOn:["source.capabilities"],json:{read:!1,
write:!1}})],a.prototype,"capabilities",null);d([c.property({type:String})],a.prototype,"copyright",void 0);d([c.property({readOnly:!0,dependsOn:["fields","title"]})],a.prototype,"defaultPopupTemplate",null);d([c.property({type:String})],a.prototype,"definitionExpression",void 0);d([c.property({type:String})],a.prototype,"displayField",void 0);d([c.property({type:Boolean})],a.prototype,"editingEnabled",void 0);d([c.property({type:L})],a.prototype,"elevationInfo",void 0);d([c.property({types:{key:"type",
base:E.default,typeMap:{selection:F.default}}})],a.prototype,"featureReduction",void 0);d([c.property({type:[I]})],a.prototype,"fields",void 0);d([c.property({readOnly:!0,dependsOn:["fields"]})],a.prototype,"fieldsMap",null);d([c.property({type:k.Extent,aliasOf:"source.fullExtent"})],a.prototype,"fullExtent",void 0);d([c.property({type:["point","polygon","polyline","multipoint"],json:{read:{reader:M.read}}})],a.prototype,"geometryType",void 0);d([c.property({type:Boolean})],a.prototype,"hasZ",void 0);
d([c.property({type:String})],a.prototype,"id",void 0);d([c.property({type:Boolean,readOnly:!0,dependsOn:["loaded"]})],a.prototype,"isTable",null);d([c.property({type:Boolean})],a.prototype,"labelsVisible",void 0);d([c.property({type:[J]})],a.prototype,"labelingInfo",void 0);d([c.property({type:Boolean})],a.prototype,"legendEnabled",void 0);d([c.property({type:["show","hide"]})],a.prototype,"listMode",void 0);d([c.property({type:String})],a.prototype,"objectIdField",void 0);d([c.property({readOnly:!0,
dependsOn:["url"]})],a.prototype,"parsedUrl",null);d([c.property({type:Boolean})],a.prototype,"popupEnabled",void 0);d([c.property({type:t})],a.prototype,"popupTemplate",void 0);d([c.property({types:n.rendererTypes,json:{read:{source:"drawingInfo.renderer",reader:n.read}}})],a.prototype,"renderer",null);d([c.property({type:Boolean})],a.prototype,"screenSizePerspectiveEnabled",void 0);d([c.property({readOnly:!0})],a.prototype,"source",void 0);d([c.property({type:k.SpatialReference})],a.prototype,"spatialReference",
void 0);d([c.property({type:[G]})],a.prototype,"templates",void 0);d([c.property()],a.prototype,"title",void 0);d([c.property({json:{read:!1},readOnly:!0})],a.prototype,"type",void 0);d([c.property({type:String,readOnly:!0})],a.prototype,"typeIdField",void 0);d([c.property({type:[H]})],a.prototype,"types",void 0);d([c.property({type:String})],a.prototype,"url",void 0);d([g(0,c.cast(e))],a.prototype,"queryFeatures",null);d([g(0,c.cast(e))],a.prototype,"queryObjectIds",null);d([g(0,c.cast(e))],a.prototype,
"queryFeatureCount",null);d([g(0,c.cast(e))],a.prototype,"queryExtent",null);return a=d([c.subclass("esri.layers.GeoJSONLayer")],a)}(c.declared(y,C,B,w,D))});