// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/Map ../../../core/Error ../../../core/has ../../../core/Logger ../../../core/libs/rbush/rbush ../../../geometry/support/aaBoundingRect ../featureConversionUtils".split(" "),function(w,a,t,n,b,c,k,l,x,u,m){Object.defineProperty(a,"__esModule",{value:!0});var q=[],C=l.getLogger("esri.layers.graphics.data.FeatureStore"),
B={minX:0,minY:0,maxX:0,maxY:0};w=function(){function a(a){this._featuresById=new b.default;this._boundsByFeature=new b.default;this._featuresByBounds=new b.default;this._index=x(9,k("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._geometryInfo=a}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var a=u.create(u.NEGATIVE_INFINITY);this._boundsByFeature.forEach(function(f){f&&(a[0]=Math.min(f[0],a[0]),a[1]=Math.min(f[1],
a[1]),a[2]=Math.max(f[2],a[2]),a[3]=Math.max(f[3],a[3]))});return a},enumerable:!0,configurable:!0});a.prototype.setEngine=function(a){this._engine=a};a.prototype.add=function(a){this._add(a,q);this._index.load(q);this._clearCache();q.length=0};a.prototype.addMany=function(a){for(var f=0;f<a.length;f++)this._add(a[f],q);this._index.load(q);this._clearCache();q.length=0};a.prototype.clear=function(){this._featuresById.clear();this._boundsByFeature.clear();this._featuresByBounds.clear();this._index.clear();
this._clearCache()};a.prototype.removeManyById=function(a){for(var f=0;f<a.length;f++){var e=a[f],r=this._featuresById.get(e);if(r){var h=this._boundsByFeature.get(r);h&&(this._index.remove(h),this._featuresByBounds.delete(h));this._boundsByFeature.delete(r)}this._featuresById.delete(e)}this._clearCache()};a.prototype.forEachBounds=function(a,f){for(var e=0;e<a.length;e++){var r=a[e],h=this._boundsByFeature.get(r);h&&f(h,r)}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=
function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(f){return a(f)})};a.prototype.forEachInBounds=function(a,f){var e=0,r=this._index;B.minX=a[0];B.minY=a[1];B.maxX=a[2];B.maxY=a[3];for(a=r.search(B);e<a.length;e++)f(this._featuresByBounds.get(a[e]))};a.prototype.transferIds=function(a,f){for(var e=[],r=0;r<f.length;r++){var h=this._featuresById.get(f[r]);h&&(this._remove(h),e.push(h))}a.addMany(e);this._clearCache()};a.prototype.transferIdRange=
function(a,f,e){for(var r=[];f<e;f++){var h=this._featuresById.get(f);h&&(this._remove(h),r.push(h))}a.addMany(r);this._clearCache()};a.prototype.transferIf=function(a,f){var e=this,r=[];this._featuresById.forEach(function(a,p){f(a)&&(e._remove(a),r.push(a))});a.addMany(r);this._clearCache()};a.prototype.transferAll=function(a){var f=this,e=[];this._featuresById.forEach(function(a,h){f._remove(a);e.push(a)});a.addMany(e);this._clearCache()};a.prototype._clearCache=function(){this._engine&&this._engine.clearCache()};
a.prototype._add=function(a,f){if(a){var e=a.objectId;if(null==e)C.error(new c("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var r=this._featuresById.get(e),h;r&&(h=this._boundsByFeature.get(r))&&(this._index.remove(h),this._boundsByFeature.delete(r),this._featuresByBounds.delete(h));a.geometry?(h=m.getBoundsOptimizedGeometry(h||u.create(),a.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(a,h),this._featuresByBounds.set(h,a),this._featuresById.set(e,
a),f.push(h)):(this._boundsByFeature.set(a,null),this._featuresById.set(e,a))}}};a.prototype._remove=function(a){var f;if(a){if(f=this._boundsByFeature.get(a))this._index.remove(f),this._boundsByFeature.delete(a),this._featuresByBounds.delete(f);this._featuresById.delete(a.objectId)}};return a}();a.default=w})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(w){function a(b,m){if(!(this instanceof a))return new a(b,m);this._maxEntries=Math.max(4,b||9);this._minEntries=
Math.max(2,Math.ceil(.4*this._maxEntries));m&&("function"===typeof m?this.toBBox=m:this._initFormat(m));this.clear()}function t(a,m){n(a,0,a.children.length,m,a)}function n(a,m,c,f,e){e||(e=q(null));e.minX=Infinity;e.minY=Infinity;e.maxX=-Infinity;e.maxY=-Infinity;for(var r;m<c;m++)r=a.children[m],b(e,a.leaf?f(r):r);return e}function b(a,m){a.minX=Math.min(a.minX,m.minX);a.minY=Math.min(a.minY,m.minY);a.maxX=Math.max(a.maxX,m.maxX);a.maxY=Math.max(a.maxY,m.maxY);return a}function c(a,m){return a.minX-
m.minX}function k(a,m){return a.minY-m.minY}function l(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function x(a){return a.maxX-a.minX+(a.maxY-a.minY)}function u(a,m){return a.minX<=m.minX&&a.minY<=m.minY&&m.maxX<=a.maxX&&m.maxY<=a.maxY}function m(a,m){return m.minX<=a.maxX&&m.minY<=a.maxY&&m.maxX>=a.minX&&m.maxY>=a.minY}function q(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function C(a,m,b,f,e){for(var r=[m,b],h;r.length;)b=r.pop(),m=r.pop(),b-m<=
f||(h=m+Math.ceil((b-m)/f/2)*f,w(a,h,m,b,e),r.push(m,h,h,b))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],f=this.toBBox;if(!m(a,b))return c;for(var e=[],r,h,p,q;b;){r=0;for(h=b.children.length;r<h;r++)p=b.children[r],q=b.leaf?f(p):p,m(a,q)&&(b.leaf?c.push(p):u(a,q)?this._all(p,c):e.push(p));b=e.pop()}return c},collides:function(a){var b=this.data,c=this.toBBox;if(!m(a,b))return!1;for(var f=[],e,r,h,p;b;){e=0;for(r=b.children.length;e<r;e++)if(h=
b.children[e],p=b.leaf?c(h):h,m(a,p)){if(b.leaf||u(a,p))return!0;f.push(h)}b=f.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var m=0,b=a.length;m<b;m++)this.insert(a[m]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(m=this.data,this.data=a,a=m),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&
this._insert(a,this.data.height-1);return this},clear:function(){this.data=q([]);return this},remove:function(a,m){if(!a)return this;for(var b=this.data,f=this.toBBox(a),e=[],r=[],h,p,c,q;b||e.length;){b||(b=e.pop(),p=e[e.length-1],h=r.pop(),q=!0);if(b.leaf){a:{c=a;var l=b.children,D=m;if(D){for(var k=0;k<l.length;k++)if(D(c,l[k])){c=k;break a}c=-1}else c=l.indexOf(c)}if(-1!==c){b.children.splice(c,1);e.push(b);this._condense(e);break}}q||b.leaf||!u(b,f)?p?(h++,b=p.children[h],q=!1):b=null:(e.push(b),
r.push(h),h=0,p=b,b=b.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:k,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,m){for(var b=[];a;)a.leaf?m.push.apply(m,a.children):b.push.apply(b,a.children),a=b.pop();return m},_build:function(a,m,b,f){var e=b-m+1,r=this._maxEntries,h;if(e<=r)return h=q(a.slice(m,b+1)),t(h,this.toBBox),h;f||(f=Math.ceil(Math.log(e)/Math.log(r)),r=Math.ceil(e/Math.pow(r,f-1)));h=q([]);h.leaf=
!1;h.height=f;var e=Math.ceil(e/r),r=e*Math.ceil(Math.sqrt(r)),p,c,l;for(C(a,m,b,r,this.compareMinX);m<=b;m+=r)for(c=Math.min(m+r-1,b),C(a,m,c,e,this.compareMinY),p=m;p<=c;p+=e)l=Math.min(p+e-1,c),h.children.push(this._build(a,p,l,f-1));t(h,this.toBBox);return h},_chooseSubtree:function(a,m,b,f){for(var e,r,h,p,c,q,z,D;;){f.push(m);if(m.leaf||f.length-1===b)break;z=D=Infinity;e=0;for(r=m.children.length;e<r;e++)h=m.children[e],c=l(h),q=(Math.max(h.maxX,a.maxX)-Math.min(h.minX,a.minX))*(Math.max(h.maxY,
a.maxY)-Math.min(h.minY,a.minY))-c,q<D?(D=q,z=c<z?c:z,p=h):q===D&&c<z&&(z=c,p=h);m=p||m.children[0]}return m},_insert:function(a,m,c){var f=this.toBBox;c=c?a:f(a);var f=[],e=this._chooseSubtree(c,this.data,m,f);e.children.push(a);for(b(e,c);0<=m;)if(f[m].children.length>this._maxEntries)this._split(f,m),m--;else break;this._adjustParentBBoxes(c,f,m)},_split:function(a,m){var b=a[m],f=b.children.length,e=this._minEntries;this._chooseSplitAxis(b,e,f);f=this._chooseSplitIndex(b,e,f);f=q(b.children.splice(f,
b.children.length-f));f.height=b.height;f.leaf=b.leaf;t(b,this.toBBox);t(f,this.toBBox);m?a[m-1].children.push(f):this._splitRoot(b,f)},_splitRoot:function(a,m){this.data=q([a,m]);this.data.height=a.height+1;this.data.leaf=!1;t(this.data,this.toBBox)},_chooseSplitIndex:function(a,m,b){var f,e,r,h,c,q,k;c=q=Infinity;for(f=m;f<=b-m;f++)e=n(a,0,f,this.toBBox),r=n(a,f,b,this.toBBox),h=Math.max(0,Math.min(e.maxX,r.maxX)-Math.max(e.minX,r.minX))*Math.max(0,Math.min(e.maxY,r.maxY)-Math.max(e.minY,r.minY)),
e=l(e)+l(r),h<c?(c=h,k=f,q=e<q?e:q):h===c&&e<q&&(q=e,k=f);return k},_chooseSplitAxis:function(a,m,b){var f=a.leaf?this.compareMinX:c,e=a.leaf?this.compareMinY:k,r=this._allDistMargin(a,m,b,f);m=this._allDistMargin(a,m,b,e);r<m&&a.children.sort(f)},_allDistMargin:function(a,m,c,f){a.children.sort(f);f=this.toBBox;var e=n(a,0,m,f),r=n(a,c-m,c,f),h=x(e)+x(r),p,q;for(p=m;p<c-m;p++)q=a.children[p],b(e,a.leaf?f(q):q),h+=x(e);for(p=c-m-1;p>=m;p--)q=a.children[p],b(r,a.leaf?f(q):q),h+=x(r);return h},_adjustParentBBoxes:function(a,
m,c){for(;0<=c;c--)b(m[c],a)},_condense:function(a){for(var m=a.length-1,b;0<=m;m--)0===a[m].children.length?0<m?(b=a[m-1].children,b.splice(b.indexOf(a[m]),1)):this.clear():t(a[m],this.toBBox)},_initFormat:function(a){var m=["return a"," - b",";"];this.compareMinX=new Function("a","b",m.join(a[0]));this.compareMinY=new Function("a","b",m.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],
function(){function w(n,b,c,k,l){for(;k>c;){if(600<k-c){var x=k-c+1,u=b-c+1,m=Math.log(x),q=.5*Math.exp(2*m/3),m=.5*Math.sqrt(m*q*(x-q)/x)*(0>u-x/2?-1:1);w(n,b,Math.max(c,Math.floor(b-u*q/x+m)),Math.min(k,Math.floor(b+(x-u)*q/x+m)),l)}x=n[b];u=c;q=k;a(n,c,b);for(0<l(n[k],x)&&a(n,c,k);u<q;){a(n,u,q);u++;for(q--;0>l(n[u],x);)u++;for(;0<l(n[q],x);)q--}0===l(n[c],x)?a(n,c,q):(q++,a(n,q,k));q<=b&&(c=q+1);b<=q&&(k=q-1)}}function a(a,b,c){var k=a[b];a[b]=a[c];a[c]=k}function t(a,b){return a<b?-1:a>b?1:0}
return function(a,b,c,k,l){w(a,b,c||0,k||a.length-1,l||t)}})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(w,a,t,n){function b(m){void 0===m&&(m=a.ZERO);return[m[0],m[1],m[2],m[3]]}function c(a){return a[0]>=a[2]?0:a[2]-a[0]}function k(a){return a[1]>=a[3]?0:a[3]-a[1]}function l(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a}function x(a){return 4===a.length}function u(a,b,c){return a<b?b:a>c?c:a}Object.defineProperty(a,
"__esModule",{value:!0});a.create=b;a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,c,l,k,n){void 0===n&&(n=b());n[0]=a;n[1]=c;n[2]=l;n[3]=k;return n};a.fromExtent=function(a,c){void 0===c&&(c=b());c[0]=a.xmin;c[1]=a.ymin;c[2]=a.xmax;c[3]=a.ymax;return c};a.toExtent=function(a,b){return new n({xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:b})};a.expandPointInPlace=function(a,b){b[0]<a[0]&&(a[0]=b[0]);b[0]>a[2]&&(a[2]=b[0]);b[1]<a[1]&&(a[1]=b[1]);b[1]>a[3]&&(a[3]=
b[1])};a.expand=function(a,b,c){void 0===c&&(c=a);if("length"in b)if(x(b))c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.max(a[2],b[2]),c[3]=Math.max(a[3],b[3]);else{if(2===b.length||3===b.length)c[0]=Math.min(a[0],b[0]),c[1]=Math.min(a[1],b[1]),c[2]=Math.max(a[2],b[0]),c[3]=Math.max(a[3],b[1])}else switch(b.type){case "extent":c[0]=Math.min(a[0],b.xmin);c[1]=Math.min(a[1],b.ymin);c[2]=Math.max(a[2],b.xmax);c[3]=Math.max(a[3],b.ymax);break;case "point":c[0]=Math.min(a[0],b.x);c[1]=Math.min(a[1],
b.y);c[2]=Math.max(a[2],b.x);c[3]=Math.max(a[3],b.y);break;default:t.neverReached(b)}return c};a.expandWithNestedArray=function(a,b,c){void 0===c&&(c=a);var m=b.length,q=a[0],l=a[1],f=a[2];a=a[3];for(var e=0;e<m;e++){var r=b[e],q=Math.min(q,r[0]),l=Math.min(l,r[1]),f=Math.max(f,r[0]);a=Math.max(a,r[1])}c[0]=q;c[1]=l;c[2]=f;c[3]=a;return c};a.allFinite=function(a){for(var b=0;4>b;b++)if(!isFinite(a[b]))return!1;return!0};a.width=c;a.height=k;a.diameter=function(a){var b=c(a);a=k(a);return Math.sqrt(b*
b+a*a)};a.area=function(a){return c(a)*k(a)};a.center=function(a,b){void 0===b&&(b=[0,0]);b[0]=a[0]+c(a)/2;b[1]=a[1]+k(a)/2;return b};a.containsPoint=function(a,b){return b[0]>=a[0]&&b[1]>=a[1]&&b[0]<=a[2]&&b[1]<=a[3]};a.containsPointWithMargin=function(a,b,c){return b[0]>=a[0]-c&&b[1]>=a[1]-c&&b[0]<=a[2]+c&&b[1]<=a[3]+c};a.intersects=function(a,b){return Math.max(b[0],a[0])<=Math.min(b[2],a[2])&&Math.max(b[1],a[1])<=Math.min(b[3],a[3])};a.contains=function(a,b){return b[0]>=a[0]&&b[2]<=a[2]&&b[1]>=
a[1]&&b[3]<=a[3]};a.intersection=function(a,b,c){void 0===c&&(c=a);var m=b[0],l=b[1],k=b[2];b=b[3];c[0]=u(a[0],m,k);c[1]=u(a[1],l,b);c[2]=u(a[2],m,k);c[3]=u(a[3],l,b);return c};a.distance=function(a,b){var m=(a[1]+a[3])/2,l=Math.max(Math.abs(b[0]-(a[0]+a[2])/2)-c(a)/2,0);a=Math.max(Math.abs(b[1]-m)-k(a)/2,0);return Math.sqrt(l*l+a*a)};a.offset=function(a,b,c,l){void 0===l&&(l=a);l[0]=a[0]+b;l[1]=a[1]+c;l[2]=a[2]+b;l[3]=a[3]+c;return l};a.pad=function(a,b,c){void 0===c&&(c=a);c[0]=a[0]-b;c[1]=a[1]-
b;c[2]=a[2]+b;c[3]=a[3]+b;return c};a.setMin=function(a,b,c){void 0===c&&(c=a);c[0]=b[0];c[1]=b[1];c!==a&&(c[2]=a[2],c[3]=a[3]);return c};a.setMax=function(a,b,c){void 0===c&&(c=a);c[2]=b[0];c[3]=b[1];c!==a&&(c[0]=a[0],c[1]=a[1]);return a};a.set=l;a.empty=function(c){return c?l(c,a.NEGATIVE_INFINITY):b(a.NEGATIVE_INFINITY)};a.is=x;a.isPoint=function(a){return(0===c(a)||!isFinite(a[0]))&&(0===k(a)||!isFinite(a[1]))};a.equals=function(a,b,c){if(null==a||null==b)return a===b;if(!x(a)||!x(b))return!1;
if(c)for(var l=0;l<a.length;l++){if(!c(a[l],b[l]))return!1}else for(l=0;l<a.length;l++)if(a[l]!==b[l])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0]})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(w,a,t,n,b,c,k){function l(a,f){var b;if(!f)return null;if("x"in f){var c={x:0,y:0};a=a(f.x,f.y,q);c.x=a[0];c.y=a[1];null!=f.z&&(c.z=f.z);null!=f.m&&(c.m=f.m);return c}if("xmin"in f)return c={xmin:0,ymin:0,xmax:0,ymax:0},b=a(f.xmin,f.ymin,q),c.xmin=b[0],c.ymin=b[1],a=a(f.xmax,f.ymax,q),c.xmax=a[0],c.ymax=a[1],f.hasZ&&(c.zmin=f.zmin,c.zmax=f.zmax,c.hasZ=!0),f.hasM&&(c.mmin=f.mmin,c.mmax=f.mmax,c.hasM=!0),c;if("rings"in f)return{rings:x(f.rings,a),hasM:f.hasM,hasZ:f.hasZ};if("paths"in f)return{paths:x(f.paths,
a),hasM:f.hasM,hasZ:f.hasZ};if("points"in f)return{points:u(f.points,a),hasM:f.hasM,hasZ:f.hasZ}}function x(a,f){for(var b=[],c=0;c<a.length;c++)b.push(u(a[c],f));return b}function u(a,f){for(var b=[],c=0;c<a.length;c++){var h=a[c],p=f(h[0],h[1],[0,0]);b.push(p);2<h.length&&p.push(h[2]);3<h.length&&p.push(h[3])}return b}function m(a,f){return!c.isValid(a)||!c.isValid(f)||c.equals(a,f)||k.canProject(a,f)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var q=[0,0];a.checkProjectionSupport=function(a,
f){if(!f)return n.resolve();if(Array.isArray(a)){for(var c=0;c<a.length;c++){var r=a[c];if(m(r.geometry&&r.geometry.spatialReference,f))return b.isSupported()?b.load():n.reject(new t("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:f}))}return n.resolve()}return m(a,f)?b.isSupported()?b.load():n.reject(new t("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:f})):n.resolve()};var C=l.bind(null,
k.lngLatToXY),B=l.bind(null,k.xyToLngLat);a.project=function(a,f,e){e||(e=f,f=a.spatialReference);return c.isValid(f)&&c.isValid(e)&&!c.equals(f,e)?k.canProject(f,e)?c.isWebMercator(e)?C(a):B(a):b.projectMany([a],f,e,null,!0)[0]:a};var F=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,r){var f=this;a&&a.length&&b&&r&&!c.equals(b,r)||n.resolve(a);var e={geometries:a,inSpatialReference:b,outSpatialReference:r,resolve:null};
this._jobs.push(e);return n.create(function(a){e.resolve=a;null===f._timer&&(f._timer=setTimeout(f._process,10))},function(){var a=f._jobs.indexOf(e);-1<a&&f._jobs.splice(a,1)})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var e=a.geometries,r=a.inSpatialReference,h=a.outSpatialReference,a=a.resolve;k.canProject(r,h)?c.isWebMercator(h)?a(e.map(C)):a(e.map(B)):a(b.projectMany(e,r,h,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());
a.projectMany=function(a,f,b){return F.push(a,f,b)}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(w,a,t,n,b,c){function k(a,k,n,u,z){void 0===u&&(u=null);void 0===z&&(z=!1);if(null===u){var f=c.cacheKey(k,n);void 0!==m[f]?u=m[f]:(u=l(k,n,null),null===u&&(u=new c),m[f]=u)}return x._project(a,k,n instanceof b||!1===z?n:new b(n),u,z)}function l(a,b,l){void 0===l&&(l=null);a=x._getTransformation(a,
b,l);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var x=null;a.isLoaded=function(){return!!x&&n.isLoaded()};a.isSupported=function(){return n.isSupported()};var u=null;a.load=function(){return u?u:u=t.create(function(a,b){var c=n.load();w(["./geometryEngine"],function(l){x=l;c.then(function(){x._enableProjection(n);a()},function(a){b(a)})})})};a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:k(a,a[0].spatialReference,b,c):
k([a],a.spatialReference,b,c)[0]};var m={};a.projectMany=k;a.getTransformation=l;a.getTransformations=function(a,b,l){void 0===l&&(l=null);a=x._getTransformationBySuitability(a,b,l);if(null!==a){b=[];for(l=0;l<a.length;l++)b.push(c.fromGE(a[l]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(w,a,t,n,b){function c(b){function f(a,b,f){a[b]=f(a[b])}a._pe=b;q.init();C.init();B.init();F.init();
z.init();a.PeGCSExtent=function(b){function f(){return null!==b&&b.apply(this,arguments)||this}t(f,b);f.prototype.destroy=function(){a._pe.destroy(this)};return f}(a._pe.PeGCSExtent);for(var c=0,h=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];c<h.length;c++)b=h[c],f(b.prototype,"getName",function(a){return function(){return a.call(this,Array(q.PE_NAME_MAX))}});c=0;for(h=[a._pe.PeGeogtran,a._pe.PeProjcs];c<
h.length;c++)b=h[c],f(b.prototype,"getParameters",function(b){return function(){for(var f=Array(q.PE_PARM_MAX),c=b.call(this),e=0;e<f.length;e++){var h=a._pe.getValue(c,"*");f[e]=h?a._pe.wrapPointer(h,a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return f}});f(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var f=[],c=a.call(this);u(f,b,c);return f}});f(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var f=a._pe._pe_getPeGTlistExtendedGTsSize();
return function(){var c=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var c=[e],h=this.getSteps();if(1<h)for(var e=a._pe.getPointer(e),p=1;p<h;p++)c.push(a._pe.wrapPointer(e+f*p,a._pe.PeGTlistExtendedGTs))}return c}});var p=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var f=this._cache;f||(this._cache=f=new Map);if(f.has(b))return f.get(b);var c=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var c=[e],h=e.getNump();if(1<h)for(var e=a._pe.getPointer(e),r=1;r<h;r++)c.push(a._pe.wrapPointer(e+
p*r,a._pe.PeHorizon))}f.set(b,c);return c}};f(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);f(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=q.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var f=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(q.PE_BUFFER_MAX));return a._pe.Pointer_stringify(a._pe._pe_object_to_string_ext(f,b,c))}}function k(b){if(b){var f=a._pe.getClass(b);f&&(f=a._pe.getCache(f))&&(b=a._pe.getPointer(b))&&delete f[b]}}
function l(b,c){var f=[];c=Array(c);for(var e=0;e<b;e++)f.push(a._pe.ensureInt8(c));return f}function x(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function u(b,c,r,h){void 0===h&&(h=!1);if(h)for(h=0;h<2*c;h++)b[h]=a._pe.getValue(r+h*Float64Array.BYTES_PER_ELEMENT,"double");else{var f=0===b.length;for(h=0;h<c;h++)f&&(b[h]=Array(2)),b[h][0]=a._pe.getValue(r,"double"),b[h][1]=a._pe.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}}
Object.defineProperty(a,"__esModule",{value:!0});var m;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!n("esri-wasm")};a.load=function(){return m?m:m=b.create(function(a,b){w(["./support/pe-wasm"],function(f){f({locateFile:function(a){return w.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){c(b);a()})})})};(function(b){function f(b,f,c){a._pe.ensureCache.prepare();var e=x(c),h=c===e,e=a._pe.ensureFloat64(e);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),
f,e))&&u(c,f,e,h);return b}function c(a,b,f){return h(a,b,f,0)}function h(b,f,c,e){a._pe.ensureCache.prepare();var h=x(c),p=c===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),f,h,e))&&u(c,f,h,p);return b}b.geogToProj=f;b.projGeog=function(a,b,e,h){switch(h){case q.PE_TRANSFORM_P_TO_G:return c(a,b,e);case q.PE_TRANSFORM_G_TO_P:return f(a,b,e)}return 0};b.projToGeog=c;b.projToGeogCenter=h})(a.PeCSTransformations||(a.PeCSTransformations={}));var q;(function(b){b.init=
function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=
a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=
a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;
b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(q=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var e=null,p=h[b];p||(p={},h[b]=p);p.hasOwnProperty(String(c))?e=p[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,p[c]=e));return e=f(e)}function f(b){if(b){var c=b.getType();switch(c){case q.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case q.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case q.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,
a._pe.PeGeogtran);break;default:c&q.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var h={},p={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(q.PE_TYPE_COORDSYS,a)};b.factoryByType=c;b.fromString=function(b,c){var e=null,h=p[b];h||(h={},p[b]=h);h.hasOwnProperty(c)?e=h[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,h[c]=e));return e=f(e)};b.geogcs=function(a){return c(q.PE_TYPE_GEOGCS,a)};b.geogtran=
function(a){return c(q.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(q.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(q.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var C;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,f,e,l,m,k){var h=null,p=new a._pe.PeInteger(k);try{var r=
a._pe.PeGTlistExtended.prototype.getGTlist(b,f,e,l,m,p);if(k=p.val)if(h=[r],1<k){var I=a._pe.getPointer(r);for(b=1;b<k;b++)h.push(a._pe.wrapPointer(I+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(p)}return h}})(C=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var f=b[c];k(f);f.getEntries().forEach(function(a){k(a);a=a.getGeogtran();k(a);a.getParameters().forEach(k);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){k(a);
var b=a.getDatum();k(b);k(b.getSpheroid());k(a.getPrimem());k(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,f,p,l){a._pe.ensureCache.prepare();var e=x(f),h=f===e,e=a._pe.ensureFloat64(e),r=0;p&&(r=a._pe.ensureFloat64(p));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,e,r,l))&&u(f,c,e,h);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function c(b,c,f,
e,r,k){a._pe.ensureCache.prepare();var h,p;switch(b){case "dd":h=a._pe._pe_geog_to_dd;p=q.PE_DD_MAX;break;case "ddm":h=a._pe._pe_geog_to_ddm;p=q.PE_DDM_MAX;break;case "dms":h=a._pe._pe_geog_to_dms,p=q.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));c=x(e);c=a._pe.ensureFloat64(c);p=l(f,p);e=a._pe.ensureInt32(p);if(r=h(b,f,c,r,e))for(h=0;h<f;h++)k[h]=a._pe.Pointer_stringify(p[h]);return r}function f(b,c,f,e,l){a._pe.ensureCache.prepare();var h;switch(b){case "dd":h=a._pe._pe_dd_to_geog;break;case "ddm":h=
a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}b=0;c&&(b=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*f));(h=h(b,f,e,c))&&u(l,f,c);return h}b.geog_to_dms=function(a,b,f,e,l){return c("dms",a,b,f,e,l)};b.dms_to_geog=function(a,b,c,e){return f("dms",a,b,c,e)};b.geog_to_ddm=function(a,b,f,e,l){return c("ddm",a,b,f,e,l)};b.ddm_to_geog=function(a,b,c,e){return f("ddm",a,b,c,e)};b.geog_to_dd=function(a,b,f,e,
l){return c("dd",a,b,f,e,l)};b.dd_to_geog=function(a,b,c,e){return f("dd",a,b,c,e)}})(a.PeNotationDms||(a.PeNotationDms={}));var B;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};
b.geog_to_mgrs_extended=function(b,c,f,p,k,m,n){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=x(f);f=a._pe.ensureFloat64(b);b=l(c,q.PE_MGRS_MAX);var h=a._pe.ensureInt32(b);if(p=a._pe._pe_geog_to_mgrs_extended(e,c,f,p,k,m,h))for(k=0;k<c;k++)n[k]=a._pe.Pointer_stringify(b[k]);return p};b.mgrs_to_geog_extended=function(b,c,f,l,k){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*
c));(l=a._pe._pe_mgrs_to_geog_extended(e,c,f,l,b))&&u(k,c,b);return l}})(B=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,f,p,k,m,n){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=x(f);f=a._pe.ensureFloat64(b);b=l(c,q.PE_MGRS_MAX);var h=a._pe.ensureInt32(b);if(p=a._pe._pe_geog_to_usng(e,c,f,p,k,m,h))for(k=0;k<c;k++)n[k]=a._pe.Pointer_stringify(b[k]);return p};b.usng_to_geog=function(b,c,f,l){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));
b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(e=a._pe._pe_usng_to_geog(e,c,f,b))&&u(l,c,b);return e}})(a.PeNotationUsng||(a.PeNotationUsng={}));var F;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,c,f,p,k){a._pe.ensureCache.prepare();
var e=0;b&&(e=a._pe.getPointer(b));b=x(f);f=a._pe.ensureFloat64(b);b=l(c,q.PE_UTM_MAX);var h=a._pe.ensureInt32(b);if(p=a._pe._pe_geog_to_utm(e,c,f,p,h))for(e=0;e<c;e++)k[e]=a._pe.Pointer_stringify(b[e]);return p};b.utm_to_geog=function(b,c,f,l,k){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(l=a._pe._pe_utm_to_geog(e,c,f,l,b))&&u(k,c,b);return l}})(F=a.PeNotationUtm||(a.PeNotationUtm=
{}));var z;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(f,e){void 0===e&&(e=b.PE_PCSINFO_OPTION_DOMAIN);var h,l;c.has(f)&&(l=c.get(f),l[e]&&(h=l[e]));h||(h=a._pe.PePCSInfo.prototype.generate(f,e),
l||(l=[],c.set(f,l)),l[e]=h);return h}})(z=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(w,a,t){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<a.length;b++){var k=
a[b];k instanceof t?this.steps.push(k):this.steps.push(new t({wkid:k.wkid,wkt:k.wkt,isInverse:k.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(b){var c=new a,k="",l=0;for(b=b.steps;l<b.length;l++){var n=t.fromGE(b[l]);c.steps.push(n);k+=n.uid.toString()+","}c._cached_projection=
{};c._gtlistentry=null;c._chain=k;return c};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var c=this.steps.length-1;0<=c;c--)b.steps.push(this.steps[c].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",c=0,k=this.steps;c<k.length;c++)a+=k[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,c,k){this._cached_projection[a.cacheKey(b,c)]=k};a.prototype.getCachedGeTransformation=
function(b,c){for(var k="",l=0,n=this.steps;l<n.length;l++)k+=n[l].uid.toString()+",";k!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=k);b=this._cached_projection[a.cacheKey(b,c)];return void 0===b?null:b};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(w,a){var t=0;return function(){function a(a){void 0===a&&(a=null);this.uid=t++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:
-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var c=new a;c._wkt=b.wkt;c._wkid=b.wkid;c._isInverse=b.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=t++},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=t++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/array @dojo/framework/shim/Map @dojo/framework/shim/Set ../../../core/asyncUtils ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/PromiseQueue".split(" "),
function(w,a,t,n,b,c,k,l,x,u,m,q,C,B,F,z,f,e,r,h,p,J,Q,A,D){function S(a,b,c,f,e,h,l,k,p){p||(p=E);l&&!h?f.forEachInBounds(e,function(f){if(!b.has(f.objectId)){var e=A.getCentroid(c,f,k),h=f.attributes;e&&(b.add(f.objectId),a.push(new T(h,null,e,p(f))))}}):h&&!l?f.forEachInBounds(e,function(f){if(!b.has(f.objectId)){var e=f.attributes,h=A.getGeometry(c,f,0,k);h&&(b.add(f.objectId),a.push(new T(e,h,null,p(f))))}}):f.forEachInBounds(e,function(f){if(!b.has(f.objectId)){var e=f.attributes,h=A.getGeometry(c,
f,0,k),l=A.getCentroid(c,f,k);h&&l&&(b.add(f.objectId),a.push(new T(e,h,l,p(f))))}})}Object.defineProperty(a,"__esModule",{value:!0});var E=function(a){return 1},I=u.getLogger("esri.layers.graphics.data.QueryEngine"),T=function(){return function(a,b,c,f){this.attributes=a;this.geometry=b;this.centroid=c;this.filterFlags=f}}(),V=new c.default,M=new m.Storage(2E6),Lb=0;w=function(){function a(a){var c=this;this.capabilities={query:h.queryCapabilities};this.fieldsMap=new b.default;this.geometryType=
a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.gdbVersion=a.gdbVersion;this.historicMoment=a.historicMoment;this.featureStore=a.featureStore;this.featureStore.setEngine(this);this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new m(Lb++ +"$$",M));a.fields.forEach(function(a){c.fieldsMap.set(a.name.trim(),
a);c.fieldsMap.set(a.name.trim().toLowerCase(),a)});a.scheduler&&a.priority&&(this._frameQueue=new D.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.priority,function(a){return c._update(a)},function(){return 0<c._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this.fieldsMap.clear()};Object.defineProperty(a.prototype,
"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:A.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=Q.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a){var b=this;void 0===a&&(a={});var c=x.clone(a);return k.safeCast(A.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).catch(function(a){if(a===
A.QUERY_ENGINE_EMPTY_RESULT)return new p.default([],null,b);throw a;}).then(function(a){return a.createQueryResponse(c)})};a.prototype.executeQueryForCount=function(a){var b=this;void 0===a&&(a={});var c=x.clone(a);c.returnGeometry=!1;c.returnCentroid=!1;c.outSR=null;return k.safeCast(A.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){return a.size}).catch(function(a){if(a===
A.QUERY_ENGINE_EMPTY_RESULT)return 0;throw a;})};a.prototype.executeQueryForExtent=function(a){var b=this;void 0===a&&(a={});var c=x.clone(a),f=c.outSR;return k.safeCast(A.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._checkQuerySupport(a)}).then(function(){c.returnGeometry=!0;c.returnCentroid=!1;c.outSR=null;return c}).then(function(a){return b._reschedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){var c=
a.size;if(!c)return{count:c,extent:null};var e={xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:A.cleanFromGeometryEngine(b.spatialReference)};b.featureStore.forEachBounds(a.items,function(a){e.xmin=Math.min(a[0],e.xmin);e.ymin=Math.min(a[1],e.ymin);e.xmax=Math.max(a[2],e.xmax);e.ymax=Math.max(a[3],e.ymax)});a=r.project(e,a.spatialReference,f);a.spatialReference=A.cleanFromGeometryEngine(f||b.spatialReference);
if(0===a.xmax-a.xmin){var h=C.getMetersPerUnitForSR(a.spatialReference);a.xmin-=h;a.xmax+=h}0===a.ymax-a.ymin&&(h=C.getMetersPerUnitForSR(a.spatialReference),a.ymin-=h,a.ymax+=h);return{count:c,extent:a}}).catch(function(a){if(a===A.QUERY_ENGINE_EMPTY_RESULT)return{count:0,extent:null};throw a;})};a.prototype.executeQueryForIds=function(a){void 0===a&&(a={});return this.executeQueryForIdSet(a).then(function(a){return n.from(a)})};a.prototype.executeQueryForIdSet=function(a){var b=this;void 0===a&&
(a={});var f=x.clone(a);f.returnGeometry=!1;f.returnCentroid=!1;f.outSR=null;return k.safeCast(A.normalizeQuery(f,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(f)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(f)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(f)}).then(function(a){return b._reschedule(a)}).then(function(a){a=
a.items;for(var b=new c.default,f=0;f<a.length;f++)b.add(a[f].objectId);return b}).catch(function(a){if(a===A.QUERY_ENGINE_EMPTY_RESULT)return new c.default;throw a;})};a.prototype.executeTileQuery=function(a,b,e){var h=this;void 0===e&&(e=null);var l=b.returnGeometry,k=b.returnCentroid,p=b.pixelBuffer;b=new c.default;var r=[],p=p*a.resolution,m=B.pad(a.bounds,p,B.create());S(r,b,this,this.featureStore,m,l,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]},
e);if("esriGeometryPoint"===this.geometryType||k){var E=f.getInfo(this.spatialReference);if(E){var I=E.valid,E=I[0],I=I[1];if(m[0]<E){var D=B.fromValues(I-p,m[1],I,m[3]);S(r,b,this,this.featureStore,D,l,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[I,a.bounds[3]]},e)}m[2]>I&&(p=B.fromValues(E,m[1],E+p,m[3]),S(r,b,this,this.featureStore,p,l,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[E-I+a.bounds[0],a.bounds[3]]},e))}}r.sort(function(a,b){return a.attributes[h.objectIdField]-
b.attributes[h.objectIdField]});return{features:r,objectIds:b}};a.prototype.executeTileQueryForIds=function(a,b){a=B.pad(a.bounds,b.pixelBuffer*a.resolution,B.create());var c=[];this.featureStore.forEachInBounds(a,function(a){return c.push(a.objectId)});return c};a.prototype.executeQueryForLatestObservations=function(a){var b=this;if(this.timeInfo)return this.executeQuery(a).then(function(a){return b._filterLatest(a,b.timeInfo)});I.error(new l("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};
a.prototype._schedule=function(a){return this._frameQueue?this._frameQueue.push(a).then(function(a){return a}):q.resolve(a)};a.prototype._reschedule=function(a){return this._frameQueue?this._frameQueue.push(a).then(function(a){return a}):q.resolve(a)};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._filterLatest=function(a,c){var f=c.trackIdField,e=c.startTimeField;c=c.endTimeField||e;for(var e=new b.default,h=
[],l=0,p=a.features;l<p.length;l++){var k=p[l],r=k.attributes[f],m=k.attributes[c];(!e.has(r)||e.get(r).attributes[c]<m)&&e.set(r,k)}e.forEach(function(a){return h.push(a)});return t({},a,{features:h})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new p.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){var b=this,e=a.geometry,h=a.outSR,l=a.spatialRel,k=f.isValid(h)&&!f.equals(this.spatialReference,
h),r=this.cacheSpatialQueries?k?JSON.stringify({geometry:e,spatialRelationship:l,outSpatialReference:h}):JSON.stringify({geometry:e,spatialRelationship:l}):null;if(r){var m=this._geometryQueryCache.get(r);if(void 0!==m)return q.resolve(m)}var E=function(c){if(k&&(a.returnGeometry||a.returnCentroid))return c.project(h).then(function(a){r&&b._geometryQueryCache.put(r,a,a.size||1);return a});r&&b._geometryQueryCache.put(r,c,c.size||1);return c};if(!e)return q.resolve(this._getAll()).then(function(a){return E(a)});
if("esriSpatialRelDisjoint"===l){m=this._searchFeatures(this._getQueryBBoxes(e));if(!m.length)return q.resolve(this._getAll()).then(function(a){return E(a)});var I,D;return this._reschedule(m).then(function(a){return new c.default(a)}).then(function(a){return b._reschedule(a)}).then(function(a){var c=0;I=Array(a.size);b.featureStore.forEach(function(a){return I[c++]=a});D=a}).then(function(){return b._reschedule()}).then(function(){return J.getSpatialQueryOperator(l,e,b)}).then(function(a){return b._runSpatialFilter(I,
function(b){return!D.has(b)||a(b.geometry)}).then(function(a){return new p.default(a,e,b)}).then(function(a){return E(a)})})}var n=this._searchFeatures(this._getQueryBBoxes(e));return n.length?this._canExecuteSoloPass(e,a)?q.resolve(new p.default(n,e,this)).then(function(a){return E(a)}):J.getSpatialQueryOperator(l,e,this).then(function(a){return b._runSpatialFilter(n,function(b){return a(b.geometry)})}).then(function(a){return new p.default(a,e,b)}).then(function(a){return E(a)}):(m=new p.default([],
e,this),r&&this._geometryQueryCache.put(r,m,m.size||1),q.resolve(m))};a.prototype._runSpatialFilter=function(a,b){var c=this;if(!b)return q.resolve(a);if(!this._budget)return q.resolve(a.filter(function(a){return b(a)}));var f=0,e=[],h=function(){for(;f<a.length;){var l=a[f];b(l)&&e.push(l);if(c._budget.done)return c._reschedule().then(function(){return h()});++f}return q.resolve()};return this._reschedule().then(function(){return h()}).then(function(){return e})};a.prototype._canExecuteSoloPass=
function(a,b){var c=this.geometryType;b=b.spatialRel;return J.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(J.canQueryWithRBush(a)){if(z.isExtent(a))return[B.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(z.isPolygon(a))return a.rings.map(function(a){return B.fromValues(a[0][0],a[0][1],a[2][0],a[2][1])})}return[F.getBoundsXY(B.create(),
a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){V.add(a)});var c=Array(V.size),f=0;V.forEach(function(a){return c[f++]=a});V.clear();return c};a.prototype._checkQuerySupport=function(a){return 0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text?q.reject(new l("feature-store:unsupported-query","Unsupported query options",{query:a})):q.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),
J.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),r.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,f=a.returnDistinctValues;c&&0<c.length&&(c=c.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),e.validateFields(this.fieldsMap,c,"orderByFields contains missing fields"));if(b&&0<b.length)e.validateFields(this.fieldsMap,
b,"outFields contains missing fields");else if(f)throw new l("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});e.validateWhere(this.fieldsMap,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){var b=a.outStatistics,c=a.groupByFieldsForStatistics,f=a.having,h=c&&c.length,k=b&&b.length;if(f){if(!h||!k)return q.reject(new l("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a}));
e.validateHaving(this.fieldsMap,f,b)}if(k&&!b.some(function(a){return"exceedslimit"===a.statisticType}))for(f=b.map(function(a){return a.onStatisticField}),e.validateFields(this.fieldsMap,f,"onStatisticFields contains missing fields"),h&&e.validateFields(this.fieldsMap,c,"groupByFieldsForStatistics contains missing fields"),c=0;c<b.length;c++){var f=b[c],k=f.onStatisticField,p=f.statisticType;if("exceedslimit"===p)return q.reject(new l("feature-store:unsupported-query","statistic type exceedslimit is not supported",
{definition:f,query:a}));if((!h||"count"!==p)&&k&&e.hasInvalidFieldType(k,this.fieldsMap))return q.reject(new l("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:a}))}};return a}();a.default=w})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports @dojo/framework/shim/Set ../../../core/Error ../../../core/ItemCache ../../../core/sql/WhereClause".split(" "),function(w,a,t,n,b,c){function k(b){if(!b)return null;var l=a.invalidClauseCache.get(b);
if(void 0!==l)return l;l=a.whereClausesCache.get(b);if(void 0!==l)return l;l=c.create(b);a.whereClausesCache.put(b,l);return l}function l(a,b,c,u){void 0===u&&(u=!0);for(var m=[],q=0;q<b.length;q++){var f=b[q];if("*"!==f&&!a.has(f))if(u){var e=x(f);try{var r=k(e);if(!r.isStandardized())throw new n("feature-store:unsupported-query","expression is not standard",{clause:r});l(a,r.getFields(),"expression contains missing fields")}catch(h){if((e=h&&h.details)&&e.clause)throw h;e&&e.missingFields?Array.prototype.push.apply(m,
e.missingFields):m.push(f)}}else m.push(f)}if(m.length)throw new n("feature-store:unsupported-query",c,{missingFields:m});}function x(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});a.invalidClauseCache=new b(500);a.whereClausesCache=new b(50);var u=new t.default("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(b,k){if(!k)return!0;var m;try{m=
c.create(k),a.whereClausesCache.put(k,m)}catch(B){throw a.invalidClauseCache.put(k,null),new n("feature-store:unsupported-query","invalid SQL expression",{where:k});}if(!m.isStandardized())throw new n("feature-store:unsupported-query","where clause is not standard",{where:k});k=m.getFields();l(b,k,"where clause contains missing fields");return!0};a.validateHaving=function(b,k,x){if(!k)return!0;var m;try{m=c.create(k),a.whereClausesCache.put(k,m)}catch(z){throw a.invalidClauseCache.put(k,null),new n("feature-store:unsupported-query",
"invalid SQL expression",{having:k});}if(!m.isAggregate())throw new n("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:k});var q=m.getFields();l(b,q,"having contains missing fields");if(!m.getExpressions().every(function(a){var c=a.aggregateType;a=a.field;var e=b.has(a)&&b.get(a).name;return x.some(function(a){var f=a.statisticType;a=a.onStatisticField.toLowerCase().trim();return(b.has(a)&&b.get(a).name)===e&&f.toLowerCase().trim()===c})}))throw new n("feature-store:unsupported-query",
"expressions in having should also exist in outStatistics",{having:k});return!0};a.getWhereClause=k;a.validateFields=l;a.getExpressionFromFieldName=x;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){var c=!1;-1!==k(a).getFields().indexOf(a)&&(a=b.get(a),c=!u.has(a.type));return c}})},"esri/core/sql/WhereClause":function(){define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../../moment ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(w,a,t,n,b,c,k,l){function x(a){return Array.isArray(a)?a:[a]}function u(a){return null!==a?!0!==a:null}function m(a,b){if(null==a)return null;for(var c=!1,f=0;f<b.length;f++){var h=b[f];if(null==h)c=null;else if(a===h){c=!0;break}}return c}function q(a,b,c){if(null==a)return null;for(var f="",e=0,l=0;l<b.length;l++){var k=b.charAt(l);switch(e){case 0:k===c?e=1:f=0<="-[]/{}()*+?.\\^$|".indexOf(k)?f+("\\"+k):"%"===k?f+".*":"_"===k?f+".":f+k;break;case 1:f=0<="-[]/{}()*+?.\\^$|".indexOf(k)?
f+("\\"+k):f+k,e=0}}return(new RegExp("^"+f+"$")).test(a)}function C(a){return a instanceof Date?a.valueOf():a}function B(a,b,c){if(null==b||null==c)return null;b=C(b);c=C(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function F(a){for(var b=[],c={},l=0;l<a.length;l++){var h=a[l],k=h.toLowerCase();void 0===c[k]&&(b.push(h),c[k]=1)}return b}return function(){function a(){this._hasAggregateFunctions=
this._hasStandardizedFunctions=this.parameters=this.parseTree=null}a.create=function(b){var f=new a;f.parseTree=l.WhereGrammar.parse(b);var m=!0,h=!0;f.visitAll(f.parseTree,function(a){if("function"===a.type){var b=a.name;a=a.args.value.length;m&&(m=k.isStandardized(b,a));h&&(h=c.isAggregate(b,a))}});f._hasStandardizedFunctions=m;f._hasAggregateFunctions=h;return f};a.prototype.isStandardized=function(){return this._hasStandardizedFunctions};a.prototype.isAggregate=function(){return this._hasAggregateFunctions};
a.prototype.setVariablesDictionary=function(a){this.parameters=a};a.prototype.testFeature=function(a){return!!this.evaluateNode(this.parseTree,a)};a.prototype.testSet=function(a){var b=this,c=new n.default;this.visitAll(this.parseTree,function(a){"column_ref"!==a.type||c.has(a.column)||c.set(a.column,a)});for(var f={},l=function(a){c.forEach(function(c,e){c=b.featureValue(a,e,c);f[e]?f[e].push(c):f[e]=[c]})},k=0;k<a.length;k++)l(a[k]);return!!this.evaluateNode(this.parseTree,{attributes:f})};a.prototype.calculateValue=
function(a){return this.evaluateNode(this.parseTree,a)};a.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return F(a)};a.prototype.getExpressions=function(){var a=new n.default;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var f=c+"-"+b;a.has(f)||a.set(f,{aggregateType:c,field:b})}}});return t.from(a.values())};
a.prototype.getFields=function(){var a=[];this.visitAll(this.parseTree,function(b){"column_ref"===b.type&&a.push(b.column)});return F(a)};a.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return F(a)};a.prototype.featureValue=function(a,b,c){a=a&&"object"===typeof a.attributes?a.attributes:a;var f=a[b];if(void 0!==f)return f;for(var e in a)if(b.toLowerCase()===e.toLowerCase())return c.column=e,a[e];return null};
a.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,f=a.clauses;c<f.length;c++){var e=f[c];this.visitAll(e,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);
this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};a.prototype.evaluateNode=function(a,e){switch(a.type){case "case_expression":if("simple"===a.format)for(var f=C(this.evaluateNode(a.operand,e)),h=0;h<a.clauses.length;h++){if(f===C(this.evaluateNode(a.clauses[h].operand,e)))return this.evaluateNode(a.clauses[h].value,e)}else for(h=0;h<a.clauses.length;h++)if(!0===this.evaluateNode(a.clauses[h].operand,e))return this.evaluateNode(a.clauses[h].value,e);return null!==a.else?this.evaluateNode(a.else,
e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":f=[];h=0;for(a=a.value;h<a.length;h++){var l=a[h];f.push(this.evaluateNode(l,e))}return f;case "unary_expr":return u(this.evaluateNode(a.expr,e));case "binary_expr":switch(a.operator){case "AND":return f=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,e),null!=f&&null!=e?!0===f&&!0===e:!1===f||!1===e?!1:null;case "OR":return f=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,e),null!=f&&null!=e?!0===
f||!0===e:!0===f||!0===e?!0:null;case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,e);case "IN":return f=x(this.evaluateNode(a.right,e)),m(this.evaluateNode(a.left,e),f);case "NOT IN":return f=x(this.evaluateNode(a.right,e)),u(m(this.evaluateNode(a.left,e),f));case "BETWEEN":return f=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,
e),null==f||null==e[0]||null==e[1]?null:f>=e[0]&&f<=e[1];case "NOTBETWEEN":return f=this.evaluateNode(a.left,e),e=this.evaluateNode(a.right,e),null==f||null==e[0]||null==e[1]?null:f<e[0]||f>e[1];case "LIKE":return q(this.evaluateNode(a.left,e),this.evaluateNode(a.right,e),a.escape);case "NOT LIKE":return u(q(this.evaluateNode(a.left,e),this.evaluateNode(a.right,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return B(a.operator,this.evaluateNode(a.left,
e),this.evaluateNode(a.right,e));case "*":return this.evaluateNode(a.left,e)*this.evaluateNode(a.right,e);case "-":return this.evaluateNode(a.left,e)-this.evaluateNode(a.right,e);case "+":return this.evaluateNode(a.left,e)+this.evaluateNode(a.right,e);case "/":return this.evaluateNode(a.left,e)/this.evaluateNode(a.right,e)}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return b(a.value,["YYYY-M-D"]).toDate();case "timestamp":return b(a.value,
["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate();case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(l=new Date,l.setHours(0,0,0,0),l):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:this.featureValue(e,a.column,a);case "function":return e=this.evaluateNode(a.args,e),this.isAggregate()?c.aggregateFunction(a.name,e):k.evaluateFunction(a.name,e)}throw Error("Unsupported sql syntax "+a.type);};return a}()})},"esri/core/sql/AggregateFunctions":function(){define(["require",
"exports"],function(w,a){function t(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function n(a){for(var b=t(a),c=a.length,n=0,u=0;u<a.length;u++)n+=Math.pow(a[u]-b,2);return 1<c?n/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,k){var c=b[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(k.length<c.minParams||k.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(k)};a.isAggregate=
function(a,k){a=b[a.toLowerCase()];return null!=a&&k>=a.minParams&&k<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:t(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},
stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(n(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:n(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(w,a,t){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateFunction=function(a,c){var b=n[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");
if(c.length<b.minParams||c.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(c)};a.isStandardized=function(a,c){a=n[a.toLowerCase()];return null!=a&&c>=a.minParams&&c<=a.maxParams};var n={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();
case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=a[0],k=a[1];return null==b||null==k?null:b.toString().substring(k-1)}if(3===a.length)return b=a[0],k=a[1],a=a[2],null==b||null==k||null==a?null:0>=a?"":b.toString().substring(k-1,k+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+
1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,k=b?a[1]:" ",b=b?a[2]:a[1];if(null==k||null==b)return null;k="("+t.escapeString(k)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+k+"*|"+k+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+k+"*","g"),"");case "TRAILING":return b.replace(new RegExp(k+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},
ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:
0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},
char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",k=0;k<a.length;k++){if(null==a[k])return null;b+=a[k].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require",
"exports","./sql92grammar"],function(w,a,t){Object.defineProperty(a,"__esModule",{value:!0});w=function(){function a(){}a.parse=function(a){return t.parse(a)};return a}();a.WhereGrammar=w})},"esri/core/sql/sql92grammar":function(){define([],function(){function w(a,t,n,b){this.message=a;this.expected=t;this.found=n;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,w)}(function(a,t){function n(){this.constructor=a}n.prototype=t.prototype;
a.prototype=new n})(w,Error);w.buildMessage=function(a,t){function n(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,
"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}var k={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",l;for(l=0;l<a.parts.length;l++)b+=a.parts[l]instanceof Array?c(a.parts[l][0])+"-"+c(a.parts[l][1]):c(a.parts[l]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};
return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var l=c,n;n=a[c];n=k[n.type](n);b[l]=n}b.sort();if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(t?'"'+b(t)+'"':"end of input")+" found."};return{SyntaxError:w,parse:function(a,t){function n(a,d){return{type:"literal",text:a,ignoreCase:d}}function b(a,
d,b){return{type:"class",parts:a,inverted:d,ignoreCase:b}}function c(d){var b=Da[d],g;if(!b){for(g=d-1;!Da[g];)g--;b=Da[g];for(b={line:b.line,column:b.column};g<d;)10===a.charCodeAt(g)?(b.line++,b.column=1):b.column++,g++;Da[d]=b}return b}function k(a,d){var b=c(a),g=c(d);return{start:{offset:a,line:b.line,column:b.column},end:{offset:d,line:g.line,column:g.column}}}function l(a){g<U||(g>U&&(U=g,Sa=[]),Sa.push(a))}function x(){var a,b,c;a=g;b=y();b!==d?(b=m(),b!==d?(c=y(),c!==d?a=b:(g=a,a=d)):(g=
a,a=d)):(g=a,a=d);return a}function u(){var a,b,c,f,e,h,l,k;a=g;b=m();if(b!==d){c=[];f=g;e=y();e!==d?(h=ka(),h!==d?(l=y(),l!==d?(k=m(),k!==d?f=e=[e,h,l,k]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);for(;f!==d;)c.push(f),f=g,e=y(),e!==d?(h=ka(),h!==d?(l=y(),l!==d?(k=m(),k!==d?f=e=[e,h,l,k]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);if(c!==d){a={type:"expr_list"};b=[b];for(f=0;f<c.length;f++)b.push(c[f][3]);a.value=b}else g=a,a=d}else g=a,a=d;return a}function m(){var a,b,c,f,e,h,l,k;a=g;b=q();if(b!==
d){c=[];f=g;e=y();e!==d?(h=da(),h!==d?(l=y(),l!==d?(k=q(),k!==d?f=e=[e,h,l,k]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);for(;f!==d;)c.push(f),f=g,e=y(),e!==d?(h=da(),h!==d?(l=y(),l!==d?(k=q(),k!==d?f=e=[e,h,l,k]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);c!==d?a=b=oa(b,c):(g=a,a=d)}else g=a,a=d;return a}function q(){var a,b,c,f,e,h,l,k;a=g;b=C();if(b!==d){c=[];f=g;e=y();e!==d?(h=aa(),h!==d?(l=y(),l!==d?(k=C(),k!==d?f=e=[e,h,l,k]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);for(;f!==d;)c.push(f),f=
g,e=y(),e!==d?(h=aa(),h!==d?(l=y(),l!==d?(k=C(),k!==d?f=e=[e,h,l,k]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);c!==d?a=b=oa(b,c):(g=a,a=d)}else g=a,a=d;return a}function C(){var b,c,e,h,k;b=g;c=ba();c===d&&(c=g,33===a.charCodeAt(g)?(e=dd,g++):(e=d,0===v&&l(ed)),e!==d?(h=g,v++,61===a.charCodeAt(g)?(k=ab,g++):(k=d,0===v&&l(bb)),v--,k===d?h=void 0:(g=h,h=d),h!==d?c=e=[e,h]:(g=c,c=d)):(g=c,c=d));c!==d?(e=y(),e!==d?(h=C(),h!==d?b=c={type:"unary_expr",operator:"NOT",expr:h}:(g=b,b=d)):(g=b,b=d)):(g=b,b=
d);if(b===d)if(b=g,c=f(),c!==d)if(e=y(),e!==d){var m,p,E;e=[];h=g;k=y();k!==d?(m=B(),m!==d?(p=y(),p!==d?(E=f(),E!==d?h=k=[k,m,p,E]:(g=h,h=d)):(g=h,h=d)):(g=h,h=d)):(g=h,h=d);if(h!==d)for(;h!==d;)e.push(h),h=g,k=y(),k!==d?(m=B(),m!==d?(p=y(),p!==d?(E=f(),E!==d?h=k=[k,m,p,E]:(g=h,h=d)):(g=h,h=d)):(g=h,h=d)):(g=h,h=d);else e=d;e!==d&&(e={type:"arithmetic",tail:e});e===d&&(e=g,h=z(),h!==d?(k=y(),k!==d?(k=pa(),k!==d?(k=y(),k!==d?(k=u(),k!==d?(m=y(),m!==d?(m=qa(),m!==d?e=h={op:h,right:k}:(g=e,e=d)):(g=
e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d),e===d&&(e=g,h=z(),h!==d?(k=y(),k!==d?(k=pa(),k!==d?(k=y(),k!==d?(k=qa(),k!==d?e=h={op:h,right:{type:"expr_list",value:[]}}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d),e===d&&(e=g,h=z(),h!==d?(k=y(),k!==d?(k=S(),k!==d?e=h={op:h,right:k}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d))),e===d&&(e=g,k=ba(),k!==d?(h=y(),h!==d?(h=ca(),h!==d?(m=y(),m!==d?(m=f(),m!==d?(p=y(),p!==d?(p=aa(),p!==d?(k=y(),k!==d?(k=f(),k!==d?e=k={op:"NOT"+h,right:{type:"expr_list",
value:[m,k]}}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d),e===d&&(e=g,k=ca(),k!==d?(h=y(),h!==d?(h=f(),h!==d?(m=y(),m!==d?(m=aa(),m!==d?(p=y(),p!==d?(p=f(),p!==d?e=k={op:k,right:{type:"expr_list",value:[h,p]}}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)),e===d&&(e=g,h=H(),h!==d?(k=y(),k!==d?(k=ba(),k!==d?(k=y(),k!==d?(k=f(),k!==d?e=h={op:h+"NOT",right:k}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d),e===
d&&(e=g,h=H(),h!==d?(k=y(),k!==d?(k=f(),k!==d?e=h={op:h,right:k}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)),e===d&&(e=g,h=F(),h!==d?(k=y(),k!==d?(k=I(),k!==d?(m=y(),m!==d?(m=g,a.substr(g,6).toLowerCase()===fd?(p=a.substr(g,6),g+=6):(p=d,0===v&&l(gd)),p!==d?(p=g,v++,E=A(),v--,E===d?p=void 0:(g=p,p=d),p!==d?m="ESCAPE":(g=m,m=d)):(g=m,m=d),m!==d?(m=y(),m!==d?(m=T(),m!==d?e=h={op:h,right:k,escape:m.value}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d),e===d&&(e=g,h=F(),h!==d?(k=y(),
k!==d?(k=I(),k!==d?e=h={op:h,right:k,escape:""}:(g=e,e=d)):(g=e,e=d)):(g=e,e=d))))));e===d&&(e=null);e!==d?(b=c,c=e,""==c||void 0==c||null==c?c=b:(e=null,c=e="arithmetic"==c.type?oa(b,c.tail):cb(c.op,b,c.right,c.escape)),b=c):(g=b,b=d)}else g=b,b=d;else g=b,b=d;return b}function B(){var b;a.substr(g,2)===db?(b=db,g+=2):(b=d,0===v&&l(hd));b===d&&(62===a.charCodeAt(g)?(b=id,g++):(b=d,0===v&&l(jd)),b===d&&(a.substr(g,2)===eb?(b=eb,g+=2):(b=d,0===v&&l(kd)),b===d&&(a.substr(g,2)===fb?(b=fb,g+=2):(b=d,
0===v&&l(ld)),b===d&&(60===a.charCodeAt(g)?(b=md,g++):(b=d,0===v&&l(nd)),b===d&&(61===a.charCodeAt(g)?(b=ab,g++):(b=d,0===v&&l(bb)),b===d&&(a.substr(g,2)===gb?(b=gb,g+=2):(b=d,0===v&&l(od))))))));return b}function F(){var a,b,c,e;a=a=g;b=ba();b!==d?(c=y(),c!==d?(e=Z(),e!==d?a=b=[b,c,e]:(g=a,a=d)):(g=a,a=d)):(g=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=Z());return a}function z(){var a,b,c,e;a=a=g;b=ba();b!==d?(c=y(),c!==d?(e=Ba(),e!==d?a=b=[b,c,e]:(g=a,a=d)):(g=a,a=d)):(g=a,a=d);a!==d&&(a=a[0]+" "+
a[2]);a===d&&(a=Ba());return a}function f(){var a,b,c,f,h,k,l,m;a=g;b=r();if(b!==d){c=[];f=g;h=y();h!==d?(k=e(),k!==d?(l=y(),l!==d?(m=r(),m!==d?f=h=[h,k,l,m]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);for(;f!==d;)c.push(f),f=g,h=y(),h!==d?(k=e(),k!==d?(l=y(),l!==d?(m=r(),m!==d?f=h=[h,k,l,m]:(g=f,f=d)):(g=f,f=d)):(g=f,f=d)):(g=f,f=d);c!==d?a=b=oa(b,c):(g=a,a=d)}else g=a,a=d;return a}function e(){var b;43===a.charCodeAt(g)?(b=hb,g++):(b=d,0===v&&l(ib));b===d&&(45===a.charCodeAt(g)?(b=jb,g++):(b=d,0===
v&&l(kb)));return b}function r(){var a,b,c,e,f,k,l,m;a=g;b=p();if(b!==d){c=[];e=g;f=y();f!==d?(k=h(),k!==d?(l=y(),l!==d?(m=p(),m!==d?e=f=[f,k,l,m]:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d);for(;e!==d;)c.push(e),e=g,f=y(),f!==d?(k=h(),k!==d?(l=y(),l!==d?(m=p(),m!==d?e=f=[f,k,l,m]:(g=e,e=d)):(g=e,e=d)):(g=e,e=d)):(g=e,e=d);c!==d?a=b=oa(b,c):(g=a,a=d)}else g=a,a=d;return a}function h(){var b;42===a.charCodeAt(g)?(b=pd,g++):(b=d,0===v&&l(qd));b===d&&(47===a.charCodeAt(g)?(b=rd,g++):(b=d,0===v&&l(sd)));
return b}function p(){var b,c,e,f,h,k,p;p=T();if(p===d){var r,n,q,x;r=g;var z,t,C,B;z=g;t=ma();t!==d?(C=R(),C!==d?(B=va(),B!==d?z=t=parseFloat(t+C+B):(g=z,z=d)):(g=z,z=d)):(g=z,z=d);z===d&&(z=g,t=ma(),t!==d?(C=R(),C!==d?z=t=parseFloat(t+C):(g=z,z=d)):(g=z,z=d),z===d&&(z=g,t=ma(),t!==d?(C=va(),C!==d?z=t=parseFloat(t+C):(g=z,z=d)):(g=z,z=d),z===d&&(z=g,t=ma(),t!==d&&(t=parseFloat(t)),z=t)));n=z;n!==d?(q=g,v++,x=Q(),v--,x===d?q=void 0:(g=q,q=d),q!==d?r=n={type:"number",value:n}:(g=r,r=d)):(g=r,r=d);
p=r;if(p===d){var F,w;F=g;var Y,H,na,ba;Y=g;a.substr(g,4).toLowerCase()===td?(H=a.substr(g,4),g+=4):(H=d,0===v&&l(ud));H!==d?(na=g,v++,ba=A(),v--,ba===d?na=void 0:(g=na,na=d),na!==d?Y=H=[H,na]:(g=Y,Y=d)):(g=Y,Y=d);w=Y;w!==d&&(w={type:"bool",value:!0});F=w;if(F===d){F=g;var U,aa,Z,ka;U=g;a.substr(g,5).toLowerCase()===vd?(aa=a.substr(g,5),g+=5):(aa=d,0===v&&l(wd));aa!==d?(Z=g,v++,ka=A(),v--,ka===d?Z=void 0:(g=Z,Z=d),Z!==d?U=aa=[aa,Z]:(g=U,U=d)):(g=U,U=d);w=U;w!==d&&(w={type:"bool",value:!1});F=w}p=
F;if(p===d){var ja,Ea,da,ca,ta;Ea=g;a.substr(g,4).toLowerCase()===xd?(da=a.substr(g,4),g+=4):(da=d,0===v&&l(yd));da!==d?(ca=g,v++,ta=A(),v--,ta===d?ca=void 0:(g=ca,ca=d),ca!==d?Ea=da=[da,ca]:(g=Ea,Ea=d)):(g=Ea,Ea=d);ja=Ea;ja!==d&&(ja={type:"null",value:null});p=ja;if(p===d){var ra,oa,Da,Aa;ra=g;var Fa,ua,lb,Sa;Fa=g;a.substr(g,4).toLowerCase()===zd?(ua=a.substr(g,4),g+=4):(ua=d,0===v&&l(Ad));ua!==d?(lb=g,v++,Sa=A(),v--,Sa===d?lb=void 0:(g=lb,lb=d),lb!==d?Fa=ua="DATE":(g=Fa,Fa=d)):(g=Fa,Fa=d);oa=Fa;
oa!==d?(Da=y(),Da!==d?(Aa=I(),Aa!==d?ra=oa={type:"date",value:Aa.value}:(g=ra,ra=d)):(g=ra,ra=d)):(g=ra,ra=d);p=ra;if(p===d){var sa,lc,ab,mc;sa=g;var Ga,Mb,mb,bb;Ga=g;a.substr(g,9).toLowerCase()===Bd?(Mb=a.substr(g,9),g+=9):(Mb=d,0===v&&l(Cd));Mb!==d?(mb=g,v++,bb=A(),v--,bb===d?mb=void 0:(g=mb,mb=d),mb!==d?Ga=Mb="TIMESTAMP":(g=Ga,Ga=d)):(g=Ga,Ga=d);lc=Ga;lc!==d?(ab=y(),ab!==d?(mc=I(),mc!==d?sa=lc={type:"timestamp",value:mc.value}:(g=sa,sa=d)):(g=sa,sa=d)):(g=sa,sa=d);p=sa}}}}}b=p;if(b===d){var O,
nc,cb,db,eb,oc,fb,gb,hb,pc,ib,jb;O=g;var Ha,Nb,nb,kb;Ha=g;a.substr(g,7).toLowerCase()===Dd?(Nb=a.substr(g,7),g+=7):(Nb=d,0===v&&l(Ed));Nb!==d?(nb=g,v++,kb=A(),v--,kb===d?nb=void 0:(g=nb,nb=d),nb!==d?Ha=Nb="EXTRACT":(g=Ha,Ha=d)):(g=Ha,Ha=d);nc=Ha;if(nc!==d)if(cb=y(),cb!==d)if(db=pa(),db!==d)if(eb=y(),eb!==d){var ea,Ia,Ob,ob,Cb;Ia=g;a.substr(g,4).toLowerCase()===Fd?(Ob=a.substr(g,4),g+=4):(Ob=d,0===v&&l(Gd));Ob!==d?(ob=g,v++,Cb=A(),v--,Cb===d?ob=void 0:(g=ob,ob=d),ob!==d?Ia=Ob="YEAR":(g=Ia,Ia=d)):(g=
Ia,Ia=d);ea=Ia;if(ea===d){var Ja,Pb,pb,Db;Ja=g;a.substr(g,5).toLowerCase()===Hd?(Pb=a.substr(g,5),g+=5):(Pb=d,0===v&&l(Id));Pb!==d?(pb=g,v++,Db=A(),v--,Db===d?pb=void 0:(g=pb,pb=d),pb!==d?Ja=Pb="MONTH":(g=Ja,Ja=d)):(g=Ja,Ja=d);ea=Ja;if(ea===d){var Ka,Qb,qb,Eb;Ka=g;a.substr(g,3).toLowerCase()===Jd?(Qb=a.substr(g,3),g+=3):(Qb=d,0===v&&l(Kd));Qb!==d?(qb=g,v++,Eb=A(),v--,Eb===d?qb=void 0:(g=qb,qb=d),qb!==d?Ka=Qb="DAY":(g=Ka,Ka=d)):(g=Ka,Ka=d);ea=Ka;if(ea===d){var La,Rb,rb,Fb;La=g;a.substr(g,4).toLowerCase()===
Ld?(Rb=a.substr(g,4),g+=4):(Rb=d,0===v&&l(Md));Rb!==d?(rb=g,v++,Fb=A(),v--,Fb===d?rb=void 0:(g=rb,rb=d),rb!==d?La=Rb="HOUR":(g=La,La=d)):(g=La,La=d);ea=La;if(ea===d){var Ma,Sb,sb,Gb;Ma=g;a.substr(g,6).toLowerCase()===Nd?(Sb=a.substr(g,6),g+=6):(Sb=d,0===v&&l(Od));Sb!==d?(sb=g,v++,Gb=A(),v--,Gb===d?sb=void 0:(g=sb,sb=d),sb!==d?Ma=Sb="MINUTE":(g=Ma,Ma=d)):(g=Ma,Ma=d);ea=Ma;if(ea===d){var Na,Tb,tb,Hb;Na=g;a.substr(g,6).toLowerCase()===Pd?(Tb=a.substr(g,6),g+=6):(Tb=d,0===v&&l(Qd));Tb!==d?(tb=g,v++,Hb=
A(),v--,Hb===d?tb=void 0:(g=tb,tb=d),tb!==d?Na=Tb="SECOND":(g=Na,Na=d)):(g=Na,Na=d);ea=Na}}}}}oc=ea;oc!==d?(fb=y(),fb!==d?(gb=Ca(),gb!==d?(hb=y(),hb!==d?(pc=m(),pc!==d?(ib=y(),ib!==d?(jb=qa(),jb!==d?O=nc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:oc},pc]}}:(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)):(g=O,O=d)}else g=O,O=d;else g=O,O=d;else g=O,O=d;else g=O,O=d;b=O;if(b===d){var N,qc,Ib,Jb,Kb,Ub,zc,Ac,Bc,Vb,Cc,X,Ta,rc,sc,tc;N=g;var Oa,Wb,
ub,Dc;Oa=g;a.substr(g,9).toLowerCase()===Rd?(Wb=a.substr(g,9),g+=9):(Wb=d,0===v&&l(Sd));Wb!==d?(ub=g,v++,Dc=A(),v--,Dc===d?ub=void 0:(g=ub,ub=d),ub!==d?Oa=Wb="SUBSTRING":(g=Oa,Oa=d)):(g=Oa,Oa=d);qc=Oa;if(qc!==d)if(Ib=y(),Ib!==d)if(Jb=pa(),Jb!==d)if(Kb=y(),Kb!==d)if(Ub=m(),Ub!==d)if(zc=y(),zc!==d)if(Ac=Ca(),Ac!==d)if(Bc=y(),Bc!==d)if(Vb=m(),Vb!==d)if(Cc=y(),Cc!==d){X=g;var Pa,Xb,vb,Ec;Pa=g;a.substr(g,3).toLowerCase()===Td?(Xb=a.substr(g,3),g+=3):(Xb=d,0===v&&l(Ud));Xb!==d?(vb=g,v++,Ec=A(),v--,Ec===
d?vb=void 0:(g=vb,vb=d),vb!==d?Pa=Xb="FOR":(g=Pa,Pa=d)):(g=Pa,Pa=d);Ta=Pa;Ta!==d?(rc=y(),rc!==d?(sc=m(),sc!==d?(tc=y(),tc!==d?X=Ta=[Ta,rc,sc,tc]:(g=X,X=d)):(g=X,X=d)):(g=X,X=d)):(g=X,X=d);X===d&&(X=null);X!==d?(Ta=qa(),Ta!==d?N=qc={type:"function",name:"substring",args:{type:"expr_list",value:X?[Ub,Vb,X[2]]:[Ub,Vb]}}:(g=N,N=d)):(g=N,N=d)}else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;else g=N,N=d;b=N;if(b===d){var G,Ua,Yb,Zb,$b,
fa,ac,Va,bc,cc,Fc,uc,Gc,Hc;G=g;Ua=$a();Ua!==d?(Yb=y(),Yb!==d?(Zb=pa(),Zb!==d?($b=y(),$b!==d?(fa=E(),fa===d&&(fa=null),fa!==d?(ac=y(),ac!==d?(Va=m(),Va!==d?(bc=y(),bc!==d?(cc=Ca(),cc!==d?(Fc=y(),Fc!==d?(uc=m(),uc!==d?(Gc=y(),Gc!==d?(Hc=qa(),Hc!==d?G=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==fa?"BOTH":fa},Va,uc]}}:(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d);
G===d&&(G=g,Ua=$a(),Ua!==d?(Yb=y(),Yb!==d?(Zb=pa(),Zb!==d?($b=y(),$b!==d?(fa=E(),fa===d&&(fa=null),fa!==d?(ac=y(),ac!==d?(Va=m(),Va!==d?(bc=y(),bc!==d?(cc=qa(),cc!==d?G=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==fa?"BOTH":fa},Va]}}:(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d)):(g=G,G=d));b=G;if(b===d){var P,vc,Ic,Jc,Kc,wc,Lc,Mc,Nc,xc,Oc,Pc;P=g;var Qa,dc,wb,Qc;Qa=g;a.substr(g,8).toLowerCase()===Vd?(dc=a.substr(g,
8),g+=8):(dc=d,0===v&&l(Wd));dc!==d?(wb=g,v++,Qc=A(),v--,Qc===d?wb=void 0:(g=wb,wb=d),wb!==d?Qa=dc="POSITION":(g=Qa,Qa=d)):(g=Qa,Qa=d);vc=Qa;vc!==d?(Ic=y(),Ic!==d?(Jc=pa(),Jc!==d?(Kc=y(),Kc!==d?(wc=m(),wc!==d?(Lc=y(),Lc!==d?(Mc=Ba(),Mc!==d?(Nc=y(),Nc!==d?(xc=m(),xc!==d?(Oc=y(),Oc!==d?(Pc=qa(),Pc!==d?P=vc={type:"function",name:"position",args:{type:"expr_list",value:[wc,xc]}}:(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d)):(g=P,P=d);b=P;
if(b===d){var W,ec,Rc,Sc,Tc,Wa,Uc,Vc;W=g;var ga,xb,yb,la;ga=g;ga=xb=J();if(ga===d)if(ga=g,96===a.charCodeAt(g)?(xb=Wc,g++):(xb=d,0===v&&l(Xc)),xb!==d){yb=[];Yc.test(a.charAt(g))?(la=a.charAt(g),g++):(la=d,0===v&&l(Zc));if(la!==d)for(;la!==d;)yb.push(la),Yc.test(a.charAt(g))?(la=a.charAt(g),g++):(la=d,0===v&&l(Zc));else yb=d;yb!==d?(96===a.charCodeAt(g)?(la=Wc,g++):(la=d,0===v&&l(Xc)),la!==d?ga=xb=yb.join(""):(g=ga,ga=d)):(g=ga,ga=d)}else g=ga,ga=d;ec=ga;ec!==d?(Rc=y(),Rc!==d?(Sc=pa(),Sc!==d?(Tc=y(),
Tc!==d?(Wa=u(),Wa===d&&(Wa=null),Wa!==d?(Uc=y(),Uc!==d?(Vc=qa(),Vc!==d?W=ec={type:"function",name:ec,args:Wa?Wa:{type:"expr_list",value:[]}}:(g=W,W=d)):(g=W,W=d)):(g=W,W=d)):(g=W,W=d)):(g=W,W=d)):(g=W,W=d)):(g=W,W=d);b=W;if(b===d){var fc,K,Xa,gc,Ya,hc,ya,ha,zb,$c,ad;K=g;Xa=wa();if(Xa!==d)if(gc=y(),gc!==d)if(Ya=m(),Ya!==d)if(hc=y(),hc!==d){ya=[];for(ha=M();ha!==d;)ya.push(ha),ha=M();ya!==d?(ha=y(),ha!==d?(zb=xa(),zb!==d?K=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:ya,else:null}:
(g=K,K=d)):(g=K,K=d)):(g=K,K=d)}else g=K,K=d;else g=K,K=d;else g=K,K=d;else g=K,K=d;if(K===d)if(K=g,Xa=wa(),Xa!==d)if(gc=y(),gc!==d)if(Ya=m(),Ya!==d)if(hc=y(),hc!==d){ya=[];for(ha=M();ha!==d;)ya.push(ha),ha=M();ya!==d?(ha=y(),ha!==d?(zb=Lb(),zb!==d?($c=y(),$c!==d?(ad=xa(),ad!==d?K=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:ya,else:zb.value}:(g=K,K=d)):(g=K,K=d)):(g=K,K=d)):(g=K,K=d)):(g=K,K=d)}else g=K,K=d;else g=K,K=d;else g=K,K=d;else g=K,K=d;fc=K;if(fc===d){var L,Za,ic,za,ia,
Ab,bd,cd;L=g;Za=wa();if(Za!==d)if(ic=y(),ic!==d){za=[];for(ia=V();ia!==d;)za.push(ia),ia=V();za!==d?(ia=y(),ia!==d?(Ab=xa(),Ab!==d?L=Za={type:"case_expression",format:"searched",clauses:za,else:null}:(g=L,L=d)):(g=L,L=d)):(g=L,L=d)}else g=L,L=d;else g=L,L=d;if(L===d)if(L=g,Za=wa(),Za!==d)if(ic=y(),ic!==d){za=[];for(ia=V();ia!==d;)za.push(ia),ia=V();za!==d?(ia=y(),ia!==d?(Ab=Lb(),Ab!==d?(bd=y(),bd!==d?(cd=xa(),cd!==d?L=Za={type:"case_expression",format:"searched",clauses:za,else:Ab.value}:(g=L,L=d)):
(g=L,L=d)):(g=L,L=d)):(g=L,L=d)):(g=L,L=d)}else g=L,L=d;else g=L,L=d;fc=L}b=fc;if(b===d){var Bb,Ra,yc,jc,kc;Ra=g;yc=Q();if(yc!==d){jc=[];for(kc=D();kc!==d;)jc.push(kc),kc=D();jc!==d?Ra=yc+=jc.join(""):(g=Ra,Ra=d)}else g=Ra,Ra=d;Bb=Ra;Bb!==d&&(Bb={type:"column_ref",table:"",column:Bb});b=Bb;b===d&&(b=S(),b===d&&(b=g,c=pa(),c!==d?(e=y(),e!==d?(f=m(),f!==d?(h=y(),h!==d?(k=qa(),k!==d?(f.paren=!0,b=c=f):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)):(g=b,b=d)))}}}}}}}return b}function J(){var a,b,c,e;a=g;
b=Q();if(b!==d){c=[];for(e=A();e!==d;)c.push(e),e=A();c!==d?a=b+=c.join(""):(g=a,a=d)}else g=a,a=d;return a}function Q(){var b;Xd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===v&&l(Yd));return b}function A(){var b;Zd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===v&&l($d));return b}function D(){var b;ae.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===v&&l(be));return b}function S(){var b,c,e;b=g;64===a.charCodeAt(g)?(c=ce,g++):(c=d,0===v&&l(de));c!==d?(e=J(),e!==d?b=c=[c,e]:(g=b,b=d)):(g=b,b=d);b!==
d&&(b={type:"param",value:b[1]});return b}function E(){var b,c,e;b=g;a.substr(g,7).toLowerCase()===ee?(c=a.substr(g,7),g+=7):(c=d,0===v&&l(fe));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="LEADING":(g=b,b=d)):(g=b,b=d);b===d&&(b=g,a.substr(g,8).toLowerCase()===ge?(c=a.substr(g,8),g+=8):(c=d,0===v&&l(he)),c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="TRAILING":(g=b,b=d)):(g=b,b=d),b===d&&(b=g,a.substr(g,4).toLowerCase()===ie?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(je)),c!==
d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="BOTH":(g=b,b=d)):(g=b,b=d)));return b}function I(){var a;a=T();a===d&&(a=S());return a}function T(){var b,c,e;b=g;39===a.charCodeAt(g)?(c=Cb,g++):(c=d,0===v&&l(Db));c===d&&(a.substr(g,2)===Eb?(c=Eb,g+=2):(c=d,0===v&&l(ke)));if(c!==d){c=[];e=g;a.substr(g,2)===Aa?(e=Aa,g+=2):(e=d,0===v&&l(Fb));e!==d&&(e="'");e===d&&(Gb.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===v&&l(Hb)));for(;e!==d;)c.push(e),e=g,a.substr(g,2)===Aa?(e=Aa,g+=2):(e=d,0===v&&
l(Fb)),e!==d&&(e="'"),e===d&&(Gb.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===v&&l(Hb)));c!==d?(39===a.charCodeAt(g)?(e=Cb,g++):(e=d,0===v&&l(Db)),e!==d?b=c={type:"string",value:c.join("")}:(g=b,b=d)):(g=b,b=d)}else g=b,b=d;return b}function V(){var a,b,c;a=g;b=ja();b!==d?(b=y(),b!==d?(b=m(),b!==d?(c=y(),c!==d?(c=ta(),c!==d?(c=y(),c!==d?(c=m(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d);return a}function M(){var a,
b,c;a=g;b=ja();b!==d?(b=y(),b!==d?(b=m(),b!==d?(c=y(),c!==d?(c=ta(),c!==d?(c=y(),c!==d?(c=m(),c!==d?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d)):(g=a,a=d);return a}function Lb(){var b,c;b=g;var e,f;c=g;a.substr(g,4).toLowerCase()===le?(e=a.substr(g,4),g+=4):(e=d,0===v&&l(me));e!==d?(e=g,v++,f=A(),v--,f===d?e=void 0:(g=e,e=d),e!==d?c="ELSE":(g=c,c=d)):(g=c,c=d);c!==d?(c=y(),c!==d?(c=m(),c!==d?b={type:"else_clause",value:c}:(g=b,b=d)):
(g=b,b=d)):(g=b,b=d);return b}function ma(){var b,c,e;b=Y();b===d&&(b=g,45===a.charCodeAt(g)?(c=jb,g++):(c=d,0===v&&l(kb)),c===d&&(43===a.charCodeAt(g)?(c=hb,g++):(c=d,0===v&&l(ib))),c!==d?(e=Y(),e!==d?b=c=c[0]+e:(g=b,b=d)):(g=b,b=d));return b}function R(){var b,c;b=g;46===a.charCodeAt(g)?(c=ne,g++):(c=d,0===v&&l(oe));c!==d?(c=Y(),c===d&&(c=null),c!==d?b="."+(null!=c?c:""):(g=b,b=d)):(g=b,b=d);return b}function va(){var b,c,e;c=b=g;pe.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===v&&l(qe));e!==d?
(re.test(a.charAt(g))?(e=a.charAt(g),g++):(e=d,0===v&&l(se)),e===d&&(e=null),e!==d?c="e"+(null===e?"":e):(g=c,c=d)):(g=c,c=d);c!==d?(e=Y(),e!==d?b=c+e:(g=b,b=d)):(g=b,b=d);return b}function Y(){var a,b;a=[];b=na();if(b!==d)for(;b!==d;)a.push(b),b=na();else a=d;a!==d&&(a=a.join(""));return a}function na(){var b;te.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===v&&l(ue));return b}function Ba(){var b,c,e;b=g;a.substr(g,2).toLowerCase()===ve?(c=a.substr(g,2),g+=2):(c=d,0===v&&l(we));c!==d?(c=g,v++,e=
A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="IN":(g=b,b=d)):(g=b,b=d);return b}function H(){var b,c,e;b=g;a.substr(g,2).toLowerCase()===xe?(c=a.substr(g,2),g+=2):(c=d,0===v&&l(ye));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="IS":(g=b,b=d)):(g=b,b=d);return b}function Z(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===ze?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(Ae));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="LIKE":(g=b,b=d)):(g=b,b=d);return b}function ba(){var b,c,e;b=g;a.substr(g,
3).toLowerCase()===Be?(c=a.substr(g,3),g+=3):(c=d,0===v&&l(Ce));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="NOT":(g=b,b=d)):(g=b,b=d);return b}function aa(){var b,c,e;b=g;a.substr(g,3).toLowerCase()===De?(c=a.substr(g,3),g+=3):(c=d,0===v&&l(Ee));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="AND":(g=b,b=d)):(g=b,b=d);return b}function da(){var b,c,e;b=g;a.substr(g,2).toLowerCase()===Fe?(c=a.substr(g,2),g+=2):(c=d,0===v&&l(Ge));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=
c,c=d),c!==d?b="OR":(g=b,b=d)):(g=b,b=d);return b}function ca(){var b,c,e;b=g;a.substr(g,7).toLowerCase()===He?(c=a.substr(g,7),g+=7):(c=d,0===v&&l(Ie));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="BETWEEN":(g=b,b=d)):(g=b,b=d);return b}function Ca(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Je?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(Ke));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="FROM":(g=b,b=d)):(g=b,b=d);return b}function $a(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===
Le?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(Me));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="TRIM":(g=b,b=d)):(g=b,b=d);return b}function wa(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Ne?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(Oe));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="CASE":(g=b,b=d)):(g=b,b=d);return b}function xa(){var b,c,e;b=g;a.substr(g,3).toLowerCase()===Pe?(c=a.substr(g,3),g+=3):(c=d,0===v&&l(Qe));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="END":
(g=b,b=d)):(g=b,b=d);return b}function ja(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Re?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(Se));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="WHEN":(g=b,b=d)):(g=b,b=d);return b}function ta(){var b,c,e;b=g;a.substr(g,4).toLowerCase()===Te?(c=a.substr(g,4),g+=4):(c=d,0===v&&l(Ue));c!==d?(c=g,v++,e=A(),v--,e===d?c=void 0:(g=c,c=d),c!==d?b="THEN":(g=b,b=d)):(g=b,b=d);return b}function ka(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=d,0===v&&l(We));return b}
function pa(){var b;40===a.charCodeAt(g)?(b=Xe,g++):(b=d,0===v&&l(Ye));return b}function qa(){var b;41===a.charCodeAt(g)?(b=Ze,g++):(b=d,0===v&&l($e));return b}function y(){var a,b;a=[];for(b=Ib();b!==d;)a.push(b),b=Ib();return a}function Ib(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=d,0===v&&l(bf));return b}function cb(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function oa(a,b){for(var c=0;c<b.length;c++)a=cb(b[c][1],a,b[c][3]);return a}t=
void 0!==t?t:{};var d={},Jb={start:x},Kb=x,dd="!",ed=n("!",!1),ab="\x3d",bb=n("\x3d",!1),db="\x3e\x3d",hd=n("\x3e\x3d",!1),id="\x3e",jd=n("\x3e",!1),eb="\x3c\x3d",kd=n("\x3c\x3d",!1),fb="\x3c\x3e",ld=n("\x3c\x3e",!1),md="\x3c",nd=n("\x3c",!1),gb="!\x3d",od=n("!\x3d",!1),hb="+",ib=n("+",!1),jb="-",kb=n("-",!1),pd="*",qd=n("*",!1),rd="/",sd=n("/",!1),Xd=/^[A-Za-z_\x80-\uFFFF]/,Yd=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Zd=/^[A-Za-z0-9_]/,$d=b([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),
ae=/^[A-Za-z0-9_.\x80-\uFFFF]/,be=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),ce="@",de=n("@",!1),Cb="'",Db=n("'",!1),Eb="N'",ke=n("N'",!1),Aa="''",Fb=n("''",!1),Gb=/^[^']/,Hb=b(["'"],!0,!1),ne=".",oe=n(".",!1),te=/^[0-9]/,ue=b([["0","9"]],!1,!1),pe=/^[eE]/,qe=b(["e","E"],!1,!1),re=/^[+\-]/,se=b(["+","-"],!1,!1),xd="null",yd=n("NULL",!0),td="true",ud=n("TRUE",!0),vd="false",wd=n("FALSE",!0),ve="in",we=n("IN",!0),xe="is",ye=n("IS",!0),ze="like",Ae=n("LIKE",!0),fd="escape",
gd=n("ESCAPE",!0),Be="not",Ce=n("NOT",!0),De="and",Ee=n("AND",!0),Fe="or",Ge=n("OR",!0),He="between",Ie=n("BETWEEN",!0),Je="from",Ke=n("FROM",!0),Td="for",Ud=n("FOR",!0),Rd="substring",Sd=n("SUBSTRING",!0),Dd="extract",Ed=n("EXTRACT",!0),Le="trim",Me=n("TRIM",!0),Vd="position",Wd=n("POSITION",!0),Bd="timestamp",Cd=n("TIMESTAMP",!0),zd="date",Ad=n("DATE",!0),ee="leading",fe=n("LEADING",!0),ge="trailing",he=n("TRAILING",!0),ie="both",je=n("BOTH",!0),Fd="year",Gd=n("YEAR",!0),Hd="month",Id=n("MONTH",
!0),Jd="day",Kd=n("DAY",!0),Ld="hour",Md=n("HOUR",!0),Nd="minute",Od=n("MINUTE",!0),Pd="second",Qd=n("SECOND",!0),Ne="case",Oe=n("CASE",!0),Pe="end",Qe=n("END",!0),Re="when",Se=n("WHEN",!0),Te="then",Ue=n("THEN",!0),le="else",me=n("ELSE",!0),Ve=",",We=n(",",!1),Xe="(",Ye=n("(",!1),Ze=")",$e=n(")",!1),af=/^[ \t\n\r]/,bf=b([" ","\t","\n","\r"],!1,!1),Wc="`",Xc=n("`",!1),Yc=/^[^`]/,Zc=b(["`"],!0,!1),g=0,Da=[{line:1,column:1}],U=0,Sa=[],v=0,ua;if("startRule"in t){if(!(t.startRule in Jb))throw Error("Can't start parsing from rule \""+
t.startRule+'".');Kb=Jb[t.startRule]}ua=Kb();if(ua!==d&&g===a.length)return ua;ua!==d&&g<a.length&&l({type:"end"});throw function(a,b,c){return new w(w.buildMessage(a,b),a,b,c)}(Sa,U<a.length?a.charAt(U):null,U<a.length?k(U,U+1):k(U,U));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(w,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsDistance:!0,supportsDistinct:!0,
supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/Set ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(w,a,t,n,b,c,k,l,x,u,m,q,C,B){Object.defineProperty(a,"__esModule",{value:!0});w=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsMap=c.fieldsMap;this.timeInfo=c.timeInfo}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0});
a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(l.isValid(a.outSR)&&!l.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=B.cleanFromGeometryEngine(t({spatialReference:a.outSR},q.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):
b.queryGeometry=B.cleanFromGeometryEngine(t({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var f=m.getWhereClause(b.where);if(!f)return c.resolve(this);if(f.isStandardized()){for(var e=0,k=[],h=0,l=this.items;h<l.length;h++){var n=l[h];f.testFeature(n.attributes)&&(k[e++]=n)}f=new a(k,this.queryGeometry,this);f.definitionExpression=b.where;return c.resolve(f)}return c.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=
function(b){if(!b.objectIds||!b.objectIds.length)return c.resolve(this);var f=new n.default(b.objectIds);return c.resolve(new a(this.items.filter(function(a){return f.has(a.objectId)}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(k){k=C.getTimeOperator(this.timeInfo,k.timeExtent);if(!b.isSome(k))return c.resolve(this);k=this.items.filter(k);return c.resolve(new a(k,this.queryGeometry,this))};a.prototype.project=function(b){var f=this;return!b||l.equals(this.spatialReference,b)?
c.resolve(this):q.projectMany(this.items.map(function(a){return B.getGeometry(f,a)}),this.spatialReference,b).then(function(c){for(var e=[],h=0;h<f.items.length;h++)e[h]={attributes:f.items[h].attributes,geometry:c[h]};c=[];x.convertFromFeatures(c,e,f.geometryType,f.hasZ,f.hasM,f.objectIdField);return new a(c,f.queryGeometry,{definitionExpression:f.definitionExpression,geometryType:f.geometryType,hasM:f.hasM,hasZ:f.hasZ,objectIdField:f.objectIdField,spatialReference:b,fieldsMap:f.fieldsMap,timeInfo:f.timeInfo})})};
a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,l=this.geometryType,h=this.hasM,m=this.hasZ,n=this.objectIdField,q=this.spatialReference,A=a.outFields,D=a.outSR,u=a.quantizationParameters,E=a.resultRecordCount,I=a.resultOffset,T=!1;null!=E&&null!=I&&(E=I+E,T=c.length>E,c=c.slice(I,Math.min(c.length,E)));return{exceededTransferLimit:T,features:this._createFeatures(a,c),fields:A&&A.map(function(a){return b.fieldsMap.get(a)}),geometryType:l,hasM:h,hasZ:m,objectIdFieldName:n,
spatialReference:B.cleanFromGeometryEngine(D?D:q),transform:u&&k.toQuantizationTransform(u)||null}};a.prototype._createFeatures=function(a,b){var c=new u.default(a,this.fieldsMap),f=a.quantizationParameters,h=a.returnGeometry,l=a.returnCentroid,m=a.maxAllowableOffset,n=a.orderByFields;a=[];var q=0;if(b.length&&n&&n.length){var n=n[0].split(" "),D=n[0],x="DESC"===n[1];b.sort(function(a,b){a=c.getFieldValue(a,D);b=c.getFieldValue(b,D);if("number"===typeof a&&"number"===typeof b)return x?b-a:a-b;if("string"===
typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(x?a>b:a<b)?-1:(x?a<b:a>b)?1:0})}if(h||l)if(f=k.toQuantizationTransform(f),h&&!l)for(l=0;l<b.length;l++)h=b[l],a[q++]={attributes:c.getAttributes(h),geometry:B.getGeometry(this,h,m,f)};else if(!h&&l)for(m=0;m<b.length;m++)h=b[m],a[q++]={attributes:c.getAttributes(h),centroid:B.getCentroid(this,h,f)};else for(l=0;l<b.length;l++)h=b[l],a[q++]={attributes:c.getAttributes(h),centroid:B.getCentroid(this,h,f),geometry:B.getGeometry(this,
h,m,f)};else for(m=0;m<b.length;m++)h=b[m],(h=c.getAttributes(h))&&(a[q++]={attributes:h});return a};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,k=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,h=0;for(a=a.outStatistics;h<a.length;h++){var l=a[h];if("exceedslimit"===l.statisticType){c=null!=l.maxPointCount?l.maxPointCount:Number.POSITIVE_INFINITY;k=null!=l.maxRecordCount?l.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=l.maxVertexCount?l.maxVertexCount:
Number.POSITIVE_INFINITY;break}}"esriGeometryPoint"===this.geometryType?b=this.items.length>c:this.items.length>k?b=!0:(c=this.hasZ?this.hasM?4:3:this.hasM?3:2,b=this.items.reduce(function(a,b){return a+(b.geometry&&b.geometry.coords.length||0)},0)/c>b);return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=
new u.default(a,this.fieldsMap),c=[],k=[],h=a.groupByFieldsForStatistics,l=a.having,m=h&&h.length,h=m&&h[0],n={},q={},D={},x={attributes:{}},E=0;for(a=a.outStatistics;E<a.length;E++){var I=a[E],T=I.outStatisticFieldName,V=I.statisticType,M="exceedslimit"!==I.statisticType?I.onStatisticField:void 0,t="1"===M;if(m&&(M===h||t)&&"count"===I.statisticType){n[M]||(n[M]=this._calculateUniqueValues(b,t?h:M));var V=n[M],C;for(C in V){var z=V[C],B=z.count,I=z.data,w=z.items,z=q[I]||{attributes:{}};if(!l||b.validateItems(w,
l))z.attributes[T]=B,z.attributes[t?"EXPR_1":M]=I,q[I]=z}k.push({name:T,alias:T,type:"esriFieldTypeString"})}else{if(m)for(C in t=this._calculateUniqueValues(b,h),t){if(z=t[C],I=z.data,w=z.items,!l||b.validateItems(w,l))z=q[I]||{attributes:{}},w=this._calculateStatistics(w,b,M),B="var"===V?"variance":V,z.attributes[T]=w[B],z.attributes[h]=I,q[I]=z}else D[M]||(D[M]=this._calculateStatistics(this.items,b,M)),w=D[M],B="var"===V?"variance":V,x.attributes[T]=w[B];k.push({name:T,alias:T,type:"esriFieldTypeDouble"})}}if(m)for(var F in q)c.push(q[F]);
else c.push(x);return{fields:k,features:c}};a.prototype._calculateStatistics=function(a,b,c){for(var e=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,k=null,l=null,m=null,n=null,D=[],q=0;q<a.length;q++){var E=b.getFieldValue(a[q],c);null==E||isNaN(E)||(k+=E,e=Math.min(e,E),f=Math.max(f,E),D.push(E))}if(a=D.length){l=k/a;for(n=m=0;n<D.length;n++)E=D[n],m+=Math.pow(E-l,2);n=1<a?m/(a-1):0;m=Math.sqrt(n)}else f=e=null;return{avg:l,count:a,max:f,min:e,stddev:m,sum:k,variance:n}};a.prototype._calculateUniqueValues=
function(a,b){for(var c={},f=0,h=this.items;f<h.length;f++){var k=h[f],l=a.getFieldValue(k,b);if(null==l||"string"===typeof l&&""===l.trim())l=null;null==c[l]?c[l]={count:1,data:l,items:[k]}:(c[l].count++,c[l].items.push(k))}return c};return a}();a.default=w})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(w,a,t){function n(a,b){return Math.round((b-a.translate[0])/a.scale[0])}function b(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}
function c(a,c,e){for(var f=[],h,k,l,m,p=0;p<e.length;p++){var E=e[p];if(0<p){if(l=n(a,E[0]),m=b(a,E[1]),l!==h||m!==k)f.push(c(E,l-h,m-k)),h=l,k=m}else h=n(a,E[0]),k=b(a,E[1]),f.push(c(E,h,k))}return 0<f.length?f:null}function k(a,b,e,f){return c(a,e?f?S:D:f?D:A,b)}function l(a,b,e,f){var h=[];e=e?f?S:D:f?D:A;for(f=0;f<b.length;f++){var k=c(a,e,b[f]);k&&3<=k.length&&h.push(k)}return h.length?h:null}function x(a,b,e,f){var h=[];e=e?f?S:D:f?D:A;for(f=0;f<b.length;f++){var k=c(a,e,b[f]);k&&2<=k.length&&
h.push(k)}return h.length?h:null}function u(a,b){return b*a.scale[0]+a.translate[0]}function m(a,b){return a.translate[1]-b*a.scale[1]}function q(a,b,c){var e=Array(c.length);if(!c.length)return e;var f=a.scale,h=f[0],f=f[1],k=u(a,c[0][0]);a=m(a,c[0][1]);e[0]=b(c[0],k,a);for(var l=1;l<c.length;l++){var p=c[l],k=k+p[0]*h;a-=p[1]*f;e[l]=b(p,k,a)}return e}function C(a,b,c){for(var e=Array(c.length),f=0;f<c.length;f++)e[f]=q(a,b,c[f]);return e}function B(a,b,c,e){return q(a,c?e?S:D:e?D:A,b)}function F(a,
b,c,e){return C(a,c?e?S:D:e?D:A,b)}function z(a,b,c,e){return C(a,c?e?S:D:e?D:A,b)}function f(a,b,c){var e=c[0],f=e[0],e=e[1],h=Math.min(f,b[0]),k=Math.min(e,b[1]),l=Math.max(f,b[2]);b=Math.max(e,b[3]);for(var m=1;m<c.length;m++){var p=c[m],n=p[0],p=p[1],f=f+n,e=e+p;0>n&&(h=Math.min(h,f));0<n&&(l=Math.max(l,f));0>p?k=Math.min(k,e):0<p&&(b=Math.max(b,e))}a[0]=h;a[1]=k;a[2]=l;a[3]=b;return a}function e(a,b){if(!b.length)return null;a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;
for(var c=0;c<b.length;c++)f(a,a,b[c]);return a}function r(a,c,e,f,h){c.xmin=n(a,e.xmin);c.ymin=b(a,e.ymin);c.xmax=n(a,e.xmax);c.ymax=b(a,e.ymax);c!==e&&(f&&(c.zmin=e.zmin,c.zmax=e.zmax),h&&(c.mmin=e.mmin,c.mmax=e.mmax));return c}function h(a,b,c,e,f){b.points=k(a,c.points,e,f);return b}function p(a,c,e,f,h){c.x=n(a,e.x);c.y=b(a,e.y);c!==e&&(f&&(c.z=e.z),h&&(c.m=e.m));return c}function J(a,b,c,e,f){a=l(a,c.rings,e,f);if(!a)return null;b.rings=a;return b}function Q(a,b,c,e,f){a=x(a,c.paths,e,f);if(!a)return null;
b.paths=a;return b}Object.defineProperty(a,"__esModule",{value:!0});var A=function(a,b,c){return[b,c]},D=function(a,b,c){return[b,c,a[2]]},S=function(a,b,c){return[b,c,a[2],a[3]]};a.toQuantizationTransform=function(a){return a?{originPosition:"upperLeft",scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var c,e,f,h;a&&"upperLeft"===a.originPosition?(c=a.translate[0],e=a.translate[1],
a=a.scale[0]):(c=a.extent.xmin,e=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(f=b.translate[0],h=b.translate[1],b=b.scale[0]):(f=b.extent.xmin,h=b.extent.ymax,b=b.tolerance);return c===f&&e===h&&a===b};a.quantizeX=n;a.quantizeY=b;a.quantizeBounds=function(a,c,e){c[0]=n(a,e[0]);c[3]=b(a,e[1]);c[2]=n(a,e[2]);c[1]=b(a,e[3]);return c};a.quantizePoints=k;a.quantizeRings=l;a.quantizePaths=x;a.hydrateX=u;a.hydrateY=m;a.hydrateCoordsArray=q;a.hydrateCoordsArrayArray=C;a.hydrateBounds=function(a,
b,c){return c?(b[0]=u(a,c[0]),b[1]=m(a,c[3]),b[2]=u(a,c[2]),b[3]=m(a,c[1]),b):[u(a,b[0]),m(a,b[3]),u(a,b[2]),m(a,b[1])]};a.hydratePoints=B;a.hydratePaths=F;a.hydrateRings=z;a.getQuantizedBoundsCoordsArray=f;a.getQuantizedBoundsCoordsArrayArray=e;a.getQuantizedBoundsPoints=function(a){var b=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return f(b,b,a)};a.getQuantizedBoundsPaths=function(a){return e([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return e([0,
0,0,0],a)};a.quantizeExtent=r;a.quantizeMultipoint=h;a.quantizePoint=p;a.quantizePolygon=J;a.quantizePolyline=Q;a.quantizeGeometry=function(a,b){return a&&b?t.isPoint(b)?p(a,{},b,!1,!1):t.isPolyline(b)?Q(a,{},b,!1,!1):t.isPolygon(b)?J(a,{},b,!1,!1):t.isMultipoint(b)?h(a,{},b,!1,!1):t.isExtent(b)?r(a,{},b,!1,!1):null:null};a.hydrateExtent=function(a,b,c,e,f){b.xmin=u(a,c.xmin);b.ymin=m(a,c.ymin);b.xmax=u(a,c.xmax);b.ymax=m(a,c.ymax);b!==c&&(e&&(b.zmin=c.zmin,b.zmax=c.zmax),f&&(b.mmin=c.mmin,b.mmax=
c.mmax));return b};a.hydrateMultipoint=function(a,b,c,e,f){b.points=B(a,c.points,e,f);return b};a.hydratePoint=function(a,b,c,e,f){b.x=u(a,c.x);b.y=m(a,c.y);b!==c&&(e&&(b.z=c.z),f&&(b.m=c.m));return b};a.hydratePolygon=function(a,b,c,e,f){b.rings=z(a,c.rings,e,f);return b};a.hydratePolyline=function(a,b,c,e,f){b.paths=F(a,c.paths,e,f);return b}})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","@dojo/framework/shim/Map","./attributeSupport"],function(w,a,t,n){Object.defineProperty(a,
"__esModule",{value:!0});w=function(){function a(a,b){this._fieldDataCache=new t.default;this._returnDistinctMap=new t.default;this.returnDistinctValues=a.returnDistinctValues;this.fieldsMap=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var k=a[c],u=n.getExpressionFromFieldName(k),m=this.fieldsMap.has(u),u=m?null:n.getWhereClause(u),m=m?this.fieldsMap.get(k).name:n.getAliasFromFieldName(k)||"FIELD_EXP_"+b++;this._fieldDataCache.set(k,{alias:m,clause:u})}}}
a.prototype.getAttributes=function(a){a=a.attributes;a=this._processAttributesForOutFields(a);return a=this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,b){a=a.attributes;var c=this.fieldsMap.has(b),k=c?this.fieldsMap.get(b).name:b,u=null;this._fieldDataCache.has(k)?u=this._fieldDataCache.get(k).clause:c||(u=n.getWhereClause(b),this._fieldDataCache.set(k,{alias:k,clause:u}));return c?a[k]:u.calculateValue(a)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||
this._fieldDataCache.set(b,{alias:b,clause:n.getWhereClause(b)});return this._fieldDataCache.get(b).clause.testFeature(a.attributes)};a.prototype.validateItems=function(a,b){var c=this;this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:n.getWhereClause(b)});a=a.map(function(a){return c.getAttributes(a)});return this._fieldDataCache.get(b).clause.testSet(a)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!a||!b||!b.length)return a;for(var c={},n=
0;n<b.length;n++){var u=this._fieldDataCache.get(b[n]),m=u.alias,u=u.clause;c[m]=u?u.calculateValue(a):a[m]}return c};a.prototype._processAttributesForDistinctValues=function(a){if(!a||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var n=0;n<b.length;n++){var u=this._fieldDataCache.get(b[n]).alias;c.push(a[u])}else for(u in a)c.push(a[u]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();
a.default=w})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(w,a){function t(a,c,k,l){if(null!=k&&null!=l&&k===l)return function(b){return k>=b.attributes[a]&&k<=b.attributes[c]};if(null!=k&&null!=l)return function(b){return!(b.attributes[a]>l||b.attributes[c]<k)};if(null!=k)return function(a){return!(a.attributes[c]<k)};if(null!=l)return function(b){return!(b.attributes[a]>l)}}function n(a,c,k){if(null!=c&&null!=k&&c===k)return function(b){return b.attributes[a]===
c};if(null!=c&&null!=k)return function(b){return b.attributes[a]>=c&&b.attributes[a]<=k};if(null!=c)return function(b){return b.attributes[a]>=c};if(null!=k)return function(b){return b.attributes[a]<=k}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=a.startTimeField,l=a.endTimeField,n=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(b&&l)c.forEach(function(a){var c=a.attributes;a=c[b];c=c[l];null==a||isNaN(a)||(n=Math.min(n,a));null==c||
isNaN(c)||(u=Math.max(u,c))});else{var m=b||l;c.forEach(function(a){a=a.attributes[m];null==a||isNaN(a)||(n=Math.min(n,a),u=Math.max(u,a))})}return{start:n,end:u}};a.getTimeOperator=function(a,c){if(!c||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var l=c.start;c=c.end;return null==l&&null==c?null:b&&a?t(b,a,l,c):n(b||a,l,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/kebabDictionary ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(w,a,t,n,b,c,k,l,x,u,m,q,C,B,F,z){function f(b,c,f){return n(this,void 0,void 0,function(){var h,k,m,p,n;return t(this,function(r){switch(r.label){case 0:if(!b)return[2,null];h=b.where;b.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||c&&c===h)b.where=null;return b.geometry?[4,e(b)]:[2,b];case 1:return k=r.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(m=b.geometry.spatialReference,k=l.getGeometryExtent(k),k.spatialReference=m),b.geometry=k,[4,F.checkProjectionSupport(k.spatialReference,
f)];case 2:return r.sent(),[4,u.normalizeCentralMeridian(x.fromJSON(k))];case 3:return p=r.sent(),[4,F.project(p[0].toJSON(),p[0].spatialReference,f)];case 4:n=r.sent();if(!n)throw a.QUERY_ENGINE_EMPTY_RESULT;n.spatialReference=f;b.geometry=n;return[2,b]}})})}function e(a){var b=a.geometry,e=a.distance,f=a.units;if(null==e)return c.resolve(b);a=b.spatialReference;var h=f&&r.fromJSON(f)||k.getUnitString(a),f=null,f=a&&(m.isGeographic(a)||m.isWebMercator(a))?c.resolve(b):F.checkProjectionSupport(a,
m.WGS84).then(function(){return F.project(b,m.WGS84)});return f.then(function(a){return z.getGeodesicBufferOperator().then(function(b){return b(a,e,h).toJSON()})})}Object.defineProperty(a,"__esModule",{value:!0});var r=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var h=new B.default,
p=new B.default,J={esriGeometryPoint:C.convertToPoint,esriGeometryPolyline:C.convertToPolyline,esriGeometryPolygon:C.convertToPolygon,esriGeometryMultipoint:C.convertToMultipoint};a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=q.getCentroidOptimizedGeometry(new B.default,b.geometry,a.hasZ,a.hasM));return c?(b=C.quantizeOptimizedGeometry(p,b.centroid,a.hasZ,a.hasM,"esriGeometryPoint",c),C.convertToPoint(b,a.hasZ,
a.hasM)):C.convertToPoint(b.centroid,a.hasZ,a.hasM)};a.getGeometry=function(a,b,c,e){b="coords"in b?b:b.geometry;return b?c?(c=C.generalizeOptimizedGeometry(h,b,a.hasZ,a.hasM,a.geometryType,c),e&&(c=C.quantizeOptimizedGeometry(p,c,a.hasZ,a.hasM,a.geometryType,e)),J[a.geometryType](c,a.hasZ,a.hasM)):e?(c=C.quantizeOptimizedGeometry(p,b,a.hasZ,a.hasM,a.geometryType,e),J[a.geometryType](c,a.hasZ,a.hasM)):J[a.geometryType](b,a.hasZ,a.hasM):null};a.normalizeQuery=function(a,b,c){return n(this,void 0,void 0,
function(){var e,h,k,l,m;return t(this,function(p){e=a.outFields;h=a.orderByFields;k=a.groupByFieldsForStatistics;l=a.outStatistics;if(e)for(m=0;m<e.length;m++)e[m]=e[m].trim();if(h)for(m=0;m<h.length;m++)h[m]=h[m].trim();if(k)for(m=0;m<k.length;m++)k[m]=k[m].trim();if(l)for(m=0;m<l.length;m++)l[m].onStatisticField&&(l[m].onStatisticField=l[m].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,f(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return n(this,
void 0,void 0,function(){return t(this,function(e){return[2,f(a,b,c)]})})};a.cleanFromGeometryEngine=function(a){return a&&Q in a?JSON.parse(JSON.stringify(a,A)):a};var Q="_geVersion",A=function(a,b){return a!==Q?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports","./utils"],function(w,a,t){function n(a,b,l,n,u,m){m=t.getStride(u,m);var c=l,k=l+m,x=0,w=0,z=l=0,f=0,e=0;for(--n;e<n;e++,c+=m,k+=m){var r=b[c],h=b[c+1],p=b[c+2],J=b[k],Q=b[k+1],A=b[k+2],D=r*Q-J*h,z=z+D,x=
x+(r+J)*D,w=w+(h+Q)*D;u&&(D=r*A-J*p,l+=(p+A)*D,f+=D);r<a[0]&&(a[0]=r);r>a[1]&&(a[1]=r);h<a[2]&&(a[2]=h);h>a[3]&&(a[3]=h);u&&(p<a[4]&&(a[4]=p),p>a[5]&&(a[5]=p))}0<z&&(z*=-1);0<f&&(f*=-1);if(!z)return null;a=[x,w,.5*z];u&&(a[3]=l,a[4]=.5*f);return a}function b(a,b,l,n,u){u=t.getStride(n,u);for(var c=b,k=b+u,x=0,B=0,w=0,z=0,f=0,e=l-1;f<e;f++,c+=u,k+=u){var r=a[c],h=a[c+1],p=a[c+2],J=a[k],Q=a[k+1],A=a[k+2],D;if(n){D=J-r;var S=Q-h,E=A-p;D=Math.sqrt(D*D+S*S+E*E)}else D=J-r,S=Q-h,D=Math.sqrt(D*D+S*S);D&&
(x+=D,n?(r=[r+.5*(J-r),h+.5*(Q-h),p+.5*(A-p)],B+=D*r[0],w+=D*r[1],z+=D*r[2]):(r=[r+.5*(J-r),h+.5*(Q-h)],B+=D*r[0],w+=D*r[1]))}return 0<x?n?[B/x,w/x,z/x]:[B/x,w/x]:0<l?n?[a[b],a[b+1],a[b+2]]:[a[b],a[b+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,k,l,x){if(!k||!k.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var c=a.coords,m=[],q=l?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],w=k.lengths,B=k.coords,F=t.getStride(l,x),z=0,f=0;f<w.length;f++){var e=w[f],r=n(q,B,z,e,l,x);r&&m.push(r);z+=e*F}m.sort(function(a,b){var c=a[2]-b[2];0===c&&l&&(c=a[4]-b[4]);return c});m.length&&(F=6*m[0][2],c[0]=m[0][0]/F,c[1]=m[0][1]/F,l&&(F=6*m[0][4],c[2]=0!==F?m[0][3]/F:0),c[0]<q[0]||c[0]>q[1]||c[1]<q[2]||c[1]>q[3]||
l&&(c[2]<q[4]||c[2]>q[5]))&&(c.length=0);if(!c.length)if(k=k.lengths[0]?b(B,0,w[0],l,x):null)c[0]=k[0],c[1]=k[1],l&&2<k.length&&(c[2]=k[2]);else return null;return a};a.lineCentroid=b})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(w,a,t,n,b,c,k,l,x,u,m,q,C){function B(){return n.create(function(a){return w(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var F={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},
z={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},f={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},e={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};
a.importGeometryEngine=B;a.getGeodesicBufferOperator=function(){return B().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,e,f){if(k.isPolygon(e)&&"esriGeometryPoint"===f.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var h=u.convertFromPolygon(new m.default,e,!1,!1);return n.resolve(function(a){return x.polygonContainsPoint(h,!1,!1,a)})}if(k.isPolygon(e)&&"esriGeometryMultipoint"===f.geometryType){var l=u.convertFromPolygon(new m.default,
e,!1,!1);if("esriSpatialRelContains"===a)return n.resolve(function(a){return x.polygonContainsMultipoint(l,!1,!1,a,f.hasZ,f.hasM)})}if(k.isExtent(e)&&"esriGeometryPoint"===f.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return n.resolve(function(a){return b.extentContainsPoint(e,C.getGeometry(f,a))});if(k.isExtent(e)&&"esriGeometryMultipoint"===f.geometryType&&"esriSpatialRelContains"===a)return n.resolve(function(a){return b.extentContainsMultipoint(e,C.getGeometry(f,
a))});if(k.isExtent(e)&&"esriSpatialRelIntersects"===a){var p=c.getExtentIntersector(f.geometryType);return n.resolve(function(a){return p(e,C.getGeometry(f,a))})}return B().then(function(b){var c=b[F[a]].bind(null,e);return function(a){return c(C.getGeometry(f,a))}})};a.checkSpatialQuerySupport=function(a,b,c){var h=a.spatialRel,m=a.geometry;return m?!0!==z[h]?n.reject(new t("feature-store:unsupported-query","Unsupported query spatial relationship",{query:a})):l.isValid(m.spatialReference)&&l.isValid(c)?
!0!==f[k.getJsonType(m)]?n.reject(new t("feature-store:unsupported-query","Unsupported query geometry type",{query:a})):!0!==e[b]?n.reject(new t("feature-store:unsupported-query","Unsupported layer geometry type",{query:a})):a.outSR?q.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR):n.resolve():n.resolve():n.resolve()};a.canQueryWithRBush=function(a){if(k.isExtent(a))return!0;if(k.isPolygon(a)){var b=0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||
c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports","./utils"],function(w,a,t){function n(a,c,k,l,n){if(!a)return!1;c=t.getStride(c,k);k=a.coords;var b=!1,m=0,q=0;for(a=a.lengths;q<a.length;q++){for(var x=a[q],w=m,F=m,z=m+x*c;F<z;F+=c){w=F+c;w===z&&(w=m);var f=k[F],e=k[F+1],r=k[w],w=k[w+1];(e<n&&w>=n||w<n&&e>=n)&&f+(n-e)/(w-e)*(r-f)<l&&(b=!b)}m+=x*c}return b}
Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,c,k,l){return n(a,c,k,l.coords[0],l.coords[1])};a.polygonContainsMultipoint=function(a,c,k,l,x,u){x=t.getStride(x,u);u=l.coords;l=l.lengths;if(!l)return!1;for(var b=0,q=0;b<l.length;b++,q+=x)if(!n(a,c,k,u[q],u[q+1]))return!1;return!0};a.polygonContainsCoords=n})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","dojo/errors/CancelError","../../core/promiseUtils"],function(w,a,t,n){Object.defineProperty(a,
"__esModule",{value:!0});w=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var b=this;return n.create(function(c,k){b._deferreds.push({resolve:c,reject:k});b._values.push(a)})};a.prototype.unshift=function(a){var b=this;return n.create(function(c,k){b._deferreds.unshift({resolve:c,reject:k});b._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0});a.prototype.process=function(){if(0===
this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=new t,b=0,l=this._deferreds;b<l.length;b++)l[b].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=w})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/valuesHelper ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),
function(w,a,t,n,b,c,k,l){function x(a){var b=[];a.forEach(function(a){return b.push(a)});return b}function u(a){var b,c,e,f;return t(this,function(h){switch(h.label){case 0:b=a.type;switch(b){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,a];case 2:return h.sent(),[3,7];case 3:c=0,e=a.features,h.label=4;case 4:return c<e.length?(f=e[c])?[4,f]:[3,6]:[3,7];case 5:h.sent(),h.label=6;case 6:return c++,[3,4];case 7:return[2]}})}function m(a){var c,e,f,h,k,
l,m,n,r,q;return t(this,function(p){switch(p.label){case 0:if(!a)return[2,null];c=a.type;switch(c){case "Point":return[3,1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,a.coordinates];case 2:return p.sent(),[3,17];case 3:return[5,b(a.coordinates)];case 4:return p.sent(),[3,17];case 5:e=0,f=a.coordinates,p.label=6;case 6:if(!(e<f.length))return[3,9];h=f[e];return[5,
b(h)];case 7:p.sent(),p.label=8;case 8:return e++,[3,6];case 9:return[3,17];case 10:k=0,l=a.coordinates,p.label=11;case 11:if(!(k<l.length))return[3,16];m=l[k];n=0;r=m;p.label=12;case 12:if(!(n<r.length))return[3,15];q=r[n];return[5,b(q)];case 13:p.sent(),p.label=14;case 14:return n++,[3,12];case 15:return k++,[3,11];case 16:return[3,17];case 17:return[2]}})}function q(a,b){var c,e,f,h,m,n,p,q,u,x,w;void 0===b&&(b={});return t(this,function(A){switch(A.label){case 0:c=b.geometryType,e=b.ignoreIds,
f=b.nextObjectId,h=void 0===f?1:f,A.label=1;case 1:m=a.next();n=m.value;if(p=m.done)return[2];q=n.geometry;u=n.properties;x=n.id;if(q&&r[q.type]!==c)return[3,1];w=new k.default(q?F(new l.default,q,b):null,u);w.objectId=e||null==x?h++:x;return[4,w];case 2:return A.sent(),[3,1];case 3:return[2]}})}function C(a){for(var b=0,c=0;c<a.length;c++)var e=a[c],f=a[(c+1)%a.length],b=b+(e[0]*f[1]-f[0]*e[1]);return 0>=b}function B(a){var b=a[0],c=a[a.length-1];b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]||a.push(b);
return a}function F(a,b,c){switch(b.type){case "LineString":return z(a,b.coordinates,c),a;case "MultiLineString":var h=0;for(b=b.coordinates;h<b.length;h++)z(a,b[h],c);return a;case "MultiPoint":return z(a,b.coordinates,c),a;case "MultiPolygon":h=0;for(b=b.coordinates;h<b.length;h++){var k=b[h],l=a,m=c,n=B(k[0]);C(n)?z(l,n,m):f(l,n,m);for(l=1;l<k.length;l++){var m=a,n=c,p=B(k[l]);C(p)?f(m,p,n):z(m,p,n)}}return a;case "Point":return e(a,b.coordinates,c),a;case "Polygon":h=b.coordinates;b=B(h[0]);C(b)?
z(a,b,c):f(a,b,c);for(b=1;b<h.length;b++)k=a,l=c,m=B(h[b]),C(m)?f(k,m,l):z(k,m,l);return a}}function z(a,b,c){for(var f=0;f<b.length;f++)e(a,b[f],c);a.lengths.push(b.length)}function f(a,b,c){for(var f=b.length-1;0<=f;f--)e(a,b[f],c);a.lengths.push(b.length)}function e(a,b,c){var e=b[2];a.coords.push(b[0],b[1]);c.hasZ&&a.coords.push(e||0)}Object.defineProperty(a,"__esModule",{value:!0});var r={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",
Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(a){if(!a)throw new c("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new c("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});if(a.crs){a=a.crs;var b=["urn:ogc:def:crs:OGC:1.3:CRS84","EPSG:4326"].map(function(a){return a.toLowerCase()});if("link"===a.type||-1===b.indexOf(a.properties.name.toLowerCase()))throw new c("geojson-layer:unsupported-crs",
"unsupported GeoJSON 'crs' member",{crs:a});}};a.inferLayerProperties=function(a,b){void 0===b&&(b={});a=u(a);var c=[],e=new Set,f=new Set,h=!1,k=Number.NEGATIVE_INFINITY,l=!1,n=void 0;b=b.geometryType;b=void 0===b?null:b;for(var p=!1;;){var q=a.next(),t=q.value;if(q.done)return{fields:c,geometryType:b,hasZ:h,maxObjectId:Math.max(0,k),objectIdFieldType:n,objectIdOnFeature:l,unknownFields:x(f)};var w=t.geometry,q=t.properties,t=t.id;if(w&&(b||(b=r[w.type]),r[w.type]!==b))continue;if(!h)a:for(h=m(w);;){var w=
h.next(),z=w.value;if(w.done){h=!1;break a}if(2<z.length){h=!0;break a}}l||(l=null!=t)&&(n=typeof t);l&&"number"===n&&null!=t&&(k=Math.max(k,t));if(!p&&q){var p=!0,B;for(B in q)if(!e.has(B))if(t=q[B],null==t)p=!1,f.add(B);else{a:switch(typeof t){case "string":t="esriFieldTypeString";break a;case "number":t="esriFieldTypeDouble";break a;default:t="unknown"}"unknown"===t?f.add(B):(f.delete(B),e.add(B),c.push({name:B,alias:B,type:t}))}}}};a.createOptimizedFeatures=function(a,b){a:for(a=q(u(a),b),b=[];;){var c=
a.next(),e=c.value;if(c.done)break a;b.push(e)}return b}})},"esri/core/tsSupport/valuesHelper":function(){define([],function(){return function(w){var a="function"===typeof Symbol&&w[Symbol.iterator],t=0;return a?a.call(w):{next:function(){w&&t>=w.length&&(w=void 0);return{value:w&&w[t++],done:!w}}}}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/has","../../../../core/lang"],function(w,
a,t,n,b){Object.defineProperty(a,"__esModule",{value:!0});var c={type:"esriSMS",style:"esriSMSCircle",size:6,color:[252,146,31,255],outline:{width:.75,color:[153,153,153,255]}},k={type:"esriSLS",style:"esriSLSSolid",width:1,color:[252,146,31,255]},l={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{width:.75,color:[255,255,255,191]}};a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c:"esriGeometryPolyline"===
a?k:l}}};a.createDefaultAttributesFunction=function(a,b){if(n("csp-restrictions"))return function(){var c;return t((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",k;for(k in a)c+="this."+k+" \x3d "+JSON.stringify(a[k])+";";var l=new Function(c);return function(){return new l}}catch(B){return function(){var c;return t((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:b.clone(a)}}]}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../request ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../../../support/fieldType ../../../support/fieldUtils".split(" "),
function(w,a,t,n,b,c,k,l,x,u,m,q,C,B,F,z,f,e){Object.defineProperty(a,"__esModule",{value:!0});var r={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,
supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}},h=function(){return function(){this.description=this.code=null}}(),p=function(){return function(a){this.error=new h;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}(),J=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();w=function(){function a(){this._featuresInfo=
this._queryEngine=null;this._fieldsMap=new Map}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._featuresInfo=this._requiredFieldNames=this._fieldsMap=this._createDefaultAttributes=null};a.prototype.load=function(a){return b(this,void 0,void 0,function(){var b,h,p,A,w,x,M,J,ma,R,va,Y,Q,Ba,H,Z,ba,aa,da,ca,Ca,$a,wa,xa,ja,ta,ka;return t(this,function(t){switch(t.label){case 0:return b=[],[4,this._checkProjection(a.spatialReference)];
case 1:return t.sent(),h=null,a.url?[4,c(a.url,{responseType:"json"})]:[3,4];case 2:return p=t.sent(),h=p.data,[4,F.validateGeoJSON(h)];case 3:t.sent(),t.label=4;case 4:A=F.inferLayerProperties(h,{geometryType:a.geometryType});w=a.fields||A.fields||[];x=null!=a.hasZ?a.hasZ:A.hasZ;M=A.geometryType;J=a.objectIdField||"OBJECTID";ma=a.spatialReference||u.WGS84;R=a.timeInfo;if(!M)return[2,l.reject(new k("geojson-layer:missing-property","geometryType not set and couldn't be inferred from the provided features"))];
"string"===A.objectIdFieldType&&b.push({type:"geojson-layer:unsupported-id-type",message:"Feature ids are of type string and can't be honored."});w===A.fields&&0<A.unknownFields.length&&b.push({type:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:A.unknownFields}});J&&(va=null,(Y=w.some(function(a){return a.name===J?(va=a,!0):!1}))?(va.type="esriFieldTypeOID",va.editable=!1,va.nullable=!1):w.unshift({alias:J,
name:J,type:"esriFieldTypeOID",editable:!1,nullable:!1}));Q=0;for(Ba=w;Q<Ba.length;Q++){H=Ba[Q];null==H.name&&(H.name=H.alias);null==H.alias&&(H.alias=H.name);if(!H.name)return[2,l.reject(new k("geojson-layer:invalid-field-name","field name is missing",{field:H}))];H.name===J&&(H.type="esriFieldTypeOID");if(-1===f.kebabDict.jsonValues.indexOf(H.type))return[2,l.reject(new k("geojson-layer:invalid-field-type",'invalid type for field "'+H.name+'"',{field:H}))]}Z={};this._requiredFieldNames=[];ba=0;
for(aa=w;ba<aa.length;ba++)H=aa[ba],"esriFieldTypeOID"!==H.type&&"esriFieldTypeGlobalID"!==H.type&&(H.editable=null==H.editable?!0:!!H.editable,H.nullable=null==H.nullable?!0:!!H.nullable,da=e.getFieldDefaultValue(H),H.nullable||void 0!==da?Z[H.name]=da:this._requiredFieldNames.push(H.name)),this._fieldsMap.set(H.name.trim(),H),this._fieldsMap.set(H.name.trim().toLowerCase(),H);R&&(R.startTimeField&&((ca=this._fieldsMap.get(R.startTimeField.toLowerCase()))?(R.startTimeField=ca.name,ca.type="esriFieldTypeDate"):
R.startTimeField=null),R.endTimeField&&((Ca=this._fieldsMap.get(R.endTimeField.toLowerCase()))?(R.endTimeField=Ca.name,Ca.type="esriFieldTypeDate"):R.endTimeField=null),R.trackIdField&&(($a=this._fieldsMap.get(R.trackIdField.toLowerCase()))?R.trackIdField=$a.name:(R.trackIdField=null,b.push({type:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:R}}))),R.startTimeField||R.endTimeField||(b.push({type:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",
details:{timeInfo:R}}),R=null));wa={warnings:b,featureErrors:[],layerDefinition:n({},r,{drawingInfo:z.createDrawingInfo(M),templates:z.createDefaultTemplate(Z),extent:null,geometryType:M,objectIdField:J,fields:w,hasZ:!!x,timeInfo:R})};this._queryEngine=new B.default({fields:w,geometryType:M,hasM:!1,hasZ:x,objectIdField:J,spatialReference:ma,timeInfo:R,featureStore:new q.default({geometryType:M,hasM:!1,hasZ:x})});this._createDefaultAttributes=z.createDefaultAttributesFunction(Z,J);this._featuresInfo=
{nextObjectId:A.maxObjectId+1,geometryType:M,hasZ:x,ignoreIds:"string"===A.objectIdFieldType};xa=F.createOptimizedFeatures(h,this._featuresInfo);if(!u.equals(ma,u.WGS84))for(ja=0,ta=xa;ja<ta.length;ja++)ka=ta[ja],ka.geometry&&(ka.geometry=m.convertFromGeometry(C.project(m.convertToGeometry(ka.geometry,M,x,!1),u.WGS84,ma)));this._loadInitialFeatures(wa,xa);return[2,wa]}})})};a.prototype.applyEdits=function(a){var b=this,c=this._queryEngine.spatialReference;return C.checkProjectionSupport(a.adds,c).then(function(){return C.checkProjectionSupport(a.updates,
c)}).then(function(){return b._applyEdits(a)})};a.prototype.queryFeatures=function(a){return this._queryEngine.executeQuery(a)};a.prototype.queryFeatureCount=function(a){return this._queryEngine.executeQueryForCount(a)};a.prototype.queryObjectIds=function(a){return this._queryEngine.executeQueryForIds(a)};a.prototype.queryExtent=function(a){return this._queryEngine.executeQueryForExtent(a)};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine.featureStore,e=[],f=0;f<b.length;f++){var h=
b[f],k=this._createDefaultAttributes(),l=this._mixAttributes(k,h.attributes,!0);l?a.featureErrors.push(l):(this._assignObjectId(k,h.attributes,!0),h.attributes=k,e.push(h))}c.addMany(e);a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var e={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};
b&&b.length&&this._applyAddEdits(e,b);c&&c.length&&this._applyUpdateEdits(e,c);if(a&&a.length){for(b=0;b<a.length;b++)e.deleteResults.push(new J(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:e}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,e=this._queryEngine,f=e.geometryType,h=e.hasM,k=e.hasZ,l=e.objectIdField,n=e.spatialReference,e=e.featureStore,q=[],r=0;r<b.length;r++){var t=
b[r];if(t.geometry&&f!==x.getJsonType(t.geometry))c.push(new p("Incorrect geometry type."));else{var u=this._createDefaultAttributes(),w=this._mixAttributes(u,t.attributes);w?c.push(w):(this._assignObjectId(u,t.attributes),t.attributes=u,null!=t.uid&&(a.uidToObjectId[t.uid]=t.attributes[l]),t.geometry&&(t.geometry=C.project(t.geometry,t.geometry.spatialReference,n)),q.push(t),c.push(new J(t.attributes[l])))}}e.addMany(m.convertFromFeatures([],q,f,k,h,l))};a.prototype._applyUpdateEdits=function(a,
b){a=a.updateResults;for(var c=this._queryEngine,e=c.geometryType,f=c.hasM,h=c.hasZ,k=c.objectIdField,l=c.spatialReference,c=c.featureStore,n=0;n<b.length;n++){var q=b[n],r=q.attributes,t=q.geometry,q=r&&r[k];if(null==q)a.push(new p("Identifier field "+k+" missing"));else if(c.has(q)){var u=m.convertToFeature(c.getFeature(q),e,h,f);if(t){if(e!==x.getJsonType(t)){a.push(new p("Incorrect geometry type."));continue}u.geometry=C.project(t,t.spatialReference,l)}if(r&&(r=this._mixAttributes(u.attributes,
r))){a.push(r);continue}c.add(m.convertFromFeature(u,e,h,f,k));a.push(new J(q))}else a.push(new p("Feature with object id "+q+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var e=this._queryEngine.objectIdField;c?b&&isFinite(b[e])?a[e]=b[e]:a[e]=this._featuresInfo.nextObjectId++:a[e]=this._featuresInfo.nextObjectId++};a.prototype._mixAttributes=function(a,b,c){void 0===c&&(c=!1);for(var f in b){var h=e.sanitizeNullFieldValue(b[f]),k=this._fieldsMap.get(f)||this._fieldsMap.get(f.toLowerCase());
if(k&&(c||k.editable)){var l=e.validateFieldValue(k,h);if(l)return new p(e.validationErrorToString(l,k,h));a[k.name]=h}}b=0;for(c=this._requiredFieldNames;b<c.length;b++)if(f=c[b],void 0===a[f])return new p('missing required field "'+f+'"');return null};a.prototype._checkProjection=function(a){return C.checkProjectionSupport(u.WGS84,a).catch(function(){throw new k("geojson-layer","Projection not supported");})};return a}();a.default=w});