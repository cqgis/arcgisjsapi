// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
require({cache:{"dstore/Csv":function(){define(["dojo/_base/lang","dojo/_base/declare"],function(z,a){function w(a,c){var f={},m=a.length,d;for(d=0;d<m;d++)f[a[d]]=c[d];return f}var n=/^\s*"([\S\s]*)"\s*$/,c=/""/g,f=/"/g;return a(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(a){var f=[];a=a.split(this.newline);var k=this.fieldNames,r=0,d=[],q="",B="",t,y,l,b,h,p,D;h=0;l=a.length;a:for(;h<l;h++)if(z.trim(a[h])){t=a[h].split(this.delimiter);p=0;for(b=t.length;p<b;p++){y=
t[p];D=-1;q+=B+y;for(B="";0<=(D=y.indexOf('"',D+1));)r++;if(0===r%2){if(0<r)if(r=n.exec(q))d.push(r[1].replace(c,'"'));else{console.warn("Csv: discarding row with invalid value: "+q);d=[];q="";r=0;continue a}else d.push(this.trim||!k?z.trim(q):q);q="";r=0}else B=this.delimiter}0===r?(k?f.push(w(k,d)):k=this.fieldNames=d,d=[]):B=this.newline}return f},toCsv:function(a){return this.stringify(this.data,a)},stringify:function(a,c){c=c||{};var m=c.alwaysQuote,k=this.fieldNames,d=this.delimiter,q=this.newline,
n="",t,y,l,b;for(t=-1;t<a.length;t++)for(-1<t&&(n+=q),y=0;y<k.length;y++){l=0>t?k[y]:a[t][k[y]];if(null===l||void 0===l)l="";"string"!==typeof l&&(l=l.toString());b=m||0<=l.indexOf('"')||0<=l.indexOf(d);n+=(0<y?d:"")+(b?'"'+l.replace(f,'""')+'"':l)}c.trailingNewline&&(n+=q);return n}})})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(z,a,w,n,c,f){function k(a,k,t,y,l){void 0===y&&(y=
null);void 0===l&&(l=!1);if(null===y){var b=f.cacheKey(k,t);void 0!==d[b]?y=d[b]:(y=m(k,t,null),null===y&&(y=new f),d[b]=y)}return v._project(a,k,t instanceof c||!1===l?t:new c(t),y,l)}function m(a,d,c){void 0===c&&(c=null);a=v._getTransformation(a,d,c);return null!==a?f.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var v=null;a.isLoaded=function(){return!!v&&n.isLoaded()};a.isSupported=function(){return n.isSupported()};var r=null;a.load=function(){return r?r:r=w.create(function(a,
d){var c=n.load();z(["./geometryEngine"],function(f){v=f;c.then(function(){v._enableProjection(n);a()},function(a){d(a)})})})};a.project=function(a,d,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:k(a,a[0].spatialReference,d,c):k([a],a.spatialReference,d,c)[0]};var d={};a.projectMany=k;a.getTransformation=m;a.getTransformations=function(a,c,d){void 0===d&&(d=null);a=v._getTransformationBySuitability(a,c,d);if(null!==a){c=[];for(d=0;d<a.length;d++)c.push(f.fromGE(a[d]));return c}return[]}})},
"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(z,a,w,n,c){function f(b){function h(a,b,h){a[b]=h(a[b])}a._pe=b;q.init();B.init();t.init();y.init();l.init();a.PeGCSExtent=function(b){function h(){return null!==b&&b.apply(this,arguments)||this}w(h,b);h.prototype.destroy=function(){a._pe.destroy(this)};return h}(a._pe.PeGCSExtent);for(var p=0,d=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,
a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];p<d.length;p++)b=d[p],h(b.prototype,"getName",function(a){return function(){return a.call(this,Array(q.PE_NAME_MAX))}});p=0;for(d=[a._pe.PeGeogtran,a._pe.PeProjcs];p<d.length;p++)b=d[p],h(b.prototype,"getParameters",function(b){return function(){for(var h=Array(q.PE_PARM_MAX),l=b.call(this),p=0;p<h.length;p++){var d=a._pe.getValue(l,"*");h[p]=d?a._pe.wrapPointer(d,a._pe.PeParameter):null;l+=Int32Array.BYTES_PER_ELEMENT}return h}});h(a._pe.PeHorizon.prototype,
"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var h=[],l=a.call(this);r(h,b,l);return h}});h(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var h=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var l=null,p=b.call(this);if(!a._pe.compare(p,a._pe.NULL)){var l=[p],d=this.getSteps();if(1<d)for(var p=a._pe.getPointer(p),c=1;c<d;c++)l.push(a._pe.wrapPointer(p+h*c,a._pe.PeGTlistExtendedGTs))}return l}});var c=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var h=
this._cache;h||(this._cache=h=new Map);if(h.has(b))return h.get(b);var l=null,p=b.call(this);if(!a._pe.compare(p,a._pe.NULL)){var l=[p],d=p.getNump();if(1<d)for(var p=a._pe.getPointer(p),D=1;D<d;D++)l.push(a._pe.wrapPointer(p+c*D,a._pe.PeHorizon))}h.set(b,l);return l}};h(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);h(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=q.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var h=a._pe.getPointer(this),
l=a._pe.ensureInt8(Array(q.PE_BUFFER_MAX));return a._pe.Pointer_stringify(a._pe._pe_object_to_string_ext(h,b,l))}}function k(b){if(b){var h=a._pe.getClass(b);h&&(h=a._pe.getCache(h))&&(b=a._pe.getPointer(b))&&delete h[b]}}function m(b,h){var l=[];h=Array(h);for(var d=0;d<b;d++)l.push(a._pe.ensureInt8(h));return l}function v(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function r(b,h,l,d){void 0===d&&(d=!1);if(d)for(d=0;d<2*h;d++)b[d]=a._pe.getValue(l+
d*Float64Array.BYTES_PER_ELEMENT,"double");else{var p=0===b.length;for(d=0;d<h;d++)p&&(b[d]=Array(2)),b[d][0]=a._pe.getValue(l,"double"),b[d][1]=a._pe.getValue(l+Float64Array.BYTES_PER_ELEMENT,"double"),l+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var d;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!n("esri-wasm")};a.load=function(){return d?d:d=c.create(function(a,h){z(["./support/pe-wasm"],function(b){b({locateFile:function(a){return z.toUrl("./support/"+
a)},onAbort:function(a){h(Error(a))}}).then(function(b){f(b);a()})})})};(function(b){function h(b,h,l){a._pe.ensureCache.prepare();var d=v(l),p=l===d,d=a._pe.ensureFloat64(d);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),h,d))&&r(l,h,d,p);return b}function l(a,b,h){return d(a,b,h,0)}function d(b,h,l,d){a._pe.ensureCache.prepare();var p=v(l),c=l===p,p=a._pe.ensureFloat64(p);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),h,p,d))&&r(l,h,p,c);return b}b.geogToProj=h;b.projGeog=function(a,b,d,p){switch(p){case q.PE_TRANSFORM_P_TO_G:return l(a,
b,d);case q.PE_TRANSFORM_G_TO_P:return h(a,b,d)}return 0};b.projToGeog=l;b.projToGeogCenter=d})(a.PeCSTransformations||(a.PeCSTransformations={}));var q;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;
b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=
a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;
b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(q=a.PeDefs||(a.PeDefs={}));(function(b){function h(b,h){var p=null,c=d[b];c||(c={},d[b]=c);c.hasOwnProperty(String(h))?p=c[h]:(b=a._pe.PeFactory.prototype.factoryByType(b,h),a._pe.compare(b,a._pe.NULL)||(p=b,c[h]=p));return p=l(p)}function l(b){if(b){var h=b.getType();
switch(h){case q.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case q.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case q.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:h&q.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var d={},c={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(b){return h(q.PE_TYPE_COORDSYS,b)};b.factoryByType=h;b.fromString=function(b,h){var d=null,p=c[b];p||(p={},c[b]=p);p.hasOwnProperty(h)?
d=p[h]:(b=a._pe.PeFactory.prototype.fromString(b,h),a._pe.compare(b,a._pe.NULL)||(d=b,p[h]=d));return d=l(d)};b.geogcs=function(b){return h(q.PE_TYPE_GEOGCS,b)};b.geogtran=function(b){return h(q.PE_TYPE_GEOGTRAN,b)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(b){return h(q.PE_TYPE_PROJCS,b)};b.unit=function(b){return h(q.PE_TYPE_UNIT,b)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var B;(function(b){var h;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
h=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,l,d,c,f,q){var p=null,D=new a._pe.PeInteger(q);try{var t=a._pe.PeGTlistExtended.prototype.getGTlist(b,l,d,c,f,D);if(q=D.val)if(p=[t],1<q){var m=a._pe.getPointer(t);for(b=1;b<q;b++)p.push(a._pe.wrapPointer(m+h*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(D)}return p}})(B=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var h=0;h<b.length;h++){var l=b[h];k(l);l.getEntries().forEach(function(b){k(b);
b=b.getGeogtran();k(b);b.getParameters().forEach(k);[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){k(b);var a=b.getDatum();k(a);k(a.getSpheroid());k(b.getPrimem());k(b.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,l,d,c,f){a._pe.ensureCache.prepare();var h=v(d),p=d===h,h=a._pe.ensureFloat64(h),q=0;c&&(q=a._pe.ensureFloat64(c));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),l,h,q,
f))&&r(d,l,h,p);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(b){function h(b,h,l,d,p,c){a._pe.ensureCache.prepare();var f,D;switch(b){case "dd":f=a._pe._pe_geog_to_dd;D=q.PE_DD_MAX;break;case "ddm":f=a._pe._pe_geog_to_ddm;D=q.PE_DDM_MAX;break;case "dms":f=a._pe._pe_geog_to_dms,D=q.PE_DMS_MAX}b=0;h&&(b=a._pe.getPointer(h));h=v(d);h=a._pe.ensureFloat64(h);D=m(l,D);d=a._pe.ensureInt32(D);if(p=f(b,l,h,p,d))for(f=0;f<l;f++)c[f]=a._pe.Pointer_stringify(D[f]);return p}function l(b,
h,l,d,p){a._pe.ensureCache.prepare();var c;switch(b){case "dd":c=a._pe._pe_dd_to_geog;break;case "ddm":c=a._pe._pe_ddm_to_geog;break;case "dms":c=a._pe._pe_dms_to_geog}b=0;h&&(b=a._pe.getPointer(h));h=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(h);h=a._pe.ensureFloat64(Array(2*l));(c=c(b,l,d,h))&&r(p,l,h);return c}b.geog_to_dms=function(b,a,l,d,p){return h("dms",b,a,l,d,p)};b.dms_to_geog=function(b,a,h,d){return l("dms",b,a,h,d)};b.geog_to_ddm=function(b,a,l,d,p){return h("ddm",
b,a,l,d,p)};b.ddm_to_geog=function(b,a,h,d){return l("ddm",b,a,h,d)};b.geog_to_dd=function(b,a,l,d,p){return h("dd",b,a,l,d,p)};b.dd_to_geog=function(b,a,h,d){return l("dd",b,a,h,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var t;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
b.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,l,d,c,f,t,y){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=v(d);d=a._pe.ensureFloat64(b);b=m(l,q.PE_MGRS_MAX);var p=a._pe.ensureInt32(b);if(c=a._pe._pe_geog_to_mgrs_extended(h,l,d,c,f,t,p))for(f=0;f<l;f++)y[f]=a._pe.Pointer_stringify(b[f]);return c};b.mgrs_to_geog_extended=function(b,l,d,c,f){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=d.map(function(b){return a._pe.ensureString(b)});
d=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*l));(c=a._pe._pe_mgrs_to_geog_extended(h,l,d,c,b))&&r(f,l,b);return c}})(t=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,l,d,c,f,t,y){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=v(d);d=a._pe.ensureFloat64(b);b=m(l,q.PE_MGRS_MAX);var p=a._pe.ensureInt32(b);if(c=a._pe._pe_geog_to_usng(h,l,d,c,f,t,p))for(f=0;f<l;f++)y[f]=a._pe.Pointer_stringify(b[f]);return c};b.usng_to_geog=function(b,l,d,c){a._pe.ensureCache.prepare();
var h=0;b&&(h=a._pe.getPointer(b));b=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*l));(h=a._pe._pe_usng_to_geog(h,l,d,b))&&r(c,l,b);return h}})(a.PeNotationUsng||(a.PeNotationUsng={}));var y;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
l,d,c,f){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=v(d);d=a._pe.ensureFloat64(b);b=m(l,q.PE_UTM_MAX);var p=a._pe.ensureInt32(b);if(c=a._pe._pe_geog_to_utm(h,l,d,c,p))for(h=0;h<l;h++)f[h]=a._pe.Pointer_stringify(b[h]);return c};b.utm_to_geog=function(b,l,d,c,f){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=d.map(function(b){return a._pe.ensureString(b)});d=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*l));(c=a._pe._pe_utm_to_geog(h,l,d,c,b))&&r(f,l,b);
return c}})(y=a.PeNotationUtm||(a.PeNotationUtm={}));var l;(function(b){var h=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(l,d){void 0===d&&(d=b.PE_PCSINFO_OPTION_DOMAIN);var c,p;h.has(l)&&(p=h.get(l),p[d]&&(c=p[d]));
c||(c=a._pe.PePCSInfo.prototype.generate(l,d),p||(p=[],h.set(l,p)),p[d]=c);return c}})(l=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=f})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(z,a,w){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=
null;if(a&&a.steps){var c=0;for(a=a.steps;c<a.length;c++){var k=a[c];k instanceof w?this.steps.push(k):this.steps.push(new w({wkid:k.wkid,wkt:k.wkt,isInverse:k.isInverse}))}}}a.cacheKey=function(a,f){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==f.wkid&&null!==f.wkid?f.wkid.toString():"-1",void 0!==f.wkt&&null!==f.wkt?f.wkt.toString():""].join()};a.fromGE=function(c){var f=new a,k="",m=0;for(c=c.steps;m<c.length;m++){var n=w.fromGE(c[m]);
f.steps.push(n);k+=n.uid.toString()+","}f._cached_projection={};f._gtlistentry=null;f._chain=k;return f};a.prototype.getInverse=function(){var c=new a;c.steps=[];for(var f=this.steps.length-1;0<=f;f--)c.steps.push(this.steps[f].getInverse());return c};a.prototype.getGTListEntry=function(){for(var a="",f=0,k=this.steps;f<k.length;f++)a+=k[f].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(c,
f,k){this._cached_projection[a.cacheKey(c,f)]=k};a.prototype.getCachedGeTransformation=function(c,f){for(var k="",m=0,n=this.steps;m<n.length;m++)k+=n[m].uid.toString()+",";k!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=k);c=this._cached_projection[a.cacheKey(c,f)];return void 0===c?null:c};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(z,a){var w=0;return function(){function a(a){void 0===a&&(a=
null);this.uid=w++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(c){var f=new a;f._wkt=c.wkt;f._wkid=c.wkid;f._isInverse=c.isInverse;return f};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=w++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},
set:function(a){this._wkid=a;this.uid=w++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=w++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var c=new a;c._wkt=this.wkt;c._wkid=this._wkid;c._isInverse=!this.isInverse;return c};return a}()})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/Map ../../../core/Error ../../../core/has ../../../core/Logger ../../../core/libs/rbush/rbush ../../../geometry/support/aaBoundingRect ../featureConversionUtils".split(" "),
function(z,a,w,n,c,f,k,m,v,r,d){Object.defineProperty(a,"__esModule",{value:!0});var q=[],B=m.getLogger("esri.layers.graphics.data.FeatureStore"),t={minX:0,minY:0,maxX:0,maxY:0};z=function(){function a(a){this._featuresById=new c.default;this._boundsByFeature=new c.default;this._featuresByBounds=new c.default;this._index=v(9,k("csp-restrictions")?function(b){return{minX:b[0],minY:b[1],maxX:b[2],maxY:b[3]}}:["[0]","[1]","[2]","[3]"]);this._geometryInfo=a}Object.defineProperty(a.prototype,"geometryType",
{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",
{get:function(){if(!this.numFeatures)return null;var a=r.create(r.NEGATIVE_INFINITY);this._boundsByFeature.forEach(function(b){b&&(a[0]=Math.min(b[0],a[0]),a[1]=Math.min(b[1],a[1]),a[2]=Math.max(b[2],a[2]),a[3]=Math.max(b[3],a[3]))});return a},enumerable:!0,configurable:!0});a.prototype.setEngine=function(a){this._engine=a};a.prototype.add=function(a){this._add(a,q);this._index.load(q);this._clearCache();q.length=0};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b],q);this._index.load(q);
this._clearCache();q.length=0};a.prototype.clear=function(){this._featuresById.clear();this._boundsByFeature.clear();this._featuresByBounds.clear();this._index.clear();this._clearCache()};a.prototype.removeManyById=function(a){for(var b=0;b<a.length;b++){var h=a[b],d=this._featuresById.get(h);if(d){var l=this._boundsByFeature.get(d);l&&(this._index.remove(l),this._featuresByBounds.delete(l));this._boundsByFeature.delete(d)}this._featuresById.delete(h)}this._clearCache()};a.prototype.forEachBounds=
function(a,b){for(var h=0;h<a.length;h++){var d=a[h],l=this._boundsByFeature.get(d);l&&b(l,d)}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var h=0,d=this._index;t.minX=a[0];t.minY=a[1];t.maxX=a[2];t.maxY=a[3];for(a=d.search(t);h<a.length;h++)b(this._featuresByBounds.get(a[h]))};a.prototype.transferIds=
function(a,b){for(var h=[],d=0;d<b.length;d++){var l=this._featuresById.get(b[d]);l&&(this._remove(l),h.push(l))}a.addMany(h);this._clearCache()};a.prototype.transferIdRange=function(a,b,h){for(var d=[];b<h;b++){var l=this._featuresById.get(b);l&&(this._remove(l),d.push(l))}a.addMany(d);this._clearCache()};a.prototype.transferIf=function(a,b){var h=this,d=[];this._featuresById.forEach(function(a,l){b(a)&&(h._remove(a),d.push(a))});a.addMany(d);this._clearCache()};a.prototype.transferAll=function(a){var b=
this,h=[];this._featuresById.forEach(function(a,d){b._remove(a);h.push(a)});a.addMany(h);this._clearCache()};a.prototype._clearCache=function(){this._engine&&this._engine.clearCache()};a.prototype._add=function(a,b){if(a){var h=a.objectId;if(null==h)B.error(new f("featurestore:invalid-feature","feature id is missing",{feature:a}));else{var l=this._featuresById.get(h),c;l&&(c=this._boundsByFeature.get(l))&&(this._index.remove(c),this._boundsByFeature.delete(l),this._featuresByBounds.delete(c));a.geometry?
(c=d.getBoundsOptimizedGeometry(c||r.create(),a.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(a,c),this._featuresByBounds.set(c,a),this._featuresById.set(h,a),b.push(c)):(this._boundsByFeature.set(a,null),this._featuresById.set(h,a))}}};a.prototype._remove=function(a){var b;if(a){if(b=this._boundsByFeature.get(a))this._index.remove(b),this._boundsByFeature.delete(a),this._featuresByBounds.delete(b);this._featuresById.delete(a.objectId)}};return a}();a.default=
z})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(z){function a(d,c){if(!(this instanceof a))return new a(d,c);this._maxEntries=Math.max(4,d||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function w(a,d){n(a,0,a.children.length,d,a)}function n(a,d,l,b,h){h||(h=q(null));h.minX=Infinity;h.minY=Infinity;h.maxX=-Infinity;h.maxY=-Infinity;for(var f;d<l;d++)f=a.children[d],
c(h,a.leaf?b(f):f);return h}function c(a,d){a.minX=Math.min(a.minX,d.minX);a.minY=Math.min(a.minY,d.minY);a.maxX=Math.max(a.maxX,d.maxX);a.maxY=Math.max(a.maxY,d.maxY);return a}function f(a,d){return a.minX-d.minX}function k(a,d){return a.minY-d.minY}function m(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function v(a){return a.maxX-a.minX+(a.maxY-a.minY)}function r(a,d){return a.minX<=d.minX&&a.minY<=d.minY&&d.maxX<=a.maxX&&d.maxY<=a.maxY}function d(a,d){return d.minX<=a.maxX&&d.minY<=a.maxY&&d.maxX>=
a.minX&&d.maxY>=a.minY}function q(a){return{children:a,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function B(a,d,l,b,h){for(var c=[d,l],f;c.length;)l=c.pop(),d=c.pop(),l-d<=b||(f=d+Math.ceil((l-d)/b/2)*b,z(a,f,d,l,h),c.push(d,f,f,l))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var c=this.data,l=[],b=this.toBBox;if(!d(a,c))return l;for(var h=[],f,q,m,k;c;){f=0;for(q=c.children.length;f<q;f++)m=c.children[f],k=c.leaf?b(m):m,d(a,k)&&
(c.leaf?l.push(m):r(a,k)?this._all(m,l):h.push(m));c=h.pop()}return l},collides:function(a){var c=this.data,l=this.toBBox;if(!d(a,c))return!1;for(var b=[],h,f,q,m;c;){h=0;for(f=c.children.length;h<f;h++)if(q=c.children[h],m=c.leaf?l(q):q,d(a,m)){if(c.leaf||r(a,m))return!0;b.push(q)}c=b.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var d=0,l=a.length;d<l;d++)this.insert(a[d]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?
this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(d=this.data,this.data=a,a=d),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=q([]);return this},remove:function(a,d){if(!a)return this;for(var l=this.data,b=this.toBBox(a),h=[],c=[],f,q,m,k;l||h.length;){l||(l=h.pop(),q=h[h.length-1],f=c.pop(),k=!0);if(l.leaf){a:{m=a;var t=l.children,n=d;if(n){for(var y=
0;y<t.length;y++)if(n(m,t[y])){m=y;break a}m=-1}else m=t.indexOf(m)}if(-1!==m){l.children.splice(m,1);h.push(l);this._condense(h);break}}k||l.leaf||!r(l,b)?q?(f++,l=q.children[f],k=!1):l=null:(h.push(l),c.push(f),f=0,q=l,l=l.children[0])}return this},toBBox:function(a){return a},compareMinX:f,compareMinY:k,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,d){for(var l=[];a;)a.leaf?d.push.apply(d,a.children):l.push.apply(l,a.children),a=l.pop();return d},
_build:function(a,d,l,b){var h=l-d+1,c=this._maxEntries,f;if(h<=c)return f=q(a.slice(d,l+1)),w(f,this.toBBox),f;b||(b=Math.ceil(Math.log(h)/Math.log(c)),c=Math.ceil(h/Math.pow(c,b-1)));f=q([]);f.leaf=!1;f.height=b;var h=Math.ceil(h/c),c=h*Math.ceil(Math.sqrt(c)),m,k,n;for(B(a,d,l,c,this.compareMinX);d<=l;d+=c)for(k=Math.min(d+c-1,l),B(a,d,k,h,this.compareMinY),m=d;m<=k;m+=h)n=Math.min(m+h-1,k),f.children.push(this._build(a,m,n,b-1));w(f,this.toBBox);return f},_chooseSubtree:function(a,d,c,b){for(var h,
l,f,q,k,n,t,v;;){b.push(d);if(d.leaf||b.length-1===c)break;t=v=Infinity;h=0;for(l=d.children.length;h<l;h++)f=d.children[h],k=m(f),n=(Math.max(f.maxX,a.maxX)-Math.min(f.minX,a.minX))*(Math.max(f.maxY,a.maxY)-Math.min(f.minY,a.minY))-k,n<v?(v=n,t=k<t?k:t,q=f):n===v&&k<t&&(t=k,q=f);d=q||d.children[0]}return d},_insert:function(a,d,l){var b=this.toBBox;l=l?a:b(a);var b=[],h=this._chooseSubtree(l,this.data,d,b);h.children.push(a);for(c(h,l);0<=d;)if(b[d].children.length>this._maxEntries)this._split(b,
d),d--;else break;this._adjustParentBBoxes(l,b,d)},_split:function(a,d){var c=a[d],b=c.children.length,h=this._minEntries;this._chooseSplitAxis(c,h,b);b=this._chooseSplitIndex(c,h,b);b=q(c.children.splice(b,c.children.length-b));b.height=c.height;b.leaf=c.leaf;w(c,this.toBBox);w(b,this.toBBox);d?a[d-1].children.push(b):this._splitRoot(c,b)},_splitRoot:function(a,d){this.data=q([a,d]);this.data.height=a.height+1;this.data.leaf=!1;w(this.data,this.toBBox)},_chooseSplitIndex:function(a,d,c){var b,h,
l,f,q,k,v;q=k=Infinity;for(b=d;b<=c-d;b++)h=n(a,0,b,this.toBBox),l=n(a,b,c,this.toBBox),f=Math.max(0,Math.min(h.maxX,l.maxX)-Math.max(h.minX,l.minX))*Math.max(0,Math.min(h.maxY,l.maxY)-Math.max(h.minY,l.minY)),h=m(h)+m(l),f<q?(q=f,v=b,k=h<k?h:k):f===q&&h<k&&(k=h,v=b);return v},_chooseSplitAxis:function(a,d,c){var b=a.leaf?this.compareMinX:f,h=a.leaf?this.compareMinY:k,l=this._allDistMargin(a,d,c,b);d=this._allDistMargin(a,d,c,h);l<d&&a.children.sort(b)},_allDistMargin:function(a,d,l,b){a.children.sort(b);
b=this.toBBox;var h=n(a,0,d,b),f=n(a,l-d,l,b),q=v(h)+v(f),m,k;for(m=d;m<l-d;m++)k=a.children[m],c(h,a.leaf?b(k):k),q+=v(h);for(m=l-d-1;m>=d;m--)k=a.children[m],c(f,a.leaf?b(k):k),q+=v(f);return q},_adjustParentBBoxes:function(a,d,l){for(;0<=l;l--)c(d[l],a)},_condense:function(a){for(var d=a.length-1,c;0<=d;d--)0===a[d].children.length?0<d?(c=a[d-1].children,c.splice(c.indexOf(a[d]),1)):this.clear():w(a[d],this.toBBox)},_initFormat:function(a){var d=["return a"," - b",";"];this.compareMinX=new Function("a",
"b",d.join(a[0]));this.compareMinY=new Function("a","b",d.join(a[1]));this.toBBox=new Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function z(n,c,f,k,m){for(;k>f;){if(600<k-f){var v=k-f+1,r=c-f+1,d=Math.log(v),q=.5*Math.exp(2*d/3),d=.5*Math.sqrt(d*q*(v-q)/v)*(0>r-v/2?-1:1);z(n,c,Math.max(f,Math.floor(c-r*q/v+d)),Math.min(k,Math.floor(c+(v-r)*q/v+d)),m)}v=n[c];r=f;
q=k;a(n,f,c);for(0<m(n[k],v)&&a(n,f,k);r<q;){a(n,r,q);r++;for(q--;0>m(n[r],v);)r++;for(;0<m(n[q],v);)q--}0===m(n[f],v)?a(n,f,q):(q++,a(n,q,k));q<=c&&(f=q+1);c<=q&&(k=q-1)}}function a(a,c,f){var k=a[c];a[c]=a[f];a[f]=k}function w(a,c){return a<c?-1:a>c?1:0}return function(a,c,f,k,m){z(a,c,f||0,k||a.length-1,m||w)}})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(z,a,w,n){function c(d){void 0===d&&(d=a.ZERO);return[d[0],
d[1],d[2],d[3]]}function f(a){return a[0]>=a[2]?0:a[2]-a[0]}function k(a){return a[1]>=a[3]?0:a[3]-a[1]}function m(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];return a}function v(a){return 4===a.length}function r(a,c,f){return a<c?c:a>f?f:a}Object.defineProperty(a,"__esModule",{value:!0});a.create=c;a.clone=function(a){return[a[0],a[1],a[2],a[3]]};a.fromValues=function(a,f,m,k,n){void 0===n&&(n=c());n[0]=a;n[1]=f;n[2]=m;n[3]=k;return n};a.fromExtent=function(a,f){void 0===f&&(f=c());f[0]=a.xmin;
f[1]=a.ymin;f[2]=a.xmax;f[3]=a.ymax;return f};a.toExtent=function(a,c){return new n({xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:c})};a.expandPointInPlace=function(a,c){c[0]<a[0]&&(a[0]=c[0]);c[0]>a[2]&&(a[2]=c[0]);c[1]<a[1]&&(a[1]=c[1]);c[1]>a[3]&&(a[3]=c[1])};a.expand=function(a,c,f){void 0===f&&(f=a);if("length"in c)if(v(c))f[0]=Math.min(a[0],c[0]),f[1]=Math.min(a[1],c[1]),f[2]=Math.max(a[2],c[2]),f[3]=Math.max(a[3],c[3]);else{if(2===c.length||3===c.length)f[0]=Math.min(a[0],c[0]),
f[1]=Math.min(a[1],c[1]),f[2]=Math.max(a[2],c[0]),f[3]=Math.max(a[3],c[1])}else switch(c.type){case "extent":f[0]=Math.min(a[0],c.xmin);f[1]=Math.min(a[1],c.ymin);f[2]=Math.max(a[2],c.xmax);f[3]=Math.max(a[3],c.ymax);break;case "point":f[0]=Math.min(a[0],c.x);f[1]=Math.min(a[1],c.y);f[2]=Math.max(a[2],c.x);f[3]=Math.max(a[3],c.y);break;default:w.neverReached(c)}return f};a.expandWithNestedArray=function(a,c,f){void 0===f&&(f=a);var d=c.length,m=a[0],l=a[1],b=a[2];a=a[3];for(var h=0;h<d;h++){var p=
c[h],m=Math.min(m,p[0]),l=Math.min(l,p[1]),b=Math.max(b,p[0]);a=Math.max(a,p[1])}f[0]=m;f[1]=l;f[2]=b;f[3]=a;return f};a.allFinite=function(a){for(var d=0;4>d;d++)if(!isFinite(a[d]))return!1;return!0};a.width=f;a.height=k;a.diameter=function(a){var d=f(a);a=k(a);return Math.sqrt(d*d+a*a)};a.area=function(a){return f(a)*k(a)};a.center=function(a,c){void 0===c&&(c=[0,0]);c[0]=a[0]+f(a)/2;c[1]=a[1]+k(a)/2;return c};a.containsPoint=function(a,c){return c[0]>=a[0]&&c[1]>=a[1]&&c[0]<=a[2]&&c[1]<=a[3]};
a.containsPointWithMargin=function(a,c,f){return c[0]>=a[0]-f&&c[1]>=a[1]-f&&c[0]<=a[2]+f&&c[1]<=a[3]+f};a.intersects=function(a,c){return Math.max(c[0],a[0])<=Math.min(c[2],a[2])&&Math.max(c[1],a[1])<=Math.min(c[3],a[3])};a.contains=function(a,c){return c[0]>=a[0]&&c[2]<=a[2]&&c[1]>=a[1]&&c[3]<=a[3]};a.intersection=function(a,c,f){void 0===f&&(f=a);var d=c[0],m=c[1],l=c[2];c=c[3];f[0]=r(a[0],d,l);f[1]=r(a[1],m,c);f[2]=r(a[2],d,l);f[3]=r(a[3],m,c);return f};a.distance=function(a,c){var d=(a[1]+a[3])/
2,m=Math.max(Math.abs(c[0]-(a[0]+a[2])/2)-f(a)/2,0);a=Math.max(Math.abs(c[1]-d)-k(a)/2,0);return Math.sqrt(m*m+a*a)};a.offset=function(a,c,f,m){void 0===m&&(m=a);m[0]=a[0]+c;m[1]=a[1]+f;m[2]=a[2]+c;m[3]=a[3]+f;return m};a.pad=function(a,c,f){void 0===f&&(f=a);f[0]=a[0]-c;f[1]=a[1]-c;f[2]=a[2]+c;f[3]=a[3]+c;return f};a.setMin=function(a,c,f){void 0===f&&(f=a);f[0]=c[0];f[1]=c[1];f!==a&&(f[2]=a[2],f[3]=a[3]);return f};a.setMax=function(a,c,f){void 0===f&&(f=a);f[2]=c[0];f[3]=c[1];f!==a&&(f[0]=a[0],
f[1]=a[1]);return a};a.set=m;a.empty=function(f){return f?m(f,a.NEGATIVE_INFINITY):c(a.NEGATIVE_INFINITY)};a.is=v;a.isPoint=function(a){return(0===f(a)||!isFinite(a[0]))&&(0===k(a)||!isFinite(a[1]))};a.equals=function(a,c,f){if(null==a||null==c)return a===c;if(!v(a)||!v(c))return!1;if(f)for(var d=0;d<a.length;d++){if(!f(a[d],c[d]))return!1}else for(d=0;d<a.length;d++)if(a[d]!==c[d])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,
-Infinity,-Infinity];a.ZERO=[0,0,0,0]})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(z,a,w,n,c,f,k){function m(a,b){var c;if(!b)return null;if("x"in b){var f={x:0,y:0};a=a(b.x,b.y,q);f.x=a[0];f.y=a[1];null!=b.z&&(f.z=b.z);null!=b.m&&(f.m=b.m);return f}if("xmin"in b)return f={xmin:0,
ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,q),f.xmin=c[0],f.ymin=c[1],a=a(b.xmax,b.ymax,q),f.xmax=a[0],f.ymax=a[1],b.hasZ&&(f.zmin=b.zmin,f.zmax=b.zmax,f.hasZ=!0),b.hasM&&(f.mmin=b.mmin,f.mmax=b.mmax,f.hasM=!0),f;if("rings"in b)return{rings:v(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:v(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:r(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function v(a,b){for(var c=[],f=0;f<a.length;f++)c.push(r(a[f],b));return c}function r(a,b){for(var c=
[],f=0;f<a.length;f++){var d=a[f],l=b(d[0],d[1],[0,0]);c.push(l);2<d.length&&l.push(d[2]);3<d.length&&l.push(d[3])}return c}function d(a,b){return!f.isValid(a)||!f.isValid(b)||f.equals(a,b)||k.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var q=[0,0];a.checkProjectionSupport=function(a,b){if(!b)return n.resolve();if(Array.isArray(a)){for(var f=0;f<a.length;f++){var l=a[f];if(d(l.geometry&&l.geometry.spatialReference,b))return c.isSupported()?c.load():n.reject(new w("feature-store:unsupported-query",
"projection not supported",{inSpatialReference:a,outSpatialReference:b}))}return n.resolve()}return d(a,b)?c.isSupported()?c.load():n.reject(new w("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b})):n.resolve()};var B=m.bind(null,k.lngLatToXY),t=m.bind(null,k.xyToLngLat);a.project=function(a,b,h){h||(h=b,b=a.spatialReference);return f.isValid(b)&&f.isValid(h)&&!f.equals(b,h)?k.canProject(b,h)?f.isWebMercator(h)?B(a):t(a):c.projectMany([a],b,
h,null,!0)[0]:a};var y=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,c,d){var b=this;a&&a.length&&c&&d&&!f.equals(c,d)||n.resolve(a);var h={geometries:a,inSpatialReference:c,outSpatialReference:d,resolve:null};this._jobs.push(h);return n.create(function(a){h.resolve=a;null===b._timer&&(b._timer=setTimeout(b._process,10))},function(){var a=b._jobs.indexOf(h);-1<a&&b._jobs.splice(a,1)})};a.prototype._process=function(){this._timer=
null;var a=this._jobs.shift();if(a){var h=a.geometries,d=a.inSpatialReference,l=a.outSpatialReference,a=a.resolve;k.canProject(d,l)?f.isWebMercator(l)?a(h.map(B)):a(h.map(t)):a(c.projectMany(h,d,l,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return y.push(a,b,c)}})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/array @dojo/framework/shim/Map @dojo/framework/shim/Set ../../../core/asyncUtils ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/MemCache ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/PromiseQueue".split(" "),
function(z,a,w,n,c,f,k,m,v,r,d,q,B,t,y,l,b,h,p,D,I,J,K,C,F){function S(a,b,c,f,h,d,l,m,k){k||(k=A);l&&!d?f.forEachInBounds(h,function(f){if(!b.has(f.objectId)){var h=C.getCentroid(c,f,m),d=f.attributes;h&&(b.add(f.objectId),a.push(new O(d,null,h,k(f))))}}):d&&!l?f.forEachInBounds(h,function(f){if(!b.has(f.objectId)){var h=f.attributes,d=C.getGeometry(c,f,0,m);d&&(b.add(f.objectId),a.push(new O(h,d,null,k(f))))}}):f.forEachInBounds(h,function(f){if(!b.has(f.objectId)){var h=f.attributes,d=C.getGeometry(c,
f,0,m),l=C.getCentroid(c,f,m);d&&l&&(b.add(f.objectId),a.push(new O(h,d,l,k(f))))}})}Object.defineProperty(a,"__esModule",{value:!0});var A=function(a){return 1},G=r.getLogger("esri.layers.graphics.data.QueryEngine"),O=function(){return function(a,b,c,f){this.attributes=a;this.geometry=b;this.centroid=c;this.filterFlags=f}}(),ha=new f.default,P=new d.Storage(2E6),da=0;z=function(){function a(a){var b=this;this.capabilities={query:D.queryCapabilities};this.fieldsMap=new c.default;this.geometryType=
a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.cacheSpatialQueries=a.cacheSpatialQueries||!1;this.gdbVersion=a.gdbVersion;this.historicMoment=a.historicMoment;this.featureStore=a.featureStore;this.featureStore.setEngine(this);this.timeInfo=a.timeInfo;this.cacheSpatialQueries&&(this._geometryQueryCache=new d(da++ +"$$",P));a.fields.forEach(function(a){b.fieldsMap.set(a.name.trim(),
a);b.fieldsMap.set(a.name.trim().toLowerCase(),a)});a.scheduler&&a.priority&&(this._frameQueue=new F.PromiseQueue,this._frameTask=a.scheduler.registerTask(a.priority,function(a){return b._update(a)},function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this.fieldsMap.clear()};Object.defineProperty(a.prototype,
"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:C.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=K.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a){var b=this;void 0===a&&(a={});var c=v.clone(a);return k.safeCast(C.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).catch(function(a){if(a===
C.QUERY_ENGINE_EMPTY_RESULT)return new I.default([],null,b);throw a;}).then(function(a){return a.createQueryResponse(c)})};a.prototype.executeQueryForCount=function(a){var b=this;void 0===a&&(a={});var c=v.clone(a);c.returnGeometry=!1;c.returnCentroid=!1;c.outSR=null;return k.safeCast(C.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._checkQuerySupport(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){return a.size}).catch(function(a){if(a===
C.QUERY_ENGINE_EMPTY_RESULT)return 0;throw a;})};a.prototype.executeQueryForExtent=function(a){var b=this;void 0===a&&(a={});var c=v.clone(a),f=c.outSR;return k.safeCast(C.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._checkQuerySupport(a)}).then(function(){c.returnGeometry=!0;c.returnCentroid=!1;c.outSR=null;return c}).then(function(a){return b._reschedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){var c=
a.size;if(!c)return{count:c,extent:null};var h={xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:C.cleanFromGeometryEngine(b.spatialReference)};b.featureStore.forEachBounds(a.items,function(a){h.xmin=Math.min(a[0],h.xmin);h.ymin=Math.min(a[1],h.ymin);h.xmax=Math.max(a[2],h.xmax);h.ymax=Math.max(a[3],h.ymax)});a=p.project(h,a.spatialReference,f);a.spatialReference=C.cleanFromGeometryEngine(f||b.spatialReference);
if(0===a.xmax-a.xmin){var d=B.getMetersPerUnitForSR(a.spatialReference);a.xmin-=d;a.xmax+=d}0===a.ymax-a.ymin&&(d=B.getMetersPerUnitForSR(a.spatialReference),a.ymin-=d,a.ymax+=d);return{count:c,extent:a}}).catch(function(a){if(a===C.QUERY_ENGINE_EMPTY_RESULT)return{count:0,extent:null};throw a;})};a.prototype.executeQueryForIds=function(a){void 0===a&&(a={});return this.executeQueryForIdSet(a).then(function(a){return n.from(a)})};a.prototype.executeQueryForIdSet=function(a){var b=this;void 0===a&&
(a={});var c=v.clone(a);c.returnGeometry=!1;c.returnCentroid=!1;c.outSR=null;return k.safeCast(C.normalizeQuery(c,this.definitionExpression,this.spatialReference)).then(function(a){return b._schedule(a)}).then(function(a){return b._executeGeometryQuery(a)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeObjectIdsQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeTimeQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){return a.executeAttributesQuery(c)}).then(function(a){return b._reschedule(a)}).then(function(a){a=
a.items;for(var b=new f.default,c=0;c<a.length;c++)b.add(a[c].objectId);return b}).catch(function(a){if(a===C.QUERY_ENGINE_EMPTY_RESULT)return new f.default;throw a;})};a.prototype.executeTileQuery=function(a,c,h){var d=this;void 0===h&&(h=null);var l=c.returnGeometry,m=c.returnCentroid,k=c.pixelBuffer;c=new f.default;var p=[],k=k*a.resolution,q=t.pad(a.bounds,k,t.create());S(p,c,this,this.featureStore,q,l,m,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]},
h);if("esriGeometryPoint"===this.geometryType||m){var G=b.getInfo(this.spatialReference);if(G){var A=G.valid,G=A[0],A=A[1];if(q[0]<G){var n=t.fromValues(A-k,q[1],A,q[3]);S(p,c,this,this.featureStore,n,l,m,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[A,a.bounds[3]]},h)}q[2]>A&&(k=t.fromValues(G,q[1],G+k,q[3]),S(p,c,this,this.featureStore,k,l,m,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[G-A+a.bounds[0],a.bounds[3]]},h))}}p.sort(function(a,b){return a.attributes[d.objectIdField]-
b.attributes[d.objectIdField]});return{features:p,objectIds:c}};a.prototype.executeTileQueryForIds=function(a,b){a=t.pad(a.bounds,b.pixelBuffer*a.resolution,t.create());var c=[];this.featureStore.forEachInBounds(a,function(a){return c.push(a.objectId)});return c};a.prototype.executeQueryForLatestObservations=function(a){var b=this;if(this.timeInfo)return this.executeQuery(a).then(function(a){return b._filterLatest(a,b.timeInfo)});G.error(new m("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))};
a.prototype._schedule=function(a){return this._frameQueue?this._frameQueue.push(a).then(function(a){return a}):q.resolve(a)};a.prototype._reschedule=function(a){return this._frameQueue?this._frameQueue.push(a).then(function(a){return a}):q.resolve(a)};a.prototype._update=function(a){for(this._budget=a;!a.done&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._filterLatest=function(a,b){var f=b.trackIdField,h=b.startTimeField;b=b.endTimeField||h;for(var h=new c.default,d=
[],l=0,m=a.features;l<m.length;l++){var k=m[l],p=k.attributes[f],q=k.attributes[b];(!h.has(p)||h.get(p).attributes[b]<q)&&h.set(p,k)}h.forEach(function(a){return d.push(a)});return w({},a,{features:d})};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new I.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){var c=this,h=a.geometry,d=a.outSR,l=a.spatialRel,m=b.isValid(d)&&!b.equals(this.spatialReference,
d),k=this.cacheSpatialQueries?m?JSON.stringify({geometry:h,spatialRelationship:l,outSpatialReference:d}):JSON.stringify({geometry:h,spatialRelationship:l}):null;if(k){var p=this._geometryQueryCache.get(k);if(void 0!==p)return q.resolve(p)}var G=function(b){if(m&&(a.returnGeometry||a.returnCentroid))return b.project(d).then(function(a){k&&c._geometryQueryCache.put(k,a,a.size||1);return a});k&&c._geometryQueryCache.put(k,b,b.size||1);return b};if(!h)return q.resolve(this._getAll()).then(function(a){return G(a)});
if("esriSpatialRelDisjoint"===l){p=this._searchFeatures(this._getQueryBBoxes(h));if(!p.length)return q.resolve(this._getAll()).then(function(a){return G(a)});var A,n;return this._reschedule(p).then(function(a){return new f.default(a)}).then(function(a){return c._reschedule(a)}).then(function(a){var b=0;A=Array(a.size);c.featureStore.forEach(function(a){return A[b++]=a});n=a}).then(function(){return c._reschedule()}).then(function(){return J.getSpatialQueryOperator(l,h,c)}).then(function(a){return c._runSpatialFilter(A,
function(b){return!n.has(b)||a(b.geometry)}).then(function(a){return new I.default(a,h,c)}).then(function(a){return G(a)})})}var v=this._searchFeatures(this._getQueryBBoxes(h));return v.length?this._canExecuteSoloPass(h,a)?q.resolve(new I.default(v,h,this)).then(function(a){return G(a)}):J.getSpatialQueryOperator(l,h,this).then(function(a){return c._runSpatialFilter(v,function(b){return a(b.geometry)})}).then(function(a){return new I.default(a,h,c)}).then(function(a){return G(a)}):(p=new I.default([],
h,this),k&&this._geometryQueryCache.put(k,p,p.size||1),q.resolve(p))};a.prototype._runSpatialFilter=function(a,b){var c=this;if(!b)return q.resolve(a);if(!this._budget)return q.resolve(a.filter(function(a){return b(a)}));var f=0,h=[],d=function(){for(;f<a.length;){var l=a[f];b(l)&&h.push(l);if(c._budget.done)return c._reschedule().then(function(){return d()});++f}return q.resolve()};return this._reschedule().then(function(){return d()}).then(function(){return h})};a.prototype._canExecuteSoloPass=
function(a,b){var c=this.geometryType;b=b.spatialRel;return J.canQueryWithRBush(a)&&("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(J.canQueryWithRBush(a)){if(l.isExtent(a))return[t.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(l.isPolygon(a))return a.rings.map(function(a){return t.fromValues(a[0][0],a[0][1],a[2][0],a[2][1])})}return[y.getBoundsXY(t.create(),
a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){ha.add(a)});var c=Array(ha.size),f=0;ha.forEach(function(a){return c[f++]=a});ha.clear();return c};a.prototype._checkQuerySupport=function(a){return 0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text?q.reject(new m("feature-store:unsupported-query","Unsupported query options",{query:a})):q.all([this._checkAttributesQuerySupport(a),
this._checkStatisticsQuerySupport(a),J.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),p.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,f=a.returnDistinctValues;c&&0<c.length&&(c=c.map(function(a){return-1<a.indexOf(" ASC")?a.split(" ASC")[0]:-1<a.indexOf(" DESC")?a.split(" DESC")[0]:a}),h.validateFields(this.fieldsMap,c,"orderByFields contains missing fields"));
if(b&&0<b.length)h.validateFields(this.fieldsMap,b,"outFields contains missing fields");else if(f)throw new m("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});h.validateWhere(this.fieldsMap,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){var b=a.outStatistics,c=a.groupByFieldsForStatistics,f=a.having,d=c&&c.length,l=b&&b.length;if(f){if(!d||!l)return q.reject(new m("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",
{query:a}));h.validateHaving(this.fieldsMap,f,b)}if(l&&!b.some(function(a){return"exceedslimit"===a.statisticType}))for(f=b.map(function(a){return a.onStatisticField}),h.validateFields(this.fieldsMap,f,"onStatisticFields contains missing fields"),d&&h.validateFields(this.fieldsMap,c,"groupByFieldsForStatistics contains missing fields"),c=0;c<b.length;c++){var f=b[c],l=f.onStatisticField,k=f.statisticType;if("exceedslimit"===k)return q.reject(new m("feature-store:unsupported-query","statistic type exceedslimit is not supported",
{definition:f,query:a}));if((!d||"count"!==k)&&l&&h.hasInvalidFieldType(l,this.fieldsMap))return q.reject(new m("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:a}))}};return a}();a.default=z})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports @dojo/framework/shim/Set ../../../core/Error ../../../core/ItemCache ../../../core/sql/WhereClause".split(" "),function(z,a,w,n,c,f){function k(c){if(!c)return null;var d=a.invalidClauseCache.get(c);
if(void 0!==d)return d;d=a.whereClausesCache.get(c);if(void 0!==d)return d;d=f.create(c);a.whereClausesCache.put(c,d);return d}function m(a,c,f,r){void 0===r&&(r=!0);for(var d=[],l=0;l<c.length;l++){var b=c[l];if("*"!==b&&!a.has(b))if(r){var h=v(b);try{var p=k(h);if(!p.isStandardized())throw new n("feature-store:unsupported-query","expression is not standard",{clause:p});m(a,p.getFields(),"expression contains missing fields")}catch(D){if((h=D&&D.details)&&h.clause)throw D;h&&h.missingFields?Array.prototype.push.apply(d,
h.missingFields):d.push(b)}}else d.push(b)}if(d.length)throw new n("feature-store:unsupported-query",f,{missingFields:d});}function v(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});a.invalidClauseCache=new c(500);a.whereClausesCache=new c(50);var r=new w.default("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(c,k){if(!k)return!0;var d;try{d=
f.create(k),a.whereClausesCache.put(k,d)}catch(t){throw a.invalidClauseCache.put(k,null),new n("feature-store:unsupported-query","invalid SQL expression",{where:k});}if(!d.isStandardized())throw new n("feature-store:unsupported-query","where clause is not standard",{where:k});k=d.getFields();m(c,k,"where clause contains missing fields");return!0};a.validateHaving=function(c,k,v){if(!k)return!0;var d;try{d=f.create(k),a.whereClausesCache.put(k,d)}catch(l){throw a.invalidClauseCache.put(k,null),new n("feature-store:unsupported-query",
"invalid SQL expression",{having:k});}if(!d.isAggregate())throw new n("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:k});var q=d.getFields();m(c,q,"having contains missing fields");if(!d.getExpressions().every(function(a){var b=a.aggregateType;a=a.field;var f=c.has(a)&&c.get(a).name;return v.some(function(a){var h=a.statisticType;a=a.onStatisticField.toLowerCase().trim();return(c.has(a)&&c.get(a).name)===f&&h.toLowerCase().trim()===b})}))throw new n("feature-store:unsupported-query",
"expressions in having should also exist in outStatistics",{having:k});return!0};a.getWhereClause=k;a.validateFields=m;a.getExpressionFromFieldName=v;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,c){var f=!1;-1!==k(a).getFields().indexOf(a)&&(a=c.get(a),f=!r.has(a.type));return f}})},"esri/core/sql/WhereClause":function(){define("require exports @dojo/framework/shim/array @dojo/framework/shim/Map ../../moment ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),
function(z,a,w,n,c,f,k,m){function v(a){return Array.isArray(a)?a:[a]}function r(a){return null!==a?!0!==a:null}function d(a,b){if(null==a)return null;for(var c=!1,f=0;f<b.length;f++){var d=b[f];if(null==d)c=null;else if(a===d){c=!0;break}}return c}function q(a,b,c){if(null==a)return null;for(var f="",h=0,d=0;d<b.length;d++){var l=b.charAt(d);switch(h){case 0:l===c?h=1:f=0<="-[]/{}()*+?.\\^$|".indexOf(l)?f+("\\"+l):"%"===l?f+".*":"_"===l?f+".":f+l;break;case 1:f=0<="-[]/{}()*+?.\\^$|".indexOf(l)?
f+("\\"+l):f+l,h=0}}return(new RegExp("^"+f+"$")).test(a)}function B(a){return a instanceof Date?a.valueOf():a}function t(a,b,c){if(null==b||null==c)return null;b=B(b);c=B(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function y(a){for(var b=[],c={},f=0;f<a.length;f++){var d=a[f],l=d.toLowerCase();void 0===c[l]&&(b.push(d),c[l]=1)}return b}return function(){function a(){this._hasAggregateFunctions=
this._hasStandardizedFunctions=this.parameters=this.parseTree=null}a.create=function(b){var c=new a;c.parseTree=m.WhereGrammar.parse(b);var d=!0,l=!0;c.visitAll(c.parseTree,function(a){if("function"===a.type){var b=a.name;a=a.args.value.length;d&&(d=k.isStandardized(b,a));l&&(l=f.isAggregate(b,a))}});c._hasStandardizedFunctions=d;c._hasAggregateFunctions=l;return c};a.prototype.isStandardized=function(){return this._hasStandardizedFunctions};a.prototype.isAggregate=function(){return this._hasAggregateFunctions};
a.prototype.setVariablesDictionary=function(a){this.parameters=a};a.prototype.testFeature=function(a){return!!this.evaluateNode(this.parseTree,a)};a.prototype.testSet=function(a){var b=this,c=new n.default;this.visitAll(this.parseTree,function(a){"column_ref"!==a.type||c.has(a.column)||c.set(a.column,a)});for(var f={},d=function(a){c.forEach(function(c,d){c=b.featureValue(a,d,c);f[d]?f[d].push(c):f[d]=[c]})},l=0;l<a.length;l++)d(a[l]);return!!this.evaluateNode(this.parseTree,{attributes:f})};a.prototype.calculateValue=
function(a){return this.evaluateNode(this.parseTree,a)};a.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return y(a)};a.prototype.getExpressions=function(){var a=new n.default;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var f=c+"-"+b;a.has(f)||a.set(f,{aggregateType:c,field:b})}}});return w.from(a.values())};
a.prototype.getFields=function(){var a=[];this.visitAll(this.parseTree,function(b){"column_ref"===b.type&&a.push(b.column)});return y(a)};a.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return y(a)};a.prototype.featureValue=function(a,c,f){a=a&&"object"===typeof a.attributes?a.attributes:a;var b=a[c];if(void 0!==b)return b;for(var d in a)if(c.toLowerCase()===d.toLowerCase())return f.column=d,a[d];return null};
a.prototype.visitAll=function(a,c){if(null!=a)switch(c(a),a.type){case "when_clause":this.visitAll(a.operand,c);this.visitAll(a.value,c);break;case "case_expression":for(var b=0,f=a.clauses;b<f.length;b++){var d=f[b];this.visitAll(d,c)}"simple"===a.format&&this.visitAll(a.operand,c);null!==a.else&&this.visitAll(a.else,c);break;case "expr_list":b=0;for(a=a.value;b<a.length;b++)d=a[b],this.visitAll(d,c);break;case "unary_expr":this.visitAll(a.expr,c);break;case "binary_expr":this.visitAll(a.left,c);
this.visitAll(a.right,c);break;case "function":this.visitAll(a.args,c)}};a.prototype.evaluateNode=function(a,h){switch(a.type){case "case_expression":if("simple"===a.format)for(var b=B(this.evaluateNode(a.operand,h)),l=0;l<a.clauses.length;l++){if(b===B(this.evaluateNode(a.clauses[l].operand,h)))return this.evaluateNode(a.clauses[l].value,h)}else for(l=0;l<a.clauses.length;l++)if(!0===this.evaluateNode(a.clauses[l].operand,h))return this.evaluateNode(a.clauses[l].value,h);return null!==a.else?this.evaluateNode(a.else,
h):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":b=[];l=0;for(a=a.value;l<a.length;l++){var m=a[l];b.push(this.evaluateNode(m,h))}return b;case "unary_expr":return r(this.evaluateNode(a.expr,h));case "binary_expr":switch(a.operator){case "AND":return b=this.evaluateNode(a.left,h),h=this.evaluateNode(a.right,h),null!=b&&null!=h?!0===b&&!0===h:!1===b||!1===h?!1:null;case "OR":return b=this.evaluateNode(a.left,h),h=this.evaluateNode(a.right,h),null!=b&&null!=h?!0===
b||!0===h:!0===b||!0===h?!0:null;case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,h);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,h);case "IN":return b=v(this.evaluateNode(a.right,h)),d(this.evaluateNode(a.left,h),b);case "NOT IN":return b=v(this.evaluateNode(a.right,h)),r(d(this.evaluateNode(a.left,h),b));case "BETWEEN":return b=this.evaluateNode(a.left,h),h=this.evaluateNode(a.right,
h),null==b||null==h[0]||null==h[1]?null:b>=h[0]&&b<=h[1];case "NOTBETWEEN":return b=this.evaluateNode(a.left,h),h=this.evaluateNode(a.right,h),null==b||null==h[0]||null==h[1]?null:b<h[0]||b>h[1];case "LIKE":return q(this.evaluateNode(a.left,h),this.evaluateNode(a.right,h),a.escape);case "NOT LIKE":return r(q(this.evaluateNode(a.left,h),this.evaluateNode(a.right,h),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return t(a.operator,this.evaluateNode(a.left,
h),this.evaluateNode(a.right,h));case "*":return this.evaluateNode(a.left,h)*this.evaluateNode(a.right,h);case "-":return this.evaluateNode(a.left,h)-this.evaluateNode(a.right,h);case "+":return this.evaluateNode(a.left,h)+this.evaluateNode(a.right,h);case "/":return this.evaluateNode(a.left,h)/this.evaluateNode(a.right,h)}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return c(a.value,["YYYY-M-D"]).toDate();case "timestamp":return c(a.value,
["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate();case "column_ref":return"CURRENT_DATE"===a.column.toUpperCase()?(m=new Date,m.setHours(0,0,0,0),m):"CURRENT_TIMESTAMP"===a.column.toUpperCase()?new Date:this.featureValue(h,a.column,a);case "function":return h=this.evaluateNode(a.args,h),this.isAggregate()?f.aggregateFunction(a.name,h):k.evaluateFunction(a.name,h)}throw Error("Unsupported sql syntax "+a.type);};return a}()})},"esri/core/sql/AggregateFunctions":function(){define(["require",
"exports"],function(z,a){function w(a){for(var c=0,f=0;f<a.length;f++)c+=a[f];return c/a.length}function n(a){for(var c=w(a),f=a.length,n=0,r=0;r<a.length;r++)n+=Math.pow(a[r]-c,2);return 1<f?n/(f-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,k){var f=c[a.toLowerCase()];if(null==f)throw Error("Function Not Recognised");if(k.length<f.minParams||k.length>f.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return f.evaluate(k)};a.isAggregate=
function(a,k){a=c[a.toLowerCase()];return null!=a&&k>=a.minParams&&k<=a.maxParams};var c={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:w(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var c=0,f=0;f<a.length;f++)c+=a[f];a=c}return a}},
stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(n(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:n(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","dojo/regexp"],function(z,a,w){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateFunction=function(a,f){var c=n[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");
if(f.length<c.minParams||f.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(f)};a.isStandardized=function(a,f){a=n[a.toLowerCase()];return null!=a&&f>=a.minParams&&f<=a.maxParams};var n={extract:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(c.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();
case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var c=a[0],k=a[1];return null==c||null==k?null:c.toString().substring(k-1)}if(3===a.length)return c=a[0],k=a[1],a=a[2],null==c||null==k||null==a?null:0>=a?"":c.toString().substring(k-1,k+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var c=a[0];a=a[1];return null==c||null==a?null:a.indexOf(c)+
1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var c=3===a.length,k=c?a[1]:" ",c=c?a[2]:a[1];if(null==k||null==c)return null;k="("+w.escapeString(k)+")";switch(a[0]){case "BOTH":return c.replace(new RegExp("^"+k+"*|"+k+"*$","g"),"");case "LEADING":return c.replace(new RegExp("^"+k+"*","g"),"");case "TRAILING":return c.replace(new RegExp(k+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},
ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:
0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var c=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==c?null:Math.round(c*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},
char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var c="",k=0;k<a.length;k++){if(null==a[k])return null;c+=a[k].toString()}return c}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require",
"exports","./sql92grammar"],function(z,a,w){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(){}a.parse=function(a){return w.parse(a)};return a}();a.WhereGrammar=z})},"esri/core/sql/sql92grammar":function(){define([],function(){function z(a,w,n,c){this.message=a;this.expected=w;this.found=n;this.location=c;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,z)}(function(a,w){function n(){this.constructor=a}n.prototype=w.prototype;
a.prototype=new n})(z,Error);z.buildMessage=function(a,w){function n(a){return a.charCodeAt(0).toString(16).toUpperCase()}function c(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}function f(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,
"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+n(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+n(a)})}var k={literal:function(a){return'"'+c(a.text)+'"'},"class":function(a){var c="",k;for(k=0;k<a.parts.length;k++)c+=a.parts[k]instanceof Array?f(a.parts[k][0])+"-"+f(a.parts[k][1]):f(a.parts[k]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};
return"Expected "+function(a){var c=Array(a.length),f;for(f=0;f<a.length;f++){var d=f,m;m=a[f];m=k[m.type](m);c[d]=m}c.sort();if(0<c.length){for(a=f=1;f<c.length;f++)c[f-1]!==c[f]&&(c[a]=c[f],a++);c.length=a}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(a)+" but "+(w?'"'+c(w)+'"':"end of input")+" found."};return{SyntaxError:z,parse:function(a,w){function n(a,e){return{type:"literal",text:a,ignoreCase:e}}function c(a,
e,b){return{type:"class",parts:a,inverted:e,ignoreCase:b}}function f(e){var b=va[e],g;if(!b){for(g=e-1;!va[g];)g--;b=va[g];for(b={line:b.line,column:b.column};g<e;)10===a.charCodeAt(g)?(b.line++,b.column=1):b.column++,g++;va[e]=b}return b}function k(a,e){var b=f(a),g=f(e);return{start:{offset:a,line:b.line,column:b.column},end:{offset:e,line:g.line,column:g.column}}}function m(a){g<U||(g>U&&(U=g,wa=[]),wa.push(a))}function v(){var a,b,c;a=g;b=x();b!==e?(b=d(),b!==e?(c=x(),c!==e?a=b:(g=a,a=e)):(g=
a,a=e)):(g=a,a=e);return a}function r(){var a,b,c,f,h,l,k,m;a=g;b=d();if(b!==e){c=[];f=g;h=x();h!==e?(l=Ua(),l!==e?(k=x(),k!==e?(m=d(),m!==e?f=h=[h,l,k,m]:(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e);for(;f!==e;)c.push(f),f=g,h=x(),h!==e?(l=Ua(),l!==e?(k=x(),k!==e?(m=d(),m!==e?f=h=[h,l,k,m]:(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e);if(c!==e){a={type:"expr_list"};b=[b];for(f=0;f<c.length;f++)b.push(c[f][3]);a.value=b}else g=a,a=e}else g=a,a=e;return a}function d(){var a,b,c,f,d,h,l,k;a=g;b=q();if(b!==
e){c=[];f=g;d=x();d!==e?(h=ua(),h!==e?(l=x(),l!==e?(k=q(),k!==e?f=d=[d,h,l,k]:(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e);for(;f!==e;)c.push(f),f=g,d=x(),d!==e?(h=ua(),h!==e?(l=x(),l!==e?(k=q(),k!==e?f=d=[d,h,l,k]:(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e);c!==e?a=b=ea(b,c):(g=a,a=e)}else g=a,a=e;return a}function q(){var a,b,c,f,d,h,l,k;a=g;b=B();if(b!==e){c=[];f=g;d=x();d!==e?(h=ta(),h!==e?(l=x(),l!==e?(k=B(),k!==e?f=d=[d,h,l,k]:(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e);for(;f!==e;)c.push(f),f=
g,d=x(),d!==e?(h=ta(),h!==e?(l=x(),l!==e?(k=B(),k!==e?f=d=[d,h,l,k]:(g=f,f=e)):(g=f,f=e)):(g=f,f=e)):(g=f,f=e);c!==e?a=b=ea(b,c):(g=a,a=e)}else g=a,a=e;return a}function B(){var c,f,d,h,k;c=g;f=pa();f===e&&(f=g,33===a.charCodeAt(g)?(d=dd,g++):(d=e,0===u&&m(ed)),d!==e?(h=g,u++,61===a.charCodeAt(g)?(k=Va,g++):(k=e,0===u&&m(Wa)),u--,k===e?h=void 0:(g=h,h=e),h!==e?f=d=[d,h]:(g=f,f=e)):(g=f,f=e));f!==e?(d=x(),d!==e?(h=B(),h!==e?c=f={type:"unary_expr",operator:"NOT",expr:h}:(g=c,c=e)):(g=c,c=e)):(g=c,c=
e);if(c===e)if(c=g,f=b(),f!==e)if(d=x(),d!==e){var A,p,n;d=[];h=g;k=x();k!==e?(A=t(),A!==e?(p=x(),p!==e?(n=b(),n!==e?h=k=[k,A,p,n]:(g=h,h=e)):(g=h,h=e)):(g=h,h=e)):(g=h,h=e);if(h!==e)for(;h!==e;)d.push(h),h=g,k=x(),k!==e?(A=t(),A!==e?(p=x(),p!==e?(n=b(),n!==e?h=k=[k,A,p,n]:(g=h,h=e)):(g=h,h=e)):(g=h,h=e)):(g=h,h=e);else d=e;d!==e&&(d={type:"arithmetic",tail:d});d===e&&(d=g,h=l(),h!==e?(k=x(),k!==e?(k=ia(),k!==e?(k=x(),k!==e?(k=r(),k!==e?(A=x(),A!==e?(A=ja(),A!==e?d=h={op:h,right:k}:(g=d,d=e)):(g=
d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,h=l(),h!==e?(k=x(),k!==e?(k=ia(),k!==e?(k=x(),k!==e?(k=ja(),k!==e?d=h={op:h,right:{type:"expr_list",value:[]}}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,h=l(),h!==e?(k=x(),k!==e?(k=S(),k!==e?d=h={op:h,right:k}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e))),d===e&&(d=g,k=pa(),k!==e?(h=x(),h!==e?(h=M(),h!==e?(A=x(),A!==e?(A=b(),A!==e?(p=x(),p!==e?(p=ta(),p!==e?(k=x(),k!==e?(k=b(),k!==e?d=k={op:"NOT"+h,right:{type:"expr_list",
value:[A,k]}}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,k=M(),k!==e?(h=x(),h!==e?(h=b(),h!==e?(A=x(),A!==e?(A=ta(),A!==e?(p=x(),p!==e?(p=b(),p!==e?d=k={op:k,right:{type:"expr_list",value:[h,p]}}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)),d===e&&(d=g,h=oa(),h!==e?(k=x(),k!==e?(k=pa(),k!==e?(k=x(),k!==e?(k=b(),k!==e?d=h={op:h+"NOT",right:k}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===
e&&(d=g,h=oa(),h!==e?(k=x(),k!==e?(k=b(),k!==e?d=h={op:h,right:k}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)),d===e&&(d=g,h=y(),h!==e?(k=x(),k!==e?(k=G(),k!==e?(A=x(),A!==e?(A=g,a.substr(g,6).toLowerCase()===fd?(p=a.substr(g,6),g+=6):(p=e,0===u&&m(gd)),p!==e?(p=g,u++,n=C(),u--,n===e?p=void 0:(g=p,p=e),p!==e?A="ESCAPE":(g=A,A=e)):(g=A,A=e),A!==e?(A=x(),A!==e?(A=O(),A!==e?d=h={op:h,right:k,escape:A.value}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e),d===e&&(d=g,h=y(),h!==e?(k=x(),
k!==e?(k=G(),k!==e?d=h={op:h,right:k,escape:""}:(g=d,d=e)):(g=d,d=e)):(g=d,d=e))))));d===e&&(d=null);d!==e?(c=f,f=d,""==f||void 0==f||null==f?f=c:(d=null,f=d="arithmetic"==f.type?ea(c,f.tail):Xa(f.op,c,f.right,f.escape)),c=f):(g=c,c=e)}else g=c,c=e;else g=c,c=e;return c}function t(){var b;a.substr(g,2)===Ya?(b=Ya,g+=2):(b=e,0===u&&m(hd));b===e&&(62===a.charCodeAt(g)?(b=id,g++):(b=e,0===u&&m(jd)),b===e&&(a.substr(g,2)===Za?(b=Za,g+=2):(b=e,0===u&&m(kd)),b===e&&(a.substr(g,2)===$a?(b=$a,g+=2):(b=e,
0===u&&m(ld)),b===e&&(60===a.charCodeAt(g)?(b=md,g++):(b=e,0===u&&m(nd)),b===e&&(61===a.charCodeAt(g)?(b=Va,g++):(b=e,0===u&&m(Wa)),b===e&&(a.substr(g,2)===ab?(b=ab,g+=2):(b=e,0===u&&m(od))))))));return b}function y(){var a,b,c,d;a=a=g;b=pa();b!==e?(c=x(),c!==e?(d=ga(),d!==e?a=b=[b,c,d]:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=ga());return a}function l(){var a,b,c,d;a=a=g;b=pa();b!==e?(c=x(),c!==e?(d=jc(),d!==e?a=b=[b,c,d]:(g=a,a=e)):(g=a,a=e)):(g=a,a=e);a!==e&&(a=a[0]+" "+
a[2]);a===e&&(a=jc());return a}function b(){var a,b,c,d,f,k,l,m;a=g;b=p();if(b!==e){c=[];d=g;f=x();f!==e?(k=h(),k!==e?(l=x(),l!==e?(m=p(),m!==e?d=f=[f,k,l,m]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);for(;d!==e;)c.push(d),d=g,f=x(),f!==e?(k=h(),k!==e?(l=x(),l!==e?(m=p(),m!==e?d=f=[f,k,l,m]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);c!==e?a=b=ea(b,c):(g=a,a=e)}else g=a,a=e;return a}function h(){var b;43===a.charCodeAt(g)?(b=bb,g++):(b=e,0===u&&m(cb));b===e&&(45===a.charCodeAt(g)?(b=db,g++):(b=e,0===
u&&m(eb)));return b}function p(){var a,b,c,d,f,h,k,l;a=g;b=I();if(b!==e){c=[];d=g;f=x();f!==e?(h=D(),h!==e?(k=x(),k!==e?(l=I(),l!==e?d=f=[f,h,k,l]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);for(;d!==e;)c.push(d),d=g,f=x(),f!==e?(h=D(),h!==e?(k=x(),k!==e?(l=I(),l!==e?d=f=[f,h,k,l]:(g=d,d=e)):(g=d,d=e)):(g=d,d=e)):(g=d,d=e);c!==e?a=b=ea(b,c):(g=a,a=e)}else g=a,a=e;return a}function D(){var b;42===a.charCodeAt(g)?(b=pd,g++):(b=e,0===u&&m(qd));b===e&&(47===a.charCodeAt(g)?(b=rd,g++):(b=e,0===u&&m(sd)));
return b}function I(){var b,c,f,h,k,l,p;p=O();if(p===e){var n,q,v,D;n=g;var t,y,I,w;t=g;y=Hb();y!==e?(I=zc(),I!==e?(w=ma(),w!==e?t=y=parseFloat(y+I+w):(g=t,t=e)):(g=t,t=e)):(g=t,t=e);t===e&&(t=g,y=Hb(),y!==e?(I=zc(),I!==e?t=y=parseFloat(y+I):(g=t,t=e)):(g=t,t=e),t===e&&(t=g,y=Hb(),y!==e?(I=ma(),I!==e?t=y=parseFloat(y+I):(g=t,t=e)):(g=t,t=e),t===e&&(t=g,y=Hb(),y!==e&&(y=parseFloat(y)),t=y)));q=t;q!==e?(v=g,u++,D=K(),u--,D===e?v=void 0:(g=v,v=e),v!==e?n=q={type:"number",value:q}:(g=n,n=e)):(g=n,n=e);
p=n;if(p===e){var B,X;B=g;var z,na,ga,pa;z=g;a.substr(g,4).toLowerCase()===td?(na=a.substr(g,4),g+=4):(na=e,0===u&&m(ud));na!==e?(ga=g,u++,pa=C(),u--,pa===e?ga=void 0:(g=ga,ga=e),ga!==e?z=na=[na,ga]:(g=z,z=e)):(g=z,z=e);X=z;X!==e&&(X={type:"bool",value:!0});B=X;if(B===e){B=g;var M,oa,U,ta;M=g;a.substr(g,5).toLowerCase()===vd?(oa=a.substr(g,5),g+=5):(oa=e,0===u&&m(wd));oa!==e?(U=g,u++,ta=C(),u--,ta===e?U=void 0:(g=U,U=e),U!==e?M=oa=[oa,U]:(g=M,M=e)):(g=M,M=e);X=M;X!==e&&(X={type:"bool",value:!1});
B=X}p=B;if(p===e){var ua,xa,ea,Ma,va;xa=g;a.substr(g,4).toLowerCase()===xd?(ea=a.substr(g,4),g+=4):(ea=e,0===u&&m(yd));ea!==e?(Ma=g,u++,va=C(),u--,va===e?Ma=void 0:(g=Ma,Ma=e),Ma!==e?xa=ea=[ea,Ma]:(g=xa,xa=e)):(g=xa,xa=e);ua=xa;ua!==e&&(ua={type:"null",value:null});p=ua;if(p===e){var ka,sa,La,wa;ka=g;var ya,Jb,fb,Ua;ya=g;a.substr(g,4).toLowerCase()===zd?(Jb=a.substr(g,4),g+=4):(Jb=e,0===u&&m(Ad));Jb!==e?(fb=g,u++,Ua=C(),u--,Ua===e?fb=void 0:(g=fb,fb=e),fb!==e?ya=Jb="DATE":(g=ya,ya=e)):(g=ya,ya=e);
sa=ya;sa!==e?(La=x(),La!==e?(wa=G(),wa!==e?ka=sa={type:"date",value:wa.value}:(g=ka,ka=e)):(g=ka,ka=e)):(g=ka,ka=e);p=ka;if(p===e){var la,lc,Va,mc;la=g;var za,Kb,gb,Wa;za=g;a.substr(g,9).toLowerCase()===Bd?(Kb=a.substr(g,9),g+=9):(Kb=e,0===u&&m(Cd));Kb!==e?(gb=g,u++,Wa=C(),u--,Wa===e?gb=void 0:(g=gb,gb=e),gb!==e?za=Kb="TIMESTAMP":(g=za,za=e)):(g=za,za=e);lc=za;lc!==e?(Va=x(),Va!==e?(mc=G(),mc!==e?la=lc={type:"timestamp",value:mc.value}:(g=la,la=e)):(g=la,la=e)):(g=la,la=e);p=la}}}}}b=p;if(b===e){var Q,
nc,Xa,Ya,Za,oc,$a,ab,bb,pc,cb,db;Q=g;var Aa,Lb,hb,eb;Aa=g;a.substr(g,7).toLowerCase()===Dd?(Lb=a.substr(g,7),g+=7):(Lb=e,0===u&&m(Ed));Lb!==e?(hb=g,u++,eb=C(),u--,eb===e?hb=void 0:(g=hb,hb=e),hb!==e?Aa=Lb="EXTRACT":(g=Aa,Aa=e)):(g=Aa,Aa=e);nc=Aa;if(nc!==e)if(Xa=x(),Xa!==e)if(Ya=ia(),Ya!==e)if(Za=x(),Za!==e){var Y,Ba,Mb,ib,wb;Ba=g;a.substr(g,4).toLowerCase()===Fd?(Mb=a.substr(g,4),g+=4):(Mb=e,0===u&&m(Gd));Mb!==e?(ib=g,u++,wb=C(),u--,wb===e?ib=void 0:(g=ib,ib=e),ib!==e?Ba=Mb="YEAR":(g=Ba,Ba=e)):(g=
Ba,Ba=e);Y=Ba;if(Y===e){var Ca,Nb,jb,xb;Ca=g;a.substr(g,5).toLowerCase()===Hd?(Nb=a.substr(g,5),g+=5):(Nb=e,0===u&&m(Id));Nb!==e?(jb=g,u++,xb=C(),u--,xb===e?jb=void 0:(g=jb,jb=e),jb!==e?Ca=Nb="MONTH":(g=Ca,Ca=e)):(g=Ca,Ca=e);Y=Ca;if(Y===e){var Da,Ob,kb,yb;Da=g;a.substr(g,3).toLowerCase()===Jd?(Ob=a.substr(g,3),g+=3):(Ob=e,0===u&&m(Kd));Ob!==e?(kb=g,u++,yb=C(),u--,yb===e?kb=void 0:(g=kb,kb=e),kb!==e?Da=Ob="DAY":(g=Da,Da=e)):(g=Da,Da=e);Y=Da;if(Y===e){var Ea,Pb,lb,zb;Ea=g;a.substr(g,4).toLowerCase()===
Ld?(Pb=a.substr(g,4),g+=4):(Pb=e,0===u&&m(Md));Pb!==e?(lb=g,u++,zb=C(),u--,zb===e?lb=void 0:(g=lb,lb=e),lb!==e?Ea=Pb="HOUR":(g=Ea,Ea=e)):(g=Ea,Ea=e);Y=Ea;if(Y===e){var Fa,Qb,mb,Ab;Fa=g;a.substr(g,6).toLowerCase()===Nd?(Qb=a.substr(g,6),g+=6):(Qb=e,0===u&&m(Od));Qb!==e?(mb=g,u++,Ab=C(),u--,Ab===e?mb=void 0:(g=mb,mb=e),mb!==e?Fa=Qb="MINUTE":(g=Fa,Fa=e)):(g=Fa,Fa=e);Y=Fa;if(Y===e){var Ga,Rb,nb,Bb;Ga=g;a.substr(g,6).toLowerCase()===Pd?(Rb=a.substr(g,6),g+=6):(Rb=e,0===u&&m(Qd));Rb!==e?(nb=g,u++,Bb=C(),
u--,Bb===e?nb=void 0:(g=nb,nb=e),nb!==e?Ga=Rb="SECOND":(g=Ga,Ga=e)):(g=Ga,Ga=e);Y=Ga}}}}}oc=Y;oc!==e?($a=x(),$a!==e?(ab=kc(),ab!==e?(bb=x(),bb!==e?(pc=d(),pc!==e?(cb=x(),cb!==e?(db=ja(),db!==e?Q=nc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:oc},pc]}}:(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)):(g=Q,Q=e)}else g=Q,Q=e;else g=Q,Q=e;else g=Q,Q=e;else g=Q,Q=e;b=Q;if(b===e){var N,qc,Cb,Db,Eb,Sb,Fb,Gb,Bc,Tb,Cc,W,Na,rc,sc,tc;N=g;var Ha,Ub,ob,Dc;
Ha=g;a.substr(g,9).toLowerCase()===Rd?(Ub=a.substr(g,9),g+=9):(Ub=e,0===u&&m(Sd));Ub!==e?(ob=g,u++,Dc=C(),u--,Dc===e?ob=void 0:(g=ob,ob=e),ob!==e?Ha=Ub="SUBSTRING":(g=Ha,Ha=e)):(g=Ha,Ha=e);qc=Ha;if(qc!==e)if(Cb=x(),Cb!==e)if(Db=ia(),Db!==e)if(Eb=x(),Eb!==e)if(Sb=d(),Sb!==e)if(Fb=x(),Fb!==e)if(Gb=kc(),Gb!==e)if(Bc=x(),Bc!==e)if(Tb=d(),Tb!==e)if(Cc=x(),Cc!==e){W=g;var Ia,Vb,pb,Ec;Ia=g;a.substr(g,3).toLowerCase()===Td?(Vb=a.substr(g,3),g+=3):(Vb=e,0===u&&m(Ud));Vb!==e?(pb=g,u++,Ec=C(),u--,Ec===e?pb=
void 0:(g=pb,pb=e),pb!==e?Ia=Vb="FOR":(g=Ia,Ia=e)):(g=Ia,Ia=e);Na=Ia;Na!==e?(rc=x(),rc!==e?(sc=d(),sc!==e?(tc=x(),tc!==e?W=Na=[Na,rc,sc,tc]:(g=W,W=e)):(g=W,W=e)):(g=W,W=e)):(g=W,W=e);W===e&&(W=null);W!==e?(Na=ja(),Na!==e?N=qc={type:"function",name:"substring",args:{type:"expr_list",value:W?[Sb,Tb,W[2]]:[Sb,Tb]}}:(g=N,N=e)):(g=N,N=e)}else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;else g=N,N=e;b=N;if(b===e){var E,Oa,Wb,Xb,Yb,Z,Zb,
Pa,$b,ac,Fc,uc,Gc,Hc;E=g;Oa=Ac();Oa!==e?(Wb=x(),Wb!==e?(Xb=ia(),Xb!==e?(Yb=x(),Yb!==e?(Z=A(),Z===e&&(Z=null),Z!==e?(Zb=x(),Zb!==e?(Pa=d(),Pa!==e?($b=x(),$b!==e?(ac=kc(),ac!==e?(Fc=x(),Fc!==e?(uc=d(),uc!==e?(Gc=x(),Gc!==e?(Hc=ja(),Hc!==e?E=Oa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Z?"BOTH":Z},Pa,uc]}}:(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e);E===e&&(E=
g,Oa=Ac(),Oa!==e?(Wb=x(),Wb!==e?(Xb=ia(),Xb!==e?(Yb=x(),Yb!==e?(Z=A(),Z===e&&(Z=null),Z!==e?(Zb=x(),Zb!==e?(Pa=d(),Pa!==e?($b=x(),$b!==e?(ac=ja(),ac!==e?E=Oa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Z?"BOTH":Z},Pa]}}:(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e)):(g=E,E=e));b=E;if(b===e){var R,vc,Ic,Jc,Kc,wc,Lc,Mc,Nc,xc,Oc,Pc;R=g;var Ja,bc,qb,Qc;Ja=g;a.substr(g,8).toLowerCase()===Vd?(bc=a.substr(g,8),g+=8):(bc=e,
0===u&&m(Wd));bc!==e?(qb=g,u++,Qc=C(),u--,Qc===e?qb=void 0:(g=qb,qb=e),qb!==e?Ja=bc="POSITION":(g=Ja,Ja=e)):(g=Ja,Ja=e);vc=Ja;vc!==e?(Ic=x(),Ic!==e?(Jc=ia(),Jc!==e?(Kc=x(),Kc!==e?(wc=d(),wc!==e?(Lc=x(),Lc!==e?(Mc=jc(),Mc!==e?(Nc=x(),Nc!==e?(xc=d(),xc!==e?(Oc=x(),Oc!==e?(Pc=ja(),Pc!==e?R=vc={type:"function",name:"position",args:{type:"expr_list",value:[wc,xc]}}:(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e)):(g=R,R=e);b=R;if(b===e){var V,
cc,Rc,Sc,Tc,Qa,Uc,Vc;V=g;var aa,rb,sb,fa;aa=g;aa=rb=J();if(aa===e)if(aa=g,96===a.charCodeAt(g)?(rb=Wc,g++):(rb=e,0===u&&m(Xc)),rb!==e){sb=[];Yc.test(a.charAt(g))?(fa=a.charAt(g),g++):(fa=e,0===u&&m(Zc));if(fa!==e)for(;fa!==e;)sb.push(fa),Yc.test(a.charAt(g))?(fa=a.charAt(g),g++):(fa=e,0===u&&m(Zc));else sb=e;sb!==e?(96===a.charCodeAt(g)?(fa=Wc,g++):(fa=e,0===u&&m(Xc)),fa!==e?aa=rb=sb.join(""):(g=aa,aa=e)):(g=aa,aa=e)}else g=aa,aa=e;cc=aa;cc!==e?(Rc=x(),Rc!==e?(Sc=ia(),Sc!==e?(Tc=x(),Tc!==e?(Qa=r(),
Qa===e&&(Qa=null),Qa!==e?(Uc=x(),Uc!==e?(Vc=ja(),Vc!==e?V=cc={type:"function",name:cc,args:Qa?Qa:{type:"expr_list",value:[]}}:(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e)):(g=V,V=e);b=V;if(b===e){var dc,H,Ra,ec,Sa,fc,qa,ba,tb,$c,ad;H=g;Ra=T();if(Ra!==e)if(ec=x(),ec!==e)if(Sa=d(),Sa!==e)if(fc=x(),fc!==e){qa=[];for(ba=P();ba!==e;)qa.push(ba),ba=P();qa!==e?(ba=x(),ba!==e?(tb=Ib(),tb!==e?H=Ra={type:"case_expression",format:"simple",operand:Sa,clauses:qa,else:null}:(g=H,H=e)):(g=H,
H=e)):(g=H,H=e)}else g=H,H=e;else g=H,H=e;else g=H,H=e;else g=H,H=e;if(H===e)if(H=g,Ra=T(),Ra!==e)if(ec=x(),ec!==e)if(Sa=d(),Sa!==e)if(fc=x(),fc!==e){qa=[];for(ba=P();ba!==e;)qa.push(ba),ba=P();qa!==e?(ba=x(),ba!==e?(tb=da(),tb!==e?($c=x(),$c!==e?(ad=Ib(),ad!==e?H=Ra={type:"case_expression",format:"simple",operand:Sa,clauses:qa,else:tb.value}:(g=H,H=e)):(g=H,H=e)):(g=H,H=e)):(g=H,H=e)):(g=H,H=e)}else g=H,H=e;else g=H,H=e;else g=H,H=e;else g=H,H=e;dc=H;if(dc===e){var L,Ta,gc,ra,ca,ub,bd,cd;L=g;Ta=
T();if(Ta!==e)if(gc=x(),gc!==e){ra=[];for(ca=ha();ca!==e;)ra.push(ca),ca=ha();ra!==e?(ca=x(),ca!==e?(ub=Ib(),ub!==e?L=Ta={type:"case_expression",format:"searched",clauses:ra,else:null}:(g=L,L=e)):(g=L,L=e)):(g=L,L=e)}else g=L,L=e;else g=L,L=e;if(L===e)if(L=g,Ta=T(),Ta!==e)if(gc=x(),gc!==e){ra=[];for(ca=ha();ca!==e;)ra.push(ca),ca=ha();ra!==e?(ca=x(),ca!==e?(ub=da(),ub!==e?(bd=x(),bd!==e?(cd=Ib(),cd!==e?L=Ta={type:"case_expression",format:"searched",clauses:ra,else:ub.value}:(g=L,L=e)):(g=L,L=e)):
(g=L,L=e)):(g=L,L=e)):(g=L,L=e)}else g=L,L=e;else g=L,L=e;dc=L}b=dc;if(b===e){var vb,Ka,yc,hc,ic;Ka=g;yc=K();if(yc!==e){hc=[];for(ic=F();ic!==e;)hc.push(ic),ic=F();hc!==e?Ka=yc+=hc.join(""):(g=Ka,Ka=e)}else g=Ka,Ka=e;vb=Ka;vb!==e&&(vb={type:"column_ref",table:"",column:vb});b=vb;b===e&&(b=S(),b===e&&(b=g,c=ia(),c!==e?(f=x(),f!==e?(h=d(),h!==e?(k=x(),k!==e?(l=ja(),l!==e?(h.paren=!0,b=c=h):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)):(g=b,b=e)))}}}}}}}return b}function J(){var a,b,d,c;a=g;b=K();if(b!==
e){d=[];for(c=C();c!==e;)d.push(c),c=C();d!==e?a=b+=d.join(""):(g=a,a=e)}else g=a,a=e;return a}function K(){var b;Xd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===u&&m(Yd));return b}function C(){var b;Zd.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===u&&m($d));return b}function F(){var b;ae.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===u&&m(be));return b}function S(){var b,d,c;b=g;64===a.charCodeAt(g)?(d=ce,g++):(d=e,0===u&&m(de));d!==e?(c=J(),c!==e?b=d=[d,c]:(g=b,b=e)):(g=b,b=e);b!==e&&(b={type:"param",
value:b[1]});return b}function A(){var b,d,c;b=g;a.substr(g,7).toLowerCase()===ee?(d=a.substr(g,7),g+=7):(d=e,0===u&&m(fe));d!==e?(d=g,u++,c=C(),u--,c===e?d=void 0:(g=d,d=e),d!==e?b="LEADING":(g=b,b=e)):(g=b,b=e);b===e&&(b=g,a.substr(g,8).toLowerCase()===ge?(d=a.substr(g,8),g+=8):(d=e,0===u&&m(he)),d!==e?(d=g,u++,c=C(),u--,c===e?d=void 0:(g=d,d=e),d!==e?b="TRAILING":(g=b,b=e)):(g=b,b=e),b===e&&(b=g,a.substr(g,4).toLowerCase()===ie?(d=a.substr(g,4),g+=4):(d=e,0===u&&m(je)),d!==e?(d=g,u++,c=C(),u--,
c===e?d=void 0:(g=d,d=e),d!==e?b="BOTH":(g=b,b=e)):(g=b,b=e)));return b}function G(){var a;a=O();a===e&&(a=S());return a}function O(){var b,d,c;b=g;39===a.charCodeAt(g)?(d=wb,g++):(d=e,0===u&&m(xb));d===e&&(a.substr(g,2)===yb?(d=yb,g+=2):(d=e,0===u&&m(ke)));if(d!==e){d=[];c=g;a.substr(g,2)===sa?(c=sa,g+=2):(c=e,0===u&&m(zb));c!==e&&(c="'");c===e&&(Ab.test(a.charAt(g))?(c=a.charAt(g),g++):(c=e,0===u&&m(Bb)));for(;c!==e;)d.push(c),c=g,a.substr(g,2)===sa?(c=sa,g+=2):(c=e,0===u&&m(zb)),c!==e&&(c="'"),
c===e&&(Ab.test(a.charAt(g))?(c=a.charAt(g),g++):(c=e,0===u&&m(Bb)));d!==e?(39===a.charCodeAt(g)?(c=wb,g++):(c=e,0===u&&m(xb)),c!==e?b=d={type:"string",value:d.join("")}:(g=b,b=e)):(g=b,b=e)}else g=b,b=e;return b}function ha(){var a,b,c;a=g;b=Cb();b!==e?(b=x(),b!==e?(b=d(),b!==e?(c=x(),c!==e?(c=Db(),c!==e?(c=x(),c!==e?(c=d(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function P(){var a,b,c;a=g;b=Cb();b!==e?
(b=x(),b!==e?(b=d(),b!==e?(c=x(),c!==e?(c=Db(),c!==e?(c=x(),c!==e?(c=d(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e)):(g=a,a=e);return a}function da(){var b,c;b=g;var f,h;c=g;a.substr(g,4).toLowerCase()===le?(f=a.substr(g,4),g+=4):(f=e,0===u&&m(me));f!==e?(f=g,u++,h=C(),u--,h===e?f=void 0:(g=f,f=e),f!==e?c="ELSE":(g=c,c=e)):(g=c,c=e);c!==e?(c=x(),c!==e?(c=d(),c!==e?b={type:"else_clause",value:c}:(g=b,b=e)):(g=b,b=e)):(g=b,b=e);
return b}function Hb(){var b,c,d;b=X();b===e&&(b=g,45===a.charCodeAt(g)?(c=db,g++):(c=e,0===u&&m(eb)),c===e&&(43===a.charCodeAt(g)?(c=bb,g++):(c=e,0===u&&m(cb))),c!==e?(d=X(),d!==e?b=c=c[0]+d:(g=b,b=e)):(g=b,b=e));return b}function zc(){var b,c;b=g;46===a.charCodeAt(g)?(c=ne,g++):(c=e,0===u&&m(oe));c!==e?(c=X(),c===e&&(c=null),c!==e?b="."+(null!=c?c:""):(g=b,b=e)):(g=b,b=e);return b}function ma(){var b,c,d;c=b=g;pe.test(a.charAt(g))?(d=a.charAt(g),g++):(d=e,0===u&&m(qe));d!==e?(re.test(a.charAt(g))?
(d=a.charAt(g),g++):(d=e,0===u&&m(se)),d===e&&(d=null),d!==e?c="e"+(null===d?"":d):(g=c,c=e)):(g=c,c=e);c!==e?(d=X(),d!==e?b=c+d:(g=b,b=e)):(g=b,b=e);return b}function X(){var a,b;a=[];b=na();if(b!==e)for(;b!==e;)a.push(b),b=na();else a=e;a!==e&&(a=a.join(""));return a}function na(){var b;te.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===u&&m(ue));return b}function jc(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===ve?(c=a.substr(g,2),g+=2):(c=e,0===u&&m(we));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:
(g=c,c=e),c!==e?b="IN":(g=b,b=e)):(g=b,b=e);return b}function oa(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===xe?(c=a.substr(g,2),g+=2):(c=e,0===u&&m(ye));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="IS":(g=b,b=e)):(g=b,b=e);return b}function ga(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===ze?(c=a.substr(g,4),g+=4):(c=e,0===u&&m(Ae));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="LIKE":(g=b,b=e)):(g=b,b=e);return b}function pa(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===
Be?(c=a.substr(g,3),g+=3):(c=e,0===u&&m(Ce));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="NOT":(g=b,b=e)):(g=b,b=e);return b}function ta(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===De?(c=a.substr(g,3),g+=3):(c=e,0===u&&m(Ee));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="AND":(g=b,b=e)):(g=b,b=e);return b}function ua(){var b,c,d;b=g;a.substr(g,2).toLowerCase()===Fe?(c=a.substr(g,2),g+=2):(c=e,0===u&&m(Ge));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="OR":
(g=b,b=e)):(g=b,b=e);return b}function M(){var b,c,d;b=g;a.substr(g,7).toLowerCase()===He?(c=a.substr(g,7),g+=7):(c=e,0===u&&m(Ie));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="BETWEEN":(g=b,b=e)):(g=b,b=e);return b}function kc(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Je?(c=a.substr(g,4),g+=4):(c=e,0===u&&m(Ke));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="FROM":(g=b,b=e)):(g=b,b=e);return b}function Ac(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Le?(c=a.substr(g,
4),g+=4):(c=e,0===u&&m(Me));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="TRIM":(g=b,b=e)):(g=b,b=e);return b}function T(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Ne?(c=a.substr(g,4),g+=4):(c=e,0===u&&m(Oe));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="CASE":(g=b,b=e)):(g=b,b=e);return b}function Ib(){var b,c,d;b=g;a.substr(g,3).toLowerCase()===Pe?(c=a.substr(g,3),g+=3):(c=e,0===u&&m(Qe));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="END":(g=b,b=e)):(g=
b,b=e);return b}function Cb(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Re?(c=a.substr(g,4),g+=4):(c=e,0===u&&m(Se));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="WHEN":(g=b,b=e)):(g=b,b=e);return b}function Db(){var b,c,d;b=g;a.substr(g,4).toLowerCase()===Te?(c=a.substr(g,4),g+=4):(c=e,0===u&&m(Ue));c!==e?(c=g,u++,d=C(),u--,d===e?c=void 0:(g=c,c=e),c!==e?b="THEN":(g=b,b=e)):(g=b,b=e);return b}function Ua(){var b;44===a.charCodeAt(g)?(b=Ve,g++):(b=e,0===u&&m(We));return b}function ia(){var b;
40===a.charCodeAt(g)?(b=Xe,g++):(b=e,0===u&&m(Ye));return b}function ja(){var b;41===a.charCodeAt(g)?(b=Ze,g++):(b=e,0===u&&m($e));return b}function x(){var a,b;a=[];for(b=Eb();b!==e;)a.push(b),b=Eb();return a}function Eb(){var b;af.test(a.charAt(g))?(b=a.charAt(g),g++):(b=e,0===u&&m(bf));return b}function Xa(a,b,c,e){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==e&&(a.escape=e);return a}function ea(a,b){for(var c=0;c<b.length;c++)a=Xa(b[c][1],a,b[c][3]);return a}w=void 0!==w?w:{};var e=
{},Fb={start:v},Gb=v,dd="!",ed=n("!",!1),Va="\x3d",Wa=n("\x3d",!1),Ya="\x3e\x3d",hd=n("\x3e\x3d",!1),id="\x3e",jd=n("\x3e",!1),Za="\x3c\x3d",kd=n("\x3c\x3d",!1),$a="\x3c\x3e",ld=n("\x3c\x3e",!1),md="\x3c",nd=n("\x3c",!1),ab="!\x3d",od=n("!\x3d",!1),bb="+",cb=n("+",!1),db="-",eb=n("-",!1),pd="*",qd=n("*",!1),rd="/",sd=n("/",!1),Xd=/^[A-Za-z_\x80-\uFFFF]/,Yd=c([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Zd=/^[A-Za-z0-9_]/,$d=c([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),ae=/^[A-Za-z0-9_.\x80-\uFFFF]/,
be=c([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),ce="@",de=n("@",!1),wb="'",xb=n("'",!1),yb="N'",ke=n("N'",!1),sa="''",zb=n("''",!1),Ab=/^[^']/,Bb=c(["'"],!0,!1),ne=".",oe=n(".",!1),te=/^[0-9]/,ue=c([["0","9"]],!1,!1),pe=/^[eE]/,qe=c(["e","E"],!1,!1),re=/^[+\-]/,se=c(["+","-"],!1,!1),xd="null",yd=n("NULL",!0),td="true",ud=n("TRUE",!0),vd="false",wd=n("FALSE",!0),ve="in",we=n("IN",!0),xe="is",ye=n("IS",!0),ze="like",Ae=n("LIKE",!0),fd="escape",gd=n("ESCAPE",!0),Be="not",Ce=n("NOT",
!0),De="and",Ee=n("AND",!0),Fe="or",Ge=n("OR",!0),He="between",Ie=n("BETWEEN",!0),Je="from",Ke=n("FROM",!0),Td="for",Ud=n("FOR",!0),Rd="substring",Sd=n("SUBSTRING",!0),Dd="extract",Ed=n("EXTRACT",!0),Le="trim",Me=n("TRIM",!0),Vd="position",Wd=n("POSITION",!0),Bd="timestamp",Cd=n("TIMESTAMP",!0),zd="date",Ad=n("DATE",!0),ee="leading",fe=n("LEADING",!0),ge="trailing",he=n("TRAILING",!0),ie="both",je=n("BOTH",!0),Fd="year",Gd=n("YEAR",!0),Hd="month",Id=n("MONTH",!0),Jd="day",Kd=n("DAY",!0),Ld="hour",
Md=n("HOUR",!0),Nd="minute",Od=n("MINUTE",!0),Pd="second",Qd=n("SECOND",!0),Ne="case",Oe=n("CASE",!0),Pe="end",Qe=n("END",!0),Re="when",Se=n("WHEN",!0),Te="then",Ue=n("THEN",!0),le="else",me=n("ELSE",!0),Ve=",",We=n(",",!1),Xe="(",Ye=n("(",!1),Ze=")",$e=n(")",!1),af=/^[ \t\n\r]/,bf=c([" ","\t","\n","\r"],!1,!1),Wc="`",Xc=n("`",!1),Yc=/^[^`]/,Zc=c(["`"],!0,!1),g=0,va=[{line:1,column:1}],U=0,wa=[],u=0,La;if("startRule"in w){if(!(w.startRule in Fb))throw Error("Can't start parsing from rule \""+w.startRule+
'".');Gb=Fb[w.startRule]}La=Gb();if(La!==e&&g===a.length)return La;La!==e&&g<a.length&&m({type:"end"});throw function(a,b,c){return new z(z.buildMessage(a,b),a,b,c)}(wa,U<a.length?a.charAt(U):null,U<a.length?k(U,U+1):k(U,U));}}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(z,a){Object.defineProperty(a,"__esModule",{value:!0});a.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,
supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/Set ../../../core/maybe ../../../core/promiseUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(z,a,w,n,c,f,k,m,v,r,d,q,B,t){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsMap=c.fieldsMap;this.timeInfo=c.timeInfo}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0});
a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(m.isValid(a.outSR)&&!m.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=t.cleanFromGeometryEngine(w({spatialReference:a.outSR},q.project(this.queryGeometry,this.queryGeometry.spatialReference,a.outSR))):
b.queryGeometry=t.cleanFromGeometryEngine(w({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(c){var b=d.getWhereClause(c.where);if(!b)return f.resolve(this);if(b.isStandardized()){for(var h=0,k=[],l=0,m=this.items;l<m.length;l++){var n=m[l];b.testFeature(n.attributes)&&(k[h++]=n)}b=new a(k,this.queryGeometry,this);b.definitionExpression=c.where;return f.resolve(b)}return f.reject(new TypeError("Where clause is not standardized"))};a.prototype.executeObjectIdsQuery=
function(c){if(!c.objectIds||!c.objectIds.length)return f.resolve(this);var b=new n.default(c.objectIds);return f.resolve(new a(this.items.filter(function(a){return b.has(a.objectId)}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(d){d=B.getTimeOperator(this.timeInfo,d.timeExtent);if(!c.isSome(d))return f.resolve(this);d=this.items.filter(d);return f.resolve(new a(d,this.queryGeometry,this))};a.prototype.project=function(c){var b=this;return!c||m.equals(this.spatialReference,c)?
f.resolve(this):q.projectMany(this.items.map(function(a){return t.getGeometry(b,a)}),this.spatialReference,c).then(function(d){for(var f=[],h=0;h<b.items.length;h++)f[h]={attributes:b.items[h].attributes,geometry:d[h]};d=[];v.convertFromFeatures(d,f,b.geometryType,b.hasZ,b.hasM,b.objectIdField);return new a(d,b.queryGeometry,{definitionExpression:b.definitionExpression,geometryType:b.geometryType,hasM:b.hasM,hasZ:b.hasZ,objectIdField:b.objectIdField,spatialReference:c,fieldsMap:b.fieldsMap,timeInfo:b.timeInfo})})};
a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,f=this.hasM,l=this.hasZ,m=this.objectIdField,n=this.spatialReference,q=a.outFields,v=a.outSR,r=a.quantizationParameters,A=a.resultRecordCount,G=a.resultOffset,O=!1;null!=A&&null!=G&&(A=G+A,O=c.length>A,c=c.slice(G,Math.min(c.length,A)));return{exceededTransferLimit:O,features:this._createFeatures(a,c),fields:q&&q.map(function(a){return b.fieldsMap.get(a)}),geometryType:d,hasM:f,hasZ:l,objectIdFieldName:m,
spatialReference:t.cleanFromGeometryEngine(v?v:n),transform:r&&k.toQuantizationTransform(r)||null}};a.prototype._createFeatures=function(a,b){var c=new r.default(a,this.fieldsMap),d=a.quantizationParameters,f=a.returnGeometry,l=a.returnCentroid,m=a.maxAllowableOffset,n=a.orderByFields;a=[];var q=0;if(b.length&&n&&n.length){var n=n[0].split(" "),v=n[0],y="DESC"===n[1];b.sort(function(a,b){a=c.getFieldValue(a,v);b=c.getFieldValue(b,v);if("number"===typeof a&&"number"===typeof b)return y?b-a:a-b;if("string"===
typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(y?a>b:a<b)?-1:(y?a<b:a>b)?1:0})}if(f||l)if(d=k.toQuantizationTransform(d),f&&!l)for(l=0;l<b.length;l++)f=b[l],a[q++]={attributes:c.getAttributes(f),geometry:t.getGeometry(this,f,m,d)};else if(!f&&l)for(m=0;m<b.length;m++)f=b[m],a[q++]={attributes:c.getAttributes(f),centroid:t.getCentroid(this,f,d)};else for(l=0;l<b.length;l++)f=b[l],a[q++]={attributes:c.getAttributes(f),centroid:t.getCentroid(this,f,d),geometry:t.getGeometry(this,
f,m,d)};else for(m=0;m<b.length;m++)f=b[m],(f=c.getAttributes(f))&&(a[q++]={attributes:f});return a};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,f=0;for(a=a.outStatistics;f<a.length;f++){var k=a[f];if("exceedslimit"===k.statisticType){c=null!=k.maxPointCount?k.maxPointCount:Number.POSITIVE_INFINITY;d=null!=k.maxRecordCount?k.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=k.maxVertexCount?k.maxVertexCount:
Number.POSITIVE_INFINITY;break}}"esriGeometryPoint"===this.geometryType?b=this.items.length>c:this.items.length>d?b=!0:(c=this.hasZ?this.hasM?4:3:this.hasM?3:2,b=this.items.reduce(function(a,b){return a+(b.geometry&&b.geometry.coords.length||0)},0)/c>b);return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=
new r.default(a,this.fieldsMap),c=[],d=[],f=a.groupByFieldsForStatistics,k=a.having,l=f&&f.length,f=l&&f[0],m={},n={},q={},v={attributes:{}},A=0;for(a=a.outStatistics;A<a.length;A++){var G=a[A],O=G.outStatisticFieldName,t=G.statisticType,P="exceedslimit"!==G.statisticType?G.onStatisticField:void 0,da="1"===P;if(l&&(P===f||da)&&"count"===G.statisticType){m[P]||(m[P]=this._calculateUniqueValues(b,da?f:P));var t=m[P],y;for(y in t){var w=t[y],ma=w.count,G=w.data,B=w.items,w=n[G]||{attributes:{}};if(!k||
b.validateItems(B,k))w.attributes[O]=ma,w.attributes[da?"EXPR_1":P]=G,n[G]=w}d.push({name:O,alias:O,type:"esriFieldTypeString"})}else{if(l)for(y in da=this._calculateUniqueValues(b,f),da){if(w=da[y],G=w.data,B=w.items,!k||b.validateItems(B,k))w=n[G]||{attributes:{}},B=this._calculateStatistics(B,b,P),ma="var"===t?"variance":t,w.attributes[O]=B[ma],w.attributes[f]=G,n[G]=w}else q[P]||(q[P]=this._calculateStatistics(this.items,b,P)),B=q[P],ma="var"===t?"variance":t,v.attributes[O]=B[ma];d.push({name:O,
alias:O,type:"esriFieldTypeDouble"})}}if(l)for(var z in n)c.push(n[z]);else c.push(v);return{fields:d,features:c}};a.prototype._calculateStatistics=function(a,b,c){for(var d=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,h=null,k=null,l=null,m=null,n=[],q=0;q<a.length;q++){var A=b.getFieldValue(a[q],c);null==A||isNaN(A)||(h+=A,d=Math.min(d,A),f=Math.max(f,A),n.push(A))}if(a=n.length){k=h/a;for(m=l=0;m<n.length;m++)A=n[m],l+=Math.pow(A-k,2);m=1<a?l/(a-1):0;l=Math.sqrt(m)}else f=d=null;return{avg:k,
count:a,max:f,min:d,stddev:l,sum:h,variance:m}};a.prototype._calculateUniqueValues=function(a,b){for(var c={},d=0,f=this.items;d<f.length;d++){var k=f[d],l=a.getFieldValue(k,b);if(null==l||"string"===typeof l&&""===l.trim())l=null;null==c[l]?c[l]={count:1,data:l,items:[k]}:(c[l].count++,c[l].items.push(k))}return c};return a}();a.default=z})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(z,a,w){function n(a,b){return Math.round((b-a.translate[0])/
a.scale[0])}function c(a,b){return Math.round((a.translate[1]-b)/a.scale[1])}function f(a,b,d){for(var f=[],h,k,l,m,A=0;A<d.length;A++){var p=d[A];if(0<A){if(l=n(a,p[0]),m=c(a,p[1]),l!==h||m!==k)f.push(b(p,l-h,m-k)),h=l,k=m}else h=n(a,p[0]),k=c(a,p[1]),f.push(b(p,h,k))}return 0<f.length?f:null}function k(a,b,c,d){return f(a,c?d?S:F:d?F:C,b)}function m(a,b,c,d){var h=[];c=c?d?S:F:d?F:C;for(d=0;d<b.length;d++){var k=f(a,c,b[d]);k&&3<=k.length&&h.push(k)}return h.length?h:null}function v(a,b,c,d){var h=
[];c=c?d?S:F:d?F:C;for(d=0;d<b.length;d++){var k=f(a,c,b[d]);k&&2<=k.length&&h.push(k)}return h.length?h:null}function r(a,b){return b*a.scale[0]+a.translate[0]}function d(a,b){return a.translate[1]-b*a.scale[1]}function q(a,b,c){var f=Array(c.length);if(!c.length)return f;var h=a.scale,k=h[0],h=h[1],l=r(a,c[0][0]);a=d(a,c[0][1]);f[0]=b(c[0],l,a);for(var m=1;m<c.length;m++){var n=c[m],l=l+n[0]*k;a-=n[1]*h;f[m]=b(n,l,a)}return f}function B(a,b,c){for(var d=Array(c.length),f=0;f<c.length;f++)d[f]=q(a,
b,c[f]);return d}function t(a,b,c,d){return q(a,c?d?S:F:d?F:C,b)}function y(a,b,c,d){return B(a,c?d?S:F:d?F:C,b)}function l(a,b,c,d){return B(a,c?d?S:F:d?F:C,b)}function b(a,b,c){var d=c[0],f=d[0],d=d[1],h=Math.min(f,b[0]),k=Math.min(d,b[1]),l=Math.max(f,b[2]);b=Math.max(d,b[3]);for(var m=1;m<c.length;m++){var n=c[m],p=n[0],n=n[1],f=f+p,d=d+n;0>p&&(h=Math.min(h,f));0<p&&(l=Math.max(l,f));0>n?k=Math.min(k,d):0<n&&(b=Math.max(b,d))}a[0]=h;a[1]=k;a[2]=l;a[3]=b;return a}function h(a,c){if(!c.length)return null;
a[0]=a[1]=Number.POSITIVE_INFINITY;a[2]=a[3]=Number.NEGATIVE_INFINITY;for(var d=0;d<c.length;d++)b(a,a,c[d]);return a}function p(a,b,d,f,h){b.xmin=n(a,d.xmin);b.ymin=c(a,d.ymin);b.xmax=n(a,d.xmax);b.ymax=c(a,d.ymax);b!==d&&(f&&(b.zmin=d.zmin,b.zmax=d.zmax),h&&(b.mmin=d.mmin,b.mmax=d.mmax));return b}function D(a,b,c,d,f){b.points=k(a,c.points,d,f);return b}function I(a,b,d,f,h){b.x=n(a,d.x);b.y=c(a,d.y);b!==d&&(f&&(b.z=d.z),h&&(b.m=d.m));return b}function J(a,b,c,d,f){a=m(a,c.rings,d,f);if(!a)return null;
b.rings=a;return b}function K(a,b,c,d,f){a=v(a,c.paths,d,f);if(!a)return null;b.paths=a;return b}Object.defineProperty(a,"__esModule",{value:!0});var C=function(a,b,c){return[b,c]},F=function(a,b,c){return[b,c,a[2]]},S=function(a,b,c){return[b,c,a[2],a[3]]};a.toQuantizationTransform=function(a){return a?{originPosition:"upperLeft",scale:[a.tolerance,a.tolerance],translate:[a.extent.xmin,a.extent.ymax]}:null};a.equals=function(a,b){if(a===b||null==a&&null==b)return!0;if(null==a||null==b)return!1;var c,
d,f,h;a&&"upperLeft"===a.originPosition?(c=a.translate[0],d=a.translate[1],a=a.scale[0]):(c=a.extent.xmin,d=a.extent.ymax,a=a.tolerance);b&&"upperLeft"===b.originPosition?(f=b.translate[0],h=b.translate[1],b=b.scale[0]):(f=b.extent.xmin,h=b.extent.ymax,b=b.tolerance);return c===f&&d===h&&a===b};a.quantizeX=n;a.quantizeY=c;a.quantizeBounds=function(a,b,d){b[0]=n(a,d[0]);b[3]=c(a,d[1]);b[2]=n(a,d[2]);b[1]=c(a,d[3]);return b};a.quantizePoints=k;a.quantizeRings=m;a.quantizePaths=v;a.hydrateX=r;a.hydrateY=
d;a.hydrateCoordsArray=q;a.hydrateCoordsArrayArray=B;a.hydrateBounds=function(a,b,c){return c?(b[0]=r(a,c[0]),b[1]=d(a,c[3]),b[2]=r(a,c[2]),b[3]=d(a,c[1]),b):[r(a,b[0]),d(a,b[3]),r(a,b[2]),d(a,b[1])]};a.hydratePoints=t;a.hydratePaths=y;a.hydrateRings=l;a.getQuantizedBoundsCoordsArray=b;a.getQuantizedBoundsCoordsArrayArray=h;a.getQuantizedBoundsPoints=function(a){var c=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return b(c,c,a)};a.getQuantizedBoundsPaths=
function(a){return h([0,0,0,0],a)};a.getQuantizedBoundsRings=function(a){return h([0,0,0,0],a)};a.quantizeExtent=p;a.quantizeMultipoint=D;a.quantizePoint=I;a.quantizePolygon=J;a.quantizePolyline=K;a.quantizeGeometry=function(a,b){return a&&b?w.isPoint(b)?I(a,{},b,!1,!1):w.isPolyline(b)?K(a,{},b,!1,!1):w.isPolygon(b)?J(a,{},b,!1,!1):w.isMultipoint(b)?D(a,{},b,!1,!1):w.isExtent(b)?p(a,{},b,!1,!1):null:null};a.hydrateExtent=function(a,b,c,f,h){b.xmin=r(a,c.xmin);b.ymin=d(a,c.ymin);b.xmax=r(a,c.xmax);
b.ymax=d(a,c.ymax);b!==c&&(f&&(b.zmin=c.zmin,b.zmax=c.zmax),h&&(b.mmin=c.mmin,b.mmax=c.mmax));return b};a.hydrateMultipoint=function(a,b,c,d,f){b.points=t(a,c.points,d,f);return b};a.hydratePoint=function(a,b,c,f,h){b.x=r(a,c.x);b.y=d(a,c.y);b!==c&&(f&&(b.z=c.z),h&&(b.m=c.m));return b};a.hydratePolygon=function(a,b,c,d,f){b.rings=l(a,c.rings,d,f);return b};a.hydratePolyline=function(a,b,c,d,f){b.paths=y(a,c.paths,d,f);return b}})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require",
"exports","@dojo/framework/shim/Map","./attributeSupport"],function(z,a,w,n){Object.defineProperty(a,"__esModule",{value:!0});z=function(){function a(a,c){this._fieldDataCache=new w.default;this._returnDistinctMap=new w.default;this.returnDistinctValues=a.returnDistinctValues;this.fieldsMap=c;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var f=c=0;f<a.length;f++){var k=a[f],r=n.getExpressionFromFieldName(k),d=this.fieldsMap.has(r),r=d?null:n.getWhereClause(r),d=d?this.fieldsMap.get(k).name:
n.getAliasFromFieldName(k)||"FIELD_EXP_"+c++;this._fieldDataCache.set(k,{alias:d,clause:r})}}}a.prototype.getAttributes=function(a){a=a.attributes;a=this._processAttributesForOutFields(a);return a=this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=function(a,c){a=a.attributes;var f=this.fieldsMap.has(c),k=f?this.fieldsMap.get(c).name:c,r=null;this._fieldDataCache.has(k)?r=this._fieldDataCache.get(k).clause:f||(r=n.getWhereClause(c),this._fieldDataCache.set(k,{alias:k,clause:r}));
return f?a[k]:r.calculateValue(a)};a.prototype.validateItem=function(a,c){this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:n.getWhereClause(c)});return this._fieldDataCache.get(c).clause.testFeature(a.attributes)};a.prototype.validateItems=function(a,c){var f=this;this._fieldDataCache.has(c)||this._fieldDataCache.set(c,{alias:c,clause:n.getWhereClause(c)});a=a.map(function(a){return f.getAttributes(a)});return this._fieldDataCache.get(c).clause.testSet(a)};a.prototype._processAttributesForOutFields=
function(a){var c=this.outFields;if(!a||!c||!c.length)return a;for(var f={},n=0;n<c.length;n++){var r=this._fieldDataCache.get(c[n]),d=r.alias,r=r.clause;f[d]=r?r.calculateValue(a):a[d]}return f};a.prototype._processAttributesForDistinctValues=function(a){if(!a||!this.returnDistinctValues)return a;var c=this.outFields,f=[];if(c)for(var n=0;n<c.length;n++){var r=this._fieldDataCache.get(c[n]).alias;f.push(a[r])}else for(r in a)f.push(a[r]);c=(c||["*"]).join(",")+"\x3d"+f.join(",");f=this._returnDistinctMap.get(c)||
0;this._returnDistinctMap.set(c,++f);return 1<f?null:a};return a}();a.default=z})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],function(z,a){function w(a,f,k,m){if(null!=k&&null!=m&&k===m)return function(c){return k>=c.attributes[a]&&k<=c.attributes[f]};if(null!=k&&null!=m)return function(c){return!(c.attributes[a]>m||c.attributes[f]<k)};if(null!=k)return function(a){return!(a.attributes[f]<k)};if(null!=m)return function(c){return!(c.attributes[a]>m)}}function n(a,
f,k){if(null!=f&&null!=k&&f===k)return function(c){return c.attributes[a]===f};if(null!=f&&null!=k)return function(c){return c.attributes[a]>=f&&c.attributes[a]<=k};if(null!=f)return function(c){return c.attributes[a]>=f};if(null!=k)return function(c){return c.attributes[a]<=k}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,f){if(!a)return null;var c=a.startTimeField,m=a.endTimeField,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;if(c&&m)f.forEach(function(a){var d=
a.attributes;a=d[c];d=d[m];null==a||isNaN(a)||(n=Math.min(n,a));null==d||isNaN(d)||(r=Math.max(r,d))});else{var d=c||m;f.forEach(function(a){a=a.attributes[d];null==a||isNaN(a)||(n=Math.min(n,a),r=Math.max(r,a))})}return{start:n,end:r}};a.getTimeOperator=function(a,f){if(!f||!a)return null;var c=a.startTimeField;a=a.endTimeField;if(!c&&!a)return null;var m=f.start;f=f.end;return null==m&&null==f?null:c&&a?w(c,a,m,f):n(c||a,m,f)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/kebabDictionary ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(z,a,w,n,c,f,k,m,v,r,d,q,B,t,y,l){function b(b,c,d){return n(this,void 0,void 0,function(){var f,k,l,n,p;return w(this,function(q){switch(q.label){case 0:if(!b)return[2,null];f=b.where;b.where=f=f&&f.trim();if(!f||/^1 *= *1$/.test(f)||c&&c===f)b.where=null;return b.geometry?[4,h(b)]:[2,b];case 1:return k=q.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(l=b.geometry.spatialReference,k=m.getGeometryExtent(k),k.spatialReference=l),b.geometry=k,[4,y.checkProjectionSupport(k.spatialReference,
d)];case 2:return q.sent(),[4,r.normalizeCentralMeridian(v.fromJSON(k))];case 3:return n=q.sent(),[4,y.project(n[0].toJSON(),n[0].spatialReference,d)];case 4:p=q.sent();if(!p)throw a.QUERY_ENGINE_EMPTY_RESULT;p.spatialReference=d;b.geometry=p;return[2,b]}})})}function h(a){var b=a.geometry,c=a.distance,h=a.units;if(null==c)return f.resolve(b);a=b.spatialReference;var m=h&&p.fromJSON(h)||k.getUnitString(a),h=null,h=a&&(d.isGeographic(a)||d.isWebMercator(a))?f.resolve(b):y.checkProjectionSupport(a,
d.WGS84).then(function(){return y.project(b,d.WGS84)});return h.then(function(a){return l.getGeodesicBufferOperator().then(function(b){return b(a,c,m).toJSON()})})}Object.defineProperty(a,"__esModule",{value:!0});var p=new c.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var D=new t.default,
I=new t.default,J={esriGeometryPoint:B.convertToPoint,esriGeometryPolyline:B.convertToPolyline,esriGeometryPolygon:B.convertToPolygon,esriGeometryMultipoint:B.convertToMultipoint};a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=q.getCentroidOptimizedGeometry(new t.default,b.geometry,a.hasZ,a.hasM));return c?(b=B.quantizeOptimizedGeometry(I,b.centroid,a.hasZ,a.hasM,"esriGeometryPoint",c),B.convertToPoint(b,a.hasZ,
a.hasM)):B.convertToPoint(b.centroid,a.hasZ,a.hasM)};a.getGeometry=function(a,b,c,d){b="coords"in b?b:b.geometry;return b?c?(c=B.generalizeOptimizedGeometry(D,b,a.hasZ,a.hasM,a.geometryType,c),d&&(c=B.quantizeOptimizedGeometry(I,c,a.hasZ,a.hasM,a.geometryType,d)),J[a.geometryType](c,a.hasZ,a.hasM)):d?(c=B.quantizeOptimizedGeometry(I,b,a.hasZ,a.hasM,a.geometryType,d),J[a.geometryType](c,a.hasZ,a.hasM)):J[a.geometryType](b,a.hasZ,a.hasM):null};a.normalizeQuery=function(a,c,d){return n(this,void 0,void 0,
function(){var f,h,k,l,m;return w(this,function(n){f=a.outFields;h=a.orderByFields;k=a.groupByFieldsForStatistics;l=a.outStatistics;if(f)for(m=0;m<f.length;m++)f[m]=f[m].trim();if(h)for(m=0;m<h.length;m++)h[m]=h[m].trim();if(k)for(m=0;m<k.length;m++)k[m]=k[m].trim();if(l)for(m=0;m<l.length;m++)l[m].onStatisticField&&(l[m].onStatisticField=l[m].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,b(a,c,d)]})})};a.normalizeFilter=function(a,c,d){return n(this,
void 0,void 0,function(){return w(this,function(f){return[2,b(a,c,d)]})})};a.cleanFromGeometryEngine=function(a){return a&&K in a?JSON.parse(JSON.stringify(a,C)):a};var K="_geVersion",C=function(a,b){return a!==K?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports","./utils"],function(z,a,w){function n(a,c,m,n,r,d){d=w.getStride(r,d);var f=m,k=m+d,t=0,v=0,l=m=0,b=0,h=0;for(--n;h<n;h++,f+=d,k+=d){var p=c[f],D=c[f+1],I=c[f+2],z=c[k],K=c[k+1],C=c[k+2],F=p*K-z*D,l=l+F,t=
t+(p+z)*F,v=v+(D+K)*F;r&&(F=p*C-z*I,m+=(I+C)*F,b+=F);p<a[0]&&(a[0]=p);p>a[1]&&(a[1]=p);D<a[2]&&(a[2]=D);D>a[3]&&(a[3]=D);r&&(I<a[4]&&(a[4]=I),I>a[5]&&(a[5]=I))}0<l&&(l*=-1);0<b&&(b*=-1);if(!l)return null;a=[t,v,.5*l];r&&(a[3]=m,a[4]=.5*b);return a}function c(a,c,m,n,r){r=w.getStride(n,r);for(var d=c,f=c+r,k=0,t=0,v=0,l=0,b=0,h=m-1;b<h;b++,d+=r,f+=r){var p=a[d],D=a[d+1],z=a[d+2],J=a[f],K=a[f+1],C=a[f+2],F;if(n){F=J-p;var S=K-D,A=C-z;F=Math.sqrt(F*F+S*S+A*A)}else F=J-p,S=K-D,F=Math.sqrt(F*F+S*S);F&&
(k+=F,n?(p=[p+.5*(J-p),D+.5*(K-D),z+.5*(C-z)],t+=F*p[0],v+=F*p[1],l+=F*p[2]):(p=[p+.5*(J-p),D+.5*(K-D)],t+=F*p[0],v+=F*p[1]))}return 0<k?n?[t/k,v/k,l/k]:[t/k,v/k]:0<m?n?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,k,m,v){if(!k||!k.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var f=a.coords,d=[],q=m?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],B=k.lengths,t=k.coords,y=w.getStride(m,v),l=0,b=0;b<B.length;b++){var h=B[b],p=n(q,t,l,h,m,v);p&&d.push(p);l+=h*y}d.sort(function(a,b){var c=a[2]-b[2];0===c&&m&&(c=a[4]-b[4]);return c});d.length&&(y=6*d[0][2],f[0]=d[0][0]/y,f[1]=d[0][1]/y,m&&(y=6*d[0][4],f[2]=0!==y?d[0][3]/y:0),f[0]<q[0]||f[0]>q[1]||f[1]<q[2]||f[1]>q[3]||
m&&(f[2]<q[4]||f[2]>q[5]))&&(f.length=0);if(!f.length)if(k=k.lengths[0]?c(t,0,B[0],m,v):null)f[0]=k[0],f[1]=k[1],m&&2<k.length&&(f[2]=k[2]);else return null;return a};a.lineCentroid=c})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(z,a,w,n,c,f,k,m,v,r,d,q,B){function t(){return n.create(function(a){return z(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var y={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},
l={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},b={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},h={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};
a.importGeometryEngine=t;a.getGeodesicBufferOperator=function(){return t().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,h){if(k.isPolygon(b)&&"esriGeometryPoint"===h.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var l=r.convertFromPolygon(new d.default,b,!1,!1);return n.resolve(function(a){return v.polygonContainsPoint(l,!1,!1,a)})}if(k.isPolygon(b)&&"esriGeometryMultipoint"===h.geometryType){var m=r.convertFromPolygon(new d.default,
b,!1,!1);if("esriSpatialRelContains"===a)return n.resolve(function(a){return v.polygonContainsMultipoint(m,!1,!1,a,h.hasZ,h.hasM)})}if(k.isExtent(b)&&"esriGeometryPoint"===h.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return n.resolve(function(a){return c.extentContainsPoint(b,B.getGeometry(h,a))});if(k.isExtent(b)&&"esriGeometryMultipoint"===h.geometryType&&"esriSpatialRelContains"===a)return n.resolve(function(a){return c.extentContainsMultipoint(b,B.getGeometry(h,
a))});if(k.isExtent(b)&&"esriSpatialRelIntersects"===a){var p=f.getExtentIntersector(h.geometryType);return n.resolve(function(a){return p(b,B.getGeometry(h,a))})}return t().then(function(c){var d=c[y[a]].bind(null,b);return function(a){return d(B.getGeometry(h,a))}})};a.checkSpatialQuerySupport=function(a,c,d){var f=a.spatialRel,p=a.geometry;return p?!0!==l[f]?n.reject(new w("feature-store:unsupported-query","Unsupported query spatial relationship",{query:a})):m.isValid(p.spatialReference)&&m.isValid(d)?
!0!==b[k.getJsonType(p)]?n.reject(new w("feature-store:unsupported-query","Unsupported query geometry type",{query:a})):!0!==h[c]?n.reject(new w("feature-store:unsupported-query","Unsupported layer geometry type",{query:a})):a.outSR?q.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR):n.resolve():n.resolve():n.resolve()};a.canQueryWithRBush=function(a){if(k.isExtent(a))return!0;if(k.isPolygon(a)){var b=0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||
c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports","./utils"],function(z,a,w){function n(a,f,k,m,n){if(!a)return!1;f=w.getStride(f,k);k=a.coords;var c=!1,d=0,q=0;for(a=a.lengths;q<a.length;q++){for(var v=a[q],t=d,y=d,l=d+v*f;y<l;y+=f){t=y+f;t===l&&(t=d);var b=k[y],h=k[y+1],p=k[t],t=k[t+1];(h<n&&t>=n||t<n&&h>=n)&&b+(n-h)/(t-h)*(p-b)<m&&(c=!c)}d+=v*f}return c}
Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,f,k,m){return n(a,f,k,m.coords[0],m.coords[1])};a.polygonContainsMultipoint=function(a,f,k,m,v,r){v=w.getStride(v,r);r=m.coords;m=m.lengths;if(!m)return!1;for(var c=0,q=0;c<m.length;c++,q+=v)if(!n(a,f,k,r[q],r[q+1]))return!1;return!0};a.polygonContainsCoords=n})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","dojo/errors/CancelError","../../core/promiseUtils"],function(z,a,w,n){Object.defineProperty(a,
"__esModule",{value:!0});z=function(){function a(){this._deferreds=[];this._values=[]}a.prototype.push=function(a){var c=this;return n.create(function(f,k){c._deferreds.push({resolve:f,reject:k});c._values.push(a)})};a.prototype.unshift=function(a){var c=this;return n.create(function(f,k){c._deferreds.unshift({resolve:f,reject:k});c._values.unshift(a)})};Object.defineProperty(a.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0});a.prototype.process=function(){if(0===
this.length)return!1;this._deferreds.shift().resolve(this._values.shift());return!0};a.prototype.cancelAll=function(){for(var a=new w,c=0,m=this._deferreds;c<m.length;c++)m[c].reject(a);this._deferreds.length=0;this._values.length=0};return a}();a.PromiseQueue=z})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/has","../../../../core/lang"],function(z,a,w,n,c){Object.defineProperty(a,"__esModule",
{value:!0});var f={type:"esriSMS",style:"esriSMSCircle",size:6,color:[252,146,31,255],outline:{width:.75,color:[153,153,153,255]}},k={type:"esriSLS",style:"esriSLSSolid",width:1,color:[252,146,31,255]},m={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{width:.75,color:[255,255,255,191]}};a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?f:"esriGeometryPolyline"===a?k:m}}};a.createDefaultAttributesFunction=
function(a,c){if(n("csp-restrictions"))return function(){var d;return w((d={},d[c]=null,d),a)};try{var d="this."+c+" \x3d null;",f;for(f in a)d+="this."+f+" \x3d "+JSON.stringify(a[f])+";";var k=new Function(d);return function(){return new k}}catch(t){return function(){var d;return w((d={},d[c]=null,d),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:c.clone(a)}}]}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper @dojo/framework/shim/Set dojo/number dstore/Csv ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../geometry/projection ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/webMercatorUtils ../../OptimizedFeature ../../OptimizedGeometry ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults".split(" "),function(z,
a,w,n,c,f,k,m,v,r,d,q,B,t,y,l,b,h,p,D,I,J){Object.defineProperty(a,"__esModule",{value:!0});var K=J.createDrawingInfo("esriGeometryPoint"),C=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];a.csvLatitudeFieldNames="lat latitude y ycenter latitude83 latdecdeg point-y".split(" ");a.csvLongitudeFieldNames="lon lng long longitude x xcenter longitude83 longdecdeg point-x".split(" ");a.csvDetectedDelimiters=[","," ",";","|","\t"];var F=
/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,S=[0,0],A=function(){return function(a,b){this.x=a;this.y=b}}(),G=function(){var a=c._parseInfo(),b=new RegExp("^"+a.regexp+"$"),d=new RegExp("["+a.group+"\\s\\xa0]","g"),f=a.factor;return function(c){c=b.exec(c);a.factor=f;if(!c)return NaN;var h=c[1];if(!c[1]){if(!c[2])return NaN;h=c[2];a.factor*=-1}h=h.replace(d,"").replace(a.decimal,
".");return+h*a.factor}}(),O=function(){return"isInteger"in Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();z=function(){function c(){this._fieldsMap=new Map;this._queryEngine=null}c.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=null};c.prototype.load=function(a){var b=this;return q.all([this._fetch(a.url),this._checkProjection(a&&a.parsing&&a.parsing.spatialReference)]).then(function(c){var d=
c[0];c=b._parse(d,a.parsing);b._queryEngine=b._createQueryEngine(d,c);c.layerDefinition.extent=b._queryEngine.fullExtent;c.layerDefinition.timeInfo&&(d=b._queryEngine.timeExtent,c.layerDefinition.timeInfo.timeExtent=[d.start,d.end]);return c})};c.prototype.applyEdits=function(a){return q.reject(new v("csv-source:editing-not-supported","applyEdits() is not supported on CSVLayer"))};c.prototype.queryFeatures=function(a){void 0===a&&(a={});return this._queryEngine.executeQuery(a)};c.prototype.queryFeatureCount=
function(a){void 0===a&&(a={});return this._queryEngine.executeQueryForCount(a)};c.prototype.queryObjectIds=function(a){void 0===a&&(a={});return this._queryEngine.executeQueryForIds(a)};c.prototype.queryExtent=function(a){void 0===a&&(a={});return this._queryEngine.executeQueryForExtent(a)};c.prototype._fetch=function(a){if(!a)return q.reject(new v("csv-source:invalid-source","url not defined"));a=B.urlToObject(a);return m(a.path,{query:a.query,responseType:"text"}).then(function(a){return a.data})};
c.prototype._parse=function(a,b){void 0===b&&(b={});for(var c={columnDelimiter:b.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:b.latitudeField,longitudeFieldName:b.longitudeField}};a&&"\n"===a[0];)a=a.slice(1);"\n"!==a[a.length-1]&&(a+="\n");var f=this._readFirstLine(a);if(!f)throw new v("csv","CSV is empty",{csv:a});if(!b.columnDelimiter){var h=this._inferDelimiter(f);if(!h)throw new v("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");c.columnDelimiter=
h}var f=f.split(c.columnDelimiter),k=c.layerDefinition={name:"csv",drawingInfo:K,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:b.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:b.spatialReference||{wkid:102100}}};if(!b.latitudeField||!b.longitudeField){h=this._inferLocationInfo(f);if(!b.longitudeField&&!h.longitudeFieldName||!b.latitudeField&&!h.latitudeFieldName)throw new v("csv",
"Unable to identify latitudeField and/or longitudeField from CSV");c.locationInfo={longitudeFieldName:b.longitudeField||h.longitudeFieldName,latitudeFieldName:b.latitudeField||h.latitudeFieldName}}a=this._inferFields(a,c.columnDelimiter,f,c.locationInfo);if(b.fields&&b.fields.length){for(var f=new Map,h=0,l=b.fields;h<l.length;h++)b=l[h],f.set(b.name.toLowerCase(),b);for(h=0;h<a.length;h++){b=a[h];if(l=f.get(b.name.toLowerCase())){var m=b.name;d.mixin(b,l);b.name=m}this._fieldsMap.set(b.name.trim(),
b);this._fieldsMap.set(b.name.trim().toLowerCase(),b)}}k.fields=a;k.fields.some(function(a){return"esriFieldTypeOID"===a.type?(k.objectIdField=a.name,!0):!1})||(b={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1},k.objectIdField=b.name,k.fields.unshift(b),this._fieldsMap.set(b.name,b),this._fieldsMap.set(b.name.toLowerCase(),b));k.timeInfo&&(b=k.timeInfo,b.startTimeField&&((a=this._fieldsMap.get(b.startTimeField.toLowerCase()))?(b.startTimeField=a.name,a.type=
"esriFieldTypeDate"):b.startTimeField=null),b.endTimeField&&((a=this._fieldsMap.get(b.endTimeField.toLowerCase()))?(b.endTimeField=a.name,a.type="esriFieldTypeDate"):b.endTimeField=null),b.trackIdField&&(a=this._fieldsMap.get(b.trackIdField.toLowerCase()),b.trackIdField=a?a.name:null),b.startTimeField||b.endTimeField||(k.timeInfo=null));return c};c.prototype._inferLocationInfo=function(b){var c=null,d=null;b.forEach(function(b){var f=b.toLowerCase(),h;h=a.csvLatitudeFieldNames.indexOf(f);-1===h||
d||(d=b);h=a.csvLongitudeFieldNames.indexOf(f);-1===h||c||(c=b)});return{longitudeFieldName:c,latitudeFieldName:d}};c.prototype._inferFields=function(a,b,c,d){var f=[],h=this._sampleLines(a).map(function(a){return a.split(b).map(function(a){return a.trim()})});a=function(a){var b=c[a];if(b===d.longitudeFieldName||b===d.latitudeFieldName)f.push({name:b,type:"esriFieldTypeDouble",alias:b});else{var l=h.map(function(b){return b[a]}),l=k._inferFieldType(l),b={name:b.replace(/[\s\'\u2019\u2018\.\-\/\(\)]+/g,
"_"),type:null,alias:b};switch(l){case "integer":b.type="esriFieldTypeInteger";break;case "double":b.type="esriFieldTypeDouble";break;case "date":b.type="esriFieldTypeDate";b.length=36;break;default:b.type="esriFieldTypeString",b.length=255}f.push(b)}};for(var k=this,l=0;l<c.length;l++)a(l);return f};c.prototype._inferFieldType=function(a){var b=this;if(!a.length)return"string";var c=/[^+-.,0-9]/;return a.map(function(a){var d=!1;if(""===a||c.test(a))d=!0;else{d=G(a);if(!isNaN(d))return/[.,]/.test(a)||
!O(d)||214783647<d||-214783648>d?"double":"integer";if(-1===a.indexOf("E"))d=!0;else if(d=Number(a),isNaN(d))if(-1===a.indexOf(","))d=!0;else if(a=a.replace(",","."),d=Number(a),isNaN(d))d=!0;else return"double";else return"double"}return d&&!/^[-]?\d*[.,]?\d*$/.test(a)&&b._isValidDate(new Date(a),a)?"date":"string"}).reduce(function(a,b){if(a===b)return b;if("string"===a||"string"===b)return"string";if("double"===a||"double"===b)return"double"})};c.prototype._isValidDate=function(a,b){if(!a||"[object Date]"!==
Object.prototype.toString.call(a)||isNaN(a.getTime()))return!1;a=!0;if(r("chrome")&&/\d+\W*$/.test(b)&&(b=b.match(/[a-zA-Z]{2,}/))){a=!1;for(var c=0;!a&&c<=b.length;)a=!F.test(b[c]),c++;a=!a}return a};c.prototype._readFirstLine=function(a){return a.substring(0,a.indexOf("\n")).trim()};c.prototype._sampleLines=function(a,b){void 0===b&&(b=10);for(var c=!1,d=[],f=a.indexOf("\n")+1;!c&&d.length<b;){var h=a.indexOf("\n",f);if(-1===h)c=!0;else{var k=void 0;(k=-1===h&&f<a.length-1?a.substring(f).trim():
a.substring(f,h).trim())&&d.push(k);f=h+1}}return d};c.prototype._inferDelimiter=function(b){var c=0,d="";a.csvDetectedDelimiters.forEach(function(a){var f=b.split(a).length;f>c&&(c=f,d=a)});return""===d?null:d};c.prototype._createQueryEngine=function(a,c){var d,m=c.locationInfo;d=m.latitudeFieldName;for(var q=m.longitudeFieldName,r=c.layerDefinition,m=r.objectIdField,v=r.fields,w=r.extent,z=r.timeInfo,r=[],B=[],D=new n.Set,F=new n.Set,P=[],M=0;M<v.length;M++){var J=v[M],K=J.name,J=J.type;"esriFieldTypeDate"===
J?D.add(K):-1<C.indexOf(J)&&F.add(K);K!==m&&P.push(K)}v=new f;v.delimiter=c.columnDelimiter;v.fieldNames=P;v.newline="\n";a=v.parse(a);v=0;a.shift();for(P=0;P<a.length;P++)if(M=a[P],K=this._parseCoordinateValue(M[d]),J=this._parseCoordinateValue(M[q]),null!=J&&null!=K&&!isNaN(K)&&!isNaN(J)){M[d]=K;M[q]=J;for(var T in M)if(T!==d&&T!==q)if(D.has(T)){var O=new Date(M[T]);M[T]=this._isValidDate(O,M[T])?O.getTime():null}else F.has(T)&&(O=G(M[T]),isNaN(O)?M[T]=null:M[T]=O);M[m]=v;v++;r.push(new A(J,K));
B.push(M)}if(!y.equals({wkid:4326},w.spatialReference))if(y.isWebMercator(w.spatialReference))for(T=0,q=r;T<q.length;T++)D=q[T],d=l.lngLatToXY(D.x,D.y,S),D.x=d[0],D.y=d[1];else r=t.projectMany(r,k.SpatialReference.WGS84,w.spatialReference,null,!0);d=new p.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});c=new I.default({fields:c.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:z,objectIdField:m,spatialReference:w.spatialReference||{wkid:4326},cacheSpatialQueries:!0,
featureStore:d});w=[];for(z=0;z<r.length;z++)q=r[z],T=q.x,q=q.y,D=B[z],D[m]=z+1,w.push(new b.default(new h.default([],[T,q]),D,null,D[m]));d.addMany(w);return c};c.prototype._parseCoordinateValue=function(a){if(null==a||""===a)return null;var b=G(a);if(isNaN(b)||181<Math.abs(b))b=parseFloat(a);return b};c.prototype._checkProjection=function(a){return D.checkProjectionSupport(y.WGS84,a).catch(function(){throw new v("csv-layer","Projection not supported");})};return c}();a.default=z});