// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ./arcadeCompiler ./arcadeRuntime ./parser ./treeAnalysis ../core/has ../core/promiseUtils".split(" "),function(r,c,e,k,l,p,t,m){function K(a,b){if(null===f)throw Error("Async Arcade must be enabled for this script");return t("csp-restrictions")||!1===L?function(b,c){return f.executeScript(a,b,c)}:e.compileScript(a,b,!0)}function C(a,b){void 0===b&&(b=[]);return l.parseScript(a,b)}function D(a,b,g){if(!0===b.useAsync||!0===a.isAsync){if(null===f)throw Error("Async Arcade must be enabled for this script");
return f.executeScript(a,b,g)}return k.executeScript(a,b,g)}function E(a,b){return k.referencesMember(a,b)}function u(a,b){void 0===b&&(b=[]);void 0===a.usesGeometry&&p.findScriptDependencies(a,b);return!0===a.usesGeometry}function F(){return v?v:v=m.create(function(a,b){r(["../geometry/geometryEngine","./functions/geomsync"],function(b,c){w=!0;c.setGeometryEngine(b);a(!0)},function(a){b(a)})})}function x(){return null!==y?y:y=e.enableAsyncSupport().then(function(){return m.create(function(a,b){r(["./arcadeAsyncRuntime"],
function(g){try{f=g;g=0;for(var c=z;g<c.length;g++){var n=c[g];f.extend(n);e.extend(n,"async")}z=null;a(!0)}catch(q){b(q)}},b)})})}function G(){return f?!0:!1}function H(){return A?A:A=x().then(function(){return m.create(function(a,b){r(["./featureSetUtils","./functions/featuresetbase","./functions/featuresetgeom","./functions/featuresetstats","./functions/featuresetstring"],function(c,d,n,q,h){try{I=c,f.extend([d,n,q,h]),e.extend([d,n,q,h],"async"),B=!0,a(!0)}catch(M){b(M)}},b)})})}function J(a,
b){void 0===b&&(b=[]);void 0===a.usesFeatureSet&&p.findScriptDependencies(a,b);return!0===a.usesFeatureSet}function N(a,b){if(b)for(var c=0;c<b.length;c++)if(E(a,b[c]))return!0;return!1}Object.defineProperty(c,"__esModule",{value:!0});var L=function(){if(t("csp-restrictions"))return!1;try{return(new Function("function* test() {}; return true"))()}catch(a){return!1}}(),B=!1,w=!1,f=null,z=[];c.compileScript=function(a,b){return!0===b.useAsync||!0===a.isAsync?K(a,b):t("csp-restrictions")?function(b,
c){return k.executeScript(a,b,c)}:e.compileScript(a,b)};c.extend=function(a){k.extend(a);e.extend(a,"sync");null===f?z.push(a):(e.extend(a,"async"),f.extend(a))};c.parseScript=C;c.validateScript=function(a,b,c){void 0===c&&(c="");return l.validateScript(a,b,c)};c.scriptCheck=function(a,b,c,d){void 0===d&&(d="");return l.scriptCheck(a,b,c,d)};c.parseAndExecuteScript=function(a,b,c,d){void 0===d&&(d=[]);a=l.parseScript(a,d);return D(a,b,c)};c.executeScript=D;c.referencesMember=E;c.referencesFunction=
function(a,b){return k.referencesFunction(a,b)};c.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return l.extractFieldLiterals(a,b)};c.scriptUsesGeometryEngine=u;var v=null;c.enableGeometrySupport=F;var y=null;c.enableAsyncSupport=x;c.isFeatureSetSupportEnabled=function(){return B};c.isAsyncEnabled=G;c.isGeometryEnabled=function(){return w};var A=null;c.enableFeatureSetSupport=H;c.scriptUsesFeatureSet=J;c.scriptIsAsync=function(a,b){void 0===b&&(b=[]);void 0===a.isAsync&&p.findScriptDependencies(a,
b);return!0===a.isAsync};c.loadScriptDependencies=function(a,b,c,d){void 0===c&&(c=[]);void 0===d&&(d=!1);return m.create(function(f,g){var h="string"===typeof a?C(a):a,e=[];h&&(!1===w&&(u(h)||d)&&e.push(F()),!1===G()&&(!0===h.isAsync||b)&&e.push(x()),!1===B&&(J(h)||N(h,c))&&e.push(H()));e?m.all(e).then(function(){f(!0)},g):f(!0)})};c.scriptTouchesGeometry=function(a){if(u(a))return!0;a=p.findFunctionCalls(a,!0);return-1<a.indexOf("geometry")||-1<a.indexOf("feature")?!0:!1};var I=null;c.featureSetUtils=
function(){return I}});