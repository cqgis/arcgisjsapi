// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./ArrayPool ./Evented ./lang ./ObjectPool ./scheduling ./accessorSupport/decorators ./accessorSupport/ensureType".split(" "),function(D,P,H,y,I,w,J,K,L,M,x,E){function r(d){return d?d.isInstanceOf&&d.isInstanceOf(F):!1}function z(d){return d?r(d)?d.toArray():d.length?Array.prototype.slice.apply(d):[]:[]}function A(d){if(d&&d.length)return d[0]}function G(d,b,l,a){b&&b.forEach(function(c,n,b){d.push(c);G(d,
l.call(a,c,n,b),l,a)})}D=function(){function d(){this.target=null;this.defaultPrevented=this.cancellable=!1}d.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};d.prototype.reset=function(b){this.defaultPrevented=!1;this.item=b};return d}();var N=function(){},l=new L(D,!0,function(d){d.item=null;d.target=null}),q=new Set,u=new Set,v=new Set,B=new Map,O=0,F=function(d){function b(a){a=d.call(this,a)||this;a._boundDispatch=a._dispatchColChange.bind(a);a._chgListeners=
[];a._notifications=null;a._timer=null;a.length=0;a._items=[];Object.defineProperty(a,"uid",{value:O++});return a}H(b,d);t=b;b.ofType=function(a){if(!a)return t;if(B.has(a))return B.get(a);var c;if("function"===typeof a)c=a.prototype.declaredClass;else if(a.base)c=a.base.prototype.declaredClass;else for(var n in a.typeMap){var b=a.typeMap[n].prototype.declaredClass;c=c?c+(" | "+b):b}c=t.createSubclass({declaredClass:"esri.core.Collection\x3c"+c+"\x3e"});c.isCollection=r;n={Type:a,ensureType:"function"===
typeof a?E.ensureType(a):E.ensureOneOfType(a)};Object.defineProperty(c.prototype,"itemType",{value:n});B.set(a,c);return c};b.prototype.normalizeCtorArgs=function(a){return a?Array.isArray(a)||r(a)?{items:a}:a:{}};Object.defineProperty(b.prototype,"items",{get:function(){return this._items},set:function(a){this._emitBeforeChanges()||(this._splice.apply(this,[0,this.length].concat(z(a))),this._emitAfterChanges())},enumerable:!0,configurable:!0});b.prototype.on=function(a,c){if("change"===a){var n=
this._chgListeners,b={removed:!1,callback:c};n.push(b);this._notifications&&this._notifications.push({listeners:n.slice(),items:this._items.slice(),changes:[]});return{remove:function(){this.remove=N;b.removed=!0;n.splice(n.indexOf(b),1)}}}return this._emitter.on(a,c)};b.prototype.hasEventListener=function(a){return"change"===a?0<this._chgListeners.length:this._emitter.hasEventListener(a)};b.prototype.add=function(a,c){if(this._emitBeforeChanges())return this;c=this.getNextIndex(c);this._splice(c,
0,a);this._emitAfterChanges();return this};b.prototype.addMany=function(a,c){void 0===c&&(c=this._items.length);if(!a||!a.length||this._emitBeforeChanges())return this;c=this.getNextIndex(c);this._splice.apply(this,[c,0].concat(z(a)));this._emitAfterChanges();return this};b.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges())return[];var a=this._splice(0,this.length)||[];this._emitAfterChanges();return a};b.prototype.clone=function(){return this._createNewInstance({items:this._items.map(K.clone)})};
b.prototype.concat=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var b,a=a.map(z);return this._createNewInstance({items:(b=this._items).concat.apply(b,a)})};b.prototype.drain=function(a,c){if(this.length&&!this._emitBeforeChanges()){for(var b=this._splice(0,this.length),e=b.length,h=0;h<e;h++)a.call(c,b[h],h,b);this._emitAfterChanges()}};b.prototype.every=function(a,c){return this._items.every(a,c)};b.prototype.filter=function(a,c){var b;b=2===arguments.length?this._items.filter(a,
c):this._items.filter(a);return this._createNewInstance({items:b})};b.prototype.find=function(a,c){if("function"!==typeof a)throw new TypeError(a+" is not a function");for(var b=this._items,e=b.length,h=0;h<e;h++){var k=b[h];if(a.call(c,k,h,b))return k}};b.prototype.findIndex=function(a,c){if("function"!==typeof a)throw new TypeError(a+" is not a function");for(var b=this._items,e=b.length,h=0;h<e;h++)if(a.call(c,b[h],h,b))return h;return-1};b.prototype.flatten=function(a,c){var b=[];G(b,this,a,c);
return new t(b)};b.prototype.forEach=function(a,c){return this._items.forEach(a,c)};b.prototype.getItemAt=function(a){return this._items[a]};b.prototype.getNextIndex=function(a){var c=this.length;a=null==a?c:a;0>a?a=0:a>c&&(a=c);return a};b.prototype.includes=function(a,c){void 0===c&&(c=0);return arguments.length?-1!==this._items.indexOf(a,c):!1};b.prototype.indexOf=function(a,c){void 0===c&&(c=0);return this._items.indexOf(a,c)};b.prototype.join=function(a){void 0===a&&(a=",");return this._items.join(a)};
b.prototype.lastIndexOf=function(a,c){void 0===c&&(c=this.length-1);return this._items.lastIndexOf(a,c)};b.prototype.map=function(a,c){a=this._items.map(a,c);return new t({items:a})};b.prototype.reorder=function(a,c){void 0===c&&(c=this.length-1);var b=this.indexOf(a);if(-1!==b){0>c?c=0:c>=this.length&&(c=this.length-1);if(b!==c){if(this._emitBeforeChanges())return a;this._splice(b,1);this._splice(c,0,a);this._emitAfterChanges()}return a}};b.prototype.pop=function(){if(this.length&&!this._emitBeforeChanges()){var a=
A(this._splice(this.length-1,1));this._emitAfterChanges();return a}};b.prototype.push=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(this._emitBeforeChanges())return this.length;this._splice.apply(this,[this.length,0].concat(a));this._emitAfterChanges();return this.length};b.prototype.reduce=function(a,c){var b=this._items;return 2===arguments.length?b.reduce(a,c):b.reduce(a)};b.prototype.reduceRight=function(a,c){var b=this._items;return 2===arguments.length?b.reduceRight(a,
c):b.reduceRight(a)};b.prototype.remove=function(a){return this.removeAt(this.indexOf(a))};b.prototype.removeAt=function(a){if(!(0>a||a>=this.length||this._emitBeforeChanges()))return a=A(this._splice(a,1)),this._emitAfterChanges(),a};b.prototype.removeMany=function(a){if(!a||!a.length||this._emitBeforeChanges())return[];a=r(a)?a.toArray():a;for(var c=this._items,b=[],e=a.length,h=0;h<e;h++){var k=c.indexOf(a[h]);if(-1<k){for(var d=h+1,m=k+1,f=Math.min(a.length-d,c.length-m),g=0;g<f&&a[d+g]===c[m+
g];)g++;d=1+g;(k=this._splice(k,d))&&0<k.length&&b.push.apply(b,k);h+=d-1}}this._emitAfterChanges();return b};b.prototype.reverse=function(){if(this._emitBeforeChanges())return this;var a=this._splice(0,this.length);a&&(a.reverse(),this._splice.apply(this,[0,0].concat(a)));this._emitAfterChanges();return this};b.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges()){var a=A(this._splice(0,1));this._emitAfterChanges();return a}};b.prototype.slice=function(a,c){void 0===a&&(a=0);void 0===
c&&(c=this.length);return this._createNewInstance({items:this._items.slice(a,c)})};b.prototype.some=function(a,c){return this._items.some(a,c)};b.prototype.sort=function(a){if(!this.length||this._emitBeforeChanges())return this;var c=this._splice(0,this.length);arguments.length?c.sort(a):c.sort();this._splice.apply(this,[0,0].concat(c));return this};b.prototype.splice=function(a,c){for(var b=[],e=2;e<arguments.length;e++)b[e-2]=arguments[e];if(this._emitBeforeChanges())return[];b=this._splice.apply(this,
[a,c].concat(b))||[];this._emitAfterChanges();return b};b.prototype.toArray=function(){return this._items.slice()};b.prototype.toJSON=function(){return this.toArray()};b.prototype.toLocaleString=function(){return this._items.toLocaleString()};b.prototype.toString=function(){return this._items.toString()};b.prototype.unshift=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];if(this._emitBeforeChanges())return this.length;this._splice.apply(this,[0,0].concat(a));this._emitAfterChanges();
return this.length};b.prototype._createNewInstance=function(a){return new this.constructor(a)};b.prototype._splice=function(a,c){for(var b=[],e=2;e<arguments.length;e++)b[e-2]=arguments[e];var e=this._items,h=this.constructor.prototype.itemType,k,d;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=M.schedule(this._boundDispatch));if(c){d=e.splice(a,
c);if(this.hasEventListener("before-remove")){var m=l.acquire();m.target=this;m.cancellable=!0;for(var f=0,g=d.length;f<g;f++)k=d[f],m.reset(k),this.emit("before-remove",m),m.defaultPrevented&&(d.splice(f,1),e.splice(a,0,k),a+=1,--f,--g);l.release(m)}this.length=this._items.length;if(this.hasEventListener("after-remove")){k=l.acquire();k.target=this;k.cancellable=!1;g=d.length;for(f=0;f<g;f++)k.reset(d[f]),this.emit("after-remove",k);l.release(k)}}if(b&&b.length){if(h){f=[];for(g=0;g<b.length;g++)k=
b[g],m=h.ensureType(k),null==m&&null!=k||f.push(m);b=f}h=this.hasEventListener("before-add");f=this.hasEventListener("after-add");g=a===this.length;if(h||f){k=l.acquire();k.target=this;k.cancellable=!0;m=l.acquire();m.target=this;m.cancellable=!1;for(var C=0,q=b;C<q.length;C++){var p=q[C];h?(k.reset(p),this.emit("before-add",k),k.defaultPrevented||(g?e.push(p):e.splice(a++,0,p),this._set("length",e.length),f&&(m.reset(p),this.emit("after-add",m)))):(g?e.push(p):e.splice(a++,0,p),this._set("length",
e.length),m.reset(p),this.emit("after-add",m))}l.release(m);l.release(k)}else g?e.push.apply(e,b):e.splice.apply(e,[a,0].concat(b)),this._set("length",e.length)}(b&&b.length||d&&d.length)&&this._notifyChangeEvent(b,d);return d};b.prototype._emitBeforeChanges=function(){var a=!1;if(this.hasEventListener("before-changes")){var b=l.acquire();b.target=this;b.cancellable=!0;this.emit("before-changes",b);a=b.defaultPrevented;l.release(b)}return a};b.prototype._emitAfterChanges=function(){if(this.hasEventListener("after-changes")){var a=
l.acquire();a.target=this;a.cancellable=!1;this.emit("after-changes",a);l.release(a)}};b.prototype._notifyChangeEvent=function(a,b){this.hasEventListener("change")&&this._notifications[this._notifications.length-1].changes.push({added:a,removed:b})};b.prototype._dispatchColChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var a=this._notifications;this._notifications=null;for(var b=function(a){var b=a.changes;q.clear();u.clear();v.clear();for(var c=0;c<
b.length;c++){var e=b[c],f=e.added,e=e.removed;if(f)if(0===v.size&&0===u.size)for(var g=0,h=f;g<h.length;g++)f=h[g],q.add(f);else for(g=0,h=f;g<h.length;g++)f=h[g],u.has(f)?(v.add(f),u.delete(f)):v.has(f)||q.add(f);if(e)if(0===v.size&&0===q.size)for(g=0;g<e.length;g++)f=e[g],u.add(f);else for(g=0;g<e.length;g++)f=e[g],q.has(f)?q.delete(f):(v.delete(f),u.add(f))}var l=w.acquire();q.forEach(function(a){l.push(a)});var p=w.acquire();u.forEach(function(a){p.push(a)});var n=d._items,t=a.items,r=w.acquire();
v.forEach(function(a){t.indexOf(a)!==n.indexOf(a)&&r.push(a)});if(a.listeners&&(l.length||p.length||r.length))for(b={target:d,added:l,removed:p,moved:r},c=a.listeners.length,f=0;f<c;f++)e=a.listeners[f],e.removed||e.callback.call(d,b);w.release(l);w.release(p);w.release(r)},d=this,e=0;e<a.length;e++)b(a[e]);q.clear();u.clear();v.clear()}};var t;b.isCollection=r;y([x.property()],b.prototype,"length",void 0);y([x.property()],b.prototype,"items",null);return b=t=y([x.subclass("esri.core.Collection")],
b)}(x.declared(I,J));return F});