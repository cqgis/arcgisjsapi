// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/assignHelper ../config ./Error ./has ./Logger ./promiseUtils ../geometry/Point ../geometry/support/webMercatorUtils ../portal/Portal ../tasks/GeometryService ../tasks/support/ProjectParameters".split(" "),function(w,e,x,f,k,g,l,d,m,n,p,q,r){function t(b,a){if(!a)return d.resolve(b);var c=a.spatialReference;return c.isWGS84?d.resolve(b):c.isWebMercator?d.resolve(n.geographicToWebMercator(b)):u().then(function(a){if(!a)return d.reject(new k("geometry-service:missing-url",
"Geometry service URL is missing"));a=new q({url:a});var e=new r({geometries:[b],outSR:c});return a.project(e).then(function(a){return a[0]})})}function u(){if(f.geometryServiceUrl)return d.resolve(f.geometryServiceUrl);var b=p.getDefault();return b.load().catch(function(a){}).then(function(){return b.get("helperServices.geometry.url")})}Object.defineProperty(e,"__esModule",{value:!0});var h=l.getLogger("esri.core.geolocationUtils"),v={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};e.supported=
function(){var b=g("esri-geolocation");b||h.warn("geolocation-unsupported","Geolocation unsupported.");b&&((b=g("esri-secure-context"))||h.warn("insecure-context","Geolocation requires a secure origin."));return b};e.getCurrentPosition=function(b){b||(b=v);var a=d.create(function(a,d){navigator.geolocation.getCurrentPosition(a,d,b)});return d.timeout(a,15E3,void 0)};e.positionToPoint=function(b){var a=b.position;b=b.view;var c=a&&a.coords||{},c={accuracy:c.accuracy,altitude:c.altitude,altitudeAccuracy:c.altitudeAccuracy,
heading:c.heading,latitude:c.latitude,longitude:c.longitude,speed:c.speed},a=a?{coords:c,timestamp:a.timestamp}:a;a=(a=a&&a.coords)?new m({longitude:a.longitude,latitude:a.latitude,z:a.altitude||null,spatialReference:{wkid:4326}}):null;return t(a,b)}});