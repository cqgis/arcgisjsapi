// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Sketch/nls/Sketch ../core/Collection ../core/lang ../core/accessorSupport/decorators ./Widget ./Sketch/SketchViewModel ./support/widget".split(" "),function(q,r,k,f,g,l,m,d,n,p,b){return function(h){function a(c){c=h.call(this)||this;c.activeTool=null;c.createGraphic=null;c.defaultUpdateOptions=null;c.iconClass="esri-icon-edit";c.layer=null;c.state=null;c.updateGraphics=new l;c.view=null;c.viewModel=
new p;c.widgetLabel=g.title;return c}k(a,h);a.prototype.postInitialize=function(){var c=this;this.own([this.viewModel.on("create",function(){return c.scheduleRender()}),this.viewModel.on("update",function(){return c.scheduleRender()}),this.viewModel.on("create",function(a){return c._onOperationComplete(a)}),this.viewModel.on("update",function(a){return c._onOperationComplete(a)}),this.viewModel.on("undo",function(){return c.scheduleRender()}),this.viewModel.on("redo",function(){return c.scheduleRender()}),
this.viewModel.on("reset",function(){return c.scheduleRender()})])};Object.defineProperty(a.prototype,"layout",{set:function(c){"vertical"!==c&&(c="horizontal");this._set("layout",c)},enumerable:!0,configurable:!0});a.prototype.create=function(c,a){};a.prototype.update=function(c,a){return this.viewModel.update(c,a)};a.prototype.complete=function(){};a.prototype.cancel=function(){};a.prototype.undo=function(){};a.prototype.redo=function(){};a.prototype.reset=function(){this.viewModel.reset();this.view.focus()};
a.prototype.render=function(){var c=this.classes("esri-sketch","esri-widget","disabled"===this.viewModel.state?"esri-disabled":null,"vertical"===this.layout?"esri-sketch--vertical":null);return b.tsx("div",{"aria-label":g.widgetLabel,class:c},b.tsx("div",{class:"esri-sketch__panel"},this.renderTopPanelContents()),b.tsx("div",{class:this.classes("esri-sketch__panel","esri-sketch__info-panel")},this.renderInfoPanelContents()))};a.prototype.renderTopPanelContents=function(){return[b.tsx("div",{class:this.classes("esri-sketch__section",
"esri-sketch__tool-section")},this.renderNavigationButtons()),b.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__tool-section")},this.renderDrawButtons()),b.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__tool-section")},this.renderMenuButtons())]};a.prototype.renderInfoPanelContents=function(){if(this.updateGraphics.length)return[b.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section","esri-sketch__info-count-section"),key:"feature-count-container"},
this.renderFeatureCount()),b.tsx("div",{class:this.classes("esri-sketch__section","esri-sketch__info-section"),key:"delete-button-container"},this.renderDeleteButton())]};a.prototype.renderFeatureCount=function(){var c=this.layout,a=this.updateGraphics.length,d=m.substitute({count:a},1===a?g.featureCount:g.featuresCount);return b.tsx("div",{class:"esri-sketch__feature-count-badge","aria-label":d},b.tsx("span",{class:"esri-sketch__feature-count-number"},"vertical"===c?a:d))};a.prototype.renderDeleteButton=
function(){var a=g.deleteFeature;return b.tsx("button",{"aria-label":a,bind:this,class:this.classes("esri-sketch__button","esri-icon-trash"),onclick:this._deleteGraphic,title:a})};a.prototype.renderNavigationButtons=function(){return[this.renderTransformButton(),this.renderReshapeButton()]};a.prototype.renderTransformButton=function(){var a=g.move,e=["esri-sketch__button","esri-icon-pan"],d=this.viewModel.defaultUpdateOptions.tool,f=!("transform"!==this.activeTool&&"move"!==this.activeTool);("ready"===
this.state&&"transform"===d||f)&&e.push("esri-sketch__button--selected");return b.tsx("button",{"aria-label":a,bind:this,class:this.classes(e),onclick:this._activateTransformTool,title:a})};a.prototype.renderReshapeButton=function(){var a=g.reshape,e=["esri-sketch__button","esri-icon-cursor"],d=this.viewModel.defaultUpdateOptions.tool,f=1<this.updateGraphics.length;("ready"===this.state&&"reshape"===d||"reshape"===this.activeTool)&&e.push("esri-sketch__button--selected");return b.tsx("button",{"aria-label":a,
bind:this,class:this.classes(e),onclick:this._activateReshapeTool,disabled:f,title:a})};a.prototype.renderDrawButtons=function(){return[this.renderPointButton(),this.renderPolylineButton(),this.renderPolygonButton(),this.renderRectangleButton(),this.renderCircleButton()]};a.prototype.renderPointButton=function(){var a=g.drawPoint,e=["esri-sketch__button","esri-icon-map-pin"];"point"===this.activeTool&&e.push("esri-sketch__button--selected");return b.tsx("button",{"aria-label":a,bind:this,class:this.classes(e),
onclick:this._activateCreatePoint,title:a})};a.prototype.renderPolygonButton=function(){var a=g.drawPolygon,e=["esri-sketch__button","esri-icon-polygon"];"polygon"===this.activeTool&&e.push("esri-sketch__button--selected");return b.tsx("button",{"aria-label":a,bind:this,class:this.classes(e),onclick:this._activateCreatePolygon,title:a})};a.prototype.renderPolylineButton=function(){var a=g.drawPolyline,e=["esri-sketch__button","esri-icon-polyline"];"polyline"===this.activeTool&&e.push("esri-sketch__button--selected");
return b.tsx("button",{"aria-label":a,bind:this,class:this.classes(e),onclick:this._activateCreatePolyline,title:a})};a.prototype.renderCircleButton=function(){var a=g.drawCircle,e=["esri-sketch__button","esri-icon-radio-unchecked"];"circle"===this.activeTool&&e.push("esri-sketch__button--selected");return b.tsx("button",{"aria-label":a,bind:this,class:this.classes(e),onclick:this._activateCreateCircle,title:a})};a.prototype.renderRectangleButton=function(){var a=g.drawRectangle,e=["esri-sketch__button",
"esri-icon-checkbox-unchecked"];"rectangle"===this.activeTool&&e.push("esri-sketch__button--selected");return b.tsx("button",{"aria-label":a,bind:this,class:this.classes(e),onclick:this._activateCreateRectangle,title:a})};a.prototype.renderMenuButtons=function(){return[this.renderUndoButton(),this.renderRedoButton()]};a.prototype.renderUndoButton=function(){var a=g.undo,e=!this.viewModel.canUndo();return b.tsx("button",{"aria-label":a,bind:this,class:this.classes("esri-sketch__button","esri-icon-undo"),
disabled:e,onclick:this._undo,title:a})};a.prototype.renderRedoButton=function(){var a=g.redo,e=!this.viewModel.canRedo();return b.tsx("button",{"aria-label":a,bind:this,class:this.classes("esri-sketch__button","esri-icon-redo"),disabled:e,onclick:this._redo,title:a})};a.prototype._isUpdateToolActive=function(){return!("transform"!==this.activeTool&&"reshape"!==this.activeTool&&"move"!==this.activeTool)};a.prototype._deleteGraphic=function(){if("active"===this.state){var a=this.activeTool,b=this.layer,
d=this.updateGraphics.toArray();b.removeMany(d);this.reset();this.emit("delete",{graphics:d,tool:a,type:"delete"})}};a.prototype._onOperationComplete=function(a){"complete"!==a.state&&"cancel"!==a.state||this._modifyDefaultUpdateTool("transform")};a.prototype._modifyDefaultUpdateTool=function(a){this.viewModel.defaultUpdateOptions&&(this.viewModel.defaultUpdateOptions.tool=a)};a.prototype._activateTransformTool=function(){"active"!==this.state||this._isUpdateToolActive()?"reshape"===this.activeTool&&
this.viewModel.toggleUpdateTool():this.viewModel.reset();this._modifyDefaultUpdateTool("transform");this.view.focus()};a.prototype._activateReshapeTool=function(){"active"!==this.state||this._isUpdateToolActive()||this.viewModel.reset();"transform"===this.activeTool&&1===this.updateGraphics.length&&this.viewModel.toggleUpdateTool();this._modifyDefaultUpdateTool("reshape");this.view.focus()};a.prototype._activateCreatePoint=function(){this.viewModel.create("point");this.view.focus()};a.prototype._activateCreatePolygon=
function(){this.viewModel.create("polygon");this.view.focus()};a.prototype._activateCreatePolyline=function(){this.viewModel.create("polyline");this.view.focus()};a.prototype._activateCreateCircle=function(){this.viewModel.create("circle");this.view.focus()};a.prototype._activateCreateRectangle=function(){this.viewModel.create("rectangle");this.view.focus()};a.prototype._undo=function(){this.undo();this.view.focus()};a.prototype._redo=function(){this.redo();this.view.focus()};f([d.aliasOf("viewModel.activeTool"),
b.renderable()],a.prototype,"activeTool",void 0);f([d.aliasOf("viewModel.createGraphic"),b.renderable()],a.prototype,"createGraphic",void 0);f([d.aliasOf("viewModel.defaultUpdateOptions"),b.renderable()],a.prototype,"defaultUpdateOptions",void 0);f([d.property()],a.prototype,"iconClass",void 0);f([d.aliasOf("viewModel.layer"),b.renderable()],a.prototype,"layer",void 0);f([d.property({value:"horizontal"}),b.renderable()],a.prototype,"layout",null);f([d.aliasOf("viewModel.state"),b.renderable()],a.prototype,
"state",void 0);f([d.aliasOf("viewModel.updateGraphics"),b.renderable(["updateGraphics","updateGraphics.length"])],a.prototype,"updateGraphics",void 0);f([d.aliasOf("viewModel.view"),b.renderable()],a.prototype,"view",void 0);f([d.property(),b.renderable("viewModel.state"),b.vmEvent(["create","update","undo","redo","reset"])],a.prototype,"viewModel",void 0);f([d.property()],a.prototype,"widgetLabel",void 0);f([d.aliasOf("viewModel.create")],a.prototype,"create",null);f([d.aliasOf("viewModel.complete")],
a.prototype,"complete",null);f([d.aliasOf("viewModel.cancel")],a.prototype,"cancel",null);f([d.aliasOf("viewModel.undo")],a.prototype,"undo",null);f([d.aliasOf("viewModel.redo")],a.prototype,"redo",null);return a=f([d.subclass("esri.widgets.Sketch")],a)}(d.declared(n))});