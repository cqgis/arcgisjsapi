// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./support/ActiveLayerInfo".split(" "),function(v,r,f,l,b,c,q,u,t,e){var h=c.ofType(e),n="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.HeatmapLayer esri.layers.MapImageLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GeoJSONLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer".split(" "),
a=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(b){function c(a){a=b.call(this,a)||this;a._handles=new q;a._layerViewByLayerId={};a._layerInfosByLayerViewId={};a._activeLayerInfosByLayerViewId={};a.activeLayerInfos=new h;a.basemapLegendVisible=!1;a.groundLegendVisible=!1;a.layerInfos=[];a.view=null;return a}f(c,b);c.prototype.initialize=function(){this._handles.add(u.init(this,"view",this._viewHandles),"view")};
c.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(u.init(this,"state",this._stateHandles),"state")};c.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()};
c.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};c.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};c.prototype._destroyViewActiveLayerInfo=function(a){this._handles.remove(a);delete this._activeLayerInfosByLayerViewId[a]};c.prototype._watchPropertiesAndAllLayerViews=function(){var a=this.view.allLayerViews;
a.length&&this._refresh();this._handles.add(a.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(u.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};c.prototype._allLayerViewsChangeHandle=function(a){var k=this;a.removed.forEach(function(a){return k._destroyViewActiveLayerInfo(a.uid)});this._refresh()};c.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();
this._refresh()};c.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};c.prototype._sortActiveLayerInfos=function(a){var k={};this.view.allLayerViews.forEach(function(a,b){return k[a.layer.uid]=b});a.sort(function(a,b){return(k[b.layer.uid]||0)-(k[a.layer.uid]||
0)})};c.prototype._generateLayerViews=function(){var b=[];a.filter(this._filterLayerViews,this).map(this.get,this).filter(function(a){return null!=a}).forEach(this._collectLayerViews("layerViews",b));return b};c.prototype._filterLayerViews=function(a){var k=!this.groundLegendVisible&&"view.groundView.layerViews"===a;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===a||"view.basemapView.referenceLayerViews"===a))&&!k};c.prototype._collectLayerViews=function(a,k){var b=function(c){c&&
c.forEach(function(c){k.push(c);b(c[a])});return k};return b};c.prototype._filterLayerViewsByLayerInfos=function(a){var k=this,b=this.layerInfos;return b&&b.length?b.some(function(b){return k._hasLayerInfo(b,a)}):!0};c.prototype._hasLayerInfo=function(a,b){var k=this._isLayerUIDMatching(a.layer,b.layer.uid);k&&(this._layerInfosByLayerViewId[b.uid]=a);return k};c.prototype._isLayerUIDMatching=function(a,b){return a&&(a.uid===b||this._hasLayerUID(a.layers,b))};c.prototype._hasLayerUID=function(a,b){var k=
this;return a&&a.some(function(a){return k._isLayerUIDMatching(a,b)})};c.prototype._isLayerViewSupported=function(a){return-1<n.indexOf(a.layer.declaredClass)?(this._layerViewByLayerId[a.layer.uid]=a,!0):!1};c.prototype._generateActiveLayerInfo=function(a){var b=this;this._isLayerActive(a)?this._buildActiveLayerInfo(a):(this._handles.remove(a.uid),this._handles.add(u.watch(a,"suspended, layer.legendEnabled",function(){return b._layerActiveHandle(a)}),a.uid))};c.prototype._layerActiveHandle=function(a){this._isLayerActive(a)&&
(this._handles.remove(a.uid),this._buildActiveLayerInfo(a))};c.prototype._isLayerActive=function(a){return!a.suspended&&a.get("layer.legendEnabled")};c.prototype._buildActiveLayerInfo=function(a){var b=this,c=a.layer,m=a.uid,h=this._layerInfosByLayerViewId[m],g=this._activeLayerInfosByLayerViewId[m];g||(g=new e({layer:c,title:h&&void 0!==h.title?h.title:c.title,view:this.view}),this._activeLayerInfosByLayerViewId[m]=g);g.parent||(h=(h=c.parent)&&this._layerViewByLayerId[h.uid],g.parent=h&&this._activeLayerInfosByLayerViewId[h.uid]);
if(!this._handles.has(m)){var h=u.watch(c,"title",function(d){return b._titleHandle(d,g,a)}),x=u.watch(c,"legendEnabled",function(d){return b._legendEnabledHandle(d,g,a)}),c=u.watch(c,"renderer?, opacity",function(){return b._constructLegendElements(g,a)}),d=u.watch(a,"suspended",function(d){return b._suspendedHandle(d,g,a)}),w=u.whenTrue(this.view,"stationary",function(){return b._scaleHandle(g,a)});this._handles.add([h,x,c,d,w],m);this._constructLegendElements(g,a)}this._addActiveLayerInfo(g,a)};
c.prototype._titleHandle=function(a,b,c){b.title=a;this._constructLegendElements(b,c)};c.prototype._legendEnabledHandle=function(a,b,c){a?this._addActiveLayerInfo(b,c):this._removeActiveLayerInfo(b)};c.prototype._suspendedHandle=function(a,b,c){a?this._removeActiveLayerInfo(b):this._addActiveLayerInfo(b,c)};c.prototype._scaleHandle=function(a,b){a.scale!==this.view.scale&&a.isScaleDriven&&this._constructLegendElements(a,b)};c.prototype._addActiveLayerInfo=function(a,b){this._isLayerActive(b)&&-1===
this.activeLayerInfos.indexOf(a)&&((b=a.parent,b)?-1===b.children.indexOf(a)&&(b.children.push(a),this._sortActiveLayerInfos(b.children)):(this.activeLayerInfos.add(a),this._sortActiveLayerInfos(this.activeLayerInfos)))};c.prototype._removeActiveLayerInfo=function(a){var b=a.parent;b?b.children.remove(a):this.activeLayerInfos.remove(a)};c.prototype._constructLegendElements=function(a,b){b=b.layer;a.scale=this.view.scale;b.featureCollections?a.buildLegendElementsForFeatureCollections(b.featureCollections):
b.renderer?a.buildLegendElementsForRenderer():b.url&&a.buildLegendElementsForTools()};l([t.property({type:h})],c.prototype,"activeLayerInfos",void 0);l([t.property()],c.prototype,"basemapLegendVisible",void 0);l([t.property()],c.prototype,"groundLegendVisible",void 0);l([t.property()],c.prototype,"layerInfos",void 0);l([t.property({dependsOn:["view.ready"],readOnly:!0})],c.prototype,"state",null);l([t.property()],c.prototype,"view",void 0);return c=l([t.subclass("esri.widgets.Legend.LegendViewModel")],
c)}(t.declared(b))})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/io-query ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/Logger ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../renderers/support/jsonUtils ../../../symbols/support/gfxUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils".split(" "),
function(v,r,f,l,b,c,q,u,t,e,h,n,a,g,x,m,k,p,A,C,y,z,d,w,E,G,B){function F(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function D(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function J(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function N(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function K(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function L(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function M(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}var H=g.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),O=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,I=new t.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),Q=new t.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",outline:{width:1,color:[85,85,85,1]}});return function(g){function e(d){d=g.call(this,d)||this;d._handles=new a;d._hasColorRamp=!1;d._hasOpacityRamp=
!1;d._hasSizeRamp=!1;d._legendResponse={};d._webStyleSymbolCache=new Map;d._dotDensityUrlCache=new Map;d._dotDensityPoints=null;d.children=new n;d.layer=null;d.legendElements=[];d.parent=null;d.scale=null;d.title=null;d.view=null;return d}l(e,g);e.prototype.initialize=function(){var a=this,d=function(){return a.notifyChange("ready")};this._handles.add([k.on(this,"children","change",function(b){var c=b.removed,P=a._handles;b.added.map(function(a){var b="activeLayerInfo-ready-watcher-"+a.layer.uid;
P.add(k.init(a,"ready",d),b)});c.forEach(function(a){return P.remove(a.layer.uid)});d()})])};e.prototype.destroy=function(){this._handles.destroy();this._dotDensityPoints=this._dotDensityUrlCache=this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(e.prototype,"ready",{get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isScaleDriven",
{get:function(){var a=this,d=this.layer;if(null===d)return!1;if(d.renderer){if("dot-density"===d.renderer.type)return!0;var b=d.get("renderer.valueExpression");return O.test(b)?!0:(d=d.get("renderer.visualVariables"))&&d.some(function(d){return a._isScaleDrivenSizeVariable(d)})}return!0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,configurable:!0});e.prototype.buildLegendElementsForFeatureCollections=function(a){var d=
this;this.legendElements=[];a.forEach(function(a){if("esri.layers.FeatureLayer"===a.declaredClass)d._buildRendererLegendElements(a.renderer,a.title,"append");else if(a.featureSet&&a.featureSet.features.length){var b=a.layerDefinition;(b=(b=b&&b.drawingInfo)&&C.fromJSON(b.renderer))?d._buildRendererLegendElements(b,a.name,"append"):H.warn("drawingInfo not available!")}})};e.prototype.buildLegendElementsForRenderer=function(){this._buildRendererLegendElements(this.layer.renderer,null,"replace")};e.prototype.buildLegendElementsForTools=
function(){var a=this,d=this.layer;"esri.layers.WMTSLayer"===d.declaredClass?this._constructLegendElementsForWMTSlayer():"esri.layers.WMSLayer"===d.declaredClass?this._constructLegendElementsForWMSSublayers():"esri.layers.MapImageLayer"===d.declaredClass?this._constructLegendElementsForSublayers():(this._handles.remove("imageryLayers-watcher"),this._getLegendLayers().then(function(b){a.legendElements=[];b.forEach(function(b){if("esri.layers.ImageryLayer"===a.layer.declaredClass){var c=d.watch("renderingRule, bandIds",
function(){a._legendResponse["default"]=null;a.buildLegendElementsForTools()});a._handles.add(c,"imageryLayers-watcher")}(b=a._generateSymbolTableElementForLegendLayer(b))&&b.infos.length&&a.legendElements.push(b);a.notifyChange("ready")});a.notifyChange("ready")}).catch(function(a){H.warn("Request to server for legend has failed!",a)}))};e.prototype._isGroupActive=function(){var a=this.children;return a.length?a.some(function(a){return a.ready}):!1};e.prototype._isScaleDrivenSizeVariable=function(a){if(a&&
"size"!==a.type)return!1;var d=a.minSize,b=a.maxSize;return"object"===typeof d&&d?this._isScaleDrivenSizeVariable(d):"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):!!a.expression||O.test(a.valueExpression)};e.prototype._buildRendererLegendElements=function(a,d,b){var c=this;this._getRendererLegendElements(a,d).then(function(a){"append"===b?Array.prototype.push.apply(c.legendElements,a):c.legendElements=a;c.notifyChange("ready")}).catch(function(a){H.warn("error while building legend for layer!",
a)})};e.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var a=this.layer,d=a.activeLayer;this._handles.add(k.watch(this.layer,"activeLayer",this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher");if(d.styleId&&d.styles){var b=null;d.styles.some(function(a){if(d.styleId===a.id)return b=a.legendUrl,!0});b&&(this.legendElements=[{type:"symbol-table",title:d.title,infos:[{src:b,opacity:a.opacity}]}])}this.notifyChange("ready")};
e.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var a=this.layer,d=null;if(a.customParameters||a.customLayerParameters)d=f({},a.customParameters,a.customLayerParameters);this._handles.add(k.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(a.sublayers,d);this.notifyChange("ready")};e.prototype._generateLegendElementsForWMSSublayers=
function(a,d){var b=this,c=[];this._handles.add(a.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");a.forEach(function(a){var k=a.watch("title, visible, legendEnabled",function(){return b._constructLegendElementsForWMSSublayers()});b._handles.add(k,"wms-sublayers-watcher");a.visible&&a.legendEnabled&&(a=b._generateSymbolTableElementForWMSSublayer(a,d))&&a.infos.length&&c.unshift(a)});return c};e.prototype._generateSymbolTableElementForWMSSublayer=function(a,
d){return!a.legendUrl&&a.sublayers?(d=this._generateLegendElementsForWMSSublayers(a.sublayers,d).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:d}):this._generateSymbolTableElementForLegendUrl(a,d)};e.prototype._generateSymbolTableElementForLegendUrl=function(a,d){var b=a.legendUrl;if(b){var k={type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};d&&(b+="?"+c.objectToQuery(d));k.infos.push({src:b,opacity:a.layer&&a.layer.opacity});return k}};e.prototype._getLegendLayers=
function(a){var d=this,b=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",c=this._legendResponse&&this._legendResponse[b];return c?x.resolve(c):this._legendRequest(a).then(function(a){a=a.layers;return d._legendResponse[b]=a})};e.prototype._legendRequest=function(a){var d=this.layer;a={f:"json",dynamicLayers:a};"esri.layers.ImageryLayer"===d.declaredClass&&(d.renderingRule&&(a.renderingRule=JSON.stringify(d.renderingRule.toJSON())),d.bandIds&&(a.bandIds=d.bandIds.join()));var b=d.url.replace(/(\/)+$/,
"");10.01<=d.version?(d=b.indexOf("?"),b=-1<d?b.substring(0,d)+"/legend"+b.substring(d):b+"/legend"):(d=b.toLowerCase().indexOf("/rest/"),b=b.substring(0,d)+b.substring(d+5,b.length),b="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(b)+"\x26returnbytes\x3dtrue");return u(b,{query:a}).then(function(a){return a.data})};e.prototype._constructLegendElementsForSublayers=function(){var a=this;this.legendElements=[];this._handles.remove("sublayers-watcher");var d=this.layer,b=new A.ExportImageParameters({layer:d});
this._getLegendLayers(b).then(function(b){var c={};b.forEach(function(a){c[a.layerId]=a});a._handles.add(k.watch(d,"sublayers",a._constructLegendElementsForSublayers.bind(a)),"sublayers-watcher");a.legendElements=a._generateLegendElementsForSublayers(d.sublayers,c,d.opacity);a.notifyChange("ready")}).catch(function(a){H.warn("Request to server for legend has failed!",a)}).then(function(){return b.destroy()});this.notifyChange("ready")};e.prototype._generateLegendElementsForSublayers=function(a,d,
b){var c=this,k=[];this._handles.add(a.on("change",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher");a.forEach(function(a){var g=a.watch("renderer, opacity, title, visible",function(){return c._constructLegendElementsForSublayers()});c._handles.add(g,"sublayers-watcher");a.visible&&a.legendEnabled&&(g=a&&null!=a.opacity?a.opacity:null,(a=c._generateSymbolTableElementForSublayer(a,d,null!=g?g*b:b))&&a.infos.length&&k.unshift(a))});return k};e.prototype._generateSymbolTableElementForSublayer=
function(a,d,b){var c=d[a.id];return!c&&a.sublayers?(d=this._generateLegendElementsForSublayers(a.sublayers,d,b).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:d}):this._generateSymbolTableElementForLegendLayer(c,a,b)};e.prototype._generateSymbolTableElementForLegendLayer=function(a,d,b){var c=this;if(a){var k=d&&d.renderer,g=d&&d.title||a.layerName;k&&(k=d&&d.title||this._getRendererTitle(k,d))&&(g&&(k.title=g),g=k);g={type:"symbol-table",title:g,infos:[]};a.legendType&&(g.legendType=
a.legendType);a.legend&&this._isLegendLayerInScale(a,d)&&(d=d?this._sanitizeLegendForSublayer(a.legend.slice(),d):a.legend,g.infos=d.map(function(d){var k=d.url;if(d.imageData&&0<d.imageData.length)k="data:image/png;base64,"+d.imageData;else if(0!==k.indexOf("http"))k=m.addTokenParameter(c.layer.url+"/"+a.layerId+"/images/"+k);else return null;return{label:d.label,src:k,opacity:b,width:d.width,height:d.height}}).filter(function(a){return!!a}));return g.infos.length?g:null}};e.prototype._isLegendLayerInScale=
function(a,d){d=d||this.layer;var b=null,c=null,k=!0;!d.minScale&&0!==d.minScale||!d.maxScale&&0!==d.maxScale?(0===a.minScale&&d.tileInfo&&(b=d.tileInfo.lods[0].scale),0===a.maxScale&&d.tileInfo&&(c=d.tileInfo.lods[d.tileInfo.lods.length-1].scale)):(b=Math.min(d.minScale,a.minScale)||d.minScale||a.minScale,c=Math.max(d.maxScale,a.maxScale));if(0<b&&b<this.scale||c>this.scale)k=!1;return k};e.prototype._sanitizeLegendForSublayer=function(a,d){if(10.1>this.layer.version||0===a.length)return a;d=d.renderer;
var b=null,c=null;a.some(function(a){return a.values})&&a.some(function(a,d){a.values||(b=d,c=a,c.label||(c.label="others"));return null!=c});d?"unique-value"===d.type?c&&(a.splice(b,1),a.push(c)):"class-breaks"===d.type&&(c&&a.splice(b,1),a.reverse(),c&&a.push(c)):c&&(a.splice(b,1),a.push(c));return a};e.prototype._getRendererLegendElements=function(a,d){return F(a)||D(a)||J(a)||N(a)||K(a)||L(a)||M(a)||"esri.renderers.DotDensityRenderer"===a.declaredClass?K(a)||L(a)||M(a)||"esri.renderers.PointCloudRGBRenderer"===
a.declaredClass?this._constructPointCloudRendererLegendElements(a,d):"dot-density"===a.type?this._constructDotDensityRendererLegendElements(a):this._constructRendererLegendElements(a,d):(H.warn("Renderer not supported!"),x.resolve([]))};e.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&a.legendOptions.title||a.field};e.prototype._constructPointCloudRendererLegendElements=function(a,d){var b=this,c=this.layer.opacity,k=[],g=null,h=null;if(K(a))g={type:"symbol-table",title:d||
this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){g.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:b._getAppliedCloneSymbol(I,a.color,c)})});else if(L(a)){var h=a.stops,p=null;if(h.length&&(1===h.length&&(p=h[0].color),!p)){var m=h[0].value,e=h[h.length-1].value;null!=m&&null!=e&&(p=w.getColorFromPointCloudStops(m+(e-m)/2,h))}g={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(I,
p||I.color,c)}]};h={type:"color-ramp",title:d||this._getPointCloudRendererTitle(a),borderColor:y.getStroke(I).color,overlayColor:w.getRampOverlayColor(c),infos:w.getRampStopsForPointCloud(a.stops)}}else M(a)&&(g={type:"symbol-table",title:d||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos.forEach(function(a){g.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),symbol:b._getAppliedCloneSymbol(I,a.color,c)})}));g&&g.infos.length&&k.push(g);h&&h.infos.length&&
k.push(h);a=k.reduce(function(a,d){return a.concat(d.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return b._getSymbolPreview(a)});return x.eachAlways(a).then(function(){return k})};e.prototype._getElementInfoForDotDensity=function(a,d,b,c){var k={opacity:1,src:null,width:22,height:22},g=a+"-"+d+"-"+b+"-"+(c&&JSON.stringify(c.toJSON())),h=this._dotDensityUrlCache;if(h.has(g))return k.src=h.get(g),k;var w=Math.round(484/Math.pow(a,2)*.8),p=window.devicePixelRatio,m=document.createElement("canvas"),
x=22*p;m.width=x;m.height=x;m.style.width=m.width/p+"px";m.style.height=m.height/p+"px";var e=m.getContext("2d");b&&(e.fillStyle=b.toCss(!0),e.fillRect(0,0,x,x),e.fill());e.fillStyle=d.toCss(!0);if(this._dotDensityPoints&&this._dotDensityPoints.length/2===w)for(d=0;d<2*w;d+=2){b=this._dotDensityPoints[d];var y=this._dotDensityPoints[d+1];e.fillRect(b,y,a*p,a*p);e.fill()}else for(this._dotDensityPoints=[],d=0;d<2*w;d+=2)b=Math.floor(Math.random()*(x-0+1)+0),y=Math.floor(Math.random()*(x-0+1)+0),this._dotDensityPoints.push(b,
y),e.fillRect(b,y,a*p,a*p),e.fill();c&&(c.color&&(e.strokeStyle=c.color.toCss(!0)),e.lineWidth=c.width,e.strokeRect(0,0,x,x));k.src=m.toDataURL();h.set(g,k.src);return k};e.prototype._constructDotDensityRendererLegendElements=function(a){var d=this,b=a.calculateDotValue(this.view.scale),c={type:"symbol-table",title:{value:b&&Math.round(b),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(function(b){var k=d._getElementInfoForDotDensity(a.dotSize,b.color,a.backgroundColor,
a.outline);k.label=b.label||b.valueExpressionTitle||b.field;c.infos.push(k)});return x.resolve([c])};e.prototype._constructRendererLegendElements=function(a,d){var b=this;return this._loadRenderer(a).then(function(a){b._hasColorRamp=!1;b._hasOpacityRamp=!1;b._hasSizeRamp=!1;var c=b._getVisualVariableLegendElements(a)||[],k={type:"symbol-table",title:d||b._getRendererTitle(a),infos:[]},g=null,h=!1;if(N(a))c.push({type:"heatmap-ramp",title:d,infos:E.getHeatmapRampStops(a)});else if(J(a)){var w=a&&a.authoringInfo;
if(w&&"relationship"===w.type){var p=w.focus,m=w.numClasses,e=w.field1,y=w.field2;if(m&&e&&y){for(var w=b.layer,e=[e,y],y=G.getRotationAngleForFocus(p)||0,n=0;n<e.length;n++){var q=e[n],A=q.normalizationField,q={field:b._getFieldAlias(q.field,w),normField:A&&b._getFieldAlias(A,w)},A=Q.clone();A.angle=y;k.infos.push({label:q,symbol:A});y+=90}p=G.getRelationshipRampElement({focus:p,numClasses:m,infos:a.uniqueValueInfos});c.unshift(p)}}else{var f=a.field;a.uniqueValueInfos.forEach(function(a){a.symbol&&
k.infos.push({label:a.label||b._getDomainName(f,a.value)||a.value,value:a.value,symbol:a.symbol})})}a.defaultSymbol&&(k.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),h=!0)}else D(a)?(g=b._isUnclassedRenderer(a),g&&b._hasSizeRamp||(a.classBreakInfos.forEach(function(a){a.symbol&&k.infos.unshift({label:a.label||(g?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:a.symbol})}),g&&(k.title=null),b._updateInfosforClassedSizeRenderer(a,k.infos)),a.defaultSymbol&&
!g&&(k.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),h=!0)):F(a)&&a.symbol&&!b._hasSizeRamp&&k.infos.push({label:a.label,symbol:a.symbol});p=a.defaultSymbol;!p||h||F(a)||g&&!b._hasColorRamp&&!b._hasSizeRamp&&!b._hasOpacityRamp||c.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:p}]});k.infos.length&&c.unshift(k);var u=b._getSymbolConfig("visualVariables"in a&&a.visualVariables),h=c.reduce(function(a,d){return a.concat(d.infos)},[]).filter(function(a){return!(!a||
!a.symbol)}).map(function(a){return b._getSymbolPreview(a,u)});a=null;return x.eachAlways(h).then(function(){return c})})};e.prototype._updateInfosforClassedSizeRenderer=function(a,b){var c=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,k=a.classBreakInfos.some(function(a){return d.isVolumetricSymbol(a.symbol)});if(c&&k){var g=B.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var h=(g-B.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);b.forEach(function(a,d){a.size=g-h*d})}};e.prototype._getSymbolConfig=
function(a){var d=!1,b=!1;if(a)for(var c=0;c<a.length&&(!d||!b);c++){var k=a[c];"size"===k.type&&("height"===k.axis&&(d=!0),"width-and-depth"===k.axis&&(b=!0))}return d&&b?"tall":null};e.prototype._getSymbolPreview=function(a,d){return z.renderPreviewHTML(a.symbol,{size:a.size,opacity:this.layer.opacity,symbolConfig:d,rotation:a.symbol.angle}).then(function(d){a.preview=d;return a}).catch(function(){a.preview=null;return a})};e.prototype._loadRenderer=function(a){var d=this,b=[];a=a.clone();var c=
this._getMedianColor(a),k=this.layer.opacity;if(D(a)||J(a)){var g=(a.classBreakInfos||a.uniqueValueInfos).map(function(a){return d._fetchSymbol(a.symbol,c,k).then(function(d){a.symbol=d}).catch(function(){a.symbol=null})});Array.prototype.push.apply(b,g)}b.push(this._fetchSymbol(a.symbol||a.defaultSymbol,a.defaultSymbol?null:c,k).then(function(b){d._applySymbolToRenderer(a,b,F(a))}).catch(function(){d._applySymbolToRenderer(a,null,F(a))}));return x.eachAlways(b).then(function(){return a})};e.prototype._applySymbolToRenderer=
function(a,d,b){b?a.symbol=d:a.defaultSymbol=d};e.prototype._getMedianColor=function(a){if(!("visualVariables"in a&&a.visualVariables))return null;var d=h.find(a.visualVariables,function(a){return"color"===a.type});if(!d)return null;var b=null,c=null;if(d.stops){if(1===d.stops.length)return d.stops[0].color;b=d.stops[0].value;c=d.stops[d.stops.length-1].value}return a.getColor(b+(c-b)/2,{colorInfo:d})};e.prototype._fetchSymbol=function(a,d,b){var c=this;if(!a)return x.reject();if("web-style"===a.type){var k=
a.portal,k=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(k&&k.url)+"-"+(k&&k.user&&k.user.username),g=this._webStyleSymbolCache;g.has(k)||g.set(k,a.fetchSymbol());return g.get(k).then(function(a){return c._getAppliedCloneSymbol(a,d,b)}).catch(function(){H.warn("Fetching web-style failed!");return x.reject()})}return x.resolve(this._getAppliedCloneSymbol(a,d,b))};e.prototype._getAppliedCloneSymbol=function(a,d,b){if(!a)return a;a=a.clone();var c=-1<a.type.indexOf("3d");d=d&&d.toRgba();c?this._applyColorTo3dSymbol(a,
d,b):(a.color&&(a.color=this._getOpacityAppliedColor(d||a.color.toRgba(),b)),(d=a.outline)&&d.color&&(d.color=this._getOpacityAppliedColor(d.color.toRgba(),b)));return a};e.prototype._applyColorTo3dSymbol=function(a,d,b){var c=this;a.symbolLayers.forEach(function(a){a&&(d&&(a.material||(a.material={}),a.material.color=new q(d)),null!=b&&(a.material&&a.material.color&&(a.material.color=c._getOpacityAppliedColor(a.material.color.toRgba(),b)),a.outline&&a.outline.color&&(a.outline.color=c._getOpacityAppliedColor(a.outline.color.toRgba(),
b))))})};e.prototype._getOpacityAppliedColor=function(a,d){a[3]*=d;return a};e.prototype._getVisualVariableLegendElements=function(a){var d=this;if(!("visualVariables"in a&&a.visualVariables))return null;var b=[],c=[],k=[],g=this.layer.opacity;a.visualVariables.forEach(function(a){"color"===a.type?b.push(a):"size"===a.type?c.push(a):"opacity"===a.type&&k.push(a)});var h=b.concat(c,k),p,m;0===b.length&&D(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&(p=(p=a.classBreakInfos[0])&&p.symbol);0===
b.length&&F(a)&&(p=a.symbol);p&&(-1<p.type.indexOf("3d")?(p=p.symbolLayers.getItemAt(0),p.get("material.color")&&(m=p.material.color)):p.url||(m=p.color),m&&(m=m.toRgba()));return h.map(function(b){if(!b.legendOptions||!1!==b.legendOptions.showLegend){var c=d._getRampTitle(b,d.layer),k=w.getRampBorderColor(a),h=w.getRampOverlayColor(g),p=null;"color"===b.type?(p={type:"color-ramp",title:c,borderColor:k,overlayColor:h,infos:w.getRampStops(a,b)},d._hasColorRamp||(d._hasColorRamp=!(null==p.infos||!p.infos.length))):
"size"===b.type?(p={type:"size-ramp",title:c,infos:B.getRampStops(a,b,d._getMedianColor(a),d.scale,d.view)},d._hasSizeRamp||(d._hasSizeRamp=!(null==p.infos||!p.infos.length))):"opacity"===b.type&&(p={type:"opacity-ramp",title:c,borderColor:k,overlayColor:h,infos:w.getRampStops(a,b,m)},d._hasOpacityRamp||(d._hasOpacityRamp=!(null==p.infos||!p.infos.length)));return p.infos&&p}}).filter(function(a){return!!a})};e.prototype._getDomainName=function(a,d){if(a&&"function"!==typeof a){var b=this.layer;return(b=
(a=b.getField&&b.getField(a))&&b.getFieldDomain?b.getFieldDomain(a.name):null)&&b.codedValues?b.getName(d):null}return null};e.prototype._getRampTitle=function(a,d){var b=a.field,c=a.normalizationField,k=!1,g=!1,p=!1,h=null,b="function"===typeof b?null:b,c="function"===typeof c?null:c;if(null!=(a.legendOptions&&a.legendOptions.title))h=a.legendOptions.title;else if(a.valueExpressionTitle)h=a.valueExpressionTitle;else{if(d.renderer.authoringInfo&&d.renderer.authoringInfo.visualVariables)for(a=d.renderer.authoringInfo.visualVariables,
h=0;h<a.length;h++){var w=a[h];if("color"===w.type){if("ratio"===w.style){k=!0;break}if("percent"===w.style){g=!0;break}if("percentTotal"===w.style){p=!0;break}}}h={field:b&&this._getFieldAlias(b,d),normField:c&&this._getFieldAlias(c,d),ratio:k,ratioPercent:g,ratioPercentTotal:p}}return h};e.prototype._getRendererTitle=function(a,d){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var b=this.layer,c=a.field,k=null,g=null;
D(a)&&(k=a.normalizationField,g="percent-of-total"===a.normalizationType);c="function"===typeof c?null:c;k="function"===typeof k?null:k;a=null;if(c||k)a={field:d?c:c&&this._getFieldAlias(c,b),normField:d?k:k&&this._getFieldAlias(k,b),normByPct:g};return a};e.prototype._getFieldAlias=function(a,d){var b=d.popupTemplate,b=b&&b.fieldInfos;d="function"===typeof a?null:d.getField&&d.getField(a);var c=null;b&&b.some(function(d){if(a===d.fieldName)return c=d,!0});var b=c||d,k=null;b&&(k=c&&c.label||d&&d.alias||
b.name||b.fieldName);return k};e.prototype._isUnclassedRenderer=function(a){var d=a.visualVariables,b=!1;D(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&d&&(b=a.field?d.some(function(d){return!(!d||a.field!==d.field||(a.normalizationField||d.normalizationField)&&a.normalizationField!==d.normalizationField)}):!!d.length);return b};b([p.property()],e.prototype,"children",void 0);b([p.property()],e.prototype,"layer",void 0);b([p.property()],e.prototype,"legendElements",void 0);b([p.property()],
e.prototype,"parent",void 0);b([p.property({readOnly:!0})],e.prototype,"ready",null);b([p.property()],e.prototype,"scale",void 0);b([p.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables"],readOnly:!0})],e.prototype,"isScaleDriven",null);b([p.property()],e.prototype,"title",void 0);b([p.property({dependsOn:["ready"],readOnly:!0,value:0})],e.prototype,"version",null);b([p.property()],e.prototype,"view",void 0);return e=b([p.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],
e)}(p.declared(e))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils".split(" "),function(v,r,f,l,b,c,q,u){Object.defineProperty(r,"__esModule",{value:!0});var t={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",
opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};v=function(c){function h(){var b=null!==c&&c.apply(this,arguments)||this;b.scale=0;return b}l(h,c);Object.defineProperty(h.prototype,"dynamicLayers",{get:function(){if(!this.hasDynamicLayers)return null;var b=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});return b.length?JSON.stringify(b):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,
"hasDynamicLayers",{get:function(){return u.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"layer",{set:function(b){var a=this;this._get("layer")!==b&&(this._set("layer",b),this._layerHandles&&(this._layerHandles.forEach(function(a){return a.remove()}),this._layerHandles.length=0),b&&(this._layerHandles=[b.allSublayers.on("change",function(){return a.notifyChange("visibleSublayers")}),b.on("sublayer-update",
function(b){return a.notifyChange(t[b.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"layers",{get:function(){var b=this.visibleSublayers;return b?b.length?"show:"+b.map(function(a){return a.id}).join(","):"show:-1":null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"layerDefs",{get:function(){var b=this.visibleSublayers.filter(function(a){return null!=a.definitionExpression});return b.length?JSON.stringify(b.reduce(function(a,b){a[b.id]=
b.definitionExpression;return a},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"version",{get:function(){return(this._get("version")||0)+1},set:function(b){this._set("version",b)},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"visibleSublayers",{get:function(){var b=this,a=this.layer.sublayers,c=[],h=function(a){var k=b.scale,g=0===a.minScale||k<=a.minScale,m=0===a.maxScale||k>=a.maxScale;a.visible&&(0===k||g&&m)&&(a.sublayers?a.sublayers.forEach(h):
c.unshift(a))};a&&a.forEach(h);return c},enumerable:!0,configurable:!0});h.prototype.toJSON=function(){var b=this.layer,b={dpi:b.dpi,format:b.imageFormat,transparent:b.imageTransparency,gdbVersion:b.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?b.dynamicLayers=this.dynamicLayers:b=f({},b,{layers:this.layers,layerDefs:this.layerDefs});return b};b([q.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],h.prototype,"dynamicLayers",null);b([q.property({readOnly:!0,
dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],h.prototype,"hasDynamicLayers",null);b([q.property()],h.prototype,"layer",null);b([q.property({readOnly:!0,dependsOn:["visibleSublayers"]})],h.prototype,"layers",null);b([q.property({readOnly:!0,dependsOn:["visibleSublayers"]})],h.prototype,"layerDefs",null);b([q.property({type:Number})],h.prototype,"scale",void 0);b([q.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion".split(" ")})],
h.prototype,"version",null);b([q.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],h.prototype,"visibleSublayers",null);return h=b([q.subclass("esri.layers.mixins.ExportImageParameters")],h)}(q.declared(c));r.ExportImageParameters=v})},"esri/layers/support/sublayerUtils":function(){define(["require","exports","./layerSourceUtils"],function(v,r,f){function l(b,c){function q(b){var a=b.sublayers;f.unshift(b.id);a&&a.forEach(q)}if(!b||!b.length)return!0;var f=[];c.forEach(q);if(b.length>
f.length)return!1;c=0;for(var l=f.length,e=0;e<b.length;e++){for(var h=b[e].id;c<l&&f[c]!==h;)c++;if(c>=l)return!1}return!0}Object.defineProperty(r,"__esModule",{value:!0});r.isExportDynamic=function(b,c,q){return b.some(function(b){var c=b.source;return!(!c||c.type===f.MAPLAYER&&c.mapLayerId===b.id&&(!c.gdbVersion||c.gdbVersion===q.gdbVersion))||null!=b.renderer||null!=b.labelingInfo||b.hasOwnProperty("opacity")&&null!=b.opacity||b.hasOwnProperty("labelsVisible")&&null!=b.labelsVisible})?!0:!l(b,
c)};r.sameStructureAsService=function(b,c){return c.flatten(function(b){return(b=b.sublayers)&&b.toArray().reverse()}).toArray().reverse().every(function(c,f){return(f=b[f])&&c.id===f.id&&(null==c.sublayers&&null==f.sublayers||null!=c.sublayers&&null!=f.sublayers&&c.sublayers.map(function(b){return b.id}).join(",")===f.sublayers.map(function(b){return b.id}).join(","))})}})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/compilerUtils ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),
function(v,r,f,l,b,c,q,u,t){function e(h,f){switch(h.type){case "web-style":return u.previewWebStyleSymbol(h,e,f);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return q.previewSymbol3D(h,f);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":case "cim":return c.previewSymbol2D(h,f);default:b.neverReached(h)}}Object.defineProperty(r,"__esModule",{value:!0});r.renderPreviewHTML=e;r.getDisplayedSymbol=function(b,
c){return l(this,void 0,void 0,function(){var a,g,h;return f(this,function(m){if(!b)return[2];a=b.get("layer.opacity")||b.get("sourceLayer.opacity");return b.symbol?(g=b.symbol.clone(),t.applyColorToSymbol(g,null,a),[2,g]):(h=b.get("layer.renderer")||b.get("sourceLayer.renderer"))&&"getDisplayedSymbol"in h?[2,h.getDisplayedSymbol(b,c)]:[2]})})}})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),
function(v,r,f,l,b,c,q,u){function t(a,b){var c=h.getContext("2d"),k=[];b&&(b.weight&&k.push(b.weight),b.size&&k.push(b.size+"px"),b.family&&k.push(b.family));c.font=k.join(" ");return c.measureText(a).width}function e(c){if(0===c.length)return 0;if(2<c.length){var g=b.px2pt(1),h=parseFloat(c);switch(c.slice(-2)){case "px":return h;case "pt":return h*g;case "in":return 72*h*g;case "pc":return 12*h*g;case "mm":return h*n*g;case "cm":return h*a*g}}return parseFloat(c)}Object.defineProperty(r,"__esModule",
{value:!0});var h=document.createElement("canvas"),n=7.2/2.54,a=72/2.54;r.previewSymbol2D=function(a,h){var g=h&&h.size?b.pt2px(h.size):null,k=h&&h.maxSize?b.pt2px(h.maxSize):null,p=h&&null!=h.opacity?h.opacity:null,x=h&&null!=h.rotation?h.rotation:null,n=c.getStroke(a),y={shape:null,fill:null,stroke:n};n&&n.width&&(n.width=Math.min(n.width,80));var z=0,d=0,w=n&&n.width||0,E=!1,G=null;switch(a.type){case "simple-marker":p=a.style;d=z=g=Math.min(g||b.pt2px(a.size),k||120);switch(p){case "circle":y.shape=
{type:"circle",cx:0,cy:0,r:.5*g};break;case "cross":y.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[z,.5*d]},{command:"M",values:[.5*z,0]},{command:"L",values:[.5*z,d]},{command:"E",values:[]}]};break;case "diamond":y.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[.5*z,0]},{command:"L",values:[z,.5*d]},{command:"L",values:[.5*z,d]},{command:"Z",values:[]}]};break;case "square":y.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",
values:[z,0]},{command:"L",values:[z,d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]};break;case "triangle":y.shape={type:"path",path:[{command:"M",values:[.5*z,0]},{command:"L",values:[z,d]},{command:"L",values:[0,d]},{command:"Z",values:[]}]};break;case "x":y.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[z,d]},{command:"M",values:[z,0]},{command:"L",values:[0,d]},{command:"E",values:[]}]};break;case "path":E=!0,y.shape={type:"path",path:a.path||""}}break;case "simple-line":w=
Math.min(g||w,k||80);z=22<w?2*w:40;d=w;n.width=w;w=0;y.shape={type:"path",path:[{command:"M",values:[0,.5*d]},{command:"L",values:[z,.5*d]},{command:"E",values:[]}]};break;case "picture-fill":case "simple-fill":d=z=g=Math.min(g,k||120);E=!0;y.shape=q.shapes.fill[0];break;case "picture-marker":var B=k||120,n=b.pt2px(a.width),k=b.pt2px(a.height),g=Math.min(g||Math.max(n,k),B),k=n/k,n=1>=k?Math.ceil(g*k):g,k=1>=k?g:Math.ceil(g/k),z=n,d=k,G=p;y.shape={type:"image",x:-Math.round(n/2),y:-Math.round(k/2),
width:n,height:k,src:a.url||""};break;case "text":p=a.text||"Aa",n=a.font,g=Math.min(g||b.pt2px(n.size),k||120),B=t(p,{weight:n.weight,size:g,family:n.family}),z=(k=/[\uE600-\uE6FF]/.test(p))?g:B,d=g,B=.25*e((n?g:0).toString()),k&&(B+=5),y.shape={type:"text",text:p,x:0,y:B,align:"middle",decoration:n&&n.decoration,rotated:a.rotated,kerning:a.kerning},y.font=n&&{size:g,style:n.style,decoration:n.decoration,weight:n.weight,family:n.family}}if(!y.shape)return l.reject(new f("symbolPreview: renderPreviewHTML2D",
"symbol not supported."));var z=(z||22)+w+1,d=(d||22)+w+1,r=c.getFill(a),w=a.color,g=null;r&&"pattern"===r.type&&w&&"picture-fill"!==a.type?g=c.getPatternUrlWithColor(r.src,w.toCss(!0)).then(function(a){r.src=a;y.fill=r;return y}):(y.fill=r,g=l.resolve(y));return g.then(function(a){return u.renderSymbol([[a]],[z,d],{node:h&&h.node,scale:E,opacity:G,rotation:x})})}})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(v,r){Object.defineProperty(r,"__esModule",{value:!0});
r.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",
path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",
path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},
{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};r.getExtrudeSymbolShapes=function(f){f*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+f]},{command:"L",values:[0,22*.7+f-.7*11]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+f]},{command:"L",values:[22,f]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};r.getCubeShapes=function(f,l){var b=l?20:f,c=l?4:6,c=b=22>=b?b-.5*c:b-c;l=l?.35*b:.5*b;return[{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[c,
.5*l]},{command:"L",values:[.5*c,l]},{command:"L",values:[0,.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[.5*c,l]},{command:"L",values:[.5*c,f]},{command:"L",values:[0,f-.5*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*c,l]},{command:"L",values:[.5*c,f]},{command:"L",values:[c,f-.5*l]},{command:"L",values:[c,.5*l]},{command:"Z",values:[]}]}]};r.getCylinderShapes=function(f,l){var b=l?20:f;l=l?4:6;b=22>=b?b-.5*l:b-
l;l=.5*b;var c=.15*b;f-=c;return[{type:"ellipse",cx:.5*b,cy:f,rx:l,ry:c},{type:"path",path:[{command:"M",values:[0,c]},{command:"L",values:[0,f]},{command:"L",values:[b,f]},{command:"L",values:[b,c]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*b,cy:c,rx:l,ry:c}]};r.getConeShapes=function(f,l){var b=l?20:f;l=l?4:6;b=22>=b?b-.5*l:b-l;l=.15*b;var c=b;f-=l;return[{type:"ellipse",cx:.5*b,cy:f,rx:.5*b,ry:l},{type:"path",path:[{command:"M",values:[.5*c,0]},{command:"L",values:[c,f]},{command:"L",values:[0,
f]},{command:"Z",values:[]}]}]};r.getInvertedConeShapes=function(f){var l=f,l=22>l?l-3:l-6,b=.15*l,c=l;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[c,0]},{command:"L",values:[.5*c,f-b]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*l,cy:0,rx:.5*l,ry:b}]};r.getDiamondShapes=function(f){var l=f,l=22>l?l-2:l-4,b=Math.floor(f/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[l,.5*f-b]},{command:"L",values:[.45*l-b,.5*f+b]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,0]},{command:"L",values:[.45*l-b,.5*f+b]},{command:"L",values:[0,.5*f-b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*f-b]},{command:"L",values:[.45*l-b,.5*f+b]},{command:"L",values:[.45*l,f]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*l,f]},{command:"L",values:[l,.5*f-b]},{command:"L",values:[.45*l-b,.5*f+b]},{command:"Z",values:[]}]}]};r.getTetrahedronShapes=function(f){var l=f,l=22>
l?l-1:l-2;return[{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[f,l]},{command:"L",values:[.45*f,.6*l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*f,0]},{command:"L",values:[.45*f,.6*l]},{command:"L",values:[0,l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,l]},{command:"L",values:[.45*f,.6*l]},{command:"L",values:[f,l]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports dojox/gfx dojox/gfx/matrix ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils".split(" "),
function(v,r,f,l,b,c,q,u,t,e){function h(a){return a.map(function(a){return a.command+" "+a.values.join(",")}).join(" ").trim()}function n(a,b,c,k){var g=k&&k.node||document.createElement("div"),e=f.createSurface(g,b,c);null!=k.opacity&&(g.style.opacity=k.opacity.toString());try{a.forEach(function(a){var g=e.createGroup(),p=0;a.forEach(function(a){var b=a.shape,d=a.fill,c=a.stroke;p+=c&&c.width||0;var k=null;b&&("path"===b.type&&"string"!==typeof b.path&&(b.path=h(b.path)),k=g.createShape(b).setFill(d).setStroke(c?
c:{width:0}),"text"===b.type&&k.setFont(a.font))});a=b/2;var d=c/2,w=g.getBoundingBox(),m=w.width,n=w.height,f=!1;if(k.scale&&0!==w.width&&0!==w.height){var x=w.width/w.height,f=(b>c?b:c)-2*p,q=1,A=1;isNaN(f)||(1<x?(q=f/w.width,A=f/x/w.height):(A=f/w.height,q=f*x/w.width));g.applyTransform(l.scaleAt(q,A,a,d));f=!0}x=w.x+m/2;w=w.y+n/2;g.applyTransform(l.translate(a-x,d-w));!f&&(m>b||n>c)&&(f=m/b>n/c,m=((f?b:c)-5)/(f?m:n),g.applyTransform(l.scaleAt(m,m,a,d)));k.rotation&&g.applyTransform(l.rotategAt(k.rotation,
x,w))})}catch(C){return e.clear(),e.destroy(),null}return g}function a(a,b,h){return a?c(a,{responseType:"image"}).then(function(a){a=a.data;var c=a.width,k=a.height,g=c/k,e=b;h&&(e=Math.min(e,Math.max(c,k)));return{image:a,width:1>=g?Math.ceil(e*g):e,height:1>=g?e:Math.ceil(e/g)}}):e.reject(new u("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(r,"__esModule",{value:!0});r.renderSymbol=function(a,b,c){var k=Math.ceil(b[0]);b=Math.ceil(b[1]);return a.some(function(a){return!!a.length})?
n(a,k,b,c):null};r.tintImageWithColor=function(c,h,e,k,p){return a(c,h,p).then(function(a){var g=a.width?a.width:h,p=a.height?a.height:h,m;if(m=a.image)m=e&&"ignore"!==k?"multiply"===k&&255===e.r&&255===e.g&&255===e.b&&1===e.a?!1:!0:!1;if(m){var d=a.image.width,w=a.image.height;(t("edge")||t("ie"))&&/\.svg$/i.test(c)&&(--d,--w);var f,n;f=Math.ceil(g);n=Math.ceil(p);m=document.createElement("canvas");m.width=f;m.height=n;m.style.width=f+"px";m.style.height=n+"px";m=m.getContext("2d");m.clearRect(0,
0,f,n);m.drawImage(a.image,0,0,d,w,0,0,g,p);a=m.getImageData(0,0,g,p);d=[e.r/255,e.g/255,e.b/255,e.a];w=q.toHSV(e);for(f=0;f<a.data.length;f+=4){n=a.data;var x=f,A=d,D=w;switch(k){case "multiply":n[x+0]*=A[0];n[x+1]*=A[1];n[x+2]*=A[2];n[x+3]*=A[3];break;default:var u=q.toHSV({r:n[x+0],g:n[x+1],b:n[x+2]});u.h=D.h;u.s=D.s;u.v=u.v/100*D.v;D=q.toRGB(u);n[x+0]=D.r;n[x+1]=D.g;n[x+2]=D.b;n[x+3]*=A[3]}}m.putImageData(a,0,0);c=m.canvas.toDataURL("image/png")}else(m=b.id&&b.id.findCredential(c))&&m.token&&
(a=-1===c.indexOf("?")?"?":"\x26",c=""+c+a+"token\x3d"+m.token);return{url:c,width:g,height:p}}).catch(function(){return{url:c,width:h,height:h}})}})},"dojox/gfx":function(){define(["dojo/_base/lang","./gfx/_base","./gfx/renderer!"],function(v,r,f){r.switchTo(f);return r})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),function(v,r,f,l,b,c,q,u,t){var e=
r.getObject("dojox.gfx",!0),h=e._base={};e._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};e._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};e._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};h._getFontMeasurements=function(){var a={"1em":0,"1ex":0,"100%":0,
"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},c,h;l("ie")&&(h=b.doc.documentElement.style.fontSize||"",h||(b.doc.documentElement.style.fontSize="100%"));var g=u.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},b.body());for(c in a)g.style.fontSize=c,a[c]=16*Math.round(12*g.offsetHeight/16)/12/1E3;l("ie")&&(b.doc.documentElement.style.fontSize=
h);b.body().removeChild(g);return a};var n=null;h._getCachedFontMeasurements=function(a){if(a||!n)n=h._getFontMeasurements();return n};var a=null,g={};h._getTextBox=function(c,h,e){var k,p,m=arguments.length,d;a||(a=u.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},b.body()));k=a;k.className="";p=k.style;p.borderWidth="0";p.margin="0";p.padding="0";p.outline="0";if(1<m&&h)for(d in h)d in g||(p[d]=h[d]);2<m&&e&&(k.className=e);k.innerHTML=c;k.getBoundingClientRect?
(p=k.getBoundingClientRect(),p={l:p.left,t:p.top,w:p.width||p.right-p.left,h:p.height||p.bottom-p.top}):p=t.getMarginBox(k);k.innerHTML="";return p};h._computeTextLocation=function(a,b,c,h){var k={};switch(a.align){case "end":k.x=a.x-b;break;case "middle":k.x=a.x-b/2;break;default:k.x=a.x}k.y=a.y-c*(h?.75:1);return k};h._computeTextBoundingBox=function(a){if(!e._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var c=a.getFont()||e.defaultFont;a=a.getTextWidth();c=e.normalizedLength(c.size);
b=h._computeTextLocation(b,a,c,!0);return{x:b.x,y:b.y,width:a,height:c}};h._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var x=0;h._getUniqueId=function(){var a;do a=v._scopeName+"xUnique"+ ++x;while(q.byId(a));return a};var m=l("pointer-events")?"touchAction":null;h._fixMsTouchAction=m?function(a){a.rawNode.style[m]="none"}:function(){};r.mixin(e,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,
height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",color:"black",style:"solid",width:1,cap:"butt",join:4},
defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var c=a[b];if(c)return new c;c=a[b]=new Function;c.prototype=
e["default"+b];return new c}}(),normalizeColor:function(a){return a instanceof f?a:new f(a)},normalizeParameters:function(a,b){var c;if(b){var k={};for(c in a)c in b&&!(c in k)&&(a[c]=b[c])}return a},makeParameters:function(a,b){var c=null;if(!b)return r.delegate(a);var k={};for(c in a)c in k||(k[c]=r.clone(c in b?b[c]:a[c]));return k},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var k=c.indexOf(".");0<=k&&5<c.length-k&&(c=a.toFixed(4))}return 0>a?c:b?" "+
c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=e.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var c=a[3].indexOf("/");b.size=0>c?a[3]:a[3].substring(0,c);var h=4;0>c&&("/"==a[4]?h=6:"/"==a[4].charAt(0)&&(h=5));h<a.length&&(b.family=a.slice(h).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return e._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*e.px_in_pt()},px2pt:function(a){return a/e.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=e.px_in_pt(),c=parseFloat(a);switch(a.slice(-2)){case "px":return c;case "pt":return c*b;case "in":return 72*c*b;case "pc":return 12*c*b;case "mm":return c*e.mm_in_pt*b;case "cm":return c*e.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,b){return a&&b&&a===b},switchTo:function(a){var b="string"==typeof a?e[a]:a;b&&(c.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath Surface createSurface fixTarget".split(" "),function(a){e[a]=b[a]}),"string"==typeof a?e.renderer=a:c.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return e.renderer=e[a]&&e[a].Surface===e.Surface?a:null}))}});return e})},"dojox/gfx/renderer":function(){define(["./_base","dojo/_base/lang","dojo/_base/sniff",
"dojo/_base/window","dojo/_base/config"],function(v,r,f,l,b){var c=null;f.add("vml",function(b,c,f){f.innerHTML='\x3cv:shape adj\x3d"1"/\x3e';b="adj"in f.firstChild;f.innerHTML="";return b});return{load:function(q,u,t){function e(){u(["dojox/gfx/"+h],function(a){v.renderer=h;c=a;t(a)})}if(c&&"force"!=q)t(c);else{var h=b.forceGfxRenderer;q=!h&&(r.isString(b.gfxRenderer)?b.gfxRenderer:"svg,vml,canvas,silverlight").split(",");for(var n,a;!h&&q.length;)switch(q.shift()){case "svg":"SVGAngle"in l.global&&
(h="svg");break;case "vml":f("vml")&&(h="vml");break;case "silverlight":try{f("ie")?(n=new ActiveXObject("AgControl.AgControl"),n.IsVersionSupported("1.0"))&&(a=!0):navigator.plugins["Silverlight Plug-In"]&&(a=!0)}catch(g){a=!1}finally{n=null}a&&(h="silverlight");break;case "canvas":l.global.CanvasRenderingContext2D&&(h="canvas")}"canvas"===h&&!1!==b.canvasEvents&&(h="canvasWithEvents");b.isDebug&&console.log("gfx renderer \x3d "+h);"svg"==h&&"undefined"!=typeof window.svgweb?window.svgweb.addOnLoad(e):
e()}}}})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],function(v,r){var f=v.matrix={},l={};f._degToRad=function(b){return l[b]||(l[b]=Math.PI*b/180)};f._radToDeg=function(b){return b/Math.PI*180};f.Matrix2D=function(b){if(b)if("number"==typeof b)this.xx=this.yy=b;else if(b instanceof Array){if(0<b.length){for(var c=f.normalize(b[0]),q=1;q<b.length;++q){var u=c,l=f.normalize(b[q]),c=new f.Matrix2D;c.xx=u.xx*l.xx+u.xy*l.yx;c.xy=u.xx*l.xy+u.xy*l.yy;c.yx=u.yx*l.xx+u.yy*l.yx;c.yy=
u.yx*l.xy+u.yy*l.yy;c.dx=u.xx*l.dx+u.xy*l.dy+u.dx;c.dy=u.yx*l.dx+u.yy*l.dy+u.dy}r.mixin(this,c)}}else r.mixin(this,b)};r.extend(f.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});r.mixin(f,{identity:new f.Matrix2D,flipX:new f.Matrix2D({xx:-1}),flipY:new f.Matrix2D({yy:-1}),flipXY:new f.Matrix2D({xx:-1,yy:-1}),translate:function(b,c){return 1<arguments.length?new f.Matrix2D({dx:b,dy:c}):new f.Matrix2D({dx:b.x,dy:b.y})},scale:function(b,c){return 1<arguments.length?new f.Matrix2D({xx:b,yy:c}):"number"==typeof b?
new f.Matrix2D({xx:b,yy:b}):new f.Matrix2D({xx:b.x,yy:b.y})},rotate:function(b){var c=Math.cos(b);b=Math.sin(b);return new f.Matrix2D({xx:c,xy:-b,yx:b,yy:c})},rotateg:function(b){return f.rotate(f._degToRad(b))},skewX:function(b){return new f.Matrix2D({xy:Math.tan(b)})},skewXg:function(b){return f.skewX(f._degToRad(b))},skewY:function(b){return new f.Matrix2D({yx:Math.tan(b)})},skewYg:function(b){return f.skewY(f._degToRad(b))},reflect:function(b,c){1==arguments.length&&(c=b.y,b=b.x);var q=b*b,l=
c*c,t=q+l,e=2*b*c/t;return new f.Matrix2D({xx:2*q/t-1,xy:e,yx:e,yy:2*l/t-1})},project:function(b,c){1==arguments.length&&(c=b.y,b=b.x);var q=b*b,l=c*c,t=q+l,e=b*c/t;return new f.Matrix2D({xx:q/t,xy:e,yx:e,yy:l/t})},normalize:function(b){return b instanceof f.Matrix2D?b:new f.Matrix2D(b)},isIdentity:function(b){return 1==b.xx&&0==b.xy&&0==b.yx&&1==b.yy&&0==b.dx&&0==b.dy},clone:function(b){var c=new f.Matrix2D,q;for(q in b)"number"==typeof b[q]&&"number"==typeof c[q]&&c[q]!=b[q]&&(c[q]=b[q]);return c},
invert:function(b){b=f.normalize(b);var c=b.xx*b.yy-b.xy*b.yx;return b=new f.Matrix2D({xx:b.yy/c,xy:-b.xy/c,yx:-b.yx/c,yy:b.xx/c,dx:(b.xy*b.dy-b.yy*b.dx)/c,dy:(b.yx*b.dx-b.xx*b.dy)/c})},_multiplyPoint:function(b,c,f){return{x:b.xx*c+b.xy*f+b.dx,y:b.yx*c+b.yy*f+b.dy}},multiplyPoint:function(b,c,q){b=f.normalize(b);return"number"==typeof c&&"number"==typeof q?f._multiplyPoint(b,c,q):f._multiplyPoint(b,c.x,c.y)},multiplyRectangle:function(b,c){var q=f.normalize(b);c=c||{x:0,y:0,width:0,height:0};if(f.isIdentity(q))return{x:c.x,
y:c.y,width:c.width,height:c.height};b=f.multiplyPoint(q,c.x,c.y);var l=f.multiplyPoint(q,c.x,c.y+c.height),t=f.multiplyPoint(q,c.x+c.width,c.y);c=f.multiplyPoint(q,c.x+c.width,c.y+c.height);var q=Math.min(b.x,l.x,t.x,c.x),e=Math.min(b.y,l.y,t.y,c.y);return{x:q,y:e,width:Math.max(b.x,l.x,t.x,c.x)-q,height:Math.max(b.y,l.y,t.y,c.y)-e}},multiply:function(b){for(var c=f.normalize(b),q=1;q<arguments.length;++q){var l=c,t=f.normalize(arguments[q]),c=new f.Matrix2D;c.xx=l.xx*t.xx+l.xy*t.yx;c.xy=l.xx*t.xy+
l.xy*t.yy;c.yx=l.yx*t.xx+l.yy*t.yx;c.yy=l.yx*t.xy+l.yy*t.yy;c.dx=l.xx*t.dx+l.xy*t.dy+l.dx;c.dy=l.yx*t.dx+l.yy*t.dy+l.dy}return c},_sandwich:function(b,c,l){return f.multiply(f.translate(c,l),b,f.translate(-c,-l))},scaleAt:function(b,c,l,u){switch(arguments.length){case 4:return f._sandwich(f.scale(b,c),l,u);case 3:return"number"==typeof l?f._sandwich(f.scale(b),c,l):f._sandwich(f.scale(b,c),l.x,l.y)}return f._sandwich(f.scale(b),c.x,c.y)},rotateAt:function(b,c,l){return 2<arguments.length?f._sandwich(f.rotate(b),
c,l):f._sandwich(f.rotate(b),c.x,c.y)},rotategAt:function(b,c,l){return 2<arguments.length?f._sandwich(f.rotateg(b),c,l):f._sandwich(f.rotateg(b),c.x,c.y)},skewXAt:function(b,c,l){return 2<arguments.length?f._sandwich(f.skewX(b),c,l):f._sandwich(f.skewX(b),c.x,c.y)},skewXgAt:function(b,c,l){return 2<arguments.length?f._sandwich(f.skewXg(b),c,l):f._sandwich(f.skewXg(b),c.x,c.y)},skewYAt:function(b,c,l){return 2<arguments.length?f._sandwich(f.skewY(b),c,l):f._sandwich(f.skewY(b),c.x,c.y)},skewYgAt:function(b,
c,l){return 2<arguments.length?f._sandwich(f.skewYg(b),c,l):f._sandwich(f.skewYg(b),c.x,c.y)}});v.Matrix2D=f.Matrix2D;return f})},"esri/core/colorUtils":function(){define(["require","exports"],function(v,r){function f(b,c){var a=[],h,e;if(b[0].length!==c.length)throw"dimensions do not match";var m=b.length,k=b[0].length,p=0;for(h=0;h<m;h++){for(e=p=0;e<k;e++)p+=b[h][e]*c[e];a.push(p)}return a}function l(b){b=[b.r/255,b.g/255,b.b/255].map(function(b){return.04045>=b?b/12.92:Math.pow((b+.055)/1.055,
2.4)});b=f(t,b);return{x:100*b[0],y:100*b[1],z:100*b[2]}}function b(b){b=f(e,[b.x/100,b.y/100,b.z/100]).map(function(b){return Math.min(1,Math.max(.0031308>=b?12.92*b:1.055*Math.pow(b,1/2.4)-.055,0))});return{r:Math.round(255*b[0]),g:Math.round(255*b[1]),b:Math.round(255*b[2])}}function c(b){b=[b.x/95.047,b.y/100,b.z/108.883].map(function(b){return b>Math.pow(6/29,3)?Math.pow(b,1/3):1/3*Math.pow(29/6,2)*b+4/29});return{l:116*b[1]-16,a:500*(b[0]-b[1]),b:200*(b[1]-b[2])}}function q(b){var c=b.l;b=[(c+
16)/116+b.a/500,(c+16)/116,(c+16)/116-b.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*b[0],y:100*b[1],z:108.883*b[2]}}function u(c){if("r"in c&&"g"in c&&"b"in c)return c;if("l"in c&&"c"in c&&"h"in c){var h=c.c,a=c.h;return b(q({l:c.l,a:h*Math.cos(a),b:h*Math.sin(a)}))}if("l"in c&&"a"in c&&"b"in c)return b(q(c));if("x"in c&&"y"in c&&"z"in c)return b(c);if("h"in c&&"s"in c&&"v"in c){a=(c.h+360)%360/60;h=c.v/100*255;c=c.s/100*h;var g=c*(1-Math.abs(a%
2-1));switch(Math.floor(a)){case 0:a={r:c,g:g,b:0};break;case 1:a={r:g,g:c,b:0};break;case 2:a={r:0,g:c,b:g};break;case 3:a={r:0,g:g,b:c};break;case 4:a={r:g,g:0,b:c};break;case 5:case 6:a={r:c,g:0,b:g};break;default:a={r:0,g:0,b:0}}a.r=Math.round(a.r+h-c);a.g=Math.round(a.g+h-c);a.b=Math.round(a.b+h-c);return a}}Object.defineProperty(r,"__esModule",{value:!0});var t=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],e=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];
r.toRGB=u;r.toHSV=function(b){if("h"in b&&"s"in b&&"v"in b)return b;var c=u(b);b=c.r;var a=c.g,c=c.b,g=Math.max(b,a,c),e=g-Math.min(b,a,c),h;0===e?h=0:g===b?h=(a-c)/e%6:g===a?h=(c-b)/e+2:g===c&&(h=(b-a)/e+4);0>h&&(h+=6);return{h:60*h,s:100*(0===e?0:e/g),v:100/255*g}};r.toLAB=function(b){return"l"in b&&"a"in b&&"b"in b?b:c(l(u(b)))};r.toLCH=function(b){if(!("l"in b&&"c"in b&&"h"in b)){var e=c(l(u(b)));b=e.l;var a=e.a,g=e.b,e=Math.sqrt(a*a+g*g),a=Math.atan2(g,a),a=0<a?a:a+2*Math.PI;b={l:b,c:e,h:a}}return b};
r.toXYZ=function(b){return"x"in b&&"y"in b&&"z"in b?b:l(u(b))}})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),function(v,r,f,l,b,c,q,u,t,e,h,n,a,g,x){function m(a){var b=a.outline,d=a.material&&a.material.color,
d=d&&d.toRgba().toString();if(!b)return"fill"===a.type&&"255,255,255,1"===d?{color:"#bdc3c7",width:.75}:null;a=u.pt2px(b.size)||0;return{color:"rgba("+(null!=b.color?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function k(a,b){var d=b&&b.resource,d=d&&d.href;return a.thumbnail&&a.thumbnail.url?q.resolve(a.thumbnail.url):d&&"object"!==b.type?q.resolve(x.getIconHref(a,b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?g.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal}).catch(function(a){return a}).then(function(a){return a&&
a.thumbnail&&a.thumbnail.url||B}):q.resolve(B)}function p(a,b){void 0===b&&(b=0);if(!a.material||!a.material.color)return a=Math.min(Math.max(t.defaultThematicColor.r+191.25*b,0),255),[a,a,a,100];for(var d=a.material.color.toRgb(),c=0;3>c;c++)d[c]=Math.min(Math.max(d[c]+191.25*b,0),255);d.push(a.material.color.a);return d}function A(a){return a.outline?m(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function C(a,b){if(!a.material)return null;for(var d=a.material.color.toRgb(),c="rgba(",g=0;3>g;g++)c+=Math.min(Math.max(d[g]+
191.25*b,0),255)+",";return c+a.material.color.a+");"}function y(a,b){b=C(a,b);if(!b)return{};a=Math.min(a.size?u.pt2px(a.size):.75,80);return{color:b,width:a}}function z(a,b,d){d*=.75;return{type:"linear",x1:d?.25*d:0,y1:d?.5*d:0,x2:d||4,y2:d?.5*d:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function d(a){var b=a.depth,d=a.height;return(a=a.width)&&b&&d&&a===b&&a<d}function w(a,b,d){var c=[];if(!a)return c;switch(a.type){case "icon":var g=a.resource&&a.resource.primitive||e.defaultPrimitive;
switch(g){case "circle":c.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:p(a,0),stroke:m(a)});break;case "square":c.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[0,0]},{command:"L",values:[b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:p(a,0),stroke:m(a)});break;case "triangle":c.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:p(a,0),stroke:m(a)});
break;case "cross":c.push({shape:{type:"path",path:[{command:"M",values:[.5*b,0]},{command:"L",values:[.5*b,b]},{command:"M",values:[0,.5*b]},{command:"L",values:[b,.5*b]},{command:"E",values:[]}]},stroke:A(a)});break;case "x":c.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[b,b]},{command:"M",values:[b,0]},{command:"L",values:[0,b]},{command:"E",values:[]}]},stroke:A(a)});break;case "kite":c.push({shape:{type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",
values:[.5*b,0]},{command:"L",values:[b,.5*b]},{command:"L",values:[.5*b,b]},{command:"Z",values:[]}]},fill:p(a,0),stroke:m(a)});break;default:l.neverReached(g)}break;case "object":switch(g=a.resource&&a.resource.primitive||h.defaultPrimitive,g){case "cone":g=p(a,0);a=p(a,-.6);a=z(g,a,d?20:b);b=n.getConeShapes(b,d);c.push({shape:b[0],fill:a});c.push({shape:b[1],fill:a});break;case "inverted-cone":d=p(a,0);a=p(a,-.6);a=z(d,a,b);b=n.getInvertedConeShapes(b);c.push({shape:b[0],fill:a});c.push({shape:b[1],
fill:d});break;case "cube":b=n.getCubeShapes(b,d);c.push({shape:b[0],fill:p(a,0)});c.push({shape:b[1],fill:p(a,-.3)});c.push({shape:b[2],fill:p(a,-.5)});break;case "cylinder":var g=p(a,0),k=p(a,-.6),g=z(g,k,d?20:b);b=n.getCylinderShapes(b,d);c.push({shape:b[0],fill:g});c.push({shape:b[1],fill:g});c.push({shape:b[2],fill:p(a,0)});break;case "diamond":b=n.getDiamondShapes(b);c.push({shape:b[0],fill:p(a,-.3)});c.push({shape:b[1],fill:p(a,0)});c.push({shape:b[2],fill:p(a,-.3)});c.push({shape:b[3],fill:p(a,
-.7)});break;case "sphere":d=p(a,0);a=p(a,-.6);a=z(d,a);a.x1=0;a.y1=0;a.x2=.25*b;a.y2=.25*b;c.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:a});break;case "tetrahedron":b=n.getTetrahedronShapes(b);c.push({shape:b[0],fill:p(a,-.3)});c.push({shape:b[1],fill:p(a,0)});c.push({shape:b[2],fill:p(a,-.6)});break;default:l.neverReached(g)}}return c}function E(b,c){var g=c&&c.size?u.pt2px(c.size):null,e=c&&c.maxSize?u.pt2px(c.maxSize):null,p=c&&c.disableUpsampling,h=b.symbolLayers,f=[],l=0,x=0,n=h.getItemAt(h.length-
1),y;n&&"icon"===n.type&&(y=n.size&&u.pt2px(n.size));h.forEach(function(h,n){if("icon"===h.type||"object"===h.type){n="icon"===h.type?h.size&&u.pt2px(h.size):0;var E=g||n?Math.ceil(Math.min(g||n,e||120)):22,z="icon"===h.type?m(h):null,t=z?z.width:0;h&&h.resource&&h.resource.href?(n=k(b,h).then(function(b){var d=h.get("material.color"),c;c="icon"===h.type?"multiply":"tint";return a.tintImageWithColor(b,E,d,c,p)}).then(function(a){var b=a.width,d=a.height;l=Math.max(l,b+t+1);x=Math.max(x,d+t+1);return[{shape:{type:"image",
x:0,y:0,width:b,height:d,src:a.url},fill:null,stroke:null}]}),f.unshift(n)):(z=E,"icon"===h.type&&y&&g&&(z=n/y*E),n=c&&"tall"===c.symbolConfig||("object"===h.type?d(h):!1),l=Math.max(l,n?20:z+t+1),x=Math.max(x,z+t+1),f.unshift(q.resolve(w(h,z,n))))}});return q.eachAlways(f).then(function(b){var d=[];b.forEach(function(a){a.value?d.push(a.value):a.error&&F.warn("error while building swatchInfo!",a.error)});return a.renderSymbol(d,[l,x],{node:c&&c.node,scale:!1})})}function G(b,d){var c=b.symbolLayers,
g=[];b=x.isVolumetricSymbol(b);var k=d&&d.size?u.pt2px(d.size):null,e=(d&&d.maxSize?u.pt2px(d.maxSize):null)||80,h=0,w=0,f;c.forEach(function(a,b){if(a&&("line"===a.type||"path"===a.type)){var d=[];switch(a.type){case "line":var c=(a=y(a,0))&&a.width||0;0===b&&(f=c);var m=Math.min(k||c,e);b=0===b?m:k?c/f*m:m;w=Math.max(w,b);h=Math.max(h,22<b?b+1:40);a.width=b;d.push({shape:{type:"path",path:[{command:"M",values:[0,.5*w]},{command:"L",values:[h,.5*w]},{command:"E",values:[]}]},stroke:a});break;case "path":b=
Math.min(k||22,e),c=p(a,0),m=p(a,-.2),a=(a=C(a,-.4))?{color:a,width:1}:{},d.push({shape:n.shapes.pathSymbol3DLayer[0],fill:m,stroke:a}),d.push({shape:n.shapes.pathSymbol3DLayer[1],fill:c,stroke:a}),h=w=Math.max(w,b+(a.width||0)+1)}g.push(d)}});return q.resolve(a.renderSymbol(g,[h,w],{node:d&&d.node,scale:b}))}Object.defineProperty(r,"__esModule",{value:!0});var B=v.toUrl("../../images/Legend/legend3dsymboldefault.png"),F=c.getLogger("esri.symbols.support.previewSymbol3D");r.getSymbolLayerFill=p;r.previewSymbol3D=
function(d,c){if(0===d.symbolLayers.length)return q.reject(new b("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var g=null;switch(d.type){case "point-3d":g=E(d,c);break;case "line-3d":g=G(d,c);break;case "polygon-3d":case "mesh-3d":g="mesh-3d"===d.type;d=d.symbolLayers;for(var k=c&&c.size?u.pt2px(c.size):null,e=c&&c.maxSize?u.pt2px(c.maxSize):null,k=k||22,w=[],h=0,l=0,x=!1,z=0;z<d.length;z++){var t=d.getItemAt(z),A=[];if(!g||"fill"===t.type){var r=n.shapes.fill[0];switch(t.type){case "fill":var B=
m(t),x=B&&B.width||0,h=Math.max(h,k+x),l=Math.max(l,k+x),x=!0;A.push({shape:r,fill:p(t,0),stroke:B});break;case "line":t=(B=y(t,0))&&B.width||0;r={stroke:B,shape:r};h=Math.max(h,22+t);l=Math.max(l,22+t);A.push(r);break;case "extrude":var r=f({join:"round"},y(t,-.4)),B=p(t,0),t=p(t,-.2),C=Math.min(k,e||120),v=n.getExtrudeSymbolShapes(C);r.width=1;A.push({shape:v[0],fill:t,stroke:r});A.push({shape:v[1],fill:t,stroke:r});A.push({shape:v[2],fill:B,stroke:r});t=22*.7+.5*C;h=Math.max(h,22+r.width+1);l=
Math.max(l,t+r.width+1)}w.push(A)}}g=q.resolve(a.renderSymbol(w,[h,l],{node:c&&c.node,scale:x}))}return g?g:q.reject(new b("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require","exports","../../request","../../core/screenUtils"],function(v,r,f,l){Object.defineProperty(r,"__esModule",{value:!0});r.previewWebStyleSymbol=function(b,c,q){var u=b.thumbnail&&b.thumbnail.url;return u?f(u,{responseType:"image"}).then(function(b){b=
b.data;var c=!/\\.svg$/i.test(b.src)&&q&&q.disableUpsampling,h=Math.max(b.width,b.height),f=q&&null!=q.maxSize?l.pt2px(q.maxSize):120;c&&(f=Math.min(h,f));c=Math.min(f,q&&null!=q.size?l.pt2px(q.size):h);c!==h&&(h=0!==b.width&&0!==b.height?b.width/b.height:1,1<=h?(b.width=c,b.height=c/h):(b.width=c*h,b.height=c));return q&&q.node?(q.node.appendChild(b),q.node):b}):b.fetchSymbol().then(function(b){return c(b,q)})}})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../Color ../../../core/numberUtils ../../../symbols/support/gfxUtils ./utils".split(" "),
function(v,r,f,l,b,c){function q(b,c){b=u(b,c);var a=b.startIndex,g=b.endIndex;if(a===g)return c[a].color;c=f.blendColors(c[a].color,c[g].color,b.weight);return new f(c)}function u(b,c){var a=0,g=c.length-1;c.some(function(c,e){if(b<c.value)return g=e,!0;a=e;return!1});return{startIndex:a,endIndex:g,weight:(b-c[a].value)/(c[g].value-c[a].value)}}Object.defineProperty(r,"__esModule",{value:!0});var t=[64,64,64],e=[255,255,255];r.getRampBorderColor=function(c){var e=null;if("simple"===c.type)e=c.symbol;
else if("unique-value"===c.type||"class-breaks"===c.type)e=(c=(c=c.classBreakInfos||c.uniqueValueInfos)&&c[0])&&c.symbol;return(c=(c=e&&-1===e.type.indexOf("line-symbol")?b.getStroke(e):null)&&c.color)&&0<c.a&&!(240<=c.r&&240<=c.g&&240<=c.b)?c:null};r.getRampOverlayColor=function(b){var c=new f(e);c.a=1-b;return c};r.getRampStops=function(b,e,a){var g=!1,h=[],m=[];if(e.stops){var k=e.stops,h=k.map(function(a){return a.value});(g=k.some(function(a){return!!a.label}))&&(m=k.map(function(a){return a.label}))}var p=
h[0],k=h[h.length-1];if(null==p&&null==k)return null;var n=k-p;return h.map(function(k,x){var y;if("opacity"===e.type){y=a;void 0===y&&(y=t);y=new f(y);var d=b.getOpacity(k,{opacityInfo:e});null!=d&&(y.a=d)}else y=b.getColor(k,{colorInfo:e});x=g?m[x]:c.getLabelPrefix(x,h.length-1)+l.format(k);return{value:k,color:y,label:x,offset:n?1-(k-p)/n:1}}).reverse()};r.getRampStopsForPointCloud=function(b){var e=!1,a=[],g=[],a=b.map(function(a){return a.value});(e=b.some(function(a){return!!a.label}))&&(g=
b.map(function(a){return a.label}));var h=a[0],f=a[a.length-1];if(null==h&&null==f)return null;var k=f-h;return a.map(function(p,f){var m=q(p,b);f=e?g[f]:c.getLabelPrefix(f,a.length-1)+l.format(p);return{value:p,color:m,label:f,offset:k?1-(p-h)/k:1}}).reverse()};r.getColorFromPointCloudStops=q})},"esri/widgets/Legend/support/utils":function(){define(["require","exports"],function(v,r){Object.defineProperty(r,"__esModule",{value:!0});r.getLabelPrefix=function(f,l){return 0===f?"\x3c ":f===l?"\x3e ":
""}})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],function(v,r,f){Object.defineProperty(r,"__esModule",{value:!0});r.getHeatmapRampStops=function(l){l=l.colorStops;var b=l.length-1;if(l&&l[0]){var c=l[b];c&&1!==c.ratio&&(l=l.slice(0),l.push(new f.HeatmapColorStop({ratio:1,color:c.color})),b++)}return l.map(function(c,f){var l="";0===f?l="low":f===b&&(l="high");return{color:c.color,label:l,ratio:c.ratio,offset:1-
c.ratio}}).reverse()}})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define("require exports dojox/gfx dojox/gfx/matrix ../../../symbols/support/gfxUtils ../../../symbols/support/previewSymbol3D".split(" "),function(v,r,f,l,b,c){function q(a){if(a){var g=a.type;return-1<g.indexOf("3d")?c.getSymbolLayerFill(a.symbolLayers.getItemAt(0)):"simple-line"===g||"simple-marker"===a.type&&("x"===a.style||"cross"===a.style)?(a=b.getStroke(a))&&a.color:b.getFill(a)}}function u(a,b){var c=b.HH.label,
g=b.LL.label,e=b.HL.label;b=b.LH.label;switch(a){case "HH":return{top:c,bottom:g,left:e,right:b};case "HL":return{top:e,bottom:b,left:g,right:c};case "LL":return{top:g,bottom:c,left:b,right:e};case "LH":return{top:b,bottom:e,left:c,right:g};default:return{top:c,bottom:g,left:e,right:b}}}function t(a){var b=n[a];a&&null==b&&(b=n.HH);return b||0}function e(a,b,c,k){var g=k+"_arrowStart";k+="_arrowEnd";b="left"===b;switch(c){case "HL":a.setAttribute(b?"marker-start":"marker-end","url(#"+(b?k:g)+")");
break;case "LL":a.setAttribute("marker-start","url(#"+k+")");break;case "LH":a.setAttribute(b?"marker-end":"marker-start","url(#"+(b?g:k)+")");break;default:a.setAttribute("marker-end","url(#"+g+")")}}function h(a,b,c){var g="start"===b;b=g?c+"_arrowStart":c+"_arrowEnd";c=g?"0,0 5,5 0,10":"5,0 0,5 5,10";var e=g?"5":"0",g=document.createElementNS("http://www.w3.org/2000/svg","marker");g.setAttribute("id",b);g.setAttribute("markerWidth","10");g.setAttribute("markerHeight","10");g.setAttribute("refX",
e);g.setAttribute("refY","5");g.setAttribute("markerUnits","strokeWidth");g.setAttribute("orient","auto");b=document.createElementNS("http://www.w3.org/2000/svg","polyline");b.setAttribute("points",c);b.setAttribute("fill","none");b.setAttribute("stroke","#555555");b.setAttribute("stroke-width","1");g.appendChild(b);a.appendChild(g)}Object.defineProperty(r,"__esModule",{value:!0});var n={HH:315,HL:45,LL:135,LH:225},a={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],
4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};r.getRelationshipRampElement=function(b){var c=b.focus,g=b.numClasses,e=a[g],h={};b.infos.forEach(function(a){h[a.value]={label:a.label,fill:q(a.symbol)}});b=[];for(var f=0;f<g;f++){for(var l=[],y=0;y<g;y++)l.push(h[e[f][y]].fill);b.push(l)}e=u(c,h);return{type:"relationship-ramp",numClasses:g,focus:c,colors:b,labels:e,rotation:t(c)}};r.getRotationAngleForFocus=t;r.renderRamp=function(a,c,
m){void 0===m&&(m=60);var g=a.focus,p=a.numClasses,n=a.colors,q=a.rotation;a=!!g;var y=Math.sqrt(Math.pow(m,2)+Math.pow(m,2))+(a?0:5),x=document.createElement("div"),d=f.createSurface(x,y,y),w=b.create2DColorRamp({surface:d,colors:n,numClasses:p,size:m}),p=(y-m)/2,y=(y-m)/2;w.applyTransform(l.translate(p,y));var n=m/2,E=m/2;w.applyTransform(l.rotategAt(q,n,E));var q=d.createGroup(),w={width:1,color:"#555555"},u=d.defNode;h(u,"start",c);h(u,"end",c);u=q.createLine({x1:-10,y1:m-15,x2:-10,y2:15}).setStroke(w);
m=q.createLine({x1:15,y1:m+10,x2:m-15,y2:m+10}).setStroke(w);e(u.rawNode,"left",g,c);e(m.rawNode,"right",g,c);q.applyTransform(l.translate(p,y));a?q.applyTransform(l.rotategAt(-45,n,E)):d.rawNode.style.margin="-15px -15px -18px -15px";return x}})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../symbols ../../../core/numberUtils ../../../symbols/support/utils ./utils".split(" "),function(v,r,f,l,b,c){function q(a,b){var c=null,g=null;if("simple"===a.type)c=a.symbol;
else if("unique-value"===a.type||"class-breaks"===a.type)c=(c=(a=a.classBreakInfos||a.uniqueValueInfos)&&a[0])&&c.symbol,g=1<a.length;if(!c||u(c))return null;c=c.clone();if(b||g)-1<c.type.indexOf("3d")?t(c):(b=c,-1!==b.type.indexOf("line")?b.color=k:(b.color=x,"simple-marker"===b.type&&(b.outline={color:k,width:1.5})));return c}function u(a){if(a)return f.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill")}function t(a){b.isVolumetricSymbol(a)||
("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:k}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:m}:(a.material={color:x},a.outline={color:k,size:1.5})}))}function e(a,b,c,g,e){var d=a.getSizeRangeAtScale(b,g,e),k=d&&h(d);if(d||k){for(var f=k.map(function(a){var c=d.minSize,g=d.maxSize,e=b.minDataValue,k=b.maxDataValue;return a<=c?e:a>=g?k:(a-c)/(g-c)*(k-e)+e}),f=l.round(f),m=1;m<f.length-1;m++){var p=n(a,b,c,f[m],f[m-
1],g,e);p&&(f[m]=p[0],k[m]=p[1])}return f}}function h(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],g=0;5>g;g++)c.push(b+a*g);return c}function n(b,c,g,e,k,d,w){var h,f=a(b,c,g,e,d,w);k=a(b,c,g,k,d,w);var m=l.numDigits(e),p=m.fractional,n=m.integer,y=m=null;0<e&&1>e&&(m=Math.pow(10,p),e*=m,n=l.numDigits(e).integer);for(p=n-1;0<=p;p--){var q=Math.pow(10,p),n=Math.floor(e/q)*q,q=Math.ceil(e/q)*q;null!=m&&(n/=m,q/=m);h=(n+q)/2;h=l.round([n,h,q],{indexes:[1]});h=h[1];var x=a(b,c,g,n,d,w),u=a(b,c,
g,q,d,w),r=a(b,c,g,h,d,w),t=l.percentChange(f,x,k,null),z=l.percentChange(f,u,k,null),v=l.percentChange(f,r,k,null),A=20>=t.previous,C=20>=z.previous;A&&C&&(t.previous<=z.previous?(A=!0,C=!1):(C=!0,A=!1));A?y=[n,x]:C?y=[q,u]:20>=v.previous&&(y=[h,r]);if(y)break}return y}function a(a,b,c,g,e,d){return a.getSize(g,{sizeInfo:b,scale:e,view:d,shape:-1!==c.type.indexOf("marker-symbol")?c.style:null})}function g(a,c){a=a.clone();if(f.isSymbol3D(a))b.isVolumetricSymbol(a)||a.symbolLayers.forEach(function(a){"fill"!==
a.type&&(a.size=c)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=c;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var g=a.width,e=a.height;a.height=c;a.width=g/e*c}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=c:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&(a.font.size=c);return a}Object.defineProperty(r,"__esModule",{value:!0});r.REAL_WORLD_MAX_SIZE=30;r.REAL_WORLD_MIN_SIZE=12;var x=[255,255,255],m=[200,200,200],k=[128,128,128];r.getRampStops=
function(k,h,f,m,n){var d=h.legendOptions,d=d&&d.customValues,w=q(k,f);f=null!=h.minSize&&null!=h.maxSize;var p=h.stops&&1<h.stops.length,y=!!h.target;if(w&&(d||f||p&&!y)){var x=b.isVolumetricSymbol(w),u=null,t=null,z=null,t=x&&!p?l.round([h.minDataValue,h.maxDataValue]):d||e(k,h,w,m,n);!t&&p&&(t=h.stops.map(function(a){return a.value}),(u=h.stops.some(function(a){return!!a.label}))&&(z=h.stops.map(function(a){return a.label})));d=!x||t&&2===t.length;if(!t||!d)return null;var v=[r.REAL_WORLD_MIN_SIZE,
r.REAL_WORLD_MAX_SIZE],A=b.getSymbolOutlineSize(w);return t.map(function(b,d){var e=x?v[d]:a(k,h,w,b,m,n),f=g(w,e);d=u?z[d]:c.getLabelPrefix(d,t.length-1)+l.format(b);return{value:b,symbol:f,label:d,size:e,outlineSize:A}}).reverse()}}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/Handles ../../../core/lang ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),
function(v,r,f,l,b,c,q,u,t,e,h,n,a,g,x,m,k){var p=window.devicePixelRatio;return function(a){function b(b){b=a.call(this)||this;b._handles=new t;b._hasIndicators=!1;b._selectedSectionName=null;b._sectionNames=[];b._sectionMap=new Map;b.activeLayerInfos=null;b.layout="stack";b.type="card";b.view=null;return b}f(b,a);b.prototype.postInitialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};b.prototype.destroy=function(){this._handles.destroy();
this._handles=null};b.prototype.render=function(){var a=this,b;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var d=this.activeLayerInfos,g=d&&d.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;
var h=this._sectionNames.length,d=this._sectionNames.map(function(b,d){var g;d=e.substitute({index:d+1,total:h},c.pagination.pageText);return k.tsx("div",{key:b,"aria-label":d,title:d,tabIndex:0,onclick:a._selectSection,onkeydown:a._selectSection,bind:a,class:a.classes("esri-legend--card__carousel-indicator",(g={},g["esri-legend--card__carousel-indicator--activated"]=a._selectedSectionName===b,g)),"data-section-name":b})}),d=this._hasIndicators&&1<h?k.tsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},d):null,g=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):g&&g.length?g:null,f=(b={},b["esri-legend--stacked"]=this._hasIndicators,b);return k.tsx("div",{class:this.classes("esri-legend--card esri-widget",f)},d,g?g:k.tsx("div",{class:"esri-legend--card__message"},q.noLegend))};b.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};b.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();
a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)})))};b.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)};b.prototype._generateSectionNamesForActiveLayerInfo=
function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,g){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+g)})};b.prototype._renderLegendForLayer=function(a){var b=this,c;if(!a.ready)return null;if(a.children.length)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),k.tsx("div",{key:a.layer.uid,class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},
k.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),c);var g=a.legendElements;if(g&&!g.length)return null;var e=g.some(function(a){return"relationship-ramp"===a.type}),g=g.map(function(c,d){return b._renderLegendForElement(c,a,d,e)}).filter(function(a){return!!a});if(!g.length)return null;var h=(c={},c["esri-legend--card__group-layer-child"]=!!a.parent,c);return k.tsx("div",{key:a.layer.uid,class:this.classes("esri-legend--card__service",h)},k.tsx("div",{class:"esri-legend--card__service-caption-container"},
k.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),k.tsx("div",{class:"esri-legend--card__service-content"},g))};b.prototype._renderLegendForElement=function(a,b,c,e){var d=this;void 0===e&&(e=!1);var h,f="color-ramp"===a.type,w="opacity-ramp"===a.type,m="size-ramp"===a.type,l=b.layer,p=a.title,n=null;"string"===typeof p?n=p:p&&(n=x.getTitle(p,f||w),n=p.title?p.title+" ("+n+")":n);c="esri-legend--card__"+l.uid+"-type-"+a.type+"-"+c;l=this._hasIndicators?k.tsx("div",null,k.tsx("h3",
{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},b.title),k.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},n)):n?k.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},n):null;p=null;"symbol-table"===a.type?(m=a.infos.map(function(c,g){return d._renderLegendForElementInfo(c,b,a.legendType,g)}).filter(function(a){return!!a}),m.length&&(p=m[0].properties.classes&&m[0].properties.classes["esri-legend--card__symbol-row"],
e=(h={},h["esri-legend--card__label-container"]=!p&&!e,h["esri-legend--card__relationship-label-container"]=e,h),p=k.tsx("div",{key:c,class:"esri-legend--card__section"},l,k.tsx("div",{class:this.classes(e)},m)))):"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?p=k.tsx("div",{key:c,class:"esri-legend--card__section"},l,this._renderLegendForRamp(a)):m?p=k.tsx("div",{key:c,class:"esri-legend--card__section"},l,this._renderSizeRamps(a)):"relationship-ramp"===a.type&&(p=k.tsx("div",
{key:c,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},l,g.renderRelationshipRamp(a,this.id)));if(!p)return null;this._sectionMap.set(c,p);return p};b.prototype._renderLegendForElementInfo=function(a,b,c,g){var d,e,h,f=b.layer;if(a.type)return this._renderLegendForElement(a,b,g);b=x.isImageryStretchedLegend(f,c);if(a.symbol&&a.preview){if(-1===a.symbol.type.indexOf("simple-fill")){if(!a.label)return k.tsx("div",{key:g,bind:a.preview,afterCreate:x.attachToNode});
f=(d={},d["esri-legend--card__symbol-cell"]=this._hasIndicators,d);return k.tsx("div",{key:g,class:this.classes("esri-legend--card__layer-row",(e={},e["esri-legend--card__symbol-row"]=this._hasIndicators,e))},k.tsx("div",{class:this.classes(f),bind:a.preview,afterCreate:x.attachToNode}),k.tsx("div",{class:this.classes("esri-legend--card__image-label",(h={},h["esri-legend--card__label-cell"]=this._hasIndicators,h))},x.getTitle(a.label,!1)||""))}h=e=d=255;var f=0,w=c=b=255,l=0,p=a.symbol.color&&a.symbol.color.a,
n=a.symbol.outline&&a.symbol.outline.color.a;p&&(d=a.symbol.color.r,e=a.symbol.color.g,h=a.symbol.color.b,f=a.symbol.color.a);n&&(b=a.symbol.outline.color.r,c=a.symbol.outline.color.g,w=a.symbol.outline.color.b,l=a.symbol.outline.color.a);var q=a.symbol.color?m.isBright(a.symbol.color):!0,u=q?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return k.tsx("div",{key:g,class:"esri-legend--card__layer-row"},k.tsx("div",{class:"esri-legend--card__label-element",styles:{background:p?"rgba("+d+", "+e+", "+
h+", "+f+")":"none",color:q?"black":"white",textShadow:"-1px -1px 0 "+u+",\n                                              1px -1px 0 "+u+",\n                                              -1px 1px 0 "+u+",\n                                              1px 1px 0 "+u,border:n?"1px solid rgba("+b+", "+c+", "+w+", "+l+")":"none"}}," ",a.label," "))}if(a.src)return d=this._renderImage(a,f,b),k.tsx("div",{key:g,class:"esri-legend--card__layer-row"},d,k.tsx("div",{class:"esri-legend--card__image-label"},
a.label||""))};b.prototype._renderImage=function(a,b,c){var d,g=a.label,e=a.src,h=a.opacity;c=(d={},d["esri-legend--card__imagery-layer-image--stretched"]=c,d["esri-legend--card__symbol"]=!c,d);b={opacity:""+(null!=h?h:b.opacity)};return k.tsx("img",{alt:g,src:e,border:0,width:a.width,height:a.height,class:this.classes(c),styles:b})};b.prototype._drawImageOnSizeRamp=function(a,b,c){var d=c.x,g=c.y,e=c.width,k=c.height,h=new Image;h.src=b;h.onload=function(){a.drawImage(h,d,g,e,k);URL.revokeObjectURL(b)}};
b.prototype._attachSizeRampToNode=function(a){var b=a["data-legend-element"].infos,c=b[0],g=b[b.length-1],e=c.symbol,k=g.symbol,f="picture-marker"===e.type;e?-1<e.type.indexOf("3d")?(b=e.symbolLayers&&e.symbolLayers.length)?(b=e.symbolLayers.getItemAt(b-1).get("resource.primitive"),b="triangle"===b||"cone"===b||"tetrahedron"===b):b=void 0:b="triangle"===e.style:b=void 0;var m;e?-1<e.type.indexOf("3d")?(m=e.symbolLayers&&e.symbolLayers.length)?(m=e.symbolLayers.getItemAt(m-1),m=m.resource&&m.resource.primitive,
m="circle"===m||"cross"===m||"kite"===m||"sphere"===m||"cube"===m||"diamond"===m):m=void 0:(m=e.style,m="circle"===m||"diamond"===m||"cross"===m):m=void 0;var l,n;f?(l=e.url,n=k.url):(c.preview&&(c.preview.firstChild.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),l=new Blob([c.preview.innerHTML],{type:"image/svg+xml"}),l=URL.createObjectURL(l)),g.preview&&(g.preview.firstChild.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),
n=new Blob([g.preview.innerHTML],{type:"image/svg+xml"}),n=URL.createObjectURL(n)));var q=h.pt2px(c.size+c.outlineSize)*p,e=h.pt2px(g.size+g.outlineSize)*p,k=this._hasIndicators?q:q+100*p,f=this._hasIndicators?k+50*p:q,c=document.createElement("canvas");c.width=k;c.height=f;c.style.width=c.width/p+"px";c.style.height=c.height/p+"px";g=c.getContext("2d");this._hasIndicators?(this._drawImageOnSizeRamp(g,l,{x:0,y:0,width:q,height:q}),this._drawImageOnSizeRamp(g,n,{x:k/2-e/2,y:f-e,width:e,height:e}),
g.beginPath(),l=k/2-e/2,n=f-(b?0:m?e/2:e),g.moveTo(0,m?k/2:k),g.lineTo(l,n),l=k/2+e/2,b=f-(b?0:m?e/2:e),g.moveTo(k,m?k/2:k),g.lineTo(l,b)):(this._drawImageOnSizeRamp(g,l,{x:k-q,y:0,width:q,height:q}),this._drawImageOnSizeRamp(g,n,{x:0,y:f/2-e/2,width:e,height:e}),g.beginPath(),l=k-(m||b?q/2:q),g.moveTo(e-(m||b?e/2:0),f/2-e/2),g.lineTo(l,0),b=k-(m?q/2:q),g.moveTo(e-(m?e/2:0),f/2+e/2),g.lineTo(b,f));g.strokeStyle="#ddd";g.stroke();a.appendChild(c)};b.prototype._renderSizeRamps=function(a){var b,c=a.infos,
g=c[0].label,c=c[c.length-1].label;return k.tsx("div",{class:this.classes("esri-legend--card__layer-row",(b={},b["esri-legend--card__size-ramp-row"]=this._hasIndicators,b))},k.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?g:c),k.tsx("div",{class:"esri-legend--card__size-ramp-container"},k.tsx("div",{bind:this,"data-legend-element":a,afterCreate:this._attachSizeRampToNode})),k.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?c:g))};b.prototype._renderLegendForRamp=
function(a){var b=a.infos,c="heatmap-ramp"===a.type,g=b.length-1,e=2<g&&!c?25*g:100,h=e+20;a=document.createElement("div");a.style.width=h+"px";var f=u.createSurface(a,h,25),m=b.slice(0).reverse();try{m.forEach(function(a,b){a.offset=c?a.ratio:b/g}),c||f.createPath("M0 12.5 L10 0 L10 25 Z").setFill(m[0].color).setStroke(null),f.createRect({x:10,y:0,width:e,height:25}).setFill({type:"linear",x1:10,y1:0,x2:e+10,y2:0,colors:m}).setStroke(null),c||f.createPath("M"+(e+10)+" 0 L"+h+" 12.5 L"+(e+10)+" 25 Z").setFill(m[m.length-
1].color).setStroke(null)}catch(D){f.clear(),f.destroy()}if(!f)return null;e=m.filter(function(a,b){return!!a.label&&0!==b&&b!==m.length-1}).map(function(a){return k.tsx("div",{class:"esri-legend--card__interval-separators-container"},k.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),k.tsx("div",{class:"esri-legend--card__ramp-label"},a.label))});h=b[b.length-1].label;b=b[0].label;return k.tsx("div",{class:"esri-legend--card__layer-row"},k.tsx("div",{class:"esri-legend--card__ramp-label"},
c?q[h]:h),k.tsx("div",{class:"esri-legend--card__symbol-container"},k.tsx("div",{bind:a,afterCreate:x.attachToNode}),e),k.tsx("div",{class:"esri-legend--card__ramp-label"},c?q[b]:b))};l([k.renderable(),n.property()],b.prototype,"activeLayerInfos",void 0);l([n.property()],b.prototype,"layout",void 0);l([n.property({readOnly:!0})],b.prototype,"type",void 0);l([n.property()],b.prototype,"view",void 0);l([k.accessibleHandler()],b.prototype,"_selectSection",null);return b=l([n.subclass("esri.widgets.Legend.styles.Card")],
b)}(n.declared(a))})},"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports","../../support/relationshipRampUtils","../../support/styleUtils","../../../support/widget"],function(v,r,f,l,b){Object.defineProperty(r,"__esModule",{value:!0});r.renderRelationshipRamp=function(c,q){var u=c.labels,t=!!c.focus;c=f.renderRamp(c,q);return t?b.tsx("div",{class:"esri-relationship-ramp--diamond__container"},b.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},u.left),b.tsx("div",
{class:"esri-relationship-ramp--diamond__middle-column"},b.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},u.top),b.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--ramp",bind:c,afterCreate:l.attachToNode}),b.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},u.bottom)),b.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},u.right)):b.tsx("div",{class:"esri-relationship-ramp--square__table"},b.tsx("div",{class:"esri-relationship-ramp--square__table-row"},
b.tsx("div",{class:b.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},u.left),b.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),b.tsx("div",{class:b.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},u.top)),b.tsx("div",{class:"esri-relationship-ramp--square__table-row"},
b.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),b.tsx("div",{class:"esri-relationship-ramp--square__table-cell",bind:c,afterCreate:l.attachToNode}),b.tsx("div",{class:"esri-relationship-ramp--square__table-cell"})),b.tsx("div",{class:"esri-relationship-ramp--square__table-row"},b.tsx("div",{class:b.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},u.bottom),b.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),
b.tsx("div",{class:b.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},u.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","dojo/i18n!../../Legend/nls/Legend","../../../core/lang"],function(v,r,f,l){Object.defineProperty(r,"__esModule",{value:!0});r.attachToNode=function(b){b.appendChild(this)};r.getTitle=function(b,c){if(b){if("string"===typeof b)return b;
if("value"in b||"unit"in b)return l.substitute(b,f.dotValue);var q=null;c?q=b.ratioPercentTotal?"showRatioPercentTotal":b.ratioPercent?"showRatioPercent":b.ratio?"showRatio":b.normField?"showNormField":b.field?"showField":null:c||(q=b.normField?"showNormField":b.normByPct?"showNormPct":b.field?"showField":null);return q?l.substitute({field:b.field,normField:b.normField},"showField"===q?"{field}":f[q]):null}};r.isRendererTitle=function(b,c){return!c};r.isImageryStretchedLegend=function(b,c){return!!(c&&
"Stretched"===c&&10.3<=b.version&&"esri.layers.ImageryLayer"===b.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(v,r,f){function l(b){return new f(b)}function b(b){return!!b&&4===b.length&&e.test(b)}function c(b){return!!b&&7===b.length&&h.test(b)}function q(b){return 127<=.299*b.r+.587*b.g+.114*b.b}function u(b,a){void 0===a&&(a=1);a=Math.pow(.7,a);return new f([Math.round(b.r*a),Math.round(b.g*a),Math.round(b.b*a),b.a])}function t(b,
a){void 0===a&&(a=1);a=Math.pow(.7,a);var c=b.r,e=b.g,h=b.b;30>c&&(c=30);30>e&&(e=30);30>h&&(h=30);return new f([Math.min(255,Math.round(c/a)),Math.min(255,Math.round(e/a)),Math.min(255,Math.round(h/a)),b.a])}Object.defineProperty(r,"__esModule",{value:!0});var e=/^#[0-9A-F]{3}$/i,h=/^#[0-9A-F]{6}$/i;r.equal=function(b,a){return b&&a&&b.r===a.r&&b.g===a.g&&b.b===a.b&&b.a===a.a};r.normalizeHex=function(b){return b?"#"+b.trim().replace(/#/g,"").substr(0,6):""};r.normalizeColor=l;r.isValidHex=function(e){return b(e)||
c(e)};r.isShorthandHex=b;r.isLonghandHex=c;r.toHex=function(b){return l(b).toHex()};r.getContrastingColor=function(b){return q(b)?u(b):t(b,3)};r.isBright=q;r.darker=u;r.brighter=t})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend dojox/gfx ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),
function(v,r,f,l,b,c,q,u,t,e,h){return function(n){function a(a){a=n.call(this)||this;a.activeLayerInfos=null;a.type="classic";return a}f(a,n);a.prototype.render=function(){var a=this,c=this.activeLayerInfos,e=this.classes("esri-legend esri-widget--panel","esri-widget"),c=c&&c.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});return h.tsx("div",{class:e},c&&c.length?c:h.tsx("div",{class:"esri-legend__message"},b.noLegend))};a.prototype._renderLegendForLayer=
function(a){var b=this,c;if(!a.ready)return null;var e=!!a.children.length,g="esri-legend__"+a.layer.uid+"-version-"+a.version,f=a.title?h.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(e)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),h.tsx("div",{key:g,class:this.classes("esri-legend__service","esri-legend__group-layer")},f,c);if((e=a.legendElements)&&!e.length)return null;e=e.map(function(c){return b._renderLegendForElement(c,
a.layer)}).filter(function(a){return!!a});if(!e.length)return null;var l=(c={},c["esri-legend__group-layer-child"]=!!a.parent,c);return h.tsx("div",{key:g,class:this.classes("esri-legend__service",l)},f,h.tsx("div",{class:"esri-legend__layer"},e))};a.prototype._renderLegendForElement=function(a,b,c){var g=this,f,m="color-ramp"===a.type,l="opacity-ramp"===a.type,q="size-ramp"===a.type,n=null;if("symbol-table"===a.type||q){var d=a.infos.map(function(c){return g._renderLegendForElementInfo(c,b,q,a.legendType)}).filter(function(a){return!!a});
d.length&&(n=h.tsx("div",{class:"esri-legend__layer-body"},d))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?n=this._renderLegendForRamp(a):"relationship-ramp"===a.type&&(n=t.renderRelationshipRamp(a,this.id));if(!n)return null;var d=a.title,w=null;"string"===typeof d?w=d:d&&(w=e.getTitle(d,m||l),w=e.isRendererTitle(d,m||l)&&d.title?d.title+" ("+w+")":w);m=c?"esri-legend__layer-child-table":"esri-legend__layer-table";l=w?h.tsx("div",{class:"esri-legend__layer-caption"},
w):null;c=(f={},f["esri-legend__layer-table--size-ramp"]=q||!c,f);return h.tsx("div",{class:this.classes(m,c)},l,n)};a.prototype._renderLegendForRamp=function(a){var g=a.infos,f="opacity-ramp"===a.type,k="heatmap-ramp"===a.type,l=g.length-1,q=document.createElement("div");q.className="esri-legend__color-ramp "+(f?"esri-legend__opacity-ramp":"");q.style.height="75px";f=c.createSurface(q,"100%",75);try{if(k||g.forEach(function(a,b){a.offset=b/l}),f.createRect({x:0,y:0,width:"100%",height:75}).setFill({type:"linear",
x1:0,y1:0,x2:0,y2:75,colors:g}).setStroke(null),"color-ramp"===a.type||"opacity-ramp"===a.type){var n=a.overlayColor;n&&0<n.a&&f.createRect({x:0,y:0,width:"100%",height:75}).setFill(n).setStroke(null)}}catch(y){f.clear(),f.destroy()}if(!f)return null;a=g.filter(function(a){return!!a.label}).map(function(a){return h.tsx("div",{class:"esri-legend__ramp-label"},k?b[a.label]:a.label)});return h.tsx("div",{class:"esri-legend__layer-row"},h.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",
styles:{width:"24px"}},h.tsx("div",{class:"esri-legend__ramps",bind:q,afterCreate:e.attachToNode})),h.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},h.tsx("div",{class:"esri-legend__ramp-labels",styles:{height:"75px"}},a)))};a.prototype._renderLegendForElementInfo=function(a,b,c,k){var g,f;if(a.type)return this._renderLegendForElement(a,b,!0);var l=null;k=e.isImageryStretchedLegend(b,k);a.symbol&&a.preview?l=h.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:e.attachToNode}):
a.src&&(l=this._renderImage(a,b,k));if(!l)return null;b=(g={},g["esri-legend__imagery-layer-info--stretched"]=k,g);c=(f={},f["esri-legend__imagery-layer-info--stretched"]=k,f["esri-legend__size-ramp"]=!k&&c,f);return h.tsx("div",{class:"esri-legend__layer-row"},h.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",c)},l),h.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",b)},e.getTitle(a.label,!1)||""))};a.prototype._renderImage=
function(a,b,c){var e,g=a.label,f=a.src,l=a.opacity;c=(e={},e["esri-legend__imagery-layer-image--stretched"]=c,e["esri-legend__symbol"]=!c,e);b={opacity:""+(null!=l?l:b.opacity)};return h.tsx("img",{alt:g,src:f,border:0,width:a.width,height:a.height,class:this.classes(c),styles:b})};l([h.renderable(),q.property()],a.prototype,"activeLayerInfos",void 0);l([q.property({readOnly:!0})],a.prototype,"type",void 0);return a=l([q.subclass("esri.widgets.Legend.styles.Classic")],a)}(q.declared(u))})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),
function(v,r,f,l,b,c,q,u,t,e,h,n){function a(a,b){return f.doc.createElementNS?f.doc.createElementNS(a,b):f.doc.createElement(b)}function g(a,b,c,e){return a.setAttributeNS?a.setAttributeNS(b,c,e):a.setAttribute(c,e)}function x(a){return m.useSvgWeb?f.doc.createTextNode(a,!0):f.doc.createTextNode(a)}var m=e.svg={};m.useSvgWeb="undefined"!=typeof window.svgweb;var k=navigator.userAgent,p=r("ios"),A=r("chrome")?"auto":"optimizeLegibility";m.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};
m.getRef=function(a){return a&&"none"!=a?a.match(/^url\(#.+\)$/)?l.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?l.byId(a.slice(1)):null:null};m.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var C=0;m.Shape=b("dojox.gfx.svg.Shape",h.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");
(a=m.getRef(a))&&a.parentNode.removeChild(a)}this.clip&&(a=this.rawNode.getAttribute("clip-path"))&&(a=l.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);h.Shape.prototype.destroy.apply(this,arguments)},setFill:function(a){if(!a)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var b,d=function(a){this.setAttribute(a,b[a].toFixed(8))};if("object"==typeof a&&"type"in a){switch(a.type){case "linear":b=e.makeParameters(e.defaultLinearGradient,
a);a=this._setFillObject(b,"linearGradient");c.forEach(["x1","y1","x2","y2"],d,a);break;case "radial":b=e.makeParameters(e.defaultRadialGradient,a);a=this._setFillObject(b,"radialGradient");c.forEach(["cx","cy","r"],d,a);break;case "pattern":b=e.makeParameters(e.defaultPattern,a),a=this._setFillObject(b,"pattern"),c.forEach(["x","y","width","height"],d,a)}this.fillStyle=b;return this}this.fillStyle=b=e.normalizeColor(a);this.rawNode.setAttribute("fill",b.toCss());this.rawNode.setAttribute("fill-opacity",
b.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",0),this;if("string"==typeof a||v.isArray(a)||a instanceof t)a={color:a};a=this.strokeStyle=e.makeParameters(e.defaultStroke,a);a.color=e.normalizeColor(a.color);if(a){var c=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",a.color.a);b.setAttribute("stroke-width",
c);b.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);var d=a.style.toLowerCase();d in m.dasharray&&(d=m.dasharray[d]);if(d instanceof Array){var d=v._toArray(d),g;for(g=0;g<d.length;++g)d[g]*=c;if("butt"!=a.cap){for(g=0;g<d.length;g+=2)d[g]-=c,1>d[g]&&(d[g]=1);for(g=1;g<d.length;g+=2)d[g]+=c}d=d.join(",")}b.setAttribute("stroke-dasharray",d);b.setAttribute("dojoGfxStrokeStyle",
a.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof e.Surface);a=a.parent);return a},_setFillObject:function(b,c){var d=m.xmlns.svg;this.fillStyle=b;var h=this._getParentSurface().defNode,f=this.rawNode.getAttribute("fill");if(f=m.getRef(f))if(f.tagName.toLowerCase()!=c.toLowerCase()){var k=f.id;f.parentNode.removeChild(f);f=a(d,c);f.setAttribute("id",k);h.appendChild(f)}else for(;f.childNodes.length;)f.removeChild(f.lastChild);else f=a(d,c),f.setAttribute("id",
e._base._getUniqueId()),h.appendChild(f);if("pattern"==c)f.setAttribute("patternUnits","userSpaceOnUse"),d=a(d,"image"),d.setAttribute("x",0),d.setAttribute("y",0),d.setAttribute("width",(0>b.width?0:b.width).toFixed(8)),d.setAttribute("height",(0>b.height?0:b.height).toFixed(8)),g(d,m.xmlns.xlink,"xlink:href",b.src),f.appendChild(d);else for(f.setAttribute("gradientUnits","userSpaceOnUse"),c=0;c<b.colors.length;++c){var h=b.colors[c],k=a(d,"stop"),l=h.color=e.normalizeColor(h.color);k.setAttribute("offset",
h.offset.toFixed(8));k.setAttribute("stop-color",l.toCss());k.setAttribute("stop-opacity",l.a);f.appendChild(k)}this.rawNode.setAttribute("fill","url(#"+f.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return f},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+","+a.dy.toFixed(8)+
")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=e.makeParameters(this.shape,a);for(var b in this.shape)if("type"!=
b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(b){this.inherited(arguments);var c=b?"width"in b?"rect":"cx"in b?"ellipse":"points"in b?"polyline":"d"in b?"path":null:null;if(b&&!c)return this;"polyline"===
c&&(b=v.clone(b),b.points=b.points.join(","));var d,e=u.get(this.rawNode,"clip-path");e&&(d=l.byId(e.match(/gfx_clip[\d]+/)[0]))&&d.removeChild(d.childNodes[0]);b?(d?(c=a(m.xmlns.svg,c),d.appendChild(c)):(e="gfx_clip"+ ++C,this.rawNode.setAttribute("clip-path","url(#"+e+")"),d=a(m.xmlns.svg,"clipPath"),c=a(m.xmlns.svg,c),d.appendChild(c),this.rawNode.parentNode.insertBefore(d,this.rawNode),u.set(d,"id",e)),u.set(c,b)):(this.rawNode.removeAttribute("clip-path"),d&&d.parentNode.removeChild(d));return this},
_removeClipNode:function(){var a,b=u.get(this.rawNode,"clip-path");b&&(a=l.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});m.Group=b("dojox.gfx.svg.Group",m.Shape,{constructor:function(){h.Container._init.call(this)},setRawNode:function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);m.Shape.prototype.destroy.apply(this,arguments)}});m.Group.nodeType="g";m.Rect=b("dojox.gfx.svg.Rect",[m.Shape,h.Rect],{setShape:function(a){this.shape=
e.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!=b&&"r"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});m.Rect.nodeType="rect";m.Ellipse=b("dojox.gfx.svg.Ellipse",[m.Shape,h.Ellipse],{});m.Ellipse.nodeType="ellipse";m.Circle=b("dojox.gfx.svg.Circle",[m.Shape,h.Circle],{});m.Circle.nodeType="circle";
m.Line=b("dojox.gfx.svg.Line",[m.Shape,h.Line],{});m.Line.nodeType="line";m.Polyline=b("dojox.gfx.svg.Polyline",[m.Shape,h.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=e.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=e.makeParameters(this.shape,a);this.bbox=null;this._normalizePoints();a=[];b=this.shape.points;for(var c=0;c<b.length;++c)a.push(b[c].x.toFixed(8),b[c].y.toFixed(8));this.rawNode.setAttribute("points",
a.join(" "));return this}});m.Polyline.nodeType="polyline";m.Image=b("dojox.gfx.svg.Image",[m.Shape,h.Image],{setShape:function(a){this.shape=e.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!=b&&"src"!=b){var c=this.shape[b];if("width"===b||"height"===b)c=0>c?0:c;a.setAttribute(b,c)}a.setAttribute("preserveAspectRatio","none");g(a,m.xmlns.xlink,"xlink:href",this.shape.src);a.__gfxObject__=this;return this}});m.Image.nodeType="image";m.Text=b("dojox.gfx.svg.Text",
[m.Shape,h.Text],{setShape:function(a){this.shape=e.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.setAttribute("text-rendering",A);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(x(b.text));return this},getTextWidth:function(){var a=this.rawNode,
b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var c=0,e=a.firstChild.nodeValue;b.appendChild(a);if(""!=e)for(;!c;)c=a.getBBox?parseInt(a.getBBox().width):68;b.removeChild(a);return c},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(w){a={x:0,y:0,width:0,height:0}}return a}});m.Text.nodeType="text";m.Path=b("dojox.gfx.svg.Path",[m.Shape,n.Path],{_updateWithSegment:function(a){this.inherited(arguments);"string"==typeof this.shape.path&&
this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});m.Path.nodeType="path";m.TextPath=b("dojox.gfx.svg.TextPath",[m.Shape,n.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==typeof this.shape.path){var b=
this.rawNode;if(!b.firstChild){var c=a(m.xmlns.svg,"textPath"),f=x("");c.appendChild(f);b.appendChild(c)}c=(c=b.firstChild.getAttributeNS(m.xmlns.xlink,"href"))&&m.getRef(c);if(!c&&(f=this._getParentSurface())){var f=f.defNode,c=a(m.xmlns.svg,"path"),h=e._base._getUniqueId();c.setAttribute("id",h);f.appendChild(c);g(b.firstChild,m.xmlns.xlink,"xlink:href","#"+h)}c&&c.setAttribute("d",this.shape.path)}},_setText:function(){var b=this.rawNode;if(!b.firstChild){var c=a(m.xmlns.svg,"textPath"),e=x("");
c.appendChild(e);b.appendChild(c)}b=b.firstChild;c=this.text;b.setAttribute("alignment-baseline","middle");switch(c.align){case "middle":b.setAttribute("text-anchor","middle");b.setAttribute("startOffset","50%");break;case "end":b.setAttribute("text-anchor","end");b.setAttribute("startOffset","100%");break;default:b.setAttribute("text-anchor","start"),b.setAttribute("startOffset","0%")}b.setAttribute("baseline-shift","0.5ex");b.setAttribute("text-decoration",c.decoration);b.setAttribute("rotate",
c.rotated?90:0);b.setAttribute("kerning",c.kerning?"auto":0);b.firstChild.data=c.text}});m.TextPath.nodeType="text";var y=534<function(){var a=/WebKit\/(\d*)/.exec(k);return a?a[1]:0}();m.Surface=b("dojox.gfx.svg.Surface",h.Surface,{constructor:function(){h.Container._init.call(this)},destroy:function(){h.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,b){if(!this.rawNode)return this;a=0>a?0:a;b=0>b?0:b;this.rawNode.setAttribute("width",a);this.rawNode.setAttribute("height",
b);y&&(this.rawNode.style.width=a,this.rawNode.style.height=b);return this},getDimensions:function(){return this.rawNode?{width:e.normalizedLength(this.rawNode.getAttribute("width")),height:e.normalizedLength(this.rawNode.getAttribute("height"))}:null}});m.createSurface=function(b,c,g){var d=new m.Surface;d.rawNode=a(m.xmlns.svg,"svg");d.rawNode.setAttribute("overflow","hidden");c&&d.rawNode.setAttribute("width",0>c?0:c);g&&d.rawNode.setAttribute("height",0>g?0:g);c=a(m.xmlns.svg,"defs");d.rawNode.appendChild(c);
d.defNode=c;d._parent=l.byId(b);d._parent.appendChild(d.rawNode);e._base._fixMsTouchAction(d);return d};r={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var z=h.Container;b=m.Container={openBatch:function(){if(!this._batch){var a;a=m.useSvgWeb?f.doc.createDocumentFragment(!0):
f.doc.createDocumentFragment();this.fragment=a}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),z.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,b){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&
this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),z.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var b=this.defNode;if(b){for(;b.lastChild;)b.removeChild(b.lastChild);a.appendChild(b)}return z.clear.apply(this,arguments)},getBoundingBox:z.getBoundingBox,_moveChildToFront:z._moveChildToFront,_moveChildToBack:z._moveChildToBack};
n=m.Creator={createObject:function(b,c){if(!this.rawNode)return null;var d=new b;b=a(m.xmlns.svg,b.nodeType);d.setRawNode(b);d.setShape(c);this.add(d);return d}};v.extend(m.Text,r);v.extend(m.TextPath,r);v.extend(m.Group,b);v.extend(m.Group,h.Creator);v.extend(m.Group,n);v.extend(m.Surface,b);v.extend(m.Surface,h.Creator);v.extend(m.Surface,n);m.fixTarget=function(a,b){a.gfxTarget||(a.gfxTarget=p&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};m.useSvgWeb&&
(m.createSurface=function(b,c,g){var d=new m.Surface;c=0>c?0:c;g=0>g?0:g;if(!c||!g){var f=q.position(b);c=c||f.w;g=g||f.h}b=l.byId(b);var f=b.id?b.id+"_svgweb":e._base._getUniqueId(),h=a(m.xmlns.svg,"svg");h.id=f;h.setAttribute("width",c);h.setAttribute("height",g);svgweb.appendChild(h,b);h.addEventListener("SVGLoad",function(){d.rawNode=this;d.isLoaded=!0;var b=a(m.xmlns.svg,"defs");d.rawNode.appendChild(b);d.defNode=b;if(d.onLoad)d.onLoad(d)},!1);d.isLoaded=!1;return d},m.Surface.extend({destroy:function(){var a=
this.rawNode;svgweb.removeChild(a,a.parentNode)}}),r={connect:function(a,b,c){"on"===a.substring(0,2)&&(a=a.substring(2));c=2==arguments.length?b:v.hitch(b,c);this.getEventSource().addEventListener(a,c,!1);return[this,a,c]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);delete a[0]}},v.extend(m.Shape,r),v.extend(m.Surface,r));return m})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),
function(v,r,f,l,b,c,q,u,t,e){function h(a,b){for(var c=a.length-1;b<c;)a[b]=a[++b];a.length=c}var n=v.shape={};n.Shape=f("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(b("gfxRegistry")){var a=n.register(this);this.getUID=function(){return a}}},destroy:function(){b("gfxRegistry")&&n.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=
null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[e.multiplyPoint(b,a.x,a.y),e.multiplyPoint(b,a.x+a.width,a.y),e.multiplyPoint(b,a.x+
a.width,a.y+a.height),e.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=v.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=v.makeParameters(v.defaultLinearGradient,a);break;case "radial":b=v.makeParameters(v.defaultRadialGradient,
a);break;case "pattern":b=v.makeParameters(v.defaultPattern,a)}else b=v.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||r.isArray(a)||a instanceof t)a={color:a};a=this.strokeStyle=v.makeParameters(v.defaultStroke,a);a.color=v.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=e.clone(a?e.normalize(a):e.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=
this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&
this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?e.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=e.multiply(b.matrix,a)),b=b.parent;return a}});n._eventsProcessing={on:function(a,b){return c(this.getEventSource(),a,n.fixCallback(this,v.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));
return this.on(a,c?r.hitch(b,c):b)},disconnect:function(a){return a.remove()}};n.fixCallback=function(a,b,c,e){e||(e=c,c=null);if(r.isString(e)){c=c||l.global;if(!c[e])throw['dojox.gfx.shape.fixCallback: scope["',e,'"] is null (scope\x3d"',c,'")'].join("");return function(g){return b(g,a)?c[e].apply(c,arguments||[]):void 0}}return c?function(g){return b(g,a)?e.apply(c,arguments||[]):void 0}:function(g){return b(g,a)?e.apply(c,arguments):void 0}};r.extend(n.Shape,n._eventsProcessing);n.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);h(this.children,c);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;q.forEach(this.children,function(b){var c=b.getBoundingBox();c&&((b=b.getTransform())&&(c=e.multiplyRectangle(b,c)),a?(a.x=Math.min(a.x,c.x),a.y=Math.min(a.y,c.y),a.endX=Math.max(a.endX,c.x+c.width),a.endY=Math.max(a.endY,c.y+c.height)):a={x:c.x,y:c.y,endX:c.x+c.width,endY:c.y+c.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){h(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){h(this.children,b);this.children.unshift(a);break}return this}};n.Surface=f("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){q.forEach(this._nodes,u.destroy);this._nodes=[];q.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(b("ie"))for(;this._parent.lastChild;)u.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var e=r.hitch(a,b);if(this.isLoaded)e(this);else c.once(this,"load",function(a){e(a)})}});r.extend(n.Surface,n._eventsProcessing);n.Rect=f("dojox.gfx.shape.Rect",n.Shape,{constructor:function(a){this.shape=v.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});n.Ellipse=f("dojox.gfx.shape.Ellipse",n.Shape,{constructor:function(a){this.shape=v.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});n.Circle=f("dojox.gfx.shape.Circle",n.Shape,{constructor:function(a){this.shape=v.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});n.Line=f("dojox.gfx.shape.Line",n.Shape,{constructor:function(a){this.shape=v.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});n.Polyline=f("dojox.gfx.shape.Polyline",n.Shape,{constructor:function(a){this.shape=v.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],e=0;e<b;e+=2)c.push({x:a[e],y:a[e+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],e=c.x,f=c.y,h=c.x,l=c.y,q=1;q<b;++q)c=
a[q],e>c.x&&(e=c.x),h<c.x&&(h=c.x),f>c.y&&(f=c.y),l<c.y&&(l=c.y);this.bbox={x:e,y:f,width:h-e,height:l-f}}return this.bbox}});n.Image=f("dojox.gfx.shape.Image",n.Shape,{constructor:function(a){this.shape=v.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});n.Text=f(n.Shape,{constructor:function(a){this.fontStyle=null;this.shape=v.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?v.splitFontString(a):v.makeParameters(v.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=v._base._computeTextBoundingBox(this));return a}});n.Creator={createShape:function(a){switch(a.type){case v.defaultPath.type:return this.createPath(a);case v.defaultRect.type:return this.createRect(a);case v.defaultCircle.type:return this.createCircle(a);case v.defaultEllipse.type:return this.createEllipse(a);
case v.defaultLine.type:return this.createLine(a);case v.defaultPolyline.type:return this.createPolyline(a);case v.defaultImage.type:return this.createImage(a);case v.defaultText.type:return this.createText(a);case v.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(v.Group)},createRect:function(a){return this.createObject(v.Rect,a)},createEllipse:function(a){return this.createObject(v.Ellipse,a)},createCircle:function(a){return this.createObject(v.Circle,
a)},createLine:function(a){return this.createObject(v.Line,a)},createPolyline:function(a){return this.createObject(v.Polyline,a)},createImage:function(a){return this.createObject(v.Image,a)},createText:function(a){return this.createObject(v.Text,a)},createPath:function(a){return this.createObject(v.Path,a)},createTextPath:function(a){return this.createObject(v.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return n})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/declare","./matrix","./shape"],function(v,r,f,l,b){b=f("dojox.gfx.path.Path",b.Shape,{constructor:function(b){this.shape=r.clone(v.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=b;this.segmented=!1},setAbsoluteMode:function(b){this._confirmSegmented();this.absolute="string"==typeof b?"absolute"==b:b;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&
"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var b=this.bbox,f=this._getRealMatrix();this.bbox=null;for(var l=0,t=this.segments.length;l<t;++l)this._updateWithSegment(this.segments[l],f);f=this.bbox;this.bbox=b;return this.tbbox=f?[{x:f.l,y:f.t},{x:f.r,y:f.t},{x:f.r,y:f.b},{x:f.l,y:f.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in
this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(b,f,u){u&&(f=l.multiplyPoint(u,b,f),b=f.x,f=f.y);this.bbox&&"l"in this.bbox?(this.bbox.l>b&&(this.bbox.l=b),this.bbox.r<b&&(this.bbox.r=b),this.bbox.t>f&&(this.bbox.t=f),this.bbox.b<f&&(this.bbox.b=f)):this.bbox={l:b,b:f,r:b,t:f}},_updateWithSegment:function(b,f){var c=b.args,l=c.length,e;switch(b.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(e=0;e<l;e+=2)this._updateBBox(c[e],
c[e+1],f);this.last.x=c[l-2];this.last.y=c[l-1];this.absolute=!0;break;case "H":for(e=0;e<l;++e)this._updateBBox(c[e],this.last.y,f);this.last.x=c[l-1];this.absolute=!0;break;case "V":for(e=0;e<l;++e)this._updateBBox(this.last.x,c[e],f);this.last.y=c[l-1];this.absolute=!0;break;case "m":e=0;"x"in this.last||(this._updateBBox(this.last.x=c[0],this.last.y=c[1],f),e=2);for(;e<l;e+=2)this._updateBBox(this.last.x+=c[e],this.last.y+=c[e+1],f);this.absolute=!1;break;case "l":case "t":for(e=0;e<l;e+=2)this._updateBBox(this.last.x+=
c[e],this.last.y+=c[e+1],f);this.absolute=!1;break;case "h":for(e=0;e<l;++e)this._updateBBox(this.last.x+=c[e],this.last.y,f);this.absolute=!1;break;case "v":for(e=0;e<l;++e)this._updateBBox(this.last.x,this.last.y+=c[e],f);this.absolute=!1;break;case "c":for(e=0;e<l;e+=6)this._updateBBox(this.last.x+c[e],this.last.y+c[e+1],f),this._updateBBox(this.last.x+c[e+2],this.last.y+c[e+3],f),this._updateBBox(this.last.x+=c[e+4],this.last.y+=c[e+5],f);this.absolute=!1;break;case "s":case "q":for(e=0;e<l;e+=
4)this._updateBBox(this.last.x+c[e],this.last.y+c[e+1],f),this._updateBBox(this.last.x+=c[e+2],this.last.y+=c[e+3],f);this.absolute=!1;break;case "A":for(e=0;e<l;e+=7)this._updateBBox(c[e+5],c[e+6],f);this.last.x=c[l-2];this.last.y=c[l-1];this.absolute=!0;break;case "a":for(e=0;e<l;e+=7)this._updateBBox(this.last.x+=c[e+5],this.last.y+=c[e+6],f);this.absolute=!1}b=[b.action];for(e=0;e<l;++e)b.push(v.formatNumber(c[e],!0));if("string"==typeof this.shape.path)this.shape.path+=b.join("");else for(e=
0,l=b.length;e<l;++e)this.shape.path.push(b[e])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(b,f){this.tbbox=null;var c=this._validSegments[b.toLowerCase()];"number"==typeof c&&(c?f.length>=c&&(b={action:b,args:f.slice(0,f.length-f.length%c)},this.segments.push(b),this._updateWithSegment(b)):(b={action:b,args:[]},this.segments.push(b),this._updateWithSegment(b)))},_collectArgs:function(b,f){for(var c=0;c<f.length;++c){var l=f[c];"boolean"==typeof l?b.push(l?1:0):
"number"==typeof l?b.push(l):l instanceof Array?this._collectArgs(b,l):"x"in l&&"y"in l&&b.push(l.x,l.y)}},moveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"M":"m",b);return this},lineTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"L":"l",b);return this},hLineTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?
"H":"h",b);return this},vLineTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"V":"v",b);return this},curveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"C":"c",b);return this},smoothCurveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"S":"s",b);return this},qCurveTo:function(){this._confirmSegmented();var b=
[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"Q":"q",b);return this},qSmoothCurveTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"T":"t",b);return this},arcTo:function(){this._confirmSegmented();var b=[];this._collectArgs(b,arguments);this._pushSegment(this.absolute?"A":"a",b);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var b=
this.shape.path;this.shape.path=[];this._setPath(b);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(b){b=r.isArray(b)?b:b.match(v.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(b){for(var c="",f=[],l=b.length,e=0;e<l;++e){var h=b[e],n=parseFloat(h);isNaN(n)?(c&&this._pushSegment(c,f),f=[],c=h):f.push(n)}this._pushSegment(c,f)}},setShape:function(b){this.inherited(arguments,["string"==typeof b?{path:b}:b]);this.segmented=!1;this.segments=
[];v.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});f=f("dojox.gfx.path.TextPath",b,{constructor:function(b){"text"in this||(this.text=r.clone(v.defaultTextPath));"fontStyle"in this||(this.fontStyle=r.clone(v.defaultFont))},getText:function(){return this.text},setText:function(b){this.text=v.makeParameters(this.text,"string"==typeof b?{text:b}:b);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(b){this.fontStyle="string"==typeof b?
v.splitFontString(b):v.makeParameters(v.defaultFont,b);this._setFont();return this}});return v.path={Path:b,TextPath:f}})},"*now":function(v){v(['dojo/i18n!*preload*esri/widgets/nls/Legend*["ar","bs","ca","cs","da","de","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(v,r,f,l,b,c,q,u,t,e,h,n,a,g,x){return function(h){function k(a){a=h.call(this)||this;a._handles=new q;a.activeLayerInfos=
null;a.basemapLegendVisible=!1;a.groundLegendVisible=!1;a.iconClass="esri-icon-layer-list";a.label=c.widgetLabel;a.layerInfos=null;a.style=new g;a.view=null;a.viewModel=new n;return a}l(k,h);k.prototype.postInitialize=function(){var a=this;this.own(u.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}),u.init(this,"style",function(b,c){c&&b!==c&&c.destroy();b&&(b.activeLayerInfos=a.activeLayerInfos,"card"===b.type&&(b.view=a.view))}))};k.prototype.destroy=
function(){this._handles.destroy();this._handles=null};k.prototype.castStyle=function(b){if(b instanceof a||b instanceof g)return b;if("string"===typeof b)return"card"===b?new a:new g;if(b&&"string"===typeof b.type){var c=f({},b);delete c.type;return new ("card"===b.type?a:g)(c)}return new g};k.prototype.render=function(){return this.style.render()};k.prototype._refreshActiveLayerInfos=function(a){var b=this;this._handles.removeAll();a.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)});
this.scheduleRender()};k.prototype._renderOnActiveLayerInfoChange=function(a){var b=this,c=u.init(a,"version",function(){return b.scheduleRender()});this._handles.add(c,"version_"+a.layer.uid);a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})};b([t.aliasOf("viewModel.activeLayerInfos"),x.renderable()],k.prototype,"activeLayerInfos",void 0);b([t.aliasOf("viewModel.basemapLegendVisible"),x.renderable()],k.prototype,"basemapLegendVisible",void 0);b([t.aliasOf("viewModel.groundLegendVisible"),
x.renderable()],k.prototype,"groundLegendVisible",void 0);b([t.property()],k.prototype,"iconClass",void 0);b([t.property()],k.prototype,"label",void 0);b([t.aliasOf("viewModel.layerInfos"),x.renderable()],k.prototype,"layerInfos",void 0);b([t.property(),x.renderable()],k.prototype,"style",void 0);b([e.cast("style")],k.prototype,"castStyle",null);b([t.aliasOf("viewModel.view"),x.renderable()],k.prototype,"view",void 0);b([t.property(),x.renderable(["view.size"])],k.prototype,"viewModel",void 0);return k=
b([t.subclass("esri.widgets.Legend")],k)}(t.declared(h))});