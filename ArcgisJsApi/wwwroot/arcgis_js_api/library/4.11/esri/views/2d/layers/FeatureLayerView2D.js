// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/2d/layers/features/controllers":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/promiseUtils".split(" "),function(F,d,n,e,z,h,t){function q(b){switch(b){case "on-demand":return t.create(function(b){return F(["./controllers/OnDemandController"],b)});case "memory":return t.create(function(b){return F(["./controllers/MemoryController"],
b)});case "stream":return t.create(function(b){return F(["./controllers/StreamController"],b)});default:return t.reject(new h("mapview-controller:bad-type","Unable to create controller for unknown type: "+b))}}Object.defineProperty(d,"__esModule",{value:!0});d.getControllerConfiguration=function(b,d){var e=b.source;d=d&&d.toJSON();if("stream"===b.type){e=b.purgeOptions;if(b=b.filter){var q={};b.geometry&&(q.geometry=b.geometry.toJSON());b.where&&(q.where=b.where);b=q}else b=null;return t.resolve({type:"stream",
purgeOptions:e,filter:d,serviceFilter:b,processing:null})}if(!b.capabilities.operations.supportsQuery)return t.reject(new h("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:b}));if(e&&"openPorts"in e)return d={type:"memory",filter:d,processing:"processing"in b&&b.processing&&b.processing.toWorker()||null},t.resolve(d);d={type:"on-demand",gdbVersion:"gdbVersion"in b?b.gdbVersion:null,historicMoment:"historicMoment"in b&&b.historicMoment?
b.historicMoment.getTime():null,processing:"processing"in b&&b.processing?b.processing.toWorker():null,filter:d};return t.resolve(d)};d.createController=function(b,d){return z(this,void 0,void 0,function(){var m,r,h,w,p;return e(this,function(B){switch(B.label){case 0:return[4,q(b.type)];case 1:return m=B.sent().default,r=d.serviceAndViewInfo,h=d.remoteClient,w=d.tileStore,p=new m(n({},r,{configuration:b,tileStore:w,remoteClient:h})),[4,p.setFilter({index:0,filter:b.filter})];case 2:return B.sent(),
[2,p]}})})}})},"esri/views/2d/layers/features/tileRenderers":function(){define(["require","exports","../../../../core/nextTick","../../../../core/promiseUtils"],function(F,d,n,e){Object.defineProperty(d,"__esModule",{value:!0});d.createOrReuseTileRenderer=function(d,h,t){if(d&&d.supportsRenderer(h))return e.create(function(e){return n(function(){return e(d)})});if(!h)return e.resolve(null);switch(h.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":return e.create(function(d){n(function(){return F(["./tileRenderers/SymbolTileRenderer"],
d)})}).then(function(d){return d.default}).then(function(d){return new d(t)});case "heatmap":return e.create(function(d){n(function(){return F(["./tileRenderers/HeatmapTileRenderer"],d)})}).then(function(d){return d.default}).then(function(d){return new d(t)})}return e.resolve(null)}})},"esri/views/2d/layers/support/FeatureLayerProxy":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/Accessor ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/requireUtils ../../../../core/workers ../../../../core/accessorSupport/decorators ./util module".split(" "),
function(F,d,n,e,z,h,t,q,b,r,m,y,u){Object.defineProperty(d,"__esModule",{value:!0});z=function(d){function p(b){b=d.call(this,b)||this;b.tileRenderer=null;return b}n(p,d);p.prototype.initialize=function(){var d=this;this.addResolvingPromise(r.open(b.getAbsMid("../features/Pipeline",F,u),{client:this.client,strategy:"dedicated"}).then(function(b){d._connection=b;return d._getStartupOptions(d.layer,d.featuresTiling)}).then(function(b){return Array.isArray(b.service.source)?d._connection.invoke("startup",
b,{transferList:b.service.source}):d._connection.invoke("startup",b)}))};p.prototype.destroy=function(){this._connection&&(this._connection.close(),this._connection=null)};p.prototype.configure=function(b){return this._connection.invoke("configure",b)};p.prototype.refresh=function(){return this._connection.invoke("controller.refresh")};p.prototype.redraw=function(){return this._connection.invoke("controller.redraw")};p.prototype.setViewState=function(b){return this._connection.invoke("setViewState",
b.toJSON())};p.prototype.queryFeatures=function(b){return this._connection.invoke("controller.queryFeatures",b.toJSON())};p.prototype.queryObjectIds=function(b){return this._connection.invoke("controller.queryObjectIds",b.toJSON())};p.prototype.queryFeatureCount=function(b){return this._connection.invoke("controller.queryFeatureCount",b.toJSON())};p.prototype.queryExtent=function(b){return this._connection.invoke("controller.queryExtent",b.toJSON())};p.prototype.queryLatestObservations=function(b){return this._connection.invoke("controller.queryLatestObservations",
b.toJSON())};p.prototype.onEdits=function(b){return this._connection.invoke("controller.onEdits",{addedFeatures:b.addedFeatures,deletedFeatures:b.deletedFeatures,updatedFeatures:b.updatedFeatures})};p.prototype.enableEvent=function(b,d){return this._connection.invoke("controller.enableEvent",{name:b,value:d})};p.prototype.setFilter=function(b,d){return this._connection.invoke("controller.setFilter",{index:b,filter:d})};p.prototype._getStartupOptions=function(b,d){var p=b.capabilities,g=b.objectIdField,
a=b.source,e=b.fields.map(function(a){return a.toJSON()}),B=b.fullExtent&&b.fullExtent.toJSON(),n=y.toJSONGeometryType(b.geometryType),r=b.timeInfo&&b.timeInfo.toJSON()||null;if(a&&"openPorts"in a)return a.openPorts().then(function(a){return{service:{capabilities:p,fields:e,fullExtent:B,geometryType:n,objectIdField:g,source:a,timeInfo:r},tileInfo:d.tileInfo.toJSON()}});if("stream"===b.type){var a=b.source,m=a.relatedLayerDefinition,h=a.archivedLayerDefinition,m=m&&{capabilities:m.capabilities,fields:m.fields,
fullExtent:m.extent,geometryType:m.geometryType,objectIdField:m.objectIdField,source:a.layerDefinition.relatedFeatures.featuresUrl,joinField:a.layerDefinition.relatedFeatures.joinField}||null,h=h&&{capabilities:h.capabilities,fields:h.fields,fullExtent:h.extent,geometryType:h.geometryType,objectIdField:h.objectIdField,source:a.layerDefinition.keepLatestArchive.featuresUrl,maximumFeatureAge:a.layerDefinition.keepLatestArchive.maximumFeatureAge,updateInterval:a.layerDefinition.keepLatestArchive.updateInterval}||
null;return q.resolve({service:{capabilities:b.capabilities,fields:b.fields.map(function(a){return a.toJSON()}),fullExtent:B||null,geometryType:y.toJSONGeometryType(b.geometryType),objectIdField:b.objectIdField||"__OBJECTID",source:b.parsedUrl.path,buddyLayers:{relatedFeatures:m,keepLatestArchive:h},streamUrls:a.layerDefinition.streamUrls,timeInfo:r,content:b.parsedUrl.query},tileInfo:d.tileInfo.toJSON()})}return q.resolve({service:{capabilities:p,fields:e,fullExtent:B,geometryType:n,objectIdField:g,
source:"dynamicDataSource"in b?b.dynamicDataSource?b.parsedUrl:b.url+"/"+b.layerId:b.parsedUrl,timeInfo:r},tileInfo:d.tileInfo.toJSON()})};e([m.property({constructOnly:!0})],p.prototype,"client",void 0);e([m.property({constructOnly:!0})],p.prototype,"layer",void 0);e([m.property({constructOnly:!0})],p.prototype,"featuresTiling",void 0);e([m.property()],p.prototype,"tileRenderer",void 0);return p=e([m.subclass()],p)}(m.declared(h,t));d.default=z})},"esri/views/2d/layers/support/util":function(){define(["require",
"exports","../../../../core/kebabDictionary"],function(F,d,n){Object.defineProperty(d,"__esModule",{value:!0});var e=new n.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});d.toJSONGeometryType=function(d){return e.toJSON(d)}})},"esri/views/layers/FeatureLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper @dojo/framework/shim/array @dojo/framework/shim/Set ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../../support/arcadeUtils ./RefreshableLayerView ./support/FeatureEffect ./support/FeatureFilter ./support/popupUtils".split(" "),
function(F,d,n,e,z,h,t,q,b,r,m,y,u,w,p,B,G,ea,g,a,X){var ha=m.getLogger("esri.views.layers.FeatureLayerView");return function(d){function m(a){a=d.call(this,a)||this;a.effect=null;a.filter=null;a.layer=null;a.requiredFields=null;a.view=null;return a}n(m,d);m.prototype.initialize=function(){var a=this;w.init(this,["layer.renderer","layer.labelingInfo","layer.elevationInfo.featureExpressionInfo","filter","effect"],function(){return a._updateRequiredFields()})};Object.defineProperty(m.prototype,"availableFields",
{get:function(){var a=this.layer,b=this.layer.fields,d=this.requiredFields;return"outFields"in a&&a.outFields?B.fixFields(b,B.unpackFieldNames(b,a.outFields).concat(d)):B.fixFields(b,d)},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"maximumNumberOfFeatures",{get:function(){return 0},set:function(a){ha.error("#maximumNumberOfFeatures\x3d","Setting maximum number of features is not supported")},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"maximumNumberOfFeaturesExceeded",
{get:function(){return!1},enumerable:!0,configurable:!0});m.prototype.highlight=function(a,b){void 0===b&&(b={});return this.inherited(arguments)};m.prototype.queryFeatures=function(a){return this.inherited(arguments)};m.prototype.queryObjectIds=function(a){return this.inherited(arguments)};m.prototype.queryFeatureCount=function(a){return this.inherited(arguments)};m.prototype.queryExtent=function(a){return this.inherited(arguments)};m.prototype._updateRequiredFields=function(){return t(this,void 0,
void 0,function(){var a,d,p,g,e,m,r,n,y,w,ia,l,ra;return h(this,function(h){switch(h.label){case 0:if(!this.layer||!this.view)return[2];a="3d"===this.view.type;d=this;g=p=d.layer;e=g.fields;m=g.objectIdField;r=g.renderer;n=new b.default;return[4,u.eachAlways([r?r.collectRequiredFields(n,e):null,B.collectLabelingFields(n,p),a?B.collectElevationFields(n,p):null,this.filter?B.collectFilterFields(n,p,this.filter):null,this.effect?B.collectFilterFields(n,p,this.effect.filter):null])];case 1:y=h.sent();
w=0;for(ia=y;w<ia.length;w++)l=ia[w],l.error&&ha.error(l.error);B.collectField(n,e,m);ra=q.from(n).sort();this._set("requiredFields",ra);return[2]}})})};m.prototype.validateFetchPopupFeatures=function(a){var b=this.layer;if(!this.layer.popupEnabled)return new r("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:b});if(!X.getFetchPopupTemplate(this.layer,a))return new r("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:b})};m.prototype.fetchClientPopupFeatures=
function(a){return t(this,void 0,void 0,function(){var b,d,p,g,e,m,q,n,r,ia,l;return h(this,function(ra){switch(ra.label){case 0:b=y.isSome(a)?a.clientGraphics:null;if(!b||0===b.length)return[2,u.resolve([])];d=[];p=[];g=this.layer;e=X.getFetchPopupTemplate(g,a);if(!y.isSome(e))return[2,u.resolve([])];m=G.hasGeometryOperations(e);return[4,this.createPopupQuery(a)];case 1:q=ra.sent();n=B.unpackFieldNames(g.fields,q.outFields);r=0;for(ia=b;r<ia.length;r++)l=ia[r],m||!B.featureHasFields(n,l)?p.push(l):
d.push(l);if(0===p.length)return[2,u.resolve(d)];q.objectIds=p.map(function(a){return a.attributes[g.objectIdField]});return[2,g.queryFeatures(q).then(function(a){return d.concat(a.features)}).catch(function(){return p})]}})})};m.prototype.createPopupQuery=function(a){return t(this,void 0,void 0,function(){var b,d,p;return h(this,function(g){switch(g.label){case 0:return b=this.layer,d=b.createQuery(),d.returnGeometry=!0,d.returnZ=!0,d.returnM=!0,p=d,[4,X.getRequiredFields(this.layer,X.getFetchPopupTemplate(this.layer,
a))];case 1:return p.outFields=g.sent(),d.outSpatialReference=this.view.spatialReference,[2,d]}})})};e([p.property({readOnly:!0,dependsOn:["layer.outFields?","requiredFields"]})],m.prototype,"availableFields",null);e([p.property({type:g})],m.prototype,"effect",void 0);e([p.property({type:a})],m.prototype,"filter",void 0);e([p.property()],m.prototype,"layer",void 0);e([p.property({type:Number})],m.prototype,"maximumNumberOfFeatures",null);e([p.property({readOnly:!0,type:Boolean})],m.prototype,"maximumNumberOfFeaturesExceeded",
null);e([p.property({readOnly:!0})],m.prototype,"requiredFields",void 0);e([p.property()],m.prototype,"view",void 0);return m=e([p.subclass("esri.views.layers.FeatureLayerView")],m)}(p.declared(ea))})},"esri/views/layers/support/FeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ./FeatureFilter ./ParsedFeatureEffect ./Transition".split(" "),
function(F,d,n,e,z,h,t,q,b,r,m){var y=h.getLogger("esri.views.layers.support.FeatureEffect");return function(d){function h(){var b=null!==d&&d.apply(this,arguments)||this;b.filter=null;b.includedEffect=null;b.excludedEffect=null;b.excludedLabelsVisible=!1;return b}e(h,d);p=h;Object.defineProperty(h.prototype,"insideEffect",{get:function(){y.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");return this.includedEffect},set:function(b){y.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");
this.includedEffect=b},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"outsideEffect",{get:function(){y.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");return this.excludedEffect},set:function(b){y.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");this.excludedEffect=b},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parsedIncludedEffect",{get:function(){return t.isSome(this.includedEffect)?
"string"===typeof this.includedEffect?r.fromString(this.includedEffect):new m({from:r.fromString(this.includedEffect.from),to:r.fromString(this.includedEffect.to),duration:this.includedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"parsedExcludedEffect",{get:function(){return t.isSome(this.excludedEffect)?"string"===typeof this.excludedEffect?r.fromString(this.excludedEffect):new m({from:r.fromString(this.excludedEffect.from),to:r.fromString(this.excludedEffect.to),
duration:this.excludedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"renderingHash",{get:function(){return this.excludedLabelsVisible+"-"+this.includedEffect+"-"+this.excludedEffect},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"done",{get:function(){return(!t.isSome(this.parsedIncludedEffect)||this.parsedIncludedEffect.done)&&(!t.isSome(this.parsedExcludedEffect)||this.parsedExcludedEffect.done)},enumerable:!0,configurable:!0});h.prototype.clone=
function(){return new p({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})};var p;n([q.property({type:b})],h.prototype,"filter",void 0);n([q.property({type:String})],h.prototype,"includedEffect",void 0);n([q.property({type:String})],h.prototype,"excludedEffect",void 0);n([q.property({type:Boolean})],h.prototype,"excludedLabelsVisible",void 0);n([q.property({dependsOn:["includedEffect"]})],
h.prototype,"parsedIncludedEffect",null);n([q.property({dependsOn:["excludedEffect"]})],h.prototype,"parsedExcludedEffect",null);n([q.property({dependsOn:["includedEffect","excludedEffect"]})],h.prototype,"renderingHash",null);return h=p=n([q.subclass("esri.views.layers.support.FeatureEffect")],h)}(q.declared(z))})},"esri/views/layers/support/FeatureFilter":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper @dojo/framework/shim/array @dojo/framework/shim/Set ../../../geometry ../../../TimeExtent ../../../core/JSONSupport ../../../core/kebabDictionary ../../../core/lang ../../../core/accessorSupport/decorators ../../../geometry/support/jsonUtils ../../../tasks/support/Query".split(" "),
function(F,d,n,e,z,h,t,q,b,r,m,y,u,w,p){var B=new m.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),G=new m.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(d){function g(a){a=d.call(this,a)||this;a.where=null;a.geometry=null;a.spatialRelationship="intersects";a.hiddenIds=new t.default;a.distance=void 0;a.objectIds=null;a.units=null;a.timeExtent=null;a.enabled=!1;return a}e(g,d);a=g;g.prototype.writeWhere=function(a,b,d){b.where=a||"1\x3d1"};g.prototype.enable=function(){this._set("enabled",!0)};
g.prototype.createQuery=function(a){void 0===a&&(a={});var b=this.where,d=this.spatialRelationship,g=this.timeExtent,e=this.objectIds;return new p(z({geometry:y.clone(this.geometry),objectIds:y.clone(e),spatialRelationship:d,timeExtent:y.clone(g),where:b},a))};g.prototype.clone=function(){var b=this.where,d=this.geometry,p=this.spatialRelationship,g=this.hiddenIds,e=this.timeExtent,m=this.objectIds,h=new t.default;g.forEach(function(a){return h.add(a)});return new a({geometry:y.clone(d),hiddenIds:h,
objectIds:y.clone(m),spatialRelationship:p,timeExtent:y.clone(e),where:b})};var a;n([u.property({type:String})],g.prototype,"where",void 0);n([u.writer("where")],g.prototype,"writeWhere",null);n([u.property({types:q.geometryTypes,json:{read:w.fromJSON,write:!0}})],g.prototype,"geometry",void 0);n([u.property({type:String,json:{read:{source:"spatialRel",reader:B.read},write:{target:"spatialRel",writer:B.write}}})],g.prototype,"spatialRelationship",void 0);n([u.property({json:{write:function(a,b,d){return b[d]=
h.from(a)},read:function(a,b){return new t.default(a)}}})],g.prototype,"hiddenIds",void 0);n([u.property({type:Number,json:{write:{overridePolicy:function(a){return{enabled:0<a}}}}})],g.prototype,"distance",void 0);n([u.property({type:[Number],json:{write:!0}})],g.prototype,"objectIds",void 0);n([u.property({type:String,json:{read:G.read,write:{writer:G.write,overridePolicy:function(a){return{enabled:a&&0<this.distance}}}}})],g.prototype,"units",void 0);n([u.property({type:b,json:{write:!0}})],g.prototype,
"timeExtent",void 0);n([u.property({readOnly:!0})],g.prototype,"enabled",void 0);return g=a=n([u.subclass("esri.views.layers.support.FeatureFilter")],g)}(u.declared(r))})},"esri/views/layers/support/ParsedFeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f32 ./cssFilterParser".split(" "),
function(F,d,n,e,z,h,t,q,b,r,m,y){var u=q.getLogger("esri.views.layers.support.ParsedFeatureEffect"),w={grayscale:function(b){b=1-b.amount;b=m.mat4f32.fromValues(.2126+.7874*b,.7152-.7152*b,.0722-.0722*b,0,.2126-.2126*b,.7152+.2848*b,.0722-.0722*b,0,.2126-.2126*b,.7152-.7152*b,.0722+.9278*b,0,0,0,0,1);return r.mat4.transpose(b,b)},sepia:function(b){b=1-b.amount;b=m.mat4f32.fromValues(.393+.607*b,.769-.769*b,.189-.189*b,0,.349-.349*b,.686+.314*b,.168-.168*b,0,.272-.272*b,.534-.534*b,.131+.869*b,0,
0,0,0,1);return r.mat4.transpose(b,b)},saturate:function(b){b=b.amount;b=m.mat4f32.fromValues(.213+.787*b,.715-.715*b,.072-.072*b,0,.213-.213*b,.715+.285*b,.072-.072*b,0,.213-.213*b,.715-.715*b,.072+.928*b,0,0,0,0,1);return r.mat4.transpose(b,b)},"hue-rotate":function(b){var d=Math.sin(b.angle*Math.PI/180);b=Math.cos(b.angle*Math.PI/180);d=m.mat4f32.fromValues(.213+.787*b-.213*d,.715-.715*b-.715*d,.072-.072*b+.928*d,0,.213-.213*b+.143*d,.715+.285*b+.14*d,.072-.072*b-.283*d,0,.213-.213*b-.787*d,.715-
.715*b+.715*d,.072+.928*b+.072*d,0,0,0,0,1);return r.mat4.transpose(d,d)},invert:function(b){b=b.amount;b=m.mat4f32.fromValues(-b,0,0,1,0,-b,0,1,0,0,-b,1,0,0,0,1);return r.mat4.transpose(b,b)},opacity:function(b){b=b.amount;b=m.mat4f32.fromValues(b,0,0,0,0,b,0,0,0,0,b,0,0,0,0,b);return r.mat4.transpose(b,b)},brightness:function(b){b=b.amount;b=m.mat4f32.fromValues(b,0,0,0,0,b,0,0,0,0,b,0,0,0,0,1);return r.mat4.transpose(b,b)},contrast:function(b){b=b.amount;b=m.mat4f32.fromValues(b,0,0,.5-.5*b,0,
b,0,.5-.5*b,0,0,b,.5-.5*b,0,0,0,1);return r.mat4.transpose(b,b)}};return function(d){function q(){var b=null!==d&&d.apply(this,arguments)||this;b.customTransforms=null;b.done=!0;return b}e(q,d);p=q;q.fromString=function(b){var d;try{d=y.parse(b)}catch(a){u.error(new h("invalid-type","Encountered an error when parsing css",a))}return new p({transforms:d})};q.prototype.getColorMatrix=function(){var b=this;return(this.transforms||[]).map(function(b){return z({},b)}).reverse().reduce(function(d,a){return r.mat4.multiply(d,
d,b._getFactory(a)(a))},m.mat4f32.create())};q.prototype.clone=function(){return new p({transforms:this.transforms&&this.transforms.map(function(b){return z({},b)}),customTransforms:this.customTransforms&&this.customTransforms.map(function(b){return z({},b)})})};q.prototype._getFactory=function(b){var d=w[b.type];if(!d){if(this.customTransforms)for(var d=function(a){if(a.type===b.type){a=m.mat4f32.fromValues.apply(m.mat4f32,a.matrix);var d=r.mat4.transpose(a,a);return{value:function(a){return d}}}},
a=0,e=this.customTransforms;a<e.length;a++){var h=d(e[a]);if("object"===typeof h)return h.value}u.error("invalid-type","No effect "+b.type+" exists");return function(a){return m.mat4f32.create()}}return d};var p;n([b.property()],q.prototype,"transforms",void 0);n([b.property()],q.prototype,"customTransforms",void 0);return q=p=n([b.subclass("esri.views.layers.support.ParsedFeatureEffect")],q)}(b.declared(t))})},"esri/views/layers/support/cssFilterParser":function(){define([],function(){function F(d,
n,e,z){this.message=d;this.expected=n;this.found=e;this.location=z;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,F)}(function(d,n){function e(){this.constructor=d}e.prototype=n.prototype;d.prototype=new e})(F,Error);F.buildMessage=function(d,n){function e(d){return d.charCodeAt(0).toString(16).toUpperCase()}function z(d){return d.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,
"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+e(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+e(b)})}function h(d){return d.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+e(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+e(b)})}var t={literal:function(d){return'"'+z(d.text)+'"'},"class":function(d){var b=
"",e;for(e=0;e<d.parts.length;e++)b+=d.parts[e]instanceof Array?h(d.parts[e][0])+"-"+h(d.parts[e][1]):h(d.parts[e]);return"["+(d.inverted?"^":"")+b+"]"},any:function(d){return"any character"},end:function(d){return"end of input"},other:function(d){return d.description}};return"Expected "+function(d){var b=Array(d.length),e;for(e=0;e<d.length;e++){var m=e,h;h=d[e];h=t[h.type](h);b[m]=h}b.sort();if(0<b.length){for(d=e=1;e<b.length;e++)b[e-1]!==b[e]&&(b[d]=b[e],d++);b.length=d}switch(b.length){case 1:return b[0];
case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(d)+" but "+(n?'"'+z(n)+'"':"end of input")+" found."};return{SyntaxError:F,parse:function(d,n){function e(a,b){return{type:"literal",text:a,ignoreCase:b}}function z(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function h(a){return{type:"other",description:a}}function t(a){var b=sa[a],c;if(!b){for(c=a-1;!sa[c];)c--;b=sa[c];for(b={line:b.line,column:b.column};c<a;)10===d.charCodeAt(c)?(b.line++,
b.column=1):b.column++,c++;sa[a]=b}return b}function q(a,b){var c=t(a),d=t(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function b(a){c<Z||(c>Z&&(Z=c,ta=[]),ta.push(a))}function r(){var x,l;k++;x=c;l=g();l!==a?(d.substr(c,4)===na?(l=na,c+=4):(l=a,0===k&&b(ya)),l!==a?(l=g(),l!==a?(v=x,x=null):(c=x,x=a)):(c=x,x=a)):(c=x,x=a);k--;x===a&&(l=a,0===k&&b(qa));if(x===a)if(x=[],l=m(),l!==a)for(;l!==a;)x.push(l),l=m();else x=a;return x}function m(){var x,
e,m,h,n,r,t,z,G;k++;e=c;m=g();m!==a?(d.substr(c,5)===Oa?(h=Oa,c+=5):(h=a,0===k&&b(cb)),h!==a?(n=g(),n!==a?(r=B(),r!==a?(t=g(),t!==a?(41===d.charCodeAt(c)?(z=R,c++):(z=a,0===k&&b(S)),z!==a?(G=g(),G!==a?(v=e,e=m={type:"blur",radius:r}):(c=e,e=a)):(c=e,e=a)):(c=e,e=a)):(c=e,e=a)):(c=e,e=a)):(c=e,e=a)):(c=e,e=a);k--;e===a&&(m=a,0===k&&b(bb));x=e;if(x===a){var J,X,Z,ha,ja,la,na,sa;k++;J=c;X=g();X!==a?(d.substr(c,11)===Pa?(Z=Pa,c+=11):(Z=a,0===k&&b(eb)),Z!==a?(ha=g(),ha!==a?(ja=y(),ja!==a?(la=g(),la!==
a?(41===d.charCodeAt(c)?(na=R,c++):(na=a,0===k&&b(S)),na!==a?(sa=g(),sa!==a?(v=J,J=X={type:"brightness",amount:ja}):(c=J,J=a)):(c=J,J=a)):(c=J,J=a)):(c=J,J=a)):(c=J,J=a)):(c=J,J=a)):(c=J,J=a);k--;J===a&&(X=a,0===k&&b(db));x=J;if(x===a){var K,ma,qa,ya,ta,Ea,fb,Fa;k++;K=c;ma=g();ma!==a?(d.substr(c,9)===ia?(qa=ia,c+=9):(qa=a,0===k&&b(l)),qa!==a?(ya=g(),ya!==a?(ta=y(),ta!==a?(Ea=g(),Ea!==a?(41===d.charCodeAt(c)?(fb=R,c++):(fb=a,0===k&&b(S)),fb!==a?(Fa=g(),Fa!==a?(v=K,K=ma={type:"contrast",amount:ta}):
(c=K,K=a)):(c=K,K=a)):(c=K,K=a)):(c=K,K=a)):(c=K,K=a)):(c=K,K=a)):(c=K,K=a);k--;K===a&&(ma=a,0===k&&b(nc));x=K;if(x===a){var D,Qa,gb,Ga,hb,Ha,ib,Ia,Aa,Ja,Ba,Ka,jb,La;k++;D=c;Qa=g();if(Qa!==a)if(d.substr(c,12)===Fb?(gb=Fb,c+=12):(gb=a,0===k&&b(oc)),gb!==a)if(Ga=g(),Ga!==a)if(hb=B(),hb!==a)if(Ha=g(),Ha!==a)if(ib=B(),ib!==a)if(Ia=g(),Ia!==a)if(Aa=B(),Aa===a&&(Aa=null),Aa!==a)if(Ja=g(),Ja!==a){var f,C,I,A,E,H,Y,T,fa,U,ga,V,aa,ba,Ca,za,Ma,kb;f=c;35===d.charCodeAt(c)?(C=Gb,c++):(C=a,0===k&&b(Hb));if(C!==
a)if(I=c,A=ea(),A!==a?(E=ea(),E!==a?I=A=[A,E]:(c=I,I=a)):(c=I,I=a),I!==a)if(A=c,E=ea(),E!==a?(H=ea(),H!==a?A=E=[E,H]:(c=A,A=a)):(c=A,A=a),A!==a)if(E=c,H=ea(),H!==a?(Y=ea(),Y!==a?E=H=[H,Y]:(c=E,E=a)):(c=E,E=a),E!==a){v=f;var $a=A,ab=E;f=C=[parseInt(I.join(""),16),parseInt($a.join(""),16),parseInt(ab.join(""),16)]}else c=f,f=a;else c=f,f=a;else c=f,f=a;else c=f,f=a;if(f===a){f=c;35===d.charCodeAt(c)?(C=Gb,c++):(C=a,0===k&&b(Hb));if(C!==a)if(I=ea(),I!==a)if(A=ea(),A!==a)if(E=ea(),E!==a){v=f;var Na=A,
Ib=E;f=C=[parseInt([I,I].join(""),16),parseInt([Na,Na].join(""),16),parseInt([Ib,Ib].join(""),16)]}else c=f,f=a;else c=f,f=a;else c=f,f=a;else c=f,f=a;if(f===a&&(f=c,d.substr(c,5)===oa?(C=oa,c+=5):(C=a,0===k&&b(Ra)),C!==a?(I=g(),I!==a?(A=w(),A!==a?(E=g(),E!==a?(44===d.charCodeAt(c)?(H=ca,c++):(H=a,0===k&&b(da)),H!==a?(Y=g(),Y!==a?(T=w(),T!==a?(fa=g(),fa!==a?(44===d.charCodeAt(c)?(U=ca,c++):(U=a,0===k&&b(da)),U!==a?(ga=g(),ga!==a?(V=w(),V!==a?(aa=g(),aa!==a?(44===d.charCodeAt(c)?(ba=ca,c++):(ba=a,
0===k&&b(da)),ba!==a?(Ca=g(),Ca!==a?(za=y(),za!==a?(Ma=g(),Ma!==a?(41===d.charCodeAt(c)?(kb=R,c++):(kb=a,0===k&&b(S)),kb!==a?(v=f,f=C=[255*A,255*T,255*V,za]):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a),f===a&&(f=c,d.substr(c,5)===oa?(C=oa,c+=5):(C=a,0===k&&b(Ra)),C!==a?(I=g(),I!==a?(A=u(),A!==a?(E=g(),E!==a?(44===d.charCodeAt(c)?(H=ca,c++):(H=a,0===k&&b(da)),
H!==a?(Y=g(),Y!==a?(T=u(),T!==a?(fa=g(),fa!==a?(44===d.charCodeAt(c)?(U=ca,c++):(U=a,0===k&&b(da)),U!==a?(ga=g(),ga!==a?(V=u(),V!==a?(44===d.charCodeAt(c)?(aa=ca,c++):(aa=a,0===k&&b(da)),aa!==a?(ba=g(),ba!==a?(Ca=y(),Ca!==a?(41===d.charCodeAt(c)?(za=R,c++):(za=a,0===k&&b(S)),za!==a?(v=f,f=C=[A,T,V,Ca]):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a),f===a&&(f=c,d.substr(c,5)===oa?(C=
oa,c+=5):(C=a,0===k&&b(Ra)),C!==a?(I=g(),I!==a?(A=w(),A!==a?(E=g(),E!==a?(44===d.charCodeAt(c)?(H=ca,c++):(H=a,0===k&&b(da)),H!==a?(Y=g(),Y!==a?(T=w(),T!==a?(fa=g(),fa!==a?(44===d.charCodeAt(c)?(U=ca,c++):(U=a,0===k&&b(da)),U!==a?(ga=g(),ga!==a?(V=w(),V!==a?(aa=g(),aa!==a?(41===d.charCodeAt(c)?(ba=R,c++):(ba=a,0===k&&b(S)),ba!==a?(v=f,f=C=[255*A,255*T,255*V,1]):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,
f=a),f===a&&(f=c,d.substr(c,5)===oa?(C=oa,c+=5):(C=a,0===k&&b(Ra)),C!==a?(I=g(),I!==a?(A=u(),A!==a?(E=g(),E!==a?(44===d.charCodeAt(c)?(H=ca,c++):(H=a,0===k&&b(da)),H!==a?(Y=g(),Y!==a?(T=u(),T!==a?(fa=g(),fa!==a?(44===d.charCodeAt(c)?(U=ca,c++):(U=a,0===k&&b(da)),U!==a?(ga=g(),ga!==a?(V=u(),V!==a?(41===d.charCodeAt(c)?(aa=R,c++):(aa=a,0===k&&b(S)),aa!==a?(v=f,f=C=[A,T,V,1]):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,
f=a),f===a&&(f=c,d.substr(c,4)===Sa?(C=Sa,c+=4):(C=a,0===k&&b(Jb)),C!==a?(I=g(),I!==a?(A=w(),A!==a?(E=g(),E!==a?(44===d.charCodeAt(c)?(H=ca,c++):(H=a,0===k&&b(da)),H!==a?(Y=g(),Y!==a?(T=w(),T!==a?(fa=g(),fa!==a?(44===d.charCodeAt(c)?(U=ca,c++):(U=a,0===k&&b(da)),U!==a?(ga=g(),ga!==a?(V=w(),V!==a?(aa=g(),aa!==a?(41===d.charCodeAt(c)?(ba=R,c++):(ba=a,0===k&&b(S)),ba!==a?(v=f,f=C=[255*A,255*T,255*V,1]):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):
(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a),f===a&&(f=c,d.substr(c,4)===Sa?(C=Sa,c+=4):(C=a,0===k&&b(Jb)),C!==a?(I=g(),I!==a?(A=u(),A!==a?(E=g(),E!==a?(44===d.charCodeAt(c)?(H=ca,c++):(H=a,0===k&&b(da)),H!==a?(Y=g(),Y!==a?(T=u(),T!==a?(fa=g(),fa!==a?(44===d.charCodeAt(c)?(U=ca,c++):(U=a,0===k&&b(da)),U!==a?(ga=g(),ga!==a?(V=u(),V!==a?(aa=g(),aa!==a?(41===d.charCodeAt(c)?(ba=R,c++):(ba=a,0===k&&b(S)),ba!==a?(v=f,f=C=[A,T,V,1]):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=
a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a)):(c=f,f=a),f===a))))))){var Da,ua,va;k++;Da=c;ua=[];Kb.test(d.charAt(c))?(va=d.charAt(c),c++):(va=a,0===k&&b(Lb));if(va!==a)for(;va!==a;)ua.push(va),Kb.test(d.charAt(c))?(va=d.charAt(c),c++):(va=a,0===k&&b(Lb));else ua=a;if(ua!==a){v=Da;var lb=d.substring(v,c);if(!pc.has(lb)){var Eb='unknown color "'+lb+'"',Ta=void 0,Ta=void 0!==Ta?Ta:q(v,c);throw new F(Eb,null,null,Ta);}ua=Mb[lb].concat(1)}Da=ua;k--;Da===a&&(ua=a,0===k&&b(qc));f=Da}}Ba=f;
Ba===a&&(Ba=null);Ba!==a?(Ka=g(),Ka!==a?(41===d.charCodeAt(c)?(jb=R,c++):(jb=a,0===k&&b(S)),jb!==a?(La=g(),La!==a?(v=D,D=Qa={type:"drop-shadow",offsetX:hb,offsetY:ib,blurRadius:Aa,color:Ba}):(c=D,D=a)):(c=D,D=a)):(c=D,D=a)):(c=D,D=a)}else c=D,D=a;else c=D,D=a;else c=D,D=a;else c=D,D=a;else c=D,D=a;else c=D,D=a;else c=D,D=a;else c=D,D=a;else c=D,D=a;k--;D===a&&(Qa=a,0===k&&b(ra));x=D;if(x===a){var L,Ua,mb,Nb,nb,Ob,ob,Pb;k++;L=c;Ua=g();Ua!==a?(d.substr(c,10)===Qb?(mb=Qb,c+=10):(mb=a,0===k&&b(rc)),mb!==
a?(Nb=g(),Nb!==a?(nb=y(),nb!==a?(Ob=g(),Ob!==a?(41===d.charCodeAt(c)?(ob=R,c++):(ob=a,0===k&&b(S)),ob!==a?(Pb=g(),Pb!==a?(v=L,L=Ua={type:"grayscale",amount:nb}):(c=L,L=a)):(c=L,L=a)):(c=L,L=a)):(c=L,L=a)):(c=L,L=a)):(c=L,L=a)):(c=L,L=a);k--;L===a&&(Ua=a,0===k&&b(sc));x=L;if(x===a){var M,Va,pb,Rb,qb,Sb,rb,Tb;k++;M=c;Va=g();if(Va!==a)if(d.substr(c,11)===Ub?(pb=Ub,c+=11):(pb=a,0===k&&b(tc)),pb!==a)if(Rb=g(),Rb!==a){var W,pa,wa;k++;W=c;var ka,xa,Vb;k++;ka=c;uc.test(d.charAt(c))?(xa=d.charAt(c),c++):(xa=
a,0===k&&b(vc));xa===a&&(xa=null);xa!==a?(Vb=u(),Vb!==a?(v=ka,ka=xa=parseFloat(d.substring(v,c))):(c=ka,ka=a)):(c=ka,ka=a);k--;ka===a&&(xa=a,0===k&&b(wc));pa=ka;pa!==a?(wa=p(),wa!==a?(v=W,W=pa*=wa):(c=W,W=a)):(c=W,W=a);W===a&&(W=c,48===d.charCodeAt(c)?(pa=Wb,c++):(pa=a,0===k&&b(Xb)),pa!==a?(wa=p(),wa===a&&(wa=null),wa!==a?(v=W,W=pa=0):(c=W,W=a)):(c=W,W=a));k--;W===a&&(pa=a,0===k&&b(xc));qb=W;qb!==a?(Sb=g(),Sb!==a?(41===d.charCodeAt(c)?(rb=R,c++):(rb=a,0===k&&b(S)),rb!==a?(Tb=g(),Tb!==a?(v=M,M=Va=
{type:"hue-rotate",angle:qb}):(c=M,M=a)):(c=M,M=a)):(c=M,M=a)):(c=M,M=a)}else c=M,M=a;else c=M,M=a;else c=M,M=a;k--;M===a&&(Va=a,0===k&&b(yc));x=M;if(x===a){var N,Wa,sb,Yb,tb,Zb,ub,$b;k++;N=c;Wa=g();Wa!==a?(d.substr(c,7)===ac?(sb=ac,c+=7):(sb=a,0===k&&b(zc)),sb!==a?(Yb=g(),Yb!==a?(tb=y(),tb!==a?(Zb=g(),Zb!==a?(41===d.charCodeAt(c)?(ub=R,c++):(ub=a,0===k&&b(S)),ub!==a?($b=g(),$b!==a?(v=N,N=Wa={type:"invert",amount:tb}):(c=N,N=a)):(c=N,N=a)):(c=N,N=a)):(c=N,N=a)):(c=N,N=a)):(c=N,N=a)):(c=N,N=a);k--;
N===a&&(Wa=a,0===k&&b(Ac));x=N;if(x===a){var O,Xa,vb,bc,wb,cc,xb,dc;k++;O=c;Xa=g();Xa!==a?(d.substr(c,8)===ec?(vb=ec,c+=8):(vb=a,0===k&&b(Bc)),vb!==a?(bc=g(),bc!==a?(wb=y(),wb!==a?(cc=g(),cc!==a?(41===d.charCodeAt(c)?(xb=R,c++):(xb=a,0===k&&b(S)),xb!==a?(dc=g(),dc!==a?(v=O,O=Xa={type:"opacity",amount:wb}):(c=O,O=a)):(c=O,O=a)):(c=O,O=a)):(c=O,O=a)):(c=O,O=a)):(c=O,O=a)):(c=O,O=a);k--;O===a&&(Xa=a,0===k&&b(Cc));x=O;if(x===a){var P,Ya,yb,fc,zb,gc,Ab,hc;k++;P=c;Ya=g();Ya!==a?(d.substr(c,9)===ic?(yb=
ic,c+=9):(yb=a,0===k&&b(Dc)),yb!==a?(fc=g(),fc!==a?(zb=y(),zb!==a?(gc=g(),gc!==a?(41===d.charCodeAt(c)?(Ab=R,c++):(Ab=a,0===k&&b(S)),Ab!==a?(hc=g(),hc!==a?(v=P,P=Ya={type:"saturate",amount:zb}):(c=P,P=a)):(c=P,P=a)):(c=P,P=a)):(c=P,P=a)):(c=P,P=a)):(c=P,P=a)):(c=P,P=a);k--;P===a&&(Ya=a,0===k&&b(Ec));x=P;if(x===a){var Q,Za,Bb,jc,Cb,kc,Db,lc;k++;Q=c;Za=g();Za!==a?(d.substr(c,6)===mc?(Bb=mc,c+=6):(Bb=a,0===k&&b(Fc)),Bb!==a?(jc=g(),jc!==a?(Cb=y(),Cb!==a?(kc=g(),kc!==a?(41===d.charCodeAt(c)?(Db=R,c++):
(Db=a,0===k&&b(S)),Db!==a?(lc=g(),lc!==a?(v=Q,Q=Za={type:"sepia",amount:Cb}):(c=Q,Q=a)):(c=Q,Q=a)):(c=Q,Q=a)):(c=Q,Q=a)):(c=Q,Q=a)):(c=Q,Q=a)):(c=Q,Q=a);k--;Q===a&&(Za=a,0===k&&b(Gc));x=Q}}}}}}}}}return x}function y(){var c;k++;c=w();c===a&&(c=u());k--;c===a&&0===k&&b(Eb);return c}function u(){var e,l,g;k++;e=c;l=[];ja.test(d.charAt(c))?(g=d.charAt(c),c++):(g=a,0===k&&b(la));if(g!==a)for(;g!==a;)l.push(g),ja.test(d.charAt(c))?(g=d.charAt(c),c++):(g=a,0===k&&b(la));else l=a;if(l!==a)if(46===d.charCodeAt(c)?
(g=Hc,c++):(g=a,0===k&&b(Ic)),g!==a){l=[];ja.test(d.charAt(c))?(g=d.charAt(c),c++):(g=a,0===k&&b(la));if(g!==a)for(;g!==a;)l.push(g),ja.test(d.charAt(c))?(g=d.charAt(c),c++):(g=a,0===k&&b(la));else l=a;l!==a?(v=e,e=l=parseFloat(d.substring(v,c))):(c=e,e=a)}else c=e,e=a;else c=e,e=a;if(e===a){k++;e=c;l=[];ja.test(d.charAt(c))?(g=d.charAt(c),c++):(g=a,0===k&&b(la));if(g!==a)for(;g!==a;)l.push(g),ja.test(d.charAt(c))?(g=d.charAt(c),c++):(g=a,0===k&&b(la));else l=a;l!==a&&(v=e,l=parseInt(d.substring(v,
c),10));e=l;k--;e===a&&(l=a,0===k&&b(Jc))}k--;e===a&&(l=a,0===k&&b(Kc));return e}function w(){var e,l,g;e=c;l=u();l!==a?(37===d.charCodeAt(c)?(g=Lc,c++):(g=a,0===k&&b(Mc)),g!==a?(v=e,e=l/100):(c=e,e=a)):(c=e,e=a);return e}function p(){var e,l;k++;e=c;d.substr(c,3)===Ea?(l=Ea,c+=3):(l=a,0===k&&b(Nc));l!==a&&(v=e,l=1);e=l;e===a&&(e=c,d.substr(c,4)===Fa?(l=Fa,c+=4):(l=a,0===k&&b(Oc)),l!==a&&(v=e,l=.9),e=l,e===a&&(e=c,d.substr(c,3)===Ga?(l=Ga,c+=3):(l=a,0===k&&b(Pc)),l!==a&&(v=e,l=180/Math.PI),e=l,e===
a&&(e=c,d.substr(c,4)===Ha?(l=Ha,c+=4):(l=a,0===k&&b(Qc)),l!==a&&(v=e,l=1/360),e=l)));k--;e===a&&(l=a,0===k&&b(Rc));return e}function B(){var e,l,g;k++;e=c;l=u();l!==a?(g=G(),g!==a?(v=e,e=l*g):(c=e,e=a)):(c=e,e=a);e===a&&(e=c,48===d.charCodeAt(c)?(l=Wb,c++):(l=a,0===k&&b(Xb)),l!==a?(g=G(),g===a&&(g=null),g!==a?(v=e,e=0):(c=e,e=a)):(c=e,e=a));k--;e===a&&(l=a,0===k&&b(Sc));return e}function G(){var e,l;e=c;d.substr(c,2)===Ia?(l=Ia,c+=2):(l=a,0===k&&b(Tc));l!==a&&(v=e,l=1);e=l;e===a&&(e=c,d.substr(c,
2)===Ja?(l=Ja,c+=2):(l=a,0===k&&b(Uc)),l!==a&&(v=e,l=96/2.54),e=l,e===a&&(e=c,d.substr(c,2)===Ka?(l=Ka,c+=2):(l=a,0===k&&b(Vc)),l!==a&&(v=e,l=96/2.54/10),e=l,e===a&&(e=c,81===d.charCodeAt(c)?(l=Wc,c++):(l=a,0===k&&b(Xc)),l!==a&&(v=e,l=96/2.54/40),e=l,e===a&&(e=c,d.substr(c,2)===La?(l=La,c+=2):(l=a,0===k&&b(Yc)),l!==a&&(v=e,l=96),e=l,e===a&&(e=c,d.substr(c,2)===Ma?(l=Ma,c+=2):(l=a,0===k&&b(Zc)),l!==a&&(v=e,l=16),e=l,e===a&&(e=c,d.substr(c,2)===$a?(l=$a,c+=2):(l=a,0===k&&b($c)),l!==a&&(v=e,l=96/73),
e=l))))));return e}function ea(){var e;ad.test(d.charAt(c))?(e=d.charAt(c),c++):(e=a,0===k&&b(bd));return e}function g(){var e,l;k++;e=[];ab.test(d.charAt(c))?(l=d.charAt(c),c++):(l=a,0===k&&b(Na));for(;l!==a;)e.push(l),ab.test(d.charAt(c))?(l=d.charAt(c),c++):(l=a,0===k&&b(Na));k--;e===a&&(l=a,0===k&&b(cd));return e}n=void 0!==n?n:{};var a={},X={start:r},ha=r,qa=h("none"),na="none",ya=e("none",!1),bb=h("blur()"),Oa="blur(",cb=e("blur(",!1),R=")",S=e(")",!1),db=h("brightness()"),Pa="brightness(",
eb=e("brightness(",!1),nc=h("contrast()"),ia="contrast(",l=e("contrast(",!1),ra=h("drop-shadow()"),Fb="drop-shadow(",oc=e("drop-shadow(",!1),sc=h("grayscale()"),Qb="grayscale(",rc=e("grayscale(",!1),yc=h("hue-rotate()"),Ub="hue-rotate(",tc=e("hue-rotate(",!1),Ac=h("invert()"),ac="invert(",zc=e("invert(",!1),Cc=h("opacity()"),ec="opacity(",Bc=e("opacity(",!1),Ec=h("saturate()"),ic="saturate(",Dc=e("saturate(",!1),Gc=h("sepia()"),mc="sepia(",Fc=e("sepia(",!1),Eb=h("\x3cnumber-percentage\x3e"),Jc=h("\x3cinteger\x3e"),
ja=/^[0-9]/,la=z([["0","9"]],!1,!1),Kc=h("\x3cnumber\x3e"),Hc=".",Ic=e(".",!1),wc=h("\x3csignedNumber\x3e"),uc=/^[+\-]/,vc=z(["+","-"],!1,!1),Lc="%",Mc=e("%",!1),xc=h("\x3cangle\x3e"),Wb="0",Xb=e("0",!1),Rc=h("\x3cunit\x3e"),Ea="deg",Nc=e("deg",!1),Fa="grad",Oc=e("grad",!1),Ga="rad",Pc=e("rad",!1),Ha="turn",Qc=e("turn",!1),Sc=h("\x3clength\x3e"),Ia="px",Tc=e("px",!1),Ja="cm",Uc=e("cm",!1),Ka="mm",Vc=e("mm",!1),Wc="Q",Xc=e("Q",!1),La="in",Yc=e("in",!1),Ma="pc",Zc=e("pc",!1),$a="pt",$c=e("pt",!1),Gb=
"#",Hb=e("#",!1),oa="rgba(",Ra=e("rgba(",!1),ca=",",da=e(",",!1),Sa="rgb(",Jb=e("rgb(",!1),ad=/^[0-9a-fA-F]/,bd=z([["0","9"],["a","f"],["A","F"]],!1,!1),cd=h("whitespace"),ab=/^[ \t\n\r]/,Na=z([" ","\t","\n","\r"],!1,!1),qc=h("\x3cnamed-color\x3e"),Kb=/^[a-z]/,Lb=z([["a","z"]],!1,!1),c=0,v=0,sa=[{line:1,column:1}],Z=0,ta=[],k=0,ma;if("startRule"in n){if(!(n.startRule in X))throw Error("Can't start parsing from rule \""+n.startRule+'".');ha=X[n.startRule]}var Mb={transparent:[0,0,0,0],black:[0,0,0],
silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,
158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,
61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,
0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,
196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,
142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rebeccapurple:[102,51,153],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,
82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},pc=new Set(Object.keys(Mb));ma=ha();if(ma!==a&&c===d.length)return ma;ma!==a&&c<d.length&&b({type:"end"});throw function(a,b,c){return new F(F.buildMessage(a,b),
a,b,c)}(ta,Z<d.length?d.charAt(Z):null,Z<d.length?q(Z,Z+1):q(Z,Z));}}})},"esri/views/layers/support/Transition":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4".split(" "),function(F,d,n,e,z,h,t){return function(d){function b(){var b=null!==d&&d.apply(this,arguments)||this;b.from=null;b.to=null;b.duration=4E3;b.repeat=!0;b.done=
!1;return b}e(b,d);q=b;b.prototype.getColorMatrix=function(){this.done=!1;if(null==this._lastTime)this._currentStep=0,this._lastTime=Date.now();else{var b=this._lastTime,d=Date.now();this._currentStep+=d-b;2147483647<=this._currentStep&&(this._currentStep=0);this._lastTime=d}var b=this._currentStep%this.duration/(this.duration/2),b=1>=b?b:2-b,d=this.from.getColorMatrix(),e=this.to.getColorMatrix();t.mat4.multiplyScalar(d,d,1-b);t.mat4.multiplyScalar(e,e,b);!this.repeat&&this._currentStep>=this.duration&&
(this.done=!0);return t.mat4.add(d,d,e)};b.prototype.clone=function(){var b=new q({from:this.from.clone(),to:this.to.clone(),duration:this.duration});b._lastTime=this._lastTime;b._currentStep=this._currentStep;return b};var q;n([h.property()],b.prototype,"from",void 0);n([h.property()],b.prototype,"to",void 0);n([h.property({type:Number})],b.prototype,"duration",void 0);n([h.property({type:Boolean})],b.prototype,"repeat",void 0);return b=q=n([h.subclass("esri.views.layers.support.Transition")],b)}(h.declared(z))})},
"esri/views/layers/support/popupUtils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array ../../../core/maybe ../../../layers/support/fieldUtils".split(" "),function(F,d,n,e,z,h,t){Object.defineProperty(d,"__esModule",{value:!0});d.getRequiredFields=function(d,b){void 0===b&&(b=d.popupTemplate);return e(this,void 0,void 0,function(){var e,m,q,u,w,p,B,G,F,g,a;return n(this,function(n){switch(n.label){case 0:return h.isSome(b)?
[4,b.getRequiredFields(d.fields)]:[2,[]];case 1:e=n.sent();m=b.lastEditInfoEnabled;q=d.objectIdField;u=d.typeIdField;if(z.includes(e,"*"))return[2,["*"]];p=t.fixFields;B=[d.fields];F=(G=e).concat;g=[[u]];return(a=m)?[4,t.getFeatureEditFields(d)]:[3,3];case 2:a=n.sent(),n.label=3;case 3:return(w=p.apply(void 0,B.concat([F.apply(G,g.concat([a||null]))])))&&q&&t.hasField(d.fields,q)&&-1===w.indexOf(q)&&w.push(q),[2,w]}})})};d.getFetchPopupTemplate=function(d,b){return d.popupTemplate?d.popupTemplate:
h.isSome(b)&&b.defaultPopupTemplateEnabled&&h.isSome(d.defaultPopupTemplate)?d.defaultPopupTemplate:null}})},"*noref":1}});
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/paramHelper ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry ../../../Graphic ../../../core/arrayUtils ../../../core/Collection ../../../core/Error ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../renderers/support/clickToleranceUtils ../../../tasks/support/FeatureSet ../../../tasks/support/Query ../engine/Container ../engine/webgl/definitions ./LayerView2D ./features/controllers ./features/tileRenderers ./support/FeatureLayerProxy ./support/popupUtils2D ../tiling/TileStrategy ../../layers/FeatureLayerView ../../../views/layers/support/FeatureFilter ../../layers/support/FeatureEffect".split(" "),function(F,
d,n,e,z,h,t,q,b,r,m,y,u,w,p,B,G,ea,g,a,X,ha,qa,na,ya,bb,Oa,cb,R,S,db,Pa){var eb=ea.ensureType(X);return function(d){function h(){var a=null!==d&&d.apply(this,arguments)||this;a._pipelineIsUpdating=!1;a._filterRequestsOutstanding=Array(qa.MAX_FILTERS);a._updatingFilter=!1;a._updatingRenderer=!1;a.container=new ha.Container;a.filter=null;a.effect=null;a.highlightIDs=new Set;return a}n(h,d);h.prototype.destroy=function(){this._proxy.destroy()};h.prototype.initialize=function(){var a=this;this._proxy=
this._createProxy();if(this.layer.isTable)this.addResolvingPromise(p.reject(new u("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer})));else{this.addResolvingPromise(p.all([ya.getControllerConfiguration(this.layer,this.filter),this._proxy.when()]).then(function(a){return a[1].configure({controller:a[0]})}));var b=this.watch("filter",function(){return a._handleFilterChange(0,a.filter)}),d=this.watch("effect",function(b,d){d&&b&&b.filter.enable();a._handleFilterChange(1,
b&&b.filter)});this.handles.add(b);this.handles.add(d)}};Object.defineProperty(h.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"numFeatures",{get:function(){var a=0;this.attached&&this._tileStrategy.tiles.forEach(function(b){a+=b.iconDisplayRecords?
b.iconDisplayRecords.length:0});return a},enumerable:!0,configurable:!0});Object.defineProperty(h.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var a=this.availableFields,b=this.layer,d=b.definitionExpression,e=b.renderer,b=b.labelingInfo,g="historicMoment"in this.layer?this.layer.historicMoment:null;return JSON.stringify({effectHash:w.isSome(this.effect)&&this.effect.renderingHash,definitionExpression:d,historicMoment:g,availableFields:a,renderer:e,labelingInfo:b})},
enumerable:!0,configurable:!0});h.prototype.highlight=function(a,b){var d=this;void 0===b&&(b={});var e;a instanceof r?e=[a.getAttribute(this.layer.objectIdField||"__OBJECTID")]:"number"===typeof a?e=[a]:y.isCollection(a)?e=a.map(function(a){return a&&a.getAttribute(d.layer.objectIdField)}).toArray():Array.isArray(a)&&0<a.length&&(e="number"===typeof a[0]?a:a.map(function(a){return a&&a.getAttribute(d.layer.objectIdField)}));(e=e.filter(function(a){return null!=a}))&&e.length&&this._addHighlight(e);
return{remove:function(){d._removeHighlight(e)},pause:function(){d._removeHighlight(e)},resume:function(){d._addHighlight(e)}}};h.prototype._addHighlight=function(a){for(var b=0;b<a.length;b++)this.highlightIDs.add(a[b]);this._updateHighlight()};h.prototype._removeHighlight=function(a){for(var b=0;b<a.length;b++)this.highlightIDs.delete(a[b]);this._updateHighlight()};h.prototype.hitTest=function(a,b){var d=this;return this.suspended||!this.tileRenderer?p.resolve(null):this.tileRenderer.hitTest(a,
b).then(function(a){return 0===a.length?null:d._proxy.queryFeatures(new X({objectIds:a,outSpatialReference:d.view.spatialReference,returnGeometry:!0})).then(function(a){if(!a.features[0])return null;a=r.fromJSON(a.features[0]);a.layer=d.layer;a.sourceLayer=d.layer;a.geometry&&(a.geometry.spatialReference=d.view.spatialReference);return a})})};h.prototype.queryFeatures=function(b){var d=this;return this.queryFeaturesJSON(b).then(function(b){b=a.fromJSON(b);b.features.forEach(function(a){a.layer=d.layer;
a.sourceLayer=d.layer});return b})};h.prototype.queryFeaturesJSON=function(a){return this._proxy.queryFeatures(this._cleanUpQuery(a))};h.prototype.queryObjectIds=function(a){return this._proxy.queryObjectIds(this._cleanUpQuery(a))};h.prototype.queryFeatureCount=function(a){return this._proxy.queryFeatureCount(this._cleanUpQuery(a))};h.prototype.queryExtent=function(a){return this._proxy.queryExtent(this._cleanUpQuery(a)).then(function(a){return{count:a.count,extent:b.Extent.fromJSON(a.extent)}})};
h.prototype.setVisibility=function(a,b){this.tileRenderer.setFilterFlag(0,b?[a]:[],b?[]:[a],!0)};h.prototype.update=function(a){this.attached&&this._tileStrategy&&this.tileRenderer&&(this._tileStrategy.update(a)||this.requestUpdate(),this._proxy.setViewState(a.state),this.notifyChange("numFeatures"),this.notifyChange("updating"))};h.prototype.attach=function(){var a=this;this._tileStrategy=new R({cachePolicy:"purge",acquireTile:function(b){return a._acquireTile(b)},releaseTile:function(b){return a._releaseTile(b)},
tileInfoView:this.view.featuresTilingScheme,buffer:0});this.handles.add([B.watch(this,"layer.processing?.version",function(b){a._proxy.redraw()}),this.layer.on("edits",function(b){a._proxy.onEdits(b)}),B.init(this,"renderingConfigHash",function(){return a._renderingConfigHashChanged()})],"attach")};h.prototype.detach=function(){this.container.removeAllChildren();this.handles.remove("attach");this._tileRendererPromise=null;this._pipelineIsUpdating=!1;this.tileRenderer&&(this.tileRenderer.uninstall(this.container),
this.tileRenderer=null);this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null)};h.prototype.moveStart=function(){this.requestUpdate()};h.prototype.viewChange=function(){this.requestUpdate()};h.prototype.moveEnd=function(){this.requestUpdate()};h.prototype.fetchPopupFeatures=function(a,b){return q(this,void 0,void 0,function(){var d,e,l;return t(this,function(g){if(d=this.validateFetchPopupFeatures(b))return[2,p.reject(d)];e=this.fetchClientPopupFeatures(b);if(!a)return[2,e];l=
this._fetchServicePopupFeatures(a,b);return[2,p.eachAlwaysValues([e,l]).then(m.flatten)]})})};h.prototype._fetchServicePopupFeatures=function(a,b){return q(this,void 0,void 0,function(){var d,e,l,h,m,n,p,q,r,u;return t(this,function(t){switch(t.label){case 0:return[4,this.createPopupQuery(b)];case 1:d=t.sent();e=this.layer;l=e.renderer;h=g.calculateTolerance(l);d.geometry=this.createFetchPopupFeaturesQueryGeometry(a,h);m=new Set;n=e.objectIdField;if(p=w.isSome(b)?b.clientGraphics:null)for(q=0,r=p;q<
r.length;q++)u=r[q],m.add(u.attributes[n]);return[2,e.queryFeatures(d).then(function(a){return a.features.filter(function(a){return!m.has(a.attributes[n])})})]}})})};h.prototype.createFetchPopupFeaturesQueryGeometry=function(a,b){return cb.createQueryGeometry(a,b,this.view)};h.prototype.doRefresh=function(){this._proxy.refresh()};h.prototype.isUpdating=function(){return null!=this.layer.renderer&&(null==this.tileRenderer||this._pipelineIsUpdating||this.tileRenderer.updating||this._updatingFilter||
this._updatingRenderer)};h.prototype._createClientOptions=function(){var a=this;return{executeProcessing:function(b){if(!("processing"in a.layer&&a.layer.processing))return b.featureSet;var d=a.layer.processing;return(b=d.process(b.featureSet,d.options))?b:p.reject(new u("FeatureLayer","invalid processing.process() method, returns nothing"))},setUpdating:function(b){a._pipelineIsUpdating=b;a.notifyChange("updating")}}};h.prototype._cleanUpQuery=function(a){a=a?eb(a):new X;a.outSpatialReference||(a.outSpatialReference=
this.view.spatialReference);return a};h.prototype._handleFilterChange=function(a,b){return q(this,void 0,void 0,function(){var d,e,g,l,h,m,n;return t(this,function(p){switch(p.label){case 0:if(w.isSome(this._filterRequestsOutstanding[a]))return this._filterRequestsOutstanding[a]={filter:b},[2];this._updatingFilter=!0;d=w.isSome(b)&&b.toJSON();return[4,this._proxy.setFilter(a,d)];case 1:e=p.sent();g=e.show;l=e.hide;this.tileRenderer&&this.tileRenderer.setFilterFlag(a,g,l,!1);w.isSome(b)&&b.enable();
this.tileRenderer&&(this.tileRenderer.featuresView.requestRender(),h=!(!this.layer.labelingInfo||!this.layer.labelingInfo.length))&&(this.tileRenderer.forEachTile(function(a){return a.isDirty=!0}),this.view.labelManager.requestUpdate());for(m=0;m<this._filterRequestsOutstanding.length;m++)if(n=this._filterRequestsOutstanding[m],w.isSome(n)){this._filterRequestsOutstanding[m]=null;this._handleFilterChange(m,n.filter);break}this._updatingFilter=!1;return[2]}})})};h.prototype._createProxy=function(){return new Oa.default({layer:this.layer,
featuresTiling:this.view.featuresTilingScheme,client:this._createClientOptions()})};h.prototype._acquireTile=function(a){var b=this;a=this.tileRenderer.acquireTile(a);a.once("attach",function(){b.requestUpdate()});return a};h.prototype._releaseTile=function(a){this.tileRenderer.releaseTile(a)};h.prototype._renderingConfigHashChanged=function(){var a=this;this._updatingRenderer=!0;var b=this._tileRendererPromise=bb.createOrReuseTileRenderer(this.tileRenderer,this.layer.renderer,{layerView:this,tileInfoView:this.view.featuresTilingScheme,
layer:this.layer}).then(function(d){a._tileRendererPromise===b&&(a._tileRendererPromise=null,a.tileRenderer!==d&&(a._tileStrategy.clear(),a.tileRenderer&&(a.tileRenderer.uninstall(a.container),a.tileRenderer.destroy()),(a.tileRenderer=a._proxy.client.tileRenderer=d)&&d.install(a.container),a._updateHighlight(),a.requestUpdate()),d?(d=d.getProcessorConfiguration(),a.tileRenderer.wouldClear(d)?(a.tileRenderer.clear(),a.tileRenderer.applyConfiguration(d),a._proxy.configure({processor:d}).then(function(){a._updatingRenderer=
!1;a.notifyChange("updating")}),a.requestUpdate()):a.tileRenderer.needsProcessorReconfiguration(d)?(a._proxy.configure({processor:d}).then(function(){a._updatingRenderer=!1;a.notifyChange("updating")}),a.requestUpdate()):(a.tileRenderer.applyConfiguration(d),a.requestUpdate(),a._updatingRenderer=!1,a.notifyChange("updating"))):a._updatingRenderer=!1)},function(){a._tileRendererPromise=null;a._updatingRenderer=!1;a.notifyChange("updating")})};h.prototype._updateHighlight=function(){this.tileRenderer&&
"updateHighlight"in this.tileRenderer&&this.tileRenderer.updateHighlight()};e([G.property()],h.prototype,"_pipelineIsUpdating",void 0);e([G.property()],h.prototype,"_updatingFilter",void 0);e([G.property()],h.prototype,"_updatingRenderer",void 0);e([G.property({dependsOn:["suspended","layer.labelingInfo","layer.labelsVisible"]})],h.prototype,"labelsVisible",null);e([G.property({type:db})],h.prototype,"filter",void 0);e([G.property({type:Pa})],h.prototype,"effect",void 0);e([G.property({readOnly:!0,
dependsOn:["effect"]})],h.prototype,"effects",null);e([G.property()],h.prototype,"numFeatures",null);e([G.property({dependsOn:"effect layer.renderer availableFields layer.definitionExpression layer.historicMoment? layer.labelingInfo".split(" ")})],h.prototype,"renderingConfigHash",null);e([G.property()],h.prototype,"tileRenderer",void 0);e([G.property({dependsOn:["layer.renderer","tileRenderer.updating","_updatingFilter","_updatingRenderer"]})],h.prototype,"updating",void 0);return h=e([G.subclass("esri.views.2d.layers.FeatureLayerView2D")],
h)}(G.declared(na,S))});