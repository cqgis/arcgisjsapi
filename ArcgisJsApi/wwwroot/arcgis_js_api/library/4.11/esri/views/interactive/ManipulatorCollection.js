// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../../core/iteratorUtils ../../core/maybe ../../core/screenUtils ../../core/libs/gl-matrix-2/vec2".split(" "),function(g,r,l,k,h,m){g=function(){function b(){this._toolManipulators=new Map;this._nextManipulatorId=0}b.prototype.add=function(a,d,c){this._toolManipulators.has(a)||this._toolManipulators.set(a,[]);a=this._toolManipulators.get(a);var f=this._nextManipulatorId++;a.push({id:f,manipulator:d,pointerUpEventId:c})};b.prototype.remove=function(a,d){if(this._toolManipulators.has(a)){a=
this._toolManipulators.get(a);for(var c=0;c<a.length;c++)if(a[c].manipulator===d)return d=a.splice(c,1)[0],a=d.id,d.manipulator.destroy(),a;return null}};b.prototype.removeTool=function(a){this._toolManipulators.has(a)&&(this._toolManipulators.get(a).forEach(function(a){return a.manipulator.destroy()}),this._toolManipulators.delete(a))};b.prototype.removeAll=function(){var a=this;this._toolManipulators.forEach(function(d,c){a.removeTool(c)})};b.prototype.destroy=function(){this.removeAll()};b.prototype.forEach=
function(a){l.everyMap(this._toolManipulators,function(d,c){for(var f=0;f<d.length;f++)if(!1===a(d[f].manipulator,c))return!1;return!0})};b.prototype.findClosest=function(a,d,c){void 0===c&&(c=null);var f=null,e=Number.MAX_VALUE;this._toolManipulators.forEach(function(b,h){b.forEach(function(b){var n=b.id,g=b.manipulator;b.pointerUpEventId!==c&&(b=g.intersectionDistance(a,d),k.isSome(b)&&b<e&&g.active&&(e=b,f={tool:h,manipulatorId:n}))})});return f};b.prototype.hasOverlappingInTool=function(a,b,c){var d=
0;for(a=this._toolManipulators.get(a);d<a.length;d++){var e=a[d].manipulator;if(b!==e&&!e.allowOverlap){var g=h.screenPointObjectToArray(c,p),k=h.screenPointObjectToArray(e.screenPoint,q),g=m.vec2.squaredDistance(g,k),e=b.radius+e.radius;if(g<e*e)return!0}}return!1};b.prototype.findByKey=function(a){if(k.isNone(a))return null;for(var b=0,c=this._toolManipulators.get(a.tool);b<c.length;b++){var f=c[b],e=f.manipulator;if(f.id===a.manipulatorId)return e}return null};return b}();var p=h.createScreenPointArray(),
q=h.createScreenPointArray();return g});