// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Evented ../../core/Handles ../../core/screenUtils ../../core/accessorSupport/decorators ./DrawAction ./input/DrawEvents".split(" "),function(m,n,p,k,q,r,t,d,h,u,v){Object.defineProperty(n,"__esModule",{value:!0});var w=function(){function d(b,a,c){this.view=b;this.native=a;this.vertices=c;this.defaultPrevented=!1;this.type="rectangle-cursor-update"}d.prototype.preventDefault=
function(){this.defaultPrevented=!0};return d}();m=function(l){function b(){var a=null!==l&&l.apply(this,arguments)||this;a._cursorMoved=!1;a._startPoint=null;a._viewHandles=new t;a._dragEnabled=!0;a.vertices=[];a.view=null;return a}p(b,l);b.prototype.initialize=function(){this._addViewHandles()};b.prototype.destroy=function(){this._removeViewHandles();this._viewHandles.destroy();this.emit("destroy")};b.prototype.complete=function(){4===this.vertices.length&&this._drawCompleteHandler(null)};b.prototype._addViewHandles=
function(){var a=this;this._removeViewHandles();this._viewHandles.add([this.view.on("pointer-down",function(c){a._startPoint=d.createScreenPointFromEvent(c)}),this.view.on("pointer-move",function(c){if(a._startPoint){var e=d.createScreenPointFromEvent(c);a._cursorMoved=!0;a._cursorUpdateHandler(c.native,e)}}),this.view.on("pointer-up",function(c){if(!a._cursorMoved){var e=c.x,b=c.y,f=a.view.toMap(d.createScreenPoint(e-48,b+48)),e=a.view.toMap(d.createScreenPoint(e+48,b-48));a._set("vertices",[[f.x,
e.y],[e.x,e.y],[e.x,f.y],[f.x,f.y]])}a._drawCompleteHandler(c.native)}),this.view.on("drag",function(c){a._dragEnabled&&a._startPoint&&c.stopPropagation()})])};b.prototype._removeViewHandles=function(){this._viewHandles.removeAll()};b.prototype._cursorUpdateHandler=function(a,c){var b=c.x,g=c.y;c=Math.min(b,this._startPoint.x);var f=Math.min(g,this._startPoint.y),g=Math.abs(g-this._startPoint.y);Math.abs(b-this._startPoint.x)&&g?(b=this.view.toMap(d.createScreenPoint(c,f+g)),c=this.view.toMap(d.createScreenPoint(c,
f)),this._set("vertices",[[b.x,c.y],[c.x,c.y],[c.x,b.y],[b.x,b.y]]),a=new w(this.view,a,this.vertices),this.emit("cursor-update",a)):this._set("vertices",[])};b.prototype._drawCompleteHandler=function(a){a=new v.DrawCompleteEvent(a,this.vertices);this.emit("draw-complete",a);a.defaultPrevented?(this._cursorMoved=!1,this._startPoint=null,this._set("vertices",[])):this._removeViewHandles()};k([h.property({readOnly:!0})],b.prototype,"vertices",void 0);k([h.property()],b.prototype,"view",void 0);return b=
k([h.subclass("esri/views/2d/engine/markup/RectangleDrawAction")],b)}(h.declared(u,q,r));n.RectangleDrawAction=m});