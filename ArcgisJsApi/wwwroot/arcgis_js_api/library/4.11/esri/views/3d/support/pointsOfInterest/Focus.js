// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/screenUtils ../../../../core/accessorSupport/decorators ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../geometry/Point ../geometryUtils ../mathUtils ../PropertiesPool ./PointOfInterest".split(" "),function(m,n,q,h,r,e,f,c,t,u,v,w,x){Object.defineProperty(n,"__esModule",{value:!0});var y=Array;m=function(c){function a(b){b=c.call(this,
b)||this;b.propertiesPool=new w.default({locationOnSurface:t,renderLocationOnSurface:y},b);b.centerOnSurface=null;return b}q(a,c);a.prototype.destroy=function(){this.propertiesPool.destroy();this.propertiesPool=null};Object.defineProperty(a.prototype,"locationOnSurface",{get:function(){var b=this.propertiesPool.get("locationOnSurface");this.renderCoordsHelper.fromRenderCoords(this.renderLocationOnSurface,b,this.state.spatialReference);return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"renderLocationOnSurface",{get:function(){var b=this.centerOnSurface.renderLocation,k=this.renderCoordsHelper,a=this.calculateScreenHorizontalEdgeOnSurface(z);f.vec3.subtract(l,b,this.state.camera.eye);f.vec3.normalize(l,l);k.worldUpAtPosition(b,p);var d=Math.abs(Math.acos(f.vec3.dot(p,l))-.5*Math.PI),k=this.propertiesPool.get("renderLocationOnSurface"),d=1-v.clamp(d/(.5*Math.PI),0,1);f.vec3.lerp(k,b,a,d*d*d);return k},enumerable:!0,configurable:!0});a.prototype.update=function(b){};a.prototype.forceUpdate=
function(){};a.prototype.hasPendingUpdates=function(){return this.centerOnSurface.hasPendingUpdates()};a.prototype.calculateScreenHorizontalEdgeOnSurface=function(b){var a=this.state.camera,c=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation),d=this.renderCoordsHelper.getAltitude(a.eye)>=c,e=a.getRenderCenter(r.createRenderScreenPointArray3());e[1]=d?a.padding[2]:a.fullHeight-a.padding[0];a.unprojectPoint(e,g);f.vec3.subtract(g,g,a.eye);d=f.vec3.normalize(g,g);if(this.renderCoordsHelper.intersectManifold(u.ray.wrap(a.eye,
d),c,b))return b;f.vec3.copy(b,a.eye);this.renderCoordsHelper.setAltitude(c,b);return b};h([e.property({constructOnly:!0})],a.prototype,"centerOnSurface",void 0);h([e.property({readOnly:!0,dependsOn:["renderLocationOnSurface"]})],a.prototype,"locationOnSurface",null);h([e.property({readOnly:!0,dependsOn:["centerOnSurface.renderLocation"]})],a.prototype,"renderLocationOnSurface",null);return a=h([e.subclass("esri.views.3d.support.CenterOnSurface")],a)}(e.declared(x.PointOfInterest));n.Focus=m;var l=
c.vec3f64.create(),p=c.vec3f64.create(),g=c.vec3f64.create(),z=c.vec3f64.create();n.default=m});