// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/quat ../../../core/libs/gl-matrix-2/quatf32 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f32 ../../../core/libs/gl-matrix-2/vec3f64 ../../../geometry/support/aaBoundingBox ./dito ./geometryUtils".split(" "),function(t,d,v,w,p,k,l,g,u,x,y,m){function q(a,b,c){return{center:u.vec3f64.clone(a),halfSize:g.vec3f32.clone(b),quaternion:k.quatf32.clone(c)}}
function e(a,b){var c=m.plane.signedDistance(b,a.center);a=r(a,b);return c>a?1:c<-a?-1:0}function r(a,b){p.quat.conjugate(n,a.quaternion);l.vec3.transformQuat(h,b,n);a=a.halfSize;return Math.abs(h[0]*a[0])+Math.abs(h[1]*a[1])+Math.abs(h[2]*a[2])}Object.defineProperty(d,"__esModule",{value:!0});var n=k.quatf32.create(),h=g.vec3f32.create(),z=g.vec3f32.create(),A=w.mat3f32.create();t=function(){return function(a){this.buffer=new ArrayBuffer(56*a);this.obbs=Array(a);for(var b=0;b<a;b++)this.obbs[b]=
{center:u.vec3f64.createView(this.buffer,56*b+0),halfSize:g.vec3f32.createView(this.buffer,56*b+24),quaternion:k.quatf32.createView(this.buffer,56*b+36)}}}();d.ObbArray=t;d.create=q;d.clone=function(a){return q(a.center,a.halfSize,a.quaternion)};d.set=function(a,b){l.vec3.copy(b.center,a.center);l.vec3.copy(b.halfSize,a.halfSize);p.quat.copy(b.quaternion,a.quaternion)};d.compute=function(a,b){b||(b=q([0,0,0],[-1,-1,-1],[0,0,0,1]));y.computeOBB(a,b);return b};d.intersectPlane=e;d.toAaBoundingBox=function(a,
b){b||(b=x.create());var c=v.mat3.fromQuat(A,a.quaternion),d=a.halfSize[0]*Math.abs(c[0])+a.halfSize[1]*Math.abs(c[3])+a.halfSize[2]*Math.abs(c[6]),e=a.halfSize[0]*Math.abs(c[1])+a.halfSize[1]*Math.abs(c[4])+a.halfSize[2]*Math.abs(c[7]),c=a.halfSize[0]*Math.abs(c[2])+a.halfSize[1]*Math.abs(c[5])+a.halfSize[2]*Math.abs(c[8]);b[0]=a.center[0]-d;b[1]=a.center[1]-e;b[2]=a.center[2]-c;b[3]=a.center[0]+d;b[4]=a.center[1]+e;b[5]=a.center[2]+c;return b};d.minimumDistancePlane=function(a,b){var c=m.plane.signedDistance(b,
a.center);a=r(a,b);return c-a};d.maximumDistancePlane=function(a,b){var c=m.plane.signedDistance(b,a.center);a=r(a,b);return c+a};d.isVisible=function(a,b){return 0>=e(a,b.planes[0])&&0>=e(a,b.planes[1])&&0>=e(a,b.planes[2])&&0>=e(a,b.planes[3])&&0>=e(a,b.planes[4])&&0>=e(a,b.planes[5])};d.intersectLine=function(a,b,c,d){void 0===d&&(d=0);p.quat.conjugate(n,a.quaternion);l.vec3.subtract(h,b,a.center);b=l.vec3.transformQuat(h,h,n);c=l.vec3.transformQuat(z,c,n);for(var e=-Infinity,g=Infinity,f=0;3>
f;f++)if(1E-6<Math.abs(c[f]))var k=(d+a.halfSize[f]-b[f])/c[f],m=(-d-a.halfSize[f]-b[f])/c[f],e=Math.max(e,Math.min(k,m)),g=Math.min(g,Math.max(k,m));else if(b[f]>a.halfSize[f]+d||b[f]<-a.halfSize[f]-d)return!1;return e<=g}});