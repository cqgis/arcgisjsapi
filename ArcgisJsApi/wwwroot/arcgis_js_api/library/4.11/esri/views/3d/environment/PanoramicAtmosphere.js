// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f64 ./resources/SimpleAtmosphereTexture ../support/imageUtils ../support/buffer/glUtil ../support/buffer/InterleavedLayout ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Util ../webgl-engine/shaders/SimpleAtmospherePrograms ../../webgl/BufferObject ../../webgl/programUtils ../../webgl/renderState ../../webgl/Texture ../../webgl/Util ../../webgl/Util ../../webgl/VertexArrayObject".split(" "),function(h,
D,p,q,r,t,u,v,w,k,l,x,y,f,z,A,B,C){h=function(){function e(c){this.needsRender=!1;this.didRender=!0;this.slot=12;this.view=c}e.prototype.destroy=function(){this._program&&(this._program.dispose(),this._program=null);this._texture&&(this._texture.dispose(),this._texture=null);this._readyPromise&&(this._readyPromise.cancel(),this._readyPromise=null)};e.prototype.when=function(c){return this._readyPromise.then(c)};e.prototype.initializeRenderContext=function(c){var d=this,b=c.rctx;this._program=y.createProgram(b,
l.colorPass,{panoramic:!0});this._pipelineState=f.makePipelineState({blending:f.separateBlendingParams(770,1,771,771),culling:f.backFaceCullingParams,depthTest:{func:515},colorWrite:f.defaultColorWriteParams});this._vao=this._createVertexArrayObject(b);this._vaoCount=B.vertexCount(this._vao,"geometry");this._readyPromise=t.requestImage(r).then(function(a){d._texture=new z(c.rctx,{pixelFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!0},a);d.needsRender=!0})};e.prototype.uninitializeRenderContext=
function(c){this.destroy()};e.prototype.render=function(c){if(c.slot!==this.slot||0!==c.pass||null==this._texture)return!1;var d=c.rctx,b=this._program;d.bindProgram(b);d.setPipelineState(this._pipelineState);d.bindTexture(this._texture);b.setUniform1i("tex",0);b.setUniformMatrix4fv("proj",c.camera.projectionMatrix);var a=m;p.mat4.copy(a,c.camera.viewMatrix);a[12]=0;a[13]=0;a[14]=0;a[15]=1;b.setUniformMatrix4fv("view",m);b.setUniform4f("color",1,1,1,1);b.setUniform3fv("lightDirection",c.lightingData.direction);
d.bindVAO(this._vao);A.assertCompatibleVertexAttributeLocations(this._vao,b);d.drawArrays(4,0,this._vaoCount);return!0};e.prototype._createVertexArrayObject=function(c){for(var d=w.createPolySphereGeometry(1,2,!1),b=d.indices[k.VertexAttrConstants.POSITION],a=0;a<b.length;a+=3){var e=b[a];b[a]=b[a+2];b[a+2]=e}for(var d=d.vertexAttributes[k.VertexAttrConstants.POSITION].data,e=n.createBuffer(b.length),f=e.position,a=0;a<b.length;++a){var g=3*b[a];f.set(a,0,d[g]);f.set(a,1,d[g+1]);f.set(a,2,d[g+2])}return new C(c,
l.colorPass.attributes,{geometry:u.glLayout(n)},{geometry:x.createVertex(c,35044,e.buffer)})};return e}();var m=q.mat4f64.create(),n=v.newLayout().vec3f("position");return h});