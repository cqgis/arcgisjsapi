// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define(["require","exports","../support/mathUtils","./TerrainConst"],function(v,w,r,u){return function(){function n(a,d,b,f){this.samplerData=null;this.level=a;this.i=d;this.j=b;this.extent=f}n.prototype.computeMinMaxValue=function(a,d,b,f){var c=Infinity,h=-Infinity;a-=this.level;var e=Math.pow(2,a);if(Math.floor(d/e)===this.i&&Math.floor(b/e)===this.j&&0<a){var k=this.samplerData.width,g=this.samplerData.pixelData,p=.5*u.ELEVATION_NODATA_VALUE;a=(k-1)/e;b=(b-this.j*e)*a;var q=(d-this.i*e)*a;if(1>
a){var n=Math.floor(b),t=Math.floor(q),l=n+t*k;d=g[l];var e=g[l+1],m=g[l+k],l=g[l+k+1];if(d+e+m+l<p)return c=b-n,p=q-t,h=r.bilerp(d,e,m,l,c,p),k=r.bilerp(d,e,m,l,c+a,p),g=r.bilerp(d,e,m,l,c,p+a),a=r.bilerp(d,e,m,l,c+a,p+a),f[0]=Math.min(h,k,g,a),f[1]=Math.max(h,k,g,a),f;b=n;q=t;a=1}else b=Math.floor(b),q=Math.floor(q),a=Math.ceil(a);for(d=b;d<=b+a;d++)for(e=q;e<=q+a;e++)l=d+e*k,m=g[l],m<p?(c=Math.min(c,m),h=Math.max(h,m)):(c=0<c?0:c,h=0>h?0:h)}f[0]=c;f[1]=h;return f};n.create=function(a,d,b){a=new n(a[0],
a[1],a[2],d);d=b.noDataValue;var f=b.minValue,c=b.maxValue;if(null==f||null==c){for(var h=b.values,f=Infinity,c=-Infinity,e=!0,k=0;k<h.length;k++){var g=h[k];g!==d&&(f=g<f?g:f,c=g>c?g:c,e=!1)}e&&(c=f=0)}c=-3E38<c?c:0;a.samplerData={pixelData:b.values,width:b.width,height:b.height,minValue:f,maxValue:c,noDataValue:d,safeWidth:.99999999*(b.width-1),dx:(b.width-1)/(a.extent[2]-a.extent[0]),dy:(b.width-1)/(a.extent[3]-a.extent[1]),x0:a.extent[0],y1:a.extent[3]};a.bounds=[f,c];return a};return n}()});