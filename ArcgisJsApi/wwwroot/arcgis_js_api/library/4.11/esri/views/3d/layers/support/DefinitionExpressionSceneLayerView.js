// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.11/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/Accessor ../../../../core/Logger ../../../../core/accessorSupport/decorators ../../../../core/sql/WhereClause ../../../../layers/support/fieldUtils ../i3s/I3SUtil".split(" "),function(c,g,h,f,k,l,d,m,n,p){Object.defineProperty(g,"__esModule",{value:!0});var e=l.getLogger("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView");c=function(c){function a(){var b=
null!==c&&c.apply(this,arguments)||this;b._definitionExpressionErrors=0;b._maxDefinitionExpressionErrors=20;b.logError=function(a){b._definitionExpressionErrors<b._maxDefinitionExpressionErrors&&e.error("Error while evaluating definitionExpression: "+a);b._definitionExpressionErrors++;b._definitionExpressionErrors===b._maxDefinitionExpressionErrors&&e.error("Further errors are ignored")};return b}h(a,c);Object.defineProperty(a.prototype,"parsedDefinitionExpression",{get:function(){if(this.layer.definitionExpression)try{var b=
m.create(this.layer.definitionExpression);if(!b.isStandardized())return e.error("definitionExpression is using non standard function"),null;var a=[],c=b.getFields();p.findFieldsCaseInsensitive(c,this.layer.fields,{missingFields:a});if(0<a.length)return e.error("definitionExpression references unknown fields: "+a.join(", ")),null;this._definitionExpressionErrors=0;return b}catch(r){e.error("Failed to parse definitionExpression: "+r)}return null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"definitionExpressionFields",{get:function(){return this.parsedDefinitionExpression?n.fixFields(this.layer.fields,this.parsedDefinitionExpression.getFields()):null},enumerable:!0,configurable:!0});a.prototype._evaluateClause=function(a,c){try{return a.testFeature(c)}catch(q){return this.logError(q),!1}};f([d.property()],a.prototype,"layer",void 0);f([d.property({readOnly:!0,dependsOn:["layer.definitionExpression"]})],a.prototype,"parsedDefinitionExpression",null);f([d.property({readOnly:!0,dependsOn:["parsedDefinitionExpression"]})],
a.prototype,"definitionExpressionFields",null);return a=f([d.subclass("esri.views.3d.layers.support.DefinitionExpressionSceneLayerView")],a)}(d.declared(k));g.DefinitionExpressionSceneLayerView=c;g.default=c});